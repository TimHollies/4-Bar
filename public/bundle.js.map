{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","app/app.js","app/editor/editor.html","app/editor/editor.js","app/home/home.html","app/home/home.js","app/index.gen.html","app/partials/userbox.html","app/routes.js","app/tunebook/tunebook_edit.html","app/tunebook/tunebook_edit.js","app/tunebook/tunebook_view.html","app/tunebook/tunebook_view.js","app/tutorial/tut/tut01.html","app/tutorial/tutorial.html","app/tutorial/tutorial.js","app/user/user.js","app/viewer/viewer.html","app/viewer/viewer.js","engine/abc_mode.js","engine/audio/audio.js","engine/audio/midi.js","engine/audio/myplayer.js","engine/audio_render.js","engine/data_tables.js","engine/diff.js","engine/dispatcher.js","engine/engine.js","engine/layout.js","engine/lexer.js","engine/parser.js","engine/render.js","engine/rendering/custom_elements.js","engine/rendering/glyphs.js","engine/rendering/stave_symbols.js","engine/scripts/codemirror_simple.js","engine/scripts/divvy/divvy.js","engine/scripts/transitions/ractive.transitions.fade.js","engine/scripts/transitions/ractive.transitions.fly.js","engine/springs.js","engine/types.js","engine/types/AbcBeam.js","engine/types/AbcChord.js","engine/types/AbcSymbol.js","engine/types/LineCollection.js","engine/vendor.js","node_modules/base64-arraybuffer/lib/base64-arraybuffer.js","node_modules/base64-js/lib/b64.js","node_modules/browserify/node_modules/browser-resolve/empty.js","node_modules/clockmaker/clockmaker.js","node_modules/codemirror/addon/lint/lint.js","node_modules/codemirror/lib/codemirror.js","node_modules/combokeys/Combokeys/index.js","node_modules/combokeys/Combokeys/prototype/addEvents.js","node_modules/combokeys/Combokeys/prototype/bind.js","node_modules/combokeys/Combokeys/prototype/bindMultiple.js","node_modules/combokeys/Combokeys/prototype/bindSequence.js","node_modules/combokeys/Combokeys/prototype/bindSingle.js","node_modules/combokeys/Combokeys/prototype/fireCallback.js","node_modules/combokeys/Combokeys/prototype/getKeyInfo.js","node_modules/combokeys/Combokeys/prototype/getMatches.js","node_modules/combokeys/Combokeys/prototype/getReverseMap.js","node_modules/combokeys/Combokeys/prototype/handleKey.js","node_modules/combokeys/Combokeys/prototype/handleKeyEvent.js","node_modules/combokeys/Combokeys/prototype/modifiersMatch.js","node_modules/combokeys/Combokeys/prototype/pickBestAction.js","node_modules/combokeys/Combokeys/prototype/reset.js","node_modules/combokeys/Combokeys/prototype/resetSequenceTimer.js","node_modules/combokeys/Combokeys/prototype/resetSequences.js","node_modules/combokeys/Combokeys/prototype/stopCallback.js","node_modules/combokeys/Combokeys/prototype/trigger.js","node_modules/combokeys/Combokeys/prototype/unbind.js","node_modules/combokeys/Combokeys/reset.js","node_modules/combokeys/helpers/addEvent.js","node_modules/combokeys/helpers/characterFromEvent.js","node_modules/combokeys/helpers/eventModifiers.js","node_modules/combokeys/helpers/isModifier.js","node_modules/combokeys/helpers/keysFromString.js","node_modules/combokeys/helpers/preventDefault.js","node_modules/combokeys/helpers/shift-map.js","node_modules/combokeys/helpers/special-aliases.js","node_modules/combokeys/helpers/special-characters-map.js","node_modules/combokeys/helpers/special-keys-map.js","node_modules/combokeys/helpers/stopPropagation.js","node_modules/combokeys/index.js","node_modules/data-set/create-hash.js","node_modules/data-set/index.js","node_modules/diff/diff.js","node_modules/domready/ready.js","node_modules/error/node_modules/camelize/index.js","node_modules/error/node_modules/string-template/index.js","node_modules/error/node_modules/xtend/mutable.js","node_modules/error/typed.js","node_modules/individual/index.js","node_modules/is-object/index.js","node_modules/isomorphic-fetch/node_modules/whatwg-fetch/fetch.js","node_modules/isomorphic-fetch/npm-client.js","node_modules/lex/lexer.js","node_modules/lodash/dist/lodash.js","node_modules/page/index.js","node_modules/query-string/query-string.js","node_modules/ractive/ractive.js","node_modules/randomcolor/randomColor.js","node_modules/screenfull/dist/screenfull.js","node_modules/sizzle/dist/sizzle.js","node_modules/sortablejs/Sortable.js","node_modules/virtual-dom/create-element.js","node_modules/virtual-dom/diff.js","node_modules/virtual-dom/h.js","node_modules/virtual-dom/node_modules/global/document.js","node_modules/virtual-dom/patch.js","node_modules/virtual-dom/vdom/apply-properties.js","node_modules/virtual-dom/vdom/create-element.js","node_modules/virtual-dom/vdom/dom-index.js","node_modules/virtual-dom/vdom/patch-op.js","node_modules/virtual-dom/vdom/patch.js","node_modules/virtual-dom/vdom/update-widget.js","node_modules/virtual-dom/virtual-hyperscript/hooks/data-set-hook.js","node_modules/virtual-dom/virtual-hyperscript/hooks/ev-hook.js","node_modules/virtual-dom/virtual-hyperscript/hooks/soft-set-hook.js","node_modules/virtual-dom/virtual-hyperscript/index.js","node_modules/virtual-dom/virtual-hyperscript/parse-tag.js","node_modules/virtual-dom/virtual-hyperscript/svg.js","node_modules/virtual-dom/vnode/handle-thunk.js","node_modules/virtual-dom/vnode/is-thunk.js","node_modules/virtual-dom/vnode/is-vhook.js","node_modules/virtual-dom/vnode/is-vnode.js","node_modules/virtual-dom/vnode/is-vtext.js","node_modules/virtual-dom/vnode/is-widget.js","node_modules/virtual-dom/vnode/version.js","node_modules/virtual-dom/vnode/vnode.js","node_modules/virtual-dom/vnode/vpatch.js","node_modules/virtual-dom/vnode/vtext.js","node_modules/virtual-dom/vtree/diff.js","node_modules/weakmap-shim/create-store.js","node_modules/weakmap-shim/hidden-store.js","node_modules/x-is-array/index.js","node_modules/zazate.js/core/chords.js","node_modules/zazate.js/core/diatonic.js","node_modules/zazate.js/core/init.js","node_modules/zazate.js/core/intervals.js","node_modules/zazate.js/core/meter.js","node_modules/zazate.js/core/notes.js","node_modules/zazate.js/core/scales.js","node_modules/zazate.js/node_modules/underscore/underscore.js","../node_modules/filesaver.js/FileSaver.js"],"names":[],"mappings":"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A;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjaA,YAAY,CAAC;;AAEb,IACI,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC,MAAM;IAC5B,MAAM,GAAG,OAAO,CAAC,eAAe,CAAC;IAEjC,SAAS,GAAG,MAAM,CAAC,MAAM;IACzB,IAAI,GAAG,MAAM,CAAC,IAAI;;;AAElB,SAAS,GAAG,MAAM,CAAC,MAAM;IACzB,WAAW,GAAG,MAAM,CAAC,MAAM;IAE3B,aAAa,GAAG,OAAO,CAAC,qBAAqB,CAAC;IAC9C,WAAW,GAAG,OAAO,CAAC,oBAAoB,CAAC;IAE3C,KAAK,GAAG,OAAO,CAAC,cAAc,CAAC;IAC/B,cAAc,GAAG,OAAO,CAAC,kCAAkC,CAAC;IAC5D,iBAAiB,GAAG,OAAO,CAAC,iBAAiB,CAAC;IAC9C,UAAU,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC,UAAU;IACzC,c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AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;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CAAC,QAAQ,EAAE,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC,CAAC;KAC1C,CAAA;;;AAGD,QAAI,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC;AAC3B,gBAAQ,EAAE,KAAK;AACf,gBAAQ,EAAE,QAAQ;AAClB,cAAM,EAAE,MAAM;KACf,CAAC,CAAC;;AAEH,WAAO,OAAO,CAAC;CAClB,CAAC;;;ACjMF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACpDA,IAAI,SAAS,GAAG,OAAO,MAAM,KAAK,WAAW,CAAC;;AAE9C,MAAM,CAAC,OAAO,GAAG;AACb,OAAG,EAAE;AACD,YAAI,EAAE,UAAU;AAChB,aAAK,EAAE,SAAS,GAAG,OAAO,CAAC,eAAe,CAAC,GAAG,IAAI;KACrD;AACD,aAAS,EAAE;AACP,YAAI,EAAE,YAAY;AAClB,aAAK,EAAE,SAAS,GAAG,OAAO,CAAC,mBAAmB,CAAC,GAAG,IAAI;KACzD;AACD,WAAO,EAAE;AACL,YAAI,EAAE,UAAU;AAChB,aAAK,EAAE,SAAS,GAAG,OAAO,CAAC,eAAe,CAAC,GAAG,IAAI;KACrD;AACD,aAAS,EAAE;AACP,YAAI,EAAE,YAAY;AAClB,aAAK,EAAE,SAAS,GAAG,OAAO,CAAC,mBAAmB,CAAC,GAAG,IAAI;KACzD;AACD,eAAW,EAAE;AACT,YAAI,EAAE,cAAc;AACpB,aAAK,EAAE,SAAS,GAAG,OAAO,CAAC,uBAAuB,CAAC,GAAG,IAAI;KAC7D;AACD,eAAW,EAAE;AACT,YAAI,EAAE,cAAc;AACpB,aAAK,EAAE,SAAS,GAAG,OAAO,CAAC,4BAA4B,CAAC,GAAG,IAAI;KAClE;AACD,oBAAgB,EAAE;AACd,YAAI,EAAE,oBAAoB;AAC1B,aAAK,EAAE,SAAS,GAAG,OAAO,CAAC,4BAA4B,CAAC,GAAI,IAAI;KACnE;CACJ,CAAC;;;AC/BF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA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G,OAAO,CAAC,MAAM,CAAC;AAC3B,gBAAQ,EAAE,KAAK;AACf,gBAAQ,EAAE,QAAQ;AAClB,cAAM,EAAE,MAAM;AACd,gBAAQ,EAAE,QAAQ;KACnB,CAAC,CAAC;;AAEH,WAAO,OAAO,CAAC;CAElB,CAAC;;;ACxFF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA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AAC,CAAC;KAClC,CAAC,CAAC;;AAEP,WAAO,CAAC,GAAG,CAAC,iBAAiB,EAAE,UAAS,SAAS,EAAE,MAAM,EAAE;AACvD,YAAI,MAAM,CAAC,MAAM,IAAI,CAAC,EAAE,OAAO,SAAS,CAAC;AACzC,eAAO,SAAS,CAAC,MAAM,CAAC,UAAS,CAAC,EAAE;AAChC,mBAAO,CAAC,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,WAAW,CAAC,MAAM,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC;SAC1E,CAAC,CAAC;KACN,CAAC,CAAC;;;CAGN,CAAC;;;ACxCF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzGA,YAAY,CAAC;;AAEb,IACI,IAAI,GAAG,OAAO,CAAC,8CAA8C,CAAC;IAC9D,GAAG,GAAG,OAAO,CAAC,6CAA6C,CAAC;IAE5D,UAAU,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC,UAAU;IACzC,WAAW,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC,WAAW;IAE3C,MAAM,GAAG,OAAO,CAAC,eAAe,CAAC;IAEjC,SAAS,GAAG,MAAM,CAAC,MAAM;IACzB,WAAW,GAAG,MAAM,CAAC,MAAM;IAC3B,IAAI,GAAG,MAAM,CAAC,IAAI;IAClB,SA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,CAAC;AACpC,UAAM,EAAE,OAAO,CAAC,QAAQ,CAAC;AACzB,YAAQ,EAAE,OAAO,CAAC,UAAU,CAAC;AAC7B,YAAQ,EAAE,OAAO,CAAC,YAAY,CAAC;CAClC,CAAC;;;ACvBF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5HA;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtpPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AClBA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpVA;AACA;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACjJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACjoNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5bA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3gcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChhEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACp/BA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACfA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACx0CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClHA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClcA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5vCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"bundle.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\r\nconsole.log(\"NOT READY\");\r\n\r\nvar consoleKeeper = console;\r\n\r\n//require.ensure('vendor', function() {\r\n\r\nconsole.log(\"ALMOST\");\r\n\r\nvar\r\n    Ractive = require('vendor').Ractive,\r\n    routingConfig = require(\"./routes\"),\r\n    page = require('vendor').page,\r\n    _ = require('vendor').lodash,\r\n    domready = require('vendor').domready;\r\n\r\nconsole = consoleKeeper;\r\n\r\nconsole.log(\"ALMOST\");\r\n\r\ndomready(() => {\r\n\r\n    console.log(\"READY\");\r\n\r\n    var components = {};\r\n\r\n    _.forOwn(routingConfig, function (val, key) {\r\n        components[val.name] = val.model;\r\n    });\r\n\r\n    var ractive = new Ractive({\r\n        el: \"#stage\",\r\n        template: require(\"app/index.gen.html\"),\r\n        data: {\r\n            url: \"\"\r\n        },\r\n        lazy: false,\r\n        partials: {\r\n            userbox: require(\"app/partials/userbox.html\")\r\n        },\r\n        components: components\r\n    });\r\n\r\n    //user stuff\r\n    var loggedIn = false,\r\n        userData = {};\r\n    \r\n    if(loggedIn) {\r\n        ractive.set(\"loggedIn\", true);\r\n        ractive.set(\"user\", userData);\r\n    } else {\r\n\r\n        ractive.set(\"loggedIn\", false);\r\n\r\n\r\n        fetch(\"/api/user\")\r\n        .then(function(response) {\r\n            return response.json()\r\n        }).then(function(data) {\r\n\r\n            console.log(\"CURRENT USER\", data);\r\n\r\n            ractive.set(\"loggedIn\", true);\r\n            loggedIn = true;\r\n\r\n            ractive.set(\"user\", data);\r\n            userData = data;\r\n\r\n        }).catch(function(ex) {\r\n            console.log('parsing failed', ex)\r\n        });\r\n    }   \r\n    \r\n    ractive.on('*.log_in', function() {\r\n        page(\"/auth/google\");\r\n    });\r\n\r\n    ractive.on(\"*.navigate_to_page\", function(urlToNavigateTo) {\r\n        page(urlToNavigateTo);\r\n    });\r\n\r\n    //forcs the request to go to the server rather than the client\r\n    page.serverMap = function(url) {\r\n        page(url, function(context) {\r\n            window.location = url;\r\n        });\r\n    }\r\n\r\n    page.serverMap(\"/auth/google\");\r\n    page.serverMap(\"/logout\");\r\n\r\n    page('*', function(context) {\r\n        console.log(context)\r\n        //route(context.pathname.substr(1), context);\r\n        ractive.set(\"url\", context);\r\n    });\r\n\r\n    page.start();\r\n\r\n});","module.exports = { v:1,\n  t:[ { t:7,\n      e:\"section\",\n      a:{ \"class\":\"page-view\",\n        id:\"view-editor\" },\n      f:[ { t:7,\n          e:\"div\",\n          a:{ \"class\":\"header row\" },\n          t1:\"fade\",\n          v:{ mouseup:\"app_mouseup\" },\n          f:[ { t:7,\n              e:\"div\",\n              a:{ \"class\":\"back-button\" },\n              v:{ click:\"navigate_back\" },\n              f:[ { t:7,\n                  e:\"p\",\n                  f:[ { t:7,\n                      e:\"i\",\n                      a:{ \"class\":\"fa fa-arrow-left\" } } ] } ] },\n            \" \",\n            { t:7,\n              e:\"div\",\n              a:{ \"class\":\"central-menu\" },\n              f:[ { t:7,\n                  e:\"h3\",\n                  a:{ \"class\":\"tune-title\" },\n                  f:[ { t:2,\n                      r:\"title\" } ] },\n                \" \",\n                { t:7,\n                  e:\"br\" },\n                \" \",\n                { t:7,\n                  e:\"div\",\n                  a:{ id:\"menuButtons\" } } ] },\n            \" \",\n            { t:8,\n              r:\"userbox\" },\n            \" \",\n            { t:4,\n              n:50,\n              x:{ r:[ \"loggedIn\" ],\n                s:\"!_0\" },\n              f:[ { t:7,\n                  e:\"p\",\n                  f:[ \"Your tune cannot be saved unless you are logged in\" ] } ] } ] },\n        \" \",\n        { t:7,\n          e:\"div\",\n          a:{ \"class\":\"row toolbar\" },\n          t1:\"fade\",\n          f:[ { t:7,\n              e:\"div\",\n              a:{ \"class\":\"toolbar-item\" },\n              f:[ { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"dropdown-selected-value\" },\n                  v:{ click:\"show-transposition-menu\" },\n                  f:[ { t:7,\n                      e:\"span\",\n                      a:{ \"class\":\"selected-span\" },\n                      f:[ { t:2,\n                          r:\"selectedTransposition\" } ] },\n                    { t:7,\n                      e:\"span\",\n                      a:{ \"class\":\"arrow-span\" },\n                      f:[ { t:7,\n                          e:\"i\",\n                          a:{ \"class\":\"fa fa-arrow-down\" } } ] } ] },\n                \" \",\n                { t:4,\n                  n:50,\n                  r:\"showingTranspositionDropdown\",\n                  f:[ { t:7,\n                      e:\"table\",\n                      a:{ \"class\":\"table-to-dropdown\" },\n                      f:[ { t:7,\n                          e:\"tr\",\n                          f:[ { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-icon\" } },\n                            { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-option\",\n                                val:\"-7\" },\n                              v:{ click:\"selectTransposition\" },\n                              f:[ \"-7 Semitones\" ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"tr\",\n                          f:[ { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-icon\" } },\n                            { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-option\",\n                                val:\"-6\" },\n                              v:{ click:\"selectTransposition\" },\n                              f:[ \"-6 Semitones\" ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"tr\",\n                          f:[ { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-icon\" },\n                              f:[ { t:7,\n                                  e:\"i\",\n                                  a:{ \"class\":\"fa fa-minus\" } },\n                                \" \",\n                                { t:7,\n                                  e:\"i\",\n                                  a:{ \"class\":\"fa fa-minus\" } } ] },\n                            { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-option\",\n                                val:\"-5\" },\n                              v:{ click:\"selectTransposition\" },\n                              f:[ \"-5 Semitone\" ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"tr\",\n                          f:[ { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-icon\" } },\n                            { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-option\",\n                                val:\"-4\" },\n                              v:{ click:\"selectTransposition\" },\n                              f:[ \"-4 Semitones\" ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"tr\",\n                          f:[ { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-icon\" } },\n                            { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-option\",\n                                val:\"-3\" },\n                              v:{ click:\"selectTransposition\" },\n                              f:[ \"-3 Semitones\" ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"tr\",\n                          f:[ { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-icon\" },\n                              f:[ { t:7,\n                                  e:\"i\",\n                                  a:{ \"class\":\"fa fa-minus\" } } ] },\n                            { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-option\",\n                                val:\"-2\" },\n                              v:{ click:\"selectTransposition\" },\n                              f:[ \"-2 Semitones\" ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"tr\",\n                          f:[ { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-icon\" } },\n                            { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-option\",\n                                val:\"-1\" },\n                              v:{ click:\"selectTransposition\" },\n                              f:[ \"-1 Semitones\" ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"tr\",\n                          f:[ { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-icon\" },\n                              f:[ { t:7,\n                                  e:\"i\",\n                                  a:{ \"class\":\"fa fa-circle\" } } ] },\n                            { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-option\",\n                                val:\"0\" },\n                              v:{ click:\"selectTransposition\" },\n                              f:[ \"No Tranposition\" ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"tr\",\n                          f:[ { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-icon\" } },\n                            { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-option\",\n                                val:\"1\" },\n                              v:{ click:\"selectTransposition\" },\n                              f:[ \"+1 Semitone\" ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"tr\",\n                          f:[ { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-icon\" },\n                              f:[ { t:7,\n                                  e:\"i\",\n                                  a:{ \"class\":\"fa fa-plus\" } } ] },\n                            { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-option\",\n                                val:\"2\" },\n                              v:{ click:\"selectTransposition\" },\n                              f:[ \"+2 Semitones\" ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"tr\",\n                          f:[ { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-icon\" } },\n                            { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-option\",\n                                val:\"3\" },\n                              v:{ click:\"selectTransposition\" },\n                              f:[ \"+3 Semitones\" ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"tr\",\n                          f:[ { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-icon\" } },\n                            { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-option\",\n                                val:\"4\" },\n                              v:{ click:\"selectTransposition\" },\n                              f:[ \"+4 Semitones\" ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"tr\",\n                          f:[ { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-icon\" },\n                              f:[ { t:7,\n                                  e:\"i\",\n                                  a:{ \"class\":\"fa fa-plus\" } },\n                                \" \",\n                                { t:7,\n                                  e:\"i\",\n                                  a:{ \"class\":\"fa fa-plus\" } } ] },\n                            { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-option\",\n                                val:\"5\" },\n                              v:{ click:\"selectTransposition\" },\n                              f:[ \"+5 Semitones\" ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"tr\",\n                          f:[ { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-icon\" } },\n                            { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-option\",\n                                val:\"6\" },\n                              v:{ click:\"selectTransposition\" },\n                              f:[ \"+6 Semitones\" ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"tr\",\n                          f:[ { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-icon\" } },\n                            { t:7,\n                              e:\"td\",\n                              a:{ \"class\":\"dropdown-option\",\n                                val:\"7\" },\n                              v:{ click:\"selectTransposition\" },\n                              f:[ \"+7 Semitones\" ] } ] } ] } ] } ] },\n            \" \",\n            { t:7,\n              e:\"div\",\n              a:{ \"class\":\"toolbar-item\" },\n              f:[ { t:4,\n                  n:50,\n                  r:\"playing\",\n                  f:[ { t:7,\n                      e:\"i\",\n                      v:{ click:\"toggle-stop-tune\" },\n                      a:{ \"class\":\"fa fa-stop\",\n                        style:\"cursor: pointer\" } } ] },\n                { t:4,\n                  n:51,\n                  f:[ { t:7,\n                      e:\"i\",\n                      v:{ click:\"toggle-play-tune\" },\n                      a:{ \"class\":\"fa fa-play\",\n                        style:\"cursor: pointer\" } } ],\n                  r:\"playing\" } ] } ] },\n        \" \",\n        { t:7,\n          e:\"div\",\n          a:{ \"class\":\"row editor\",\n            id:\"editor-section\" },\n          t1:\"fade\",\n          f:[ { t:7,\n              e:\"dialog\",\n              a:{ id:\"window\" },\n              f:[ { t:7,\n                  e:\"h3\",\n                  f:[ \"URL\" ] },\n                \" \",\n                { t:7,\n                  e:\"p\",\n                  a:{ style:\"width: 480px;word-break: break-all;\" },\n                  f:[ { t:2,\n                      r:\"quick_url\" } ] },\n                \" \",\n                { t:7,\n                  e:\"button\",\n                  v:{ click:\"share_url_modal_close\" },\n                  f:[ \"Done\" ] } ] },\n            \" \",\n            { t:7,\n              e:\"div\",\n              a:{ \"class\":\"column\",\n                id:\"abc-container\" },\n              f:[ { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"abc-editor\" },\n                  f:[ { t:7,\n                      e:\"textarea\",\n                      a:{ id:\"abc\" } } ] },\n                \" \",\n                { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"abc-log\" },\n                  f:[ { t:4,\n                      n:50,\n                      x:{ r:[ \"errors.length\" ],\n                        s:\"_0>0\" },\n                      f:[ { t:7,\n                          e:\"table\",\n                          f:[ { t:7,\n                              e:\"thead\",\n                              f:[ { t:7,\n                                  e:\"th\" },\n                                \" \",\n                                { t:7,\n                                  e:\"th\",\n                                  f:[ \"Line\" ] },\n                                \" \",\n                                { t:7,\n                                  e:\"th\",\n                                  f:[ \"Message\" ] } ] },\n                            \" \",\n                            { t:7,\n                              e:\"tbody\",\n                              f:[ { t:4,\n                                  n:52,\n                                  r:\"errors\",\n                                  f:[ { t:7,\n                                      e:\"tr\",\n                                      f:[ { t:7,\n                                          e:\"td\",\n                                          a:{ \"class\":\"centered-column\" },\n                                          f:[ { t:4,\n                                              n:50,\n                                              x:{ r:[ \"severity\" ],\n                                                s:\"_0===1\" },\n                                              f:[ { t:7,\n                                                  e:\"i\",\n                                                  a:{ \"class\":\"fa fa-times-circle\",\n                                                    style:\"color:red\" } } ] },\n                                            { t:4,\n                                              n:51,\n                                              f:[ { t:7,\n                                                  e:\"i\",\n                                                  a:{ \"class\":\"fa fa-exclamation-triangle\",\n                                                    style:\"color:orange\" } } ],\n                                              x:{ r:[ \"severity\" ],\n                                                s:\"_0===1\" } } ] },\n                                        \" \",\n                                        { t:7,\n                                          e:\"td\",\n                                          a:{ \"class\":\"centered-column\" },\n                                          f:[ { t:2,\n                                              x:{ r:[ \"line\" ],\n                                                s:\"_0+1\" } } ] },\n                                        \" \",\n                                        { t:7,\n                                          e:\"td\",\n                                          f:[ { t:2,\n                                              r:\"message\" } ] } ] } ] } ] } ] } ] },\n                    { t:4,\n                      n:51,\n                      f:[ { t:7,\n                          e:\"p\",\n                          a:{ \"class\":\"all-is-well-box\" },\n                          f:[ \"No errors detected :D\" ] } ],\n                      x:{ r:[ \"errors.length\" ],\n                        s:\"_0>0\" } } ] },\n                \" \",\n                { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"stats\" },\n                  f:[ { t:7,\n                      e:\"small\",\n                      f:[ \"Last Render: \",\n                        { t:2,\n                          x:{ r:[ \"lastRenderTime\" ],\n                            s:\"_0.toFixed(2)\" } },\n                        \"ms\" ] } ] } ] },\n            \" \",\n            { t:7,\n              e:\"div\",\n              a:{ \"class\":\"column\",\n                id:\"canvas\" },\n              f:[  ] } ] } ] } ] }","'use strict';\r\n\r\nvar\r\n    _ = require('vendor').lodash,\r\n    engine = require('engine/engine'),\r\n\r\n    ABCParser = engine.parser,\r\n    diff = engine.diff,\r\n    //dispatcher = engine.dispatcher,\r\n    ABCLayout = engine.layout,\r\n    ABCRenderer = engine.render,\r\n\r\n    AudioRenderer = require('engine/audio_render'),\r\n    AudioEngine = require('engine/audio/audio'),\r\n\r\n    enums = require('engine/types'),\r\n    customElements = require('engine/rendering/custom_elements'),\r\n    CodeMirrorABCMode = require('engine/abc_mode'),\r\n    CodeMirror = require('vendor').codeMirror,\r\n    CodeMirrorLint = require('vendor').codeMirrorLint,\r\n    siz = require('vendor').sizzle,\r\n    queryString = require('vendor').queryString,\r\n\r\n    FileSaver = require('vendor').filesaver,\r\n    toastr = require('vendor').toastr,\r\n    Combokeys = require('vendor').combokeys,\r\n    AbcLine = require('engine/types/LineCollection').AbcLine,\r\n    Divvy = require('engine/scripts/divvy/divvy.js'),\r\n\r\n    tunePlayer = require('engine/audio/myplayer');\r\n\r\nrequire('scripts/transitions/ractive.transitions.fade');\r\nrequire('scripts/transitions/ractive.transitions.fly');\r\n\r\nvar emptyTuneName = \"Untitled Tune\"; \r\n\r\nwindow.siz = siz;\r\n\r\nvar textFile = null,\r\n    makeTextFile = function(text) {\r\n        var data = new Blob([text], {\r\n            type: 'text/plain'\r\n        });\r\n\r\n        // If we are replacing a previously generated file we need to\r\n        // manually revoke the object URL to avoid memory leaks.\r\n        if (textFile !== null) {\r\n            window.URL.revokeObjectURL(textFile);\r\n        }\r\n\r\n        textFile = window.URL.createObjectURL(data);\r\n\r\n        return textFile;\r\n    };\r\n\r\nvar template = require(\"./editor.html\");\r\n\r\nmodule.exports = function() {\r\n\r\n    var onInit = function() {\r\n\r\n        var ractive = this;\r\n\r\n        var parser = ABCParser(ractive),\r\n            layout = ABCLayout(ractive),\r\n            renderer = ABCRenderer(ractive);\r\n\r\n        var transposeAmount = 0;\r\n\r\n        var errors = [];\r\n        var processedTune = null;\r\n\r\n        var parameters = queryString.parse(ractive.get(\"url\").querystring);\r\n\r\n        ractive.set(\"errors\", errors);\r\n\r\n        ractive.set(\"showingTranspositionDropdown\", false);\r\n        ractive.set(\"selectedTransposition\", \"No Transposition\");\r\n\r\n       /*var divvy = new Divvy({\r\n            el: document.getElementById(\"editor-section\"), // this is a reference to the container DOM element\r\n            columns: [     // or you can have rows instead\r\n                'left',\r\n                'right'\r\n            ]\r\n        });*/\r\n\r\n        \r\n\r\n        ractive.on({\r\n            \"abc_error\": (data) => {\r\n                data.markers = [];\r\n\r\n                var editor = ractive.get('editor');\r\n                data.markers.push(editor.markText({line: data.line, ch: data.char-1}, {line: data.line, ch: data.char}, {className: \"styled-background\"}));\r\n                data.markers.push(editor.markText({line: data.line, ch: data.char}, {line: data.line, ch: editor.getLine(data.line).length}, {className: \"error-not-drawn\"}));\r\n\r\n                editor.setGutterMarker(data.line, \"error-markers\", document.createRange().createContextualFragment('<i class=\"fa fa-times-circle\" style=\"color:red;padding-left: 4px;\"></i>'));\r\n\r\n                errors.push(data); \r\n\r\n                //ractive.update( 'errors' );\r\n                ractive.set(\"errors\", errors);\r\n            },\r\n            \"remove_abc_error\": (data) => {\r\n                errors = errors.filter((c) => c.type !== data);\r\n                ractive.set(\"errors\", errors);\r\n            },\r\n            \"navigate_back\": function(event) {\r\n                window.history.back();\r\n            },\r\n            \"share_url_modal_close\": function() {\r\n                dialog.close();\r\n            },\r\n            \"silly-save\": function() {\r\n                ractive.fire(\"save_tune\");\r\n            },\r\n            \"show-transposition-menu\": () => {\r\n                ractive.set(\"showingTranspositionDropdown\", !ractive.get(\"showingTranspositionDropdown\"));\r\n            },\r\n            \"selectTransposition\": (event) => {\r\n                console.log(\"EVT\", event);\r\n                var intValue = parseInt(event.node.attributes.val.value);\r\n                transposeAmount = intValue;\r\n                ractive.fire(\"transpose_change\", intValue);\r\n\r\n                ractive.set(\"selectedTransposition\", event.node.innerText);\r\n                ractive.set(\"showingTranspositionDropdown\", false);\r\n            },\r\n            \"toggle-play-tune\": () => {\r\n                //AudioEngine.play(AudioRenderer(processedTune));\r\n                tunePlayer(AudioRenderer(processedTune));\r\n                ractive.set(\"playing\", true);\r\n            },\r\n            \"toggle-stop-tune\": () => {\r\n                AudioEngine.stop();\r\n                ractive.set(\"playing\", false);\r\n            },\r\n            \"download_abc\": function() {\r\n                var blob = new Blob([ractive.get(\"inputValue\")], {\r\n                    type: \"text/plain;charset=utf-8\"\r\n                });\r\n                FileSaver(blob, ractive.get(\"title\") + \".abc\");\r\n            },\r\n            \"change_tune_title\": function(data) {\r\n                ractive.set(\"title\", data);\r\n            },\r\n            \"show_share_dialog\": function() {\r\n                ractive.set(\"quick_url\", \"localhost:3000/editor?tune=\" + encodeURIComponent(ractive.get(\"inputValue\")));\r\n                dialog.show();\r\n            },\r\n            \"save_tune\": function() {\r\n                $.ajax({\r\n                    type: \"POST\",\r\n                    url: \"/api/tunes/add\",\r\n                    data: {\r\n                        tune: ractive.get(\"inputValue\")\r\n                    }\r\n                }).then(function() {\r\n                    toastr.success(\"Tune saved\", \"Success!\");\r\n                });\r\n            },\r\n            \"selection-changed\": function(changedTo) {\r\n\r\n                siz(\".lineIndicatorRect\").forEach(function(r) { r.remove(); });\r\n\r\n                for(var i=changedTo.start; i <= changedTo.stop; i++) {\r\n                    //console.log(\"SEL\", changedTo, i);\r\n\r\n                    var line1 = document.getElementById(`line-${i}`);\r\n                    if(line1 !== null) {\r\n                        //console.log(\"LINE1\", line1);                       \r\n                        \r\n                        line1.appendChild(customElements.selectionBox());\r\n                    }\r\n\r\n                }                \r\n            }\r\n        });\r\n\r\n        console.log(\"CTX\", parameters);\r\n\r\n        var dialog = document.getElementById('window');\r\n\r\n        ractive.set(\"title\", emptyTuneName);\r\n\r\n        //incorporates an elements index into its object\r\n        function addIndexToObject(element, index) {\r\n            return {\r\n                raw: element,\r\n                i: index\r\n            };\r\n        }\r\n\r\n        ractive.on('rerenderScore', function(diffed) {    \r\n\r\n            var editor = ractive.get('editor');         \r\n\r\n            diffed.filter((c) => c.action === \"DEL\").forEach((item) => {\r\n                errors = errors.filter((err) => {\r\n                    if(err.line < item.startId || err.line >= (item.startId + item.count)) {\r\n                        return true;\r\n                    }\r\n                    if(err.markers)err.markers.forEach((marker) => marker.clear());\r\n                    editor.setGutterMarker(err.line, \"error-markers\", null);\r\n                    return false;\r\n                });\r\n            });\r\n\r\n            //ractive.update( 'errors' );\r\n            ractive.set(\"errors\", errors);\r\n\r\n            var done = diffed\r\n                .map(parser)\r\n                .reduce(layout, 0);\r\n\r\n\r\n            renderer(done);\r\n\r\n            processedTune = done;\r\n\r\n            console.log(\"done\", done);\r\n            if(window)ractive.set(\"lastRenderTime\", window.performance.now() - ractive.get('timeAtStart'));\r\n        });\r\n\r\n        function completelyRerenderScore() {\r\n\r\n            siz(\"#canvas\")[0].innerHTML = \"\";\r\n            errors = [];\r\n            ractive.set(\"errors\", errors);\r\n\r\n            parser = ABCParser(transposeAmount);\r\n            layout = ABCLayout();\r\n            renderer = ABCRenderer();\r\n\r\n            var done = diff({\r\n                newValue: ractive.get('inputValue'),\r\n                oldValue: \"\"\r\n            })\r\n            .map(parser)\r\n            .reduce(layout, 0);\r\n\r\n            renderer(done);\r\n\r\n            processedTune = done;\r\n            console.log(\"done\", done);\r\n        }\r\n\r\n        //dispatcher.after(\"transpose_change\", completelyRerenderScore);\r\n\r\n        var oldStart = -1,\r\n            oldStop = -1;\r\n\r\n        if (parameters.tuneid) {\r\n            fetch(\"/api/tune/\" + parameters.tuneid)\r\n            .then(function(response) {\r\n                return response.json()\r\n            }).then(function(res) {\r\n                ractive.get('editor').setValue(res.raw);\r\n            }).catch(function(ex) {\r\n                console.log('parsing failed', ex)\r\n            });\r\n        }\r\n\r\n        if (parameters.tune) {\r\n            editor.setValue(parameters.tune);\r\n        }\r\n\r\n        if(parameters.transpose) {\r\n            ractive.fire(\"transpose_change\", parseInt(parameters.transpose));\r\n        }       \r\n    }\r\n\r\n    var onRender = function() {\r\n\r\n        var ractive = this;\r\n\r\n        var editor = CodeMirror.fromTextArea(document.getElementById(\"abc\"), {\r\n            lineNumbers: true,\r\n            mode: \"abc\",\r\n            gutters: [\"error-markers\"],\r\n        });\r\n\r\n        editor.setSize(\"100%\", \"100%\");\r\n\r\n        ractive.set('timeAtStart', null);\r\n\r\n        editor.on(\"change\", function(instance, changeObj) {\r\n\r\n            if(window)ractive.set('timeAtStart', window.performance.now());\r\n\r\n            var endPos = CodeMirror.changeEnd(changeObj);\r\n\r\n            var\r\n                linesRemoved = changeObj.removed.length,\r\n                linesAdded = changeObj.text.length;\r\n\r\n            var deletions = {\r\n                startId: changeObj.from.line,\r\n                count: linesRemoved,\r\n                action: \"DEL\",\r\n                lines: []\r\n            }; \r\n\r\n            for(var i=0; i<linesRemoved; i++) {\r\n                deletions.lines[i] = new AbcLine(\"\", changeObj.from.line + i);\r\n            }\r\n\r\n            var count = (endPos.line - changeObj.from.line) + 1;\r\n\r\n            var additions = {\r\n                startId: changeObj.from.line,\r\n                count: linesAdded,\r\n                lines: [],\r\n                action: \"ADD\"\r\n            };\r\n\r\n            for(var i=0; i<count; i++) {\r\n                additions.lines[i] = new AbcLine(instance.getLine(additions.startId + i), changeObj.from.line + i);\r\n            }\r\n\r\n            var diffed = [deletions, additions];\r\n\r\n            ractive.fire('rerenderScore', diffed);\r\n            \r\n            ractive.set(\"inputValue\", instance.getValue());\r\n        });\r\n\r\n        editor.on(\"cursorActivity\", function(instance) {\r\n            ractive.fire(\"selection-changed\", {\r\n                start: instance.getCursor(true).line,\r\n                stop: instance.getCursor(false).line\r\n            });\r\n        });\r\n\r\n        var combokeys = new Combokeys(document.getElementById(\"view-editor\"));\r\n\r\n        combokeys.bind(\"ctrl+s\", function() {\r\n            ractive.fire(\"save_tune\");\r\n            return false;\r\n        });\r\n\r\n        editor.setValue(\"X: 1\\nT: \" + emptyTuneName);\r\n\r\n        ractive.set('editor', editor);\r\n    }\r\n\r\n    var ractive = Ractive.extend({\r\n      isolated: false,\r\n      template: template,\r\n      oninit: onInit,\r\n      onrender: onRender\r\n    });\r\n\r\n    return ractive;\r\n};","module.exports = { v:1,\n  t:[ { t:7,\n      e:\"section\",\n      a:{ \"class\":\"page-view\",\n        id:\"view-home\" },\n      v:{ click:\"page-clicked\" },\n      f:[ { t:7,\n          e:\"div\",\n          a:{ \"class\":\"header row coloured\" },\n          t1:\"fade\",\n          f:[ { t:7,\n              e:\"div\",\n              a:{ \"class\":\"central-menu\" },\n              f:[ { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"app-name\" },\n                  f:[ { t:7,\n                      e:\"img\",\n                      a:{ src:\"/images/logo.png\",\n                        \"class\":\"app-logo\",\n                        height:\"32px\" } } ] } ] },\n            \" \",\n            { t:8,\n              r:\"userbox\" } ] },\n        \" \",\n        { t:7,\n          e:\"div\",\n          a:{ \"class\":\"row main-row\" },\n          f:[ { t:7,\n              e:\"div\",\n              a:{ \"class\":\"column quarter right-divide\" },\n              t1:{ n:\"fade\",\n                a:[ { delay:100 } ] },\n              f:[ { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"tile-button-container\" },\n                  f:[ { t:7,\n                      e:\"h3\",\n                      f:[ \"Welcome to 4|Bar\" ] },\n                    \" \",\n                    { t:7,\n                      e:\"p\",\n                      f:[ \"Choose a tune from the right or one of the options below!\" ] },\n                    \" \",\n                    { t:7,\n                      e:\"div\",\n                      a:{ \"class\":\"tile-button\" },\n                      v:{ click:\"new_tune\" },\n                      f:[ { t:7,\n                          e:\"h4\",\n                          f:[ \"+ New Tune\" ] } ] },\n                    \" \",\n                    { t:7,\n                      e:\"div\",\n                      a:{ \"class\":\"tile-button\" },\n                      v:{ click:\"view_tutorial\" },\n                      f:[ { t:7,\n                          e:\"h4\",\n                          f:[ { t:7,\n                              e:\"i\",\n                              a:{ \"class\":\"fa fa-book\" } },\n                            \" Tutorial\" ] } ] } ] },\n                \" \",\n                { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"text-area-padding\" },\n                  f:[ { t:7,\n                      e:\"h3\",\n                      f:[ \"My Tunes\" ] },\n                    \" \",\n                    { t:4,\n                      n:50,\n                      x:{ r:[ \"loggedIn\" ],\n                        s:\"!_0\" },\n                      f:[ { t:7,\n                          e:\"p\",\n                          f:[ \"Login to use these features!\" ] } ] },\n                    { t:4,\n                      n:51,\n                      f:[ { t:4,\n                          n:52,\n                          r:\"myTunebookNames\",\n                          f:[ { t:7,\n                              e:\"div\",\n                              v:{ click:\"view_tunebook\" },\n                              a:{ tunebookId:[ { t:2,\n                                    r:\"_id\" } ],\n                                \"class\":\"tile-button\" },\n                              f:[ { t:7,\n                                  e:\"h4\",\n                                  f:[ { t:2,\n                                      r:\"name\" } ] } ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"div\",\n                          a:{ \"class\":\"tile-button\" },\n                          v:{ click:\"view_new_tunebook\" },\n                          f:[ { t:7,\n                              e:\"h4\",\n                              f:[ { t:7,\n                                  e:\"i\",\n                                  a:{ \"class\":\"fa fa-plus\" } },\n                                \" New Tunebook\" ] } ] } ],\n                      x:{ r:[ \"loggedIn\" ],\n                        s:\"!_0\" } } ] } ] },\n            \" \",\n            { t:7,\n              e:\"div\",\n              a:{ \"class\":\"column three-quarters\",\n                id:\"task-pane\" },\n              t1:{ n:\"fade\",\n                a:[ { delay:200 } ] },\n              f:[ { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"scroll-list\" },\n                  f:[ { t:7,\n                      e:\"div\",\n                      a:{ id:\"search-box\" },\n                      f:[ { t:7,\n                          e:\"i\",\n                          a:{ \"class\":\"fa fa-search\" } },\n                        \" \",\n                        { t:7,\n                          e:\"input\",\n                          v:{ keyup:\"updated_search\" },\n                          a:{ type:\"text\",\n                            placeholder:\"Type here to search for a tune..\",\n                            value:[ { t:2,\n                                r:\"search_filter\" } ] } } ] },\n                    \" \",\n                    { t:7,\n                      e:\"div\",\n                      a:{ \"class\":\"search-options-bar\" },\n                      f:[ { t:7,\n                          e:\"div\",\n                          a:{ \"class\":\"search-option\" },\n                          f:[ { t:7,\n                              e:\"label\",\n                              f:[ \"Key\" ] },\n                            \" \",\n                            { t:7,\n                              e:\"div\",\n                              a:{ \"class\":\"key-selector\" },\n                              f:[ { t:7,\n                                  e:\"div\",\n                                  v:{ click:\"key-selector-value-clicked\" },\n                                  a:{ \"class\":[ \"key-selector-value \",\n                                      { t:4,\n                                        n:50,\n                                        r:\"showingKeySelectorPopup\",\n                                        f:[ \"open\" ] } ] },\n                                  f:[ \"All \",\n                                    { t:7,\n                                      e:\"i\",\n                                      a:{ \"class\":\"fa fa-arrow-down\" } } ] },\n                                \" \",\n                                { t:4,\n                                  n:50,\n                                  r:\"showingKeySelectorPopup\",\n                                  f:[ { t:7,\n                                      e:\"div\",\n                                      a:{ \"class\":\"key-selector-popup\" },\n                                      v:{ click:\"key-popup-clicked\" },\n                                      f:[ { t:7,\n                                          e:\"div\",\n                                          a:{ \"class\":\"key-selector-popup-top\" },\n                                          f:[ { t:7,\n                                              e:\"div\",\n                                              a:{ \"class\":\"key-selector-popup-top-left\" },\n                                              f:[ { t:7,\n                                                  e:\"table\",\n                                                  a:{ \"class\":\"key-letter-selection-table\" },\n                                                  f:[ { t:7,\n                                                      e:\"tr\",\n                                                      f:[ { t:7,\n                                                          e:\"td\",\n                                                          v:{ click:\"toggle-note\" },\n                                                          a:{ note:\"A\",\n                                                            \"class\":[ { t:4,\n                                                                n:50,\n                                                                rx:{ r:\"keynote\",\n                                                                  m:[ { r:[  ],\n                                                                      s:\"\\\"A\\\"\" } ] },\n                                                                f:[ \"on\" ] } ] },\n                                                          f:[ \"A\" ] },\n                                                        \" \",\n                                                        { t:7,\n                                                          e:\"td\",\n                                                          v:{ click:\"toggle-note\" },\n                                                          a:{ note:\"A#\",\n                                                            \"class\":[ { t:4,\n                                                                n:50,\n                                                                rx:{ r:\"keynote\",\n                                                                  m:[ { r:[  ],\n                                                                      s:\"\\\"A#\\\"\" } ] },\n                                                                f:[ \"on\" ] } ] },\n                                                          f:[ \"A#\" ] },\n                                                        \" \",\n                                                        { t:7,\n                                                          e:\"td\",\n                                                          v:{ click:\"toggle-note\" },\n                                                          a:{ note:\"B\",\n                                                            \"class\":[ { t:4,\n                                                                n:50,\n                                                                rx:{ r:\"keynote\",\n                                                                  m:[ { r:[  ],\n                                                                      s:\"\\\"B\\\"\" } ] },\n                                                                f:[ \"on\" ] } ] },\n                                                          f:[ \"B\" ] },\n                                                        \" \",\n                                                        { t:7,\n                                                          e:\"td\",\n                                                          v:{ click:\"toggle-note\" },\n                                                          a:{ note:\"C\",\n                                                            \"class\":[ { t:4,\n                                                                n:50,\n                                                                rx:{ r:\"keynote\",\n                                                                  m:[ { r:[  ],\n                                                                      s:\"\\\"C\\\"\" } ] },\n                                                                f:[ \"on\" ] } ] },\n                                                          f:[ \"C\" ] },\n                                                        \" \",\n                                                        { t:7,\n                                                          e:\"td\",\n                                                          v:{ click:\"toggle-note\" },\n                                                          a:{ note:\"C#\",\n                                                            \"class\":[ { t:4,\n                                                                n:50,\n                                                                rx:{ r:\"keynote\",\n                                                                  m:[ { r:[  ],\n                                                                      s:\"\\\"C#\\\"\" } ] },\n                                                                f:[ \"on\" ] } ] },\n                                                          f:[ \"C#\" ] },\n                                                        \" \",\n                                                        { t:7,\n                                                          e:\"td\",\n                                                          v:{ click:\"toggle-note\" },\n                                                          a:{ note:\"D\",\n                                                            \"class\":[ { t:4,\n                                                                n:50,\n                                                                rx:{ r:\"keynote\",\n                                                                  m:[ { r:[  ],\n                                                                      s:\"\\\"D\\\"\" } ] },\n                                                                f:[ \"on\" ] } ] },\n                                                          f:[ \"D\" ] } ] },\n                                                    \" \",\n                                                    { t:7,\n                                                      e:\"tr\",\n                                                      f:[ { t:7,\n                                                          e:\"td\",\n                                                          v:{ click:\"toggle-note\" },\n                                                          a:{ note:\"D#\",\n                                                            \"class\":[ { t:4,\n                                                                n:50,\n                                                                rx:{ r:\"keynote\",\n                                                                  m:[ { r:[  ],\n                                                                      s:\"\\\"D#\\\"\" } ] },\n                                                                f:[ \"on\" ] } ] },\n                                                          f:[ \"D#\" ] },\n                                                        \" \",\n                                                        { t:7,\n                                                          e:\"td\",\n                                                          v:{ click:\"toggle-note\" },\n                                                          a:{ note:\"E\",\n                                                            \"class\":[ { t:4,\n                                                                n:50,\n                                                                rx:{ r:\"keynote\",\n                                                                  m:[ { r:[  ],\n                                                                      s:\"\\\"E\\\"\" } ] },\n                                                                f:[ \"on\" ] } ] },\n                                                          f:[ \"E\" ] },\n                                                        \" \",\n                                                        { t:7,\n                                                          e:\"td\",\n                                                          v:{ click:\"toggle-note\" },\n                                                          a:{ note:\"F\",\n                                                            \"class\":[ { t:4,\n                                                                n:50,\n                                                                rx:{ r:\"keynote\",\n                                                                  m:[ { r:[  ],\n                                                                      s:\"\\\"F\\\"\" } ] },\n                                                                f:[ \"on\" ] } ] },\n                                                          f:[ \"F\" ] },\n                                                        \" \",\n                                                        { t:7,\n                                                          e:\"td\",\n                                                          v:{ click:\"toggle-note\" },\n                                                          a:{ note:\"F#\",\n                                                            \"class\":[ { t:4,\n                                                                n:50,\n                                                                rx:{ r:\"keynote\",\n                                                                  m:[ { r:[  ],\n                                                                      s:\"\\\"F#\\\"\" } ] },\n                                                                f:[ \"on\" ] } ] },\n                                                          f:[ \"F#\" ] },\n                                                        \" \",\n                                                        { t:7,\n                                                          e:\"td\",\n                                                          v:{ click:\"toggle-note\" },\n                                                          a:{ note:\"G\",\n                                                            \"class\":[ { t:4,\n                                                                n:50,\n                                                                rx:{ r:\"keynote\",\n                                                                  m:[ { r:[  ],\n                                                                      s:\"\\\"G\\\"\" } ] },\n                                                                f:[ \"on\" ] } ] },\n                                                          f:[ \"G\" ] },\n                                                        \" \",\n                                                        { t:7,\n                                                          e:\"td\",\n                                                          v:{ click:\"toggle-note\" },\n                                                          a:{ note:\"G#\",\n                                                            \"class\":[ { t:4,\n                                                                n:50,\n                                                                rx:{ r:\"keynote\",\n                                                                  m:[ { r:[  ],\n                                                                      s:\"\\\"G#\\\"\" } ] },\n                                                                f:[ \"on\" ] } ] },\n                                                          f:[ \"G#\" ] } ] } ] },\n                                                \" \",\n                                                { t:7,\n                                                  e:\"div\",\n                                                  a:{ \"class\":\"span-button-container\" },\n                                                  f:[ { t:7,\n                                                      e:\"span\",\n                                                      v:{ click:\"clear-all-keys\" },\n                                                      f:[ \"Clear All\" ] },\n                                                    { t:7,\n                                                      e:\"span\",\n                                                      v:{ click:\"select-all-keys\" },\n                                                      f:[ \"Select All\" ] } ] } ] },\n                                            \" \",\n                                            { t:7,\n                                              e:\"div\",\n                                              a:{ \"class\":\"key-selector-popup-top-right\" },\n                                              f:[ { t:7,\n                                                  e:\"p\",\n                                                  f:[ \"Include equivilent keys\" ] },\n                                                \" \",\n                                                { t:7,\n                                                  e:\"input\",\n                                                  a:{ type:\"checkbox\",\n                                                    value:\"Bike\" } } ] } ] },\n                                        \" \",\n                                        { t:7,\n                                          e:\"table\",\n                                          a:{ \"class\":\"key-mode-selection-table\" },\n                                          f:[ { t:7,\n                                              e:\"tr\",\n                                              f:[ { t:7,\n                                                  e:\"td\",\n                                                  v:{ click:\"toggle-mode\" },\n                                                  a:{ mode:\"Major\",\n                                                    \"class\":[ { t:4,\n                                                        n:50,\n                                                        rx:{ r:\"keymode\",\n                                                          m:[ { r:[  ],\n                                                              s:\"\\\"Major\\\"\" } ] },\n                                                        f:[ \"on\" ] } ] },\n                                                  f:[ \"Major\" ] },\n                                                \" \",\n                                                { t:7,\n                                                  e:\"td\",\n                                                  v:{ click:\"toggle-mode\" },\n                                                  a:{ mode:\"Dorian\",\n                                                    \"class\":[ { t:4,\n                                                        n:50,\n                                                        rx:{ r:\"keymode\",\n                                                          m:[ { r:[  ],\n                                                              s:\"\\\"Dorian\\\"\" } ] },\n                                                        f:[ \"on\" ] } ] },\n                                                  f:[ \"Dorian\" ] },\n                                                \" \",\n                                                { t:7,\n                                                  e:\"td\",\n                                                  v:{ click:\"toggle-mode\" },\n                                                  a:{ mode:\"Phrygian\",\n                                                    \"class\":[ { t:4,\n                                                        n:50,\n                                                        rx:{ r:\"keymode\",\n                                                          m:[ { r:[  ],\n                                                              s:\"\\\"Phrygian\\\"\" } ] },\n                                                        f:[ \"on\" ] } ] },\n                                                  f:[ \"Phrygian\" ] },\n                                                \" \",\n                                                { t:7,\n                                                  e:\"td\",\n                                                  v:{ click:\"toggle-mode\" },\n                                                  a:{ mode:\"Lydian\",\n                                                    \"class\":[ { t:4,\n                                                        n:50,\n                                                        rx:{ r:\"keymode\",\n                                                          m:[ { r:[  ],\n                                                              s:\"\\\"Lydian\\\"\" } ] },\n                                                        f:[ \"on\" ] } ] },\n                                                  f:[ \"Lydian\" ] } ] },\n                                            \" \",\n                                            { t:7,\n                                              e:\"tr\",\n                                              f:[ { t:7,\n                                                  e:\"td\",\n                                                  v:{ click:\"toggle-mode\" },\n                                                  a:{ mode:\"Mixolydian\",\n                                                    \"class\":[ { t:4,\n                                                        n:50,\n                                                        rx:{ r:\"keymode\",\n                                                          m:[ { r:[  ],\n                                                              s:\"\\\"Mixolydian\\\"\" } ] },\n                                                        f:[ \"on\" ] } ] },\n                                                  f:[ \"Mixolydian\" ] },\n                                                \" \",\n                                                { t:7,\n                                                  e:\"td\",\n                                                  v:{ click:\"toggle-mode\" },\n                                                  a:{ mode:\"Minor\",\n                                                    \"class\":[ { t:4,\n                                                        n:50,\n                                                        rx:{ r:\"keymode\",\n                                                          m:[ { r:[  ],\n                                                              s:\"\\\"Minor\\\"\" } ] },\n                                                        f:[ \"on\" ] } ] },\n                                                  f:[ \"Minor\" ] },\n                                                \" \",\n                                                { t:7,\n                                                  e:\"td\",\n                                                  v:{ click:\"toggle-mode\" },\n                                                  a:{ mode:\"Locrian\",\n                                                    \"class\":[ { t:4,\n                                                        n:50,\n                                                        rx:{ r:\"keymode\",\n                                                          m:[ { r:[  ],\n                                                              s:\"\\\"Locrian\\\"\" } ] },\n                                                        f:[ \"on\" ] } ] },\n                                                  f:[ \"Locrian\" ] } ] } ] },\n                                        \" \",\n                                        { t:7,\n                                          e:\"div\",\n                                          a:{ \"class\":\"span-button-container\" },\n                                          f:[ { t:7,\n                                              e:\"span\",\n                                              v:{ click:\"clear-all-modes\" },\n                                              f:[ \"Clear All\" ] },\n                                            { t:7,\n                                              e:\"span\",\n                                              v:{ click:\"select-all-modes\" },\n                                              f:[ \"Select All\" ] } ] } ] } ] } ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"div\",\n                          a:{ \"class\":\"search-option\" },\n                          f:[ { t:7,\n                              e:\"label\",\n                              f:[ \"Rhythm\" ] },\n                            \" \",\n                            { t:7,\n                              e:\"select\",\n                              f:[ { t:7,\n                                  e:\"option\",\n                                  f:[ \"All\" ] },\n                                \" \",\n                                { t:4,\n                                  n:52,\n                                  r:\"rhythm\",\n                                  f:[ { t:7,\n                                      e:\"option\",\n                                      f:[ { t:2,\n                                          r:\".\" } ] } ] } ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"div\",\n                          a:{ \"class\":\"search-option\" },\n                          f:[ { t:7,\n                              e:\"label\",\n                              f:[ \"Type\" ] },\n                            \" \",\n                            { t:7,\n                              e:\"select\",\n                              f:[ { t:7,\n                                  e:\"option\",\n                                  f:[ \"All\" ] } ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"div\",\n                          a:{ \"class\":\"search-option\" },\n                          f:[ { t:7,\n                              e:\"label\",\n                              f:[ \"Time Signature\" ] },\n                            \" \",\n                            { t:7,\n                              e:\"select\",\n                              f:[ { t:7,\n                                  e:\"option\",\n                                  f:[ \"All\" ] } ] } ] } ] },\n                    \" \",\n                    { t:7,\n                      e:\"div\",\n                      a:{ \"class\":\"tune-card-list\" },\n                      f:[ { t:4,\n                          n:52,\n                          r:\"publicTuneNames\",\n                          f:[ { t:7,\n                              e:\"div\",\n                              v:{ click:\"view_tune\" },\n                              a:{ \"class\":\"card-list\",\n                                \"tune-id\":[ { t:2,\n                                    r:\"_id\" } ] },\n                              f:[ { t:7,\n                                  e:\"div\",\n                                  a:{ \"class\":\"tune-card card clearfix\",\n                                    title:[ { t:2,\n                                        r:\"name\" } ] },\n                                  f:[ { t:7,\n                                      e:\"div\",\n                                      a:{ \"class\":\"tune-card-left\" },\n                                      f:[ { t:7,\n                                          e:\"h3\",\n                                          f:[ { t:7,\n                                              e:\"span\",\n                                              a:{ \"class\":\"tune-key\" },\n                                              f:[ { t:2,\n                                                  r:\"settings.key.note\" },\n                                                { t:7,\n                                                  e:\"small\",\n                                                  f:[ { t:2,\n                                                      r:\"settings.key.mode\" } ] } ] },\n                                            { t:7,\n                                              e:\"span\",\n                                              a:{ \"class\":\"tune-title\" },\n                                              f:[ { t:2,\n                                                  r:\"name\" } ] } ] } ] },\n                                    \" \",\n                                    { t:7,\n                                      e:\"div\",\n                                      a:{ \"class\":\"tune-card-right\" },\n                                      f:[ { t:7,\n                                          e:\"div\",\n                                          a:{ \"class\":\"tune-rhythm\" },\n                                          f:[ { t:2,\n                                              r:\"settings.rhythm\" } ] } ] } ] } ] } ] } ] } ] } ] } ] } ] } ] }","'use strict';\r\n\r\nvar\r\n    fade = require('scripts/transitions/ractive.transitions.fade'),\r\n    fly = require('scripts/transitions/ractive.transitions.fly'),\r\n    toastr = require('vendor').toastr,\r\n    ractive = require('vendor').ractive;\r\n\r\n\r\nvar template = require(\"./home.html\");\r\n\r\n\r\nmodule.exports = function(ractive, context, page, urlcontext, user) {\r\n\r\n    var onInit = function() {\r\n\r\n        var ractive = this;\r\n\r\n        ractive.set(\"showingKeySelectorPopup\", false);\r\n\r\n        ractive.on({\r\n            'new_tune': function(event) {\r\n                ractive.fire(\"navigate_to_page\", \"/editor\");\r\n            },\r\n            'view_tutorial': function(event) {\r\n                ractive.fire(\"navigate_to_page\", \"/tutorial\")\r\n            },\r\n            'view_new_tunebook': function() {\r\n                ractive.fire(\"navigate_to_page\", \"/tunebook\")\r\n            },\r\n            'updated_search': function(event, data) {\r\n                console.log(\"EVENT\", event.context.search_filter);\r\n\r\n                fetch(\"/api/tunes?name=\" + event.context.search_filter)\r\n                .then(function(response) {\r\n                    return response.json()\r\n                })\r\n                .then(function(data) {\r\n                    console.log(\"DONE\", data);\r\n                    ractive.set(\"publicTuneNames\", data);\r\n                    ractive.update(\"publicTuneNames\");\r\n                }).catch(function(ex) {\r\n                    console.log('parsing failed', ex)\r\n                });\r\n            },\r\n            'view_tunebook': function(event) {\r\n                ractive.fire(\"navigate_to_page\", \"/tunebook/view?tunebook=\" + event.node.attributes.tunebookId.value)\r\n            },\r\n            'view_tune': function(event) {\r\n                var tuneId = event.node.attributes[\"tune-id\"].value;\r\n                console.log(tuneId);\r\n                ractive.fire(\"navigate_to_page\", \"/viewer?tuneid=\" + tuneId);\r\n            }\r\n        });\r\n\r\n        ractive.on('toggle-note', function(event) {\r\n            var note = event.node.attributes.note.value;\r\n            ractive.set(\"keynote.\" + note, !ractive.get(\"keynote.\" + note));\r\n        });\r\n\r\n        ractive.on('toggle-mode', function(event) {\r\n            var mode = event.node.attributes.mode.value;\r\n            ractive.set(\"keymode.\" + mode, !ractive.get(\"keymode.\" + mode));\r\n        });\r\n\r\n        ractive.on({\r\n            \"clear-all-keys\": function() {\r\n                ractive.set(\"keynote\", {\r\n                    'A': false,\r\n                    'A#': false,\r\n                    'B': false,\r\n                    'C': false,\r\n                    'C#': false,\r\n                    'D': false, \r\n                    'D#': false, \r\n                    'E': false, \r\n                    'F': false, \r\n                    'F#': false, \r\n                    'G': false,\r\n                    'G#': false\r\n                });\r\n            },\r\n             \"select-all-keys\": function() {\r\n                ractive.set(\"keynote\", {\r\n                    'A': true,\r\n                    'A#': true,\r\n                    'B': true,\r\n                    'C': true,\r\n                    'C#': true,\r\n                    'D': true, \r\n                    'D#': true, \r\n                    'E': true, \r\n                    'F': true, \r\n                    'F#': true, \r\n                    'G': true,\r\n                    'G#': true\r\n                });\r\n            },\r\n            \"clear-all-modes\": function() {\r\n                ractive.set(\"keymode\", {\r\n                    'Major': false,\r\n                    'Dorian': false,\r\n                    'Phrygian': false,\r\n                    'Lydian': false,\r\n                    'Mixolydian': false,\r\n                    'Minor': false, \r\n                    'Locrian': false\r\n                });\r\n            },\r\n             \"select-all-modes\": function() {\r\n                ractive.set(\"keymode\", {\r\n                    'Major': true,\r\n                    'Dorian': true,\r\n                    'Phrygian': true,\r\n                    'Lydian': true,\r\n                    'Mixolydian': true,\r\n                    'Minor': true, \r\n                    'Locrian': true\r\n                });\r\n            },\r\n            \"key-selector-value-clicked\": function() {\r\n                ractive.set(\"showingKeySelectorPopup\", !ractive.get(\"showingKeySelectorPopup\"));\r\n                return false;\r\n            },\r\n            \"page-clicked\": function() {\r\n                if(ractive.get(\"showingKeySelectorPopup\"))ractive.set(\"showingKeySelectorPopup\", false);\r\n            },\r\n            \"key-popup-clicked\": function() {\r\n                console.log(\"meh\");\r\n                if(ractive.get(\"showingKeySelectorPopup\"))return false;\r\n            }\r\n        });\r\n\r\n        //ractive.on(\"init\", function() {\r\n            fetch(\"/api/tunes\")\r\n            .then(function(response) {\r\n                return response.json()\r\n            }).then(function(data) {\r\n                ractive.set(\"publicTuneNames\", data);\r\n            }).catch(function(ex) {\r\n                console.log('parsing failed', ex)\r\n            });\r\n\r\n\r\n            fetch(\"/api/tunebooks\")\r\n            .then(function(response) {\r\n                return response.json()\r\n            }).then(function(data) {\r\n                ractive.set(\"myTunebookNames\", data);\r\n             }).catch(function(ex) {\r\n                console.log('parsing failed', ex)\r\n            });\r\n\r\n        //});\r\n\r\n        \r\n\r\n        ractive.set(\"keynote\", {\r\n            'A': true,\r\n            'A#': true,\r\n            'B': true,\r\n            'C': true,\r\n            'C#': true,\r\n            'D': true, \r\n            'D#': true, \r\n            'E': true, \r\n            'F': true, \r\n            'F#': true, \r\n            'G': true,\r\n            'G#': true\r\n        });\r\n\r\n        ractive.set(\"keymode\", {\r\n            'Major': true,\r\n            'Dorian': true,\r\n            'Phrygian': true,\r\n            'Lydian': true,\r\n            'Mixolydian': true,\r\n            'Minor': true, \r\n            'Locrian': true\r\n        });\r\n\r\n        ractive.set(\"rhythm\", [\"Jig\", \"Reel\"]);\r\n    }\r\n\r\n\r\n    var ractive = Ractive.extend({\r\n      isolated: false,\r\n      template: template,\r\n      oninit: onInit\r\n    }); \r\n\r\n    return ractive;\r\n};","module.exports = { v:1,\n  t:[ { t:4,\n      n:50,\n      x:{ r:[ \"url.pathname\" ],\n        s:\"_0===\\\"/\\\"\" },\n      f:[ { t:7,\n          e:\"HomePage\" } ] },\n    \" \",\n    { t:4,\n      n:50,\n      x:{ r:[ \"url.pathname\" ],\n        s:\"_0===\\\"/editor\\\"\" },\n      f:[ { t:7,\n          e:\"EditorPage\" } ] },\n    \" \",\n    { t:4,\n      n:50,\n      x:{ r:[ \"url.pathname\" ],\n        s:\"_0===\\\"/user\\\"\" },\n      f:[ { t:7,\n          e:\"UserPage\" } ] },\n    \" \",\n    { t:4,\n      n:50,\n      x:{ r:[ \"url.pathname\" ],\n        s:\"_0===\\\"/viewer\\\"\" },\n      f:[ { t:7,\n          e:\"ViewerPage\" } ] },\n    \" \",\n    { t:4,\n      n:50,\n      x:{ r:[ \"url.pathname\" ],\n        s:\"_0===\\\"/tutorial\\\"\" },\n      f:[ { t:7,\n          e:\"TutorialPage\" } ] },\n    \" \",\n    { t:4,\n      n:50,\n      x:{ r:[ \"url.pathname\" ],\n        s:\"_0===\\\"/tunebook\\\"\" },\n      f:[ { t:7,\n          e:\"TunebookPage\" } ] },\n    \" \",\n    { t:4,\n      n:50,\n      x:{ r:[ \"url.pathname\" ],\n        s:\"_0===\\\"/tunebook/view\\\"\" },\n      f:[ { t:7,\n          e:\"TunebookViewerPage\" } ] } ] }","module.exports = { v:1,\n  t:[ { t:7,\n      e:\"div\",\n      a:{ \"class\":\"user-box\" },\n      f:[ { t:4,\n          n:50,\n          x:{ r:[ \"loggedIn\" ],\n            s:\"_0===false\" },\n          f:[ { t:7,\n              e:\"button\",\n              a:{ \"class\":\"google-button\" },\n              v:{ click:\"log_in\" },\n              f:[ { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"left\" },\n                  f:[ { t:7,\n                      e:\"i\",\n                      a:{ \"class\":\"fa fa-google-plus\" } } ] },\n                { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"right\" },\n                  f:[ \"Sign in with Google+\" ] } ] } ] },\n        { t:4,\n          n:51,\n          f:[ { t:7,\n              e:\"div\",\n              a:{ \"class\":\"logged-in-user-box\" },\n              f:[ { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"left\" },\n                  f:[ { t:7,\n                      e:\"span\",\n                      v:{ click:\"goto_account\" },\n                      f:[ \"Hi \",\n                        { t:2,\n                          r:\"user.name\" } ] },\n                    \" \",\n                    { t:7,\n                      e:\"a\",\n                      a:{ href:\"/logout\" },\n                      f:[ \"Log out\" ] } ] },\n                \" \",\n                { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"right\" },\n                  f:[ { t:7,\n                      e:\"img\",\n                      v:{ click:\"goto_account\" },\n                      a:{ \"class\":\"user-picture\",\n                        src:[ { t:2,\n                            r:\"user.picture\" } ] } } ] } ] } ],\n          x:{ r:[ \"loggedIn\" ],\n            s:\"_0===false\" } } ] } ] }","var inBrowser = typeof window !== 'undefined';\r\n\r\nmodule.exports = {\r\n    \"/\": {\r\n        name: \"HomePage\",\r\n        model: inBrowser ? require('app/home/home') : null\r\n    },\r\n    \"/editor\": {\r\n        name: \"EditorPage\",\r\n        model: inBrowser ? require('app/editor/editor') : null\r\n    },\r\n    \"/user\": {\r\n        name: \"UserPage\",\r\n        model: inBrowser ? require('app/user/user') : null\r\n    },\r\n    \"/viewer\": {\r\n        name: \"ViewerPage\",\r\n        model: inBrowser ? require('app/viewer/viewer') : null\r\n    },\r\n    \"/tutorial\": {\r\n        name: \"TutorialPage\",\r\n        model: inBrowser ? require('app/tutorial/tutorial') : null\r\n    },\r\n    \"/tunebook\": {\r\n        name: \"TunebookPage\",\r\n        model: inBrowser ? require('app/tunebook/tunebook_edit') : null\r\n    },\r\n    \"/tunebook/view\": {\r\n        name: \"TunebookViewerPage\",\r\n        model: inBrowser ? require('app/tunebook/tunebook_view')  : null\r\n    }\r\n};","module.exports = { v:1,\n  t:[ { t:7,\n      e:\"section\",\n      a:{ \"class\":\"page-view\",\n        id:\"view-tunebook\" },\n      f:[ { t:7,\n          e:\"div\",\n          a:{ \"class\":\"header row coloured\" },\n          t1:\"fade\",\n          f:[ { t:7,\n              e:\"div\",\n              a:{ \"class\":\"central-menu\" },\n              f:[ { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"app-name\" },\n                  f:[ { t:7,\n                      e:\"img\",\n                      a:{ src:\"/images/logo.png\",\n                        \"class\":\"app-logo\",\n                        height:\"32px\" },\n                      v:{ click:\"navigate_back\" } } ] } ] },\n            \" \",\n            { t:7,\n              e:\"div\",\n              a:{ \"class\":\"page-title\" },\n              f:[ { t:7,\n                  e:\"h1\",\n                  f:[ \"Create Tunebook\" ] } ] },\n            \" \",\n            { t:8,\n              r:\"userbox\" } ] },\n        \" \",\n        { t:7,\n          e:\"div\",\n          a:{ \"class\":\"row editor\" },\n          f:[ { t:7,\n              e:\"div\",\n              a:{ \"class\":\"column half flex-column card-list\" },\n              t1:{ n:\"fade\",\n                a:[ { delay:100 } ] },\n              f:[ { t:7,\n                  e:\"div\",\n                  a:{ id:\"search-box\" },\n                  f:[ { t:7,\n                      e:\"i\",\n                      a:{ \"class\":\"fa fa-search\" } },\n                    \" \",\n                    { t:7,\n                      e:\"input\",\n                      v:{ keyup:\"updated_search\" },\n                      a:{ type:\"text\",\n                        placeholder:\"Type here to search for a tune..\",\n                        value:[ { t:2,\n                            r:\"search_filter\" } ] } } ] },\n                \" \",\n                { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"search-options-bar\" },\n                  f:[ { t:7,\n                      e:\"div\",\n                      a:{ \"class\":\"search-option\" },\n                      f:[ { t:7,\n                          e:\"label\",\n                          f:[ \"Key\" ] },\n                        \" \",\n                        { t:7,\n                          e:\"div\",\n                          a:{ \"class\":\"key-selector\" },\n                          f:[ { t:7,\n                              e:\"div\",\n                              v:{ click:\"key-selector-value-clicked\" },\n                              a:{ \"class\":[ \"key-selector-value \",\n                                  { t:4,\n                                    n:50,\n                                    r:\"showingKeySelectorPopup\",\n                                    f:[ \"open\" ] } ] },\n                              f:[ \"All \",\n                                { t:7,\n                                  e:\"i\",\n                                  a:{ \"class\":\"fa fa-arrow-down\" } } ] },\n                            \" \",\n                            { t:4,\n                              n:50,\n                              r:\"showingKeySelectorPopup\",\n                              f:[ { t:7,\n                                  e:\"div\",\n                                  a:{ \"class\":\"key-selector-popup\" },\n                                  v:{ click:\"key-popup-clicked\" },\n                                  f:[ { t:7,\n                                      e:\"div\",\n                                      a:{ \"class\":\"key-selector-popup-top\" },\n                                      f:[ { t:7,\n                                          e:\"div\",\n                                          a:{ \"class\":\"key-selector-popup-top-left\" },\n                                          f:[ { t:7,\n                                              e:\"table\",\n                                              a:{ \"class\":\"key-letter-selection-table\" },\n                                              f:[ { t:7,\n                                                  e:\"tr\",\n                                                  f:[ { t:7,\n                                                      e:\"td\",\n                                                      v:{ click:\"toggle-note\" },\n                                                      a:{ note:\"A\",\n                                                        \"class\":[ { t:4,\n                                                            n:50,\n                                                            rx:{ r:\"keynote\",\n                                                              m:[ { r:[  ],\n                                                                  s:\"\\\"A\\\"\" } ] },\n                                                            f:[ \"on\" ] } ] },\n                                                      f:[ \"A\" ] },\n                                                    \" \",\n                                                    { t:7,\n                                                      e:\"td\",\n                                                      v:{ click:\"toggle-note\" },\n                                                      a:{ note:\"A#\",\n                                                        \"class\":[ { t:4,\n                                                            n:50,\n                                                            rx:{ r:\"keynote\",\n                                                              m:[ { r:[  ],\n                                                                  s:\"\\\"A#\\\"\" } ] },\n                                                            f:[ \"on\" ] } ] },\n                                                      f:[ \"A#\" ] },\n                                                    \" \",\n                                                    { t:7,\n                                                      e:\"td\",\n                                                      v:{ click:\"toggle-note\" },\n                                                      a:{ note:\"B\",\n                                                        \"class\":[ { t:4,\n                                                            n:50,\n                                                            rx:{ r:\"keynote\",\n                                                              m:[ { r:[  ],\n                                                                  s:\"\\\"B\\\"\" } ] },\n                                                            f:[ \"on\" ] } ] },\n                                                      f:[ \"B\" ] },\n                                                    \" \",\n                                                    { t:7,\n                                                      e:\"td\",\n                                                      v:{ click:\"toggle-note\" },\n                                                      a:{ note:\"C\",\n                                                        \"class\":[ { t:4,\n                                                            n:50,\n                                                            rx:{ r:\"keynote\",\n                                                              m:[ { r:[  ],\n                                                                  s:\"\\\"C\\\"\" } ] },\n                                                            f:[ \"on\" ] } ] },\n                                                      f:[ \"C\" ] },\n                                                    \" \",\n                                                    { t:7,\n                                                      e:\"td\",\n                                                      v:{ click:\"toggle-note\" },\n                                                      a:{ note:\"C#\",\n                                                        \"class\":[ { t:4,\n                                                            n:50,\n                                                            rx:{ r:\"keynote\",\n                                                              m:[ { r:[  ],\n                                                                  s:\"\\\"C#\\\"\" } ] },\n                                                            f:[ \"on\" ] } ] },\n                                                      f:[ \"C#\" ] },\n                                                    \" \",\n                                                    { t:7,\n                                                      e:\"td\",\n                                                      v:{ click:\"toggle-note\" },\n                                                      a:{ note:\"D\",\n                                                        \"class\":[ { t:4,\n                                                            n:50,\n                                                            rx:{ r:\"keynote\",\n                                                              m:[ { r:[  ],\n                                                                  s:\"\\\"D\\\"\" } ] },\n                                                            f:[ \"on\" ] } ] },\n                                                      f:[ \"D\" ] } ] },\n                                                \" \",\n                                                { t:7,\n                                                  e:\"tr\",\n                                                  f:[ { t:7,\n                                                      e:\"td\",\n                                                      v:{ click:\"toggle-note\" },\n                                                      a:{ note:\"D#\",\n                                                        \"class\":[ { t:4,\n                                                            n:50,\n                                                            rx:{ r:\"keynote\",\n                                                              m:[ { r:[  ],\n                                                                  s:\"\\\"D#\\\"\" } ] },\n                                                            f:[ \"on\" ] } ] },\n                                                      f:[ \"D#\" ] },\n                                                    \" \",\n                                                    { t:7,\n                                                      e:\"td\",\n                                                      v:{ click:\"toggle-note\" },\n                                                      a:{ note:\"E\",\n                                                        \"class\":[ { t:4,\n                                                            n:50,\n                                                            rx:{ r:\"keynote\",\n                                                              m:[ { r:[  ],\n                                                                  s:\"\\\"E\\\"\" } ] },\n                                                            f:[ \"on\" ] } ] },\n                                                      f:[ \"E\" ] },\n                                                    \" \",\n                                                    { t:7,\n                                                      e:\"td\",\n                                                      v:{ click:\"toggle-note\" },\n                                                      a:{ note:\"F\",\n                                                        \"class\":[ { t:4,\n                                                            n:50,\n                                                            rx:{ r:\"keynote\",\n                                                              m:[ { r:[  ],\n                                                                  s:\"\\\"F\\\"\" } ] },\n                                                            f:[ \"on\" ] } ] },\n                                                      f:[ \"F\" ] },\n                                                    \" \",\n                                                    { t:7,\n                                                      e:\"td\",\n                                                      v:{ click:\"toggle-note\" },\n                                                      a:{ note:\"F#\",\n                                                        \"class\":[ { t:4,\n                                                            n:50,\n                                                            rx:{ r:\"keynote\",\n                                                              m:[ { r:[  ],\n                                                                  s:\"\\\"F#\\\"\" } ] },\n                                                            f:[ \"on\" ] } ] },\n                                                      f:[ \"F#\" ] },\n                                                    \" \",\n                                                    { t:7,\n                                                      e:\"td\",\n                                                      v:{ click:\"toggle-note\" },\n                                                      a:{ note:\"G\",\n                                                        \"class\":[ { t:4,\n                                                            n:50,\n                                                            rx:{ r:\"keynote\",\n                                                              m:[ { r:[  ],\n                                                                  s:\"\\\"G\\\"\" } ] },\n                                                            f:[ \"on\" ] } ] },\n                                                      f:[ \"G\" ] },\n                                                    \" \",\n                                                    { t:7,\n                                                      e:\"td\",\n                                                      v:{ click:\"toggle-note\" },\n                                                      a:{ note:\"G#\",\n                                                        \"class\":[ { t:4,\n                                                            n:50,\n                                                            rx:{ r:\"keynote\",\n                                                              m:[ { r:[  ],\n                                                                  s:\"\\\"G#\\\"\" } ] },\n                                                            f:[ \"on\" ] } ] },\n                                                      f:[ \"G#\" ] } ] } ] },\n                                            \" \",\n                                            { t:7,\n                                              e:\"div\",\n                                              a:{ \"class\":\"span-button-container\" },\n                                              f:[ { t:7,\n                                                  e:\"span\",\n                                                  v:{ click:\"clear-all-keys\" },\n                                                  f:[ \"Clear All\" ] },\n                                                { t:7,\n                                                  e:\"span\",\n                                                  v:{ click:\"select-all-keys\" },\n                                                  f:[ \"Select All\" ] } ] } ] },\n                                        \" \",\n                                        { t:7,\n                                          e:\"div\",\n                                          a:{ \"class\":\"key-selector-popup-top-right\" },\n                                          f:[ { t:7,\n                                              e:\"p\",\n                                              f:[ \"Include equivilent keys\" ] },\n                                            \" \",\n                                            { t:7,\n                                              e:\"input\",\n                                              a:{ type:\"checkbox\",\n                                                value:\"Bike\" } } ] } ] },\n                                    \" \",\n                                    { t:7,\n                                      e:\"table\",\n                                      a:{ \"class\":\"key-mode-selection-table\" },\n                                      f:[ { t:7,\n                                          e:\"tr\",\n                                          f:[ { t:7,\n                                              e:\"td\",\n                                              v:{ click:\"toggle-mode\" },\n                                              a:{ mode:\"Major\",\n                                                \"class\":[ { t:4,\n                                                    n:50,\n                                                    rx:{ r:\"keymode\",\n                                                      m:[ { r:[  ],\n                                                          s:\"\\\"Major\\\"\" } ] },\n                                                    f:[ \"on\" ] } ] },\n                                              f:[ \"Major\" ] },\n                                            \" \",\n                                            { t:7,\n                                              e:\"td\",\n                                              v:{ click:\"toggle-mode\" },\n                                              a:{ mode:\"Dorian\",\n                                                \"class\":[ { t:4,\n                                                    n:50,\n                                                    rx:{ r:\"keymode\",\n                                                      m:[ { r:[  ],\n                                                          s:\"\\\"Dorian\\\"\" } ] },\n                                                    f:[ \"on\" ] } ] },\n                                              f:[ \"Dorian\" ] },\n                                            \" \",\n                                            { t:7,\n                                              e:\"td\",\n                                              v:{ click:\"toggle-mode\" },\n                                              a:{ mode:\"Phrygian\",\n                                                \"class\":[ { t:4,\n                                                    n:50,\n                                                    rx:{ r:\"keymode\",\n                                                      m:[ { r:[  ],\n                                                          s:\"\\\"Phrygian\\\"\" } ] },\n                                                    f:[ \"on\" ] } ] },\n                                              f:[ \"Phrygian\" ] },\n                                            \" \",\n                                            { t:7,\n                                              e:\"td\",\n                                              v:{ click:\"toggle-mode\" },\n                                              a:{ mode:\"Lydian\",\n                                                \"class\":[ { t:4,\n                                                    n:50,\n                                                    rx:{ r:\"keymode\",\n                                                      m:[ { r:[  ],\n                                                          s:\"\\\"Lydian\\\"\" } ] },\n                                                    f:[ \"on\" ] } ] },\n                                              f:[ \"Lydian\" ] } ] },\n                                        \" \",\n                                        { t:7,\n                                          e:\"tr\",\n                                          f:[ { t:7,\n                                              e:\"td\",\n                                              v:{ click:\"toggle-mode\" },\n                                              a:{ mode:\"Mixolydian\",\n                                                \"class\":[ { t:4,\n                                                    n:50,\n                                                    rx:{ r:\"keymode\",\n                                                      m:[ { r:[  ],\n                                                          s:\"\\\"Mixolydian\\\"\" } ] },\n                                                    f:[ \"on\" ] } ] },\n                                              f:[ \"Mixolydian\" ] },\n                                            \" \",\n                                            { t:7,\n                                              e:\"td\",\n                                              v:{ click:\"toggle-mode\" },\n                                              a:{ mode:\"Minor\",\n                                                \"class\":[ { t:4,\n                                                    n:50,\n                                                    rx:{ r:\"keymode\",\n                                                      m:[ { r:[  ],\n                                                          s:\"\\\"Minor\\\"\" } ] },\n                                                    f:[ \"on\" ] } ] },\n                                              f:[ \"Minor\" ] },\n                                            \" \",\n                                            { t:7,\n                                              e:\"td\",\n                                              v:{ click:\"toggle-mode\" },\n                                              a:{ mode:\"Locrian\",\n                                                \"class\":[ { t:4,\n                                                    n:50,\n                                                    rx:{ r:\"keymode\",\n                                                      m:[ { r:[  ],\n                                                          s:\"\\\"Locrian\\\"\" } ] },\n                                                    f:[ \"on\" ] } ] },\n                                              f:[ \"Locrian\" ] } ] } ] },\n                                    \" \",\n                                    { t:7,\n                                      e:\"div\",\n                                      a:{ \"class\":\"span-button-container\" },\n                                      f:[ { t:7,\n                                          e:\"span\",\n                                          v:{ click:\"clear-all-modes\" },\n                                          f:[ \"Clear All\" ] },\n                                        { t:7,\n                                          e:\"span\",\n                                          v:{ click:\"select-all-modes\" },\n                                          f:[ \"Select All\" ] } ] } ] } ] } ] } ] },\n                    \" \",\n                    { t:7,\n                      e:\"div\",\n                      a:{ \"class\":\"search-option\" },\n                      f:[ { t:7,\n                          e:\"label\",\n                          f:[ \"Rhythm\" ] },\n                        \" \",\n                        { t:7,\n                          e:\"select\",\n                          f:[ { t:7,\n                              e:\"option\",\n                              f:[ \"All\" ] },\n                            \" \",\n                            { t:4,\n                              n:52,\n                              r:\"rhythm\",\n                              f:[ { t:7,\n                                  e:\"option\",\n                                  f:[ { t:2,\n                                      r:\".\" } ] } ] } ] } ] },\n                    \" \",\n                    { t:7,\n                      e:\"div\",\n                      a:{ \"class\":\"search-option\" },\n                      f:[ { t:7,\n                          e:\"label\",\n                          f:[ \"Type\" ] },\n                        \" \",\n                        { t:7,\n                          e:\"select\",\n                          f:[ { t:7,\n                              e:\"option\",\n                              f:[ \"All\" ] } ] } ] },\n                    \" \",\n                    { t:7,\n                      e:\"div\",\n                      a:{ \"class\":\"search-option\" },\n                      f:[ { t:7,\n                          e:\"label\",\n                          f:[ \"Time Signature\" ] },\n                        \" \",\n                        { t:7,\n                          e:\"select\",\n                          f:[ { t:7,\n                              e:\"option\",\n                              f:[ \"All\" ] } ] } ] } ] },\n                \" \",\n                { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"scrollable flex-column\" },\n                  f:[ { t:7,\n                      e:\"ul\",\n                      a:{ \"class\":\"item-list tune-list\",\n                        id:\"allTunes\" },\n                      f:[ { t:4,\n                          n:52,\n                          r:\"publicTuneNames\",\n                          f:[ { t:7,\n                              e:\"li\",\n                              a:{ \"class\":\"drag tune-list-item thin-card\",\n                                tuneId:[ { t:2,\n                                    r:\"_id\" } ],\n                                tuneData:[ { t:2,\n                                    x:{ r:[ \".\" ],\n                                      s:\"JSON.stringify(_0)\" } } ] },\n                              f:[ { t:7,\n                                  e:\"h3\",\n                                  f:[ { t:2,\n                                      r:\"settings.rhythm\" },\n                                    \" - \",\n                                    { t:2,\n                                      r:\"settings.key.note\" },\n                                    { t:2,\n                                      r:\"settings.key.mode\" },\n                                    \" - \",\n                                    { t:2,\n                                      r:\"name\" } ] },\n                                \" \" ] } ] } ] } ] } ] },\n            \" \",\n            { t:7,\n              e:\"div\",\n              a:{ \"class\":\"column half\",\n                id:\"tunebook-editor-pane\" },\n              t1:{ n:\"fade\",\n                a:[ { delay:200 } ] },\n              f:[ { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"tunebook-card-full card flex-column\" },\n                  f:[ { t:7,\n                      e:\"div\",\n                      a:{ \"class\":\"tunebook-settings\" },\n                      f:[ { t:7,\n                          e:\"input\",\n                          a:{ \"class\":\"title-box\",\n                            type:\"text\",\n                            value:[ { t:2,\n                                r:\"tunebookName\" } ] } } ] },\n                    \" \",\n                    { t:7,\n                      e:\"div\",\n                      a:{ \"class\":\"tunebook-tunes flex-column\" },\n                      f:[ { t:7,\n                          e:\"ul\",\n                          a:{ \"class\":\"item-list tune-list\",\n                            id:\"selectedTunes\" },\n                          f:[  ] } ] },\n                    \" \",\n                    { t:7,\n                      e:\"div\",\n                      a:{ \"class\":\"tunebook-footer\" },\n                      f:[ { t:7,\n                          e:\"div\",\n                          a:{ \"class\":\"footer-stats\" },\n                          f:[ { t:7,\n                              e:\"span\",\n                              f:[ { t:2,\n                                  r:\"selectedTuneCount\" },\n                                \" tune\",\n                                { t:4,\n                                  n:50,\n                                  x:{ r:[ \"selectedTuneCount\" ],\n                                    s:\"_0!==1\" },\n                                  f:[ \"s\" ] },\n                                \" added\" ] } ] },\n                        \" \",\n                        { t:7,\n                          e:\"div\",\n                          a:{ \"class\":\"footer-buttons\" },\n                          f:[ { t:7,\n                              e:\"button\",\n                              v:{ click:\"save-tunebook\" },\n                              f:[ \"Save\" ] } ] } ] } ] } ] } ] } ] } ] }","'use strict';\r\n\r\nvar\r\n    fade = require('scripts/transitions/ractive.transitions.fade'),\r\n    fly = require('scripts/transitions/ractive.transitions.fly'),\r\n    \r\n    Sortable = require('vendor').sortable,\r\n    siz = require('vendor').sizzle;\r\n\r\n\r\nvar template = require(\"./tunebook_edit.html\");\r\n\r\nmodule.exports = function() {\r\n\r\n    var onInit = function() {\r\n\r\n        var ractive = this;\r\n\r\n        var selectedTuneCount = 0;\r\n\r\n        var getSelectedTunes = () => siz(\".tunebook-tunes .tune-list-item\").map((item) => JSON.parse(item.attributes.tuneData.value));\r\n\r\n        ractive.set(\"selectedTuneCount\", selectedTuneCount);\r\n        ractive.set(\"tunebookName\", \"Untitled Tunebook\");\r\n\r\n        ractive.on({\r\n            \"navigate_back\": function(event) {\r\n                ractive.fire(\"navigate_to_page\",\"/\");\r\n            },\r\n            \"save-tunebook\": (event) => {\r\n                fetch('/api/tunebook/add', {\r\n                  method: 'post',\r\n                  headers: {\r\n                    'Accept': 'application/json',\r\n                    'Content-Type': 'application/json'\r\n                  },\r\n                  body: JSON.stringify({\r\n                    name: ractive.get(\"tunebookName\"),\r\n                    tunes: getSelectedTunes()                \r\n                    })\r\n                });\r\n\r\n                page.show(\"/\");\r\n            }\r\n        });\r\n\r\n        fetch(\"/api/tunes\")\r\n        .then(function(response) {\r\n            return response.json()\r\n        }).then(function(data) {\r\n            ractive.set(\"publicTuneNames\", data);\r\n        }).catch(function(ex) {\r\n            console.log('parsing failed', ex)\r\n        });\r\n\r\n    }\r\n\r\n    var onRender = function() {\r\n        Sortable.create(siz('#allTunes')[0], { \r\n            group: \"omega\",\r\n            sort: false,        \r\n            animation: 150\r\n        }); \r\n\r\n        Sortable.create(siz('#selectedTunes')[0], {\r\n            group: \"omega\",\r\n            animation: 150,\r\n            onAdd: (evt) => {\r\n                selectedTuneCount++;\r\n                ractive.set(\"selectedTuneCount\", selectedTuneCount);\r\n            },\r\n            onRemove: (evt) => {\r\n                selectedTuneCount--;\r\n                ractive.set(\"selectedTuneCount\", selectedTuneCount);\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    var ractive = Ractive.extend({\r\n      isolated: false,\r\n      template: template,\r\n      oninit: onInit,\r\n      onrender: onRender\r\n    }); \r\n\r\n    return ractive;\r\n\r\n};","module.exports = { v:1,\n  t:[ { t:7,\n      e:\"section\",\n      a:{ \"class\":\"page-view\",\n        id:\"view-tunebook\" },\n      f:[ { t:7,\n          e:\"div\",\n          a:{ \"class\":\"header row coloured\" },\n          t1:\"fade\",\n          f:[ { t:7,\n              e:\"div\",\n              a:{ \"class\":\"central-menu\" },\n              f:[ { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"app-name\" },\n                  f:[ { t:7,\n                      e:\"img\",\n                      a:{ src:\"/images/logo.png\",\n                        \"class\":\"app-logo\",\n                        height:\"32px\" },\n                      v:{ click:\"navigate_back\" } } ] } ] },\n            \" \",\n            { t:7,\n              e:\"div\",\n              a:{ \"class\":\"page-title\" },\n              f:[ { t:7,\n                  e:\"h1\",\n                  f:[ { t:7,\n                      e:\"i\",\n                      a:{ \"class\":\"fa fa-book\" } },\n                    \" \",\n                    { t:2,\n                      r:\"tunebook.name\" } ] } ] },\n            \" \",\n            { t:8,\n              r:\"userbox\" } ] },\n        \" \",\n        { t:7,\n          e:\"div\",\n          a:{ \"class\":\"row editor\" },\n          f:[ { t:7,\n              e:\"div\",\n              a:{ \"class\":\"column third\",\n                id:\"tunebook-editor-pane\" },\n              t1:{ n:\"fade\",\n                a:[ { delay:200 } ] },\n              f:[ { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"tunebook-card-full card flex-column\" },\n                  f:[ { t:7,\n                      e:\"div\",\n                      a:{ \"class\":\"tunebook-settings\" },\n                      f:[ { t:7,\n                          e:\"input\",\n                          a:{ \"class\":\"title-box\",\n                            type:\"text\",\n                            value:[ { t:2,\n                                r:\"tunebook.name\" } ] } } ] },\n                    \" \",\n                    { t:7,\n                      e:\"div\",\n                      a:{ \"class\":\"tunebook-tunes flex-column\" },\n                      f:[ { t:7,\n                          e:\"ul\",\n                          a:{ \"class\":\"item-list tune-list\",\n                            id:\"tunebookTunes\" },\n                          f:[ { t:4,\n                              n:52,\n                              r:\"tunebook.tunes\",\n                              i:\"num\",\n                              f:[ { t:4,\n                                  n:50,\n                                  x:{ r:[ \"type\" ],\n                                    s:\"_0===\\\"tune\\\"\" },\n                                  f:[ { t:7,\n                                      e:\"li\",\n                                      a:{ \"class\":[ \"drag tune-list-item clearfix \",\n                                          { t:4,\n                                            n:50,\n                                            x:{ r:[ \"_id\",\n                                                \"selectedItem\" ],\n                                              s:\"_0===_1\" },\n                                            f:[ \"selected\" ] } ],\n                                        tuneId:[ { t:2,\n                                            r:\"_id\" } ] },\n                                      v:{ click:\"tune_item_click\" },\n                                      f:[ { t:7,\n                                          e:\"span\",\n                                          a:{ \"class\":\"tune-info\" },\n                                          f:[ { t:7,\n                                              e:\"h3\",\n                                              f:[ { t:7,\n                                                  e:\"span\",\n                                                  a:{ \"class\":\"drag-handle\" },\n                                                  f:[ { t:7,\n                                                      e:\"i\",\n                                                      a:{ \"class\":\"fa fa-cube\" } } ] },\n                                                \" \",\n                                                { t:2,\n                                                  r:\"name\" } ] } ] },\n                                        \" \",\n                                        { t:7,\n                                          e:\"span\",\n                                          a:{ \"class\":\"tune-buttons\" },\n                                          f:[ { t:7,\n                                              e:\"span\",\n                                              a:{ \"class\":\"icon-button-panel compact\" },\n                                              f:[ { t:7,\n                                                  e:\"i\",\n                                                  a:{ \"class\":\"fa fa-sitemap\",\n                                                    arrayId:[ { t:2,\n                                                        r:\"num\" } ],\n                                                    title:\"Convert to Set\" },\n                                                  v:{ click:\"convert-to-set\" } } ] } ] } ] } ] },\n                                \" \",\n                                { t:4,\n                                  n:50,\n                                  x:{ r:[ \"type\" ],\n                                    s:\"_0===\\\"set\\\"\" },\n                                  f:[ { t:7,\n                                      e:\"li\",\n                                      a:{ \"class\":[ \"tune-list-item set-box flex-column \",\n                                          { t:4,\n                                            n:50,\n                                            x:{ r:[ \"_id\",\n                                                \"selectedItem\" ],\n                                              s:\"_0===_1\" },\n                                            f:[ \"selected\" ] } ],\n                                        setId:[ { t:2,\n                                            r:\"_id\" } ] },\n                                      v:{ click:\"set_item_click\" },\n                                      f:[ { t:7,\n                                          e:\"div\",\n                                          a:{ \"class\":\"set-box-header\" },\n                                          f:[ { t:7,\n                                              e:\"h3\",\n                                              f:[ { t:7,\n                                                  e:\"span\",\n                                                  a:{ \"class\":\"drag-handle\" },\n                                                  f:[ { t:7,\n                                                      e:\"i\",\n                                                      a:{ \"class\":\"fa fa-cubes\" } } ] },\n                                                { t:7,\n                                                  e:\"input\",\n                                                  a:{ type:\"text\",\n                                                    value:[ { t:2,\n                                                        r:\"name\" } ] } } ] } ] },\n                                        \" \",\n                                        { t:7,\n                                          e:\"div\",\n                                          a:{ \"class\":\"set-box-body flex-column\" },\n                                          f:[ { t:7,\n                                              e:\"ul\",\n                                              a:{ \"class\":\"item-list tune-list set-tune-list\",\n                                                id:[ { t:2,\n                                                    r:\"_id\" },\n                                                  \"_list\" ] },\n                                              f:[ { t:4,\n                                                  n:52,\n                                                  r:\"tunes\",\n                                                  f:[ { t:4,\n                                                      n:50,\n                                                      x:{ r:[ \"type\" ],\n                                                        s:\"_0===\\\"tune\\\"\" },\n                                                      f:[ { t:7,\n                                                          e:\"li\",\n                                                          a:{ \"class\":[ \"drag tune-list-item clearfix \",\n                                                              { t:4,\n                                                                n:50,\n                                                                x:{ r:[ \"_id\",\n                                                                    \"selectedItem\" ],\n                                                                  s:\"_0===_1\" },\n                                                                f:[ \"selected\" ] } ],\n                                                            tuneId:[ { t:2,\n                                                                r:\"_id\" } ] },\n                                                          v:{ click:\"tune_item_click\" },\n                                                          f:[ { t:7,\n                                                              e:\"span\",\n                                                              a:{ \"class\":\"tune-info\" },\n                                                              f:[ { t:7,\n                                                                  e:\"h3\",\n                                                                  f:[ { t:7,\n                                                                      e:\"span\",\n                                                                      a:{ \"class\":\"drag-handle\" },\n                                                                      f:[ { t:7,\n                                                                          e:\"i\",\n                                                                          a:{ \"class\":\"fa fa-cube\" } } ] },\n                                                                    \" \",\n                                                                    { t:2,\n                                                                      r:\"name\" } ] } ] },\n                                                            \" \",\n                                                            { t:7,\n                                                              e:\"span\",\n                                                              a:{ \"class\":\"tune-buttons\" },\n                                                              f:[ { t:7,\n                                                                  e:\"span\",\n                                                                  a:{ \"class\":\"icon-button-panel compact\" },\n                                                                  f:[  ] } ] } ] } ] } ] } ] } ] } ] } ] } ] } ] } ] },\n                    \" \",\n                    { t:7,\n                      e:\"div\",\n                      a:{ \"class\":\"tunebook-footer\" },\n                      f:[ { t:7,\n                          e:\"div\",\n                          a:{ \"class\":\"footer-stats\" },\n                          f:[  ] },\n                        \" \",\n                        { t:7,\n                          e:\"div\",\n                          a:{ \"class\":\"footer-buttons\" },\n                          f:[ { t:7,\n                              e:\"button\",\n                              v:{ click:\"add-new-set\" },\n                              f:[ \"Add New Set\" ] },\n                            \" \",\n                            { t:7,\n                              e:\"button\",\n                              v:{ click:\"save-tunebook\" },\n                              f:[ \"Save\" ] } ] } ] } ] } ] },\n            \" \",\n            { t:7,\n              e:\"div\",\n              a:{ \"class\":\"column two-thirds flex-column\" },\n              t1:{ n:\"fade\",\n                a:[ { delay:100 } ] },\n              f:[ { t:7,\n                  e:\"div\",\n                  a:{ id:\"canvas\" },\n                  f:[  ] } ] } ] } ] } ] }","'use strict';\r\n\r\nvar\r\n    fade = require('scripts/transitions/ractive.transitions.fade'),\r\n    fly = require('scripts/transitions/ractive.transitions.fly'),\r\n    \r\n    Sortable = require('vendor').sortable,\r\n    siz = require('vendor').sizzle,\r\n\r\n    queryString = require('vendor').queryString,\r\n    _ = require('vendor').lodash,\r\n\r\n    engine = require('engine/engine'),\r\n\r\n    ABCParser = engine.parser,\r\n    ABCRenderer = engine.render,\r\n    diff = engine.diff,\r\n    ABCLayout = engine.layout,\r\n    AudioRenderer = engine.audioRender,\r\n\r\n    AudioEngine = engine.audio;\r\n\r\nvar setListIdRegex = /^set_(.*)_list$/;\r\n\r\nvar template = require(\"./tunebook_view.html\");\r\n\r\nmodule.exports = function() {\r\n\r\n    var onInit = function() {\r\n\r\n        var ractive = this;\r\n\r\n        var selectedTuneCount = 0;\r\n        var params = queryString.parse(ractive.get('url').querystring);\r\n\r\n        ractive.set(\"selectedItem\", \"\");\r\n        var tunebookData = {};\r\n\r\n        if(params.tunebook != undefined) {\r\n            fetch(\"/api/tunebook/\" + params.tunebook)\r\n            .then(function(response) {\r\n                return response.json()\r\n            }).then(function(data) {\r\n                tunebookData = data;\r\n                ractive.set(\"tunebook\", data); \r\n            }).catch(function(ex) {\r\n                console.log('parsing failed', ex)\r\n            });\r\n        } else {\r\n            //error\r\n        }        \r\n\r\n        ractive.on({ \r\n            \"navigate_back\": function(event) {\r\n                ractive.fire(\"navigate_to_page\", \"/\");\r\n            },\r\n            \"tune_item_click\": function(event) {\r\n\r\n                var tuneId = event.node.attributes.tuneId.value;\r\n\r\n                ractive.set(\"selectedItem\", tuneId);\r\n\r\n                fetch(\"/api/tune/\" + tuneId)\r\n                .then(function(response) {\r\n                    return response.json()\r\n                }).then(function(res) {\r\n\r\n                    var parser = ABCParser(),\r\n                        layout = ABCLayout(),\r\n                        renderer = ABCRenderer();\r\n\r\n                    ractive.set(\"tune\", res);\r\n\r\n                    var diffed = diff({\r\n                            newValue: res.raw,\r\n                            oldValue: \"\"\r\n                        });\r\n                    var parsed = diffed.map(parser);\r\n                    var done = parsed.reduce(layout, 0);\r\n\r\n                    renderer(done);\r\n                    console.log(\"It WORKED!!\", res);\r\n\r\n                });\r\n            },\r\n            \"set_item_click\": function(event) {\r\n\r\n                var setId = event.node.attributes.setId.value;\r\n                ractive.set(\"selectedItem\", setId);\r\n\r\n                siz('#canvas')[0].innerHTML = \"<h3>YAY A SET</h3>\";\r\n            },\r\n            \"add-new-set\": function() {\r\n\r\n                var newId = _.uniqueId(\"set_\");\r\n\r\n                tunebookData.tunes.push({\r\n                    name: \"Set\",\r\n                    type: \"set\",\r\n                    _id: newId,\r\n                    tunes: []\r\n                });\r\n                \r\n                Sortable.create(siz('#' + newId + \"_list\")[0], { \r\n                    animation: 150,\r\n                    group: \"omega\",\r\n                    handle: \".drag-handle\",\r\n                    onSort: updateListOrderFunc\r\n                });              \r\n            },\r\n            \"convert-to-set\": function(event) {\r\n\r\n                var arrayId = event.node.attributes.arrayId.value;\r\n\r\n                var newId = _.uniqueId(\"set_\");\r\n\r\n                var oldTune = tunebookData.tunes[arrayId];\r\n\r\n                tunebookData.tunes.splice(arrayId, 1, {\r\n                    name: \"Set\",\r\n                    type: \"set\",\r\n                    _id: newId,\r\n                    tunes: [oldTune]\r\n                });\r\n\r\n                Sortable.create(siz('#' + newId + \"_list\")[0], { \r\n                    animation: 150,\r\n                    group: \"omega\",\r\n                    handle: \".drag-handle\",\r\n                    //onSort: updateListOrderFunc\r\n                });  \r\n            }\r\n        });         \r\n    }\r\n\r\n    var onRender = function() {\r\n\r\n        var ractive = this;\r\n\r\n        var updateListOrderFunc = function(evt) {\r\n            console.log(evt);\r\n            var movedTune = null;\r\n\r\n            if(evt.from.id === \"tunebookTunes\") {\r\n                movedTune = tunebookData.tunes.splice(evt.oldIndex, 1);\r\n            } else {\r\n                var regexTestResult = setListIdRegex.exec(evt.from.id);\r\n                if(regexTestResult !== null) {\r\n                    var currentSet = _.find(tunebookData.tunes, function(tuneItem) {\r\n                         return tuneItem.type === \"set\" && tuneItem._id === (\"set_\" + regexTestResult[1])\r\n                    });\r\n                    movedTune = currentSet.tunes.splice(evt.oldIndex, 1);\r\n                }\r\n            }\r\n\r\n            if(evt.target.id === \"tunebookTunes\") {\r\n                tunebookData.tunes.splice(evt.newIndex, 0, movedTune[0]);\r\n            } else {\r\n                var regexTestResult = setListIdRegex.exec(evt.target.id);\r\n                if(regexTestResult !== null) {\r\n                    var currentSet = _.find(tunebookData.tunes, function(tuneItem) {\r\n                         return tuneItem.type === \"set\" && tuneItem._id === (\"set_\" + regexTestResult[1])\r\n                    });\r\n                    currentSet.tunes.splice(evt.newIndex, 0, movedTune[0]);\r\n                }\r\n            } \r\n\r\n            ractive.set(\"tunebook\", tunebookData); \r\n        }\r\n\r\n        Sortable.create(siz('#tunebookTunes')[0], { \r\n            animation: 150,\r\n            group: \"omega\",\r\n            handle: \".drag-handle\",\r\n            onSort: updateListOrderFunc\r\n        });\r\n    }\r\n\r\n\r\n    var ractive = Ractive.extend({\r\n      isolated: false,\r\n      template: template,\r\n      oninit: onInit,\r\n      onrender: onRender\r\n    }); \r\n\r\n    return ractive;\r\n};","module.exports = { v:1,\n  t:[ { t:7,\n      e:\"section\",\n      a:{ \"class\":\"tutorial\",\n        id:\"tut01\" },\n      f:[ { t:7,\n          e:\"h1\",\n          f:[ \"Tutorial 1\" ] } ] } ] }","module.exports = { v:1,\n  t:[ { t:7,\n      e:\"section\",\n      a:{ \"class\":\"page-view\",\n        id:\"view-tutorial\" },\n      f:[ { t:7,\n          e:\"div\",\n          a:{ \"class\":\"header row coloured\" },\n          t1:\"fade\",\n          f:[ { t:7,\n              e:\"div\",\n              a:{ \"class\":\"central-menu\" },\n              f:[ { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"app-name\" },\n                  f:[ { t:7,\n                      e:\"img\",\n                      a:{ src:\"/images/logo.png\",\n                        \"class\":\"app-logo\",\n                        height:\"32px\" },\n                      v:{ click:\"navigate_back\" } } ] } ] },\n            \" \",\n            { t:7,\n              e:\"div\",\n              a:{ \"class\":\"page-title\" },\n              f:[ { t:7,\n                  e:\"h1\",\n                  f:[ \"Tutorial\" ] } ] },\n            \" \",\n            { t:8,\n              r:\"userbox\" } ] },\n        \" \",\n        { t:7,\n          e:\"div\",\n          a:{ \"class\":\"row editor\" },\n          f:[ { t:7,\n              e:\"div\",\n              a:{ \"class\":\"column quarter right-divide\" },\n              t1:{ n:\"fade\",\n                a:[ { delay:100 } ] },\n              f:[ { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"text-area-padding\" },\n                  f:[ { t:7,\n                      e:\"ol\",\n                      f:[ { t:7,\n                          e:\"li\",\n                          v:{ click:\"goto_p1\" },\n                          f:[ \"Getting started\" ] },\n                        \" \",\n                        { t:7,\n                          e:\"li\",\n                          v:{ click:\"goto_p2\" },\n                          f:[ \"More things\" ] } ] } ] } ] },\n            \" \",\n            { t:7,\n              e:\"div\",\n              a:{ \"class\":\"column three-quarters\",\n                id:\"task-pane\" },\n              t1:{ n:\"fade\",\n                a:[ { delay:200 } ] },\n              f:[ { t:7,\n                  e:\"h1\",\n                  f:[ \"Yay Tutorial!\" ] } ] } ] } ] } ] }","'use strict';\r\n\r\nvar\r\n    fade = require('scripts/transitions/ractive.transitions.fade'),\r\n    fly = require('scripts/transitions/ractive.transitions.fly'),\r\n\r\n    //well these work... but are they useful?\r\n    tut01 = require('app/tutorial/tut/tut01.html'),\r\n    tut02 = require('app/tutorial/tut/tut02.html');\r\n\r\n\r\nvar template = require(\"./tutorial.html\");\r\n\r\nmodule.exports = function() {\r\n\r\n    var onInit = function() {\r\n\r\n        var ractive = this;\r\n\r\n        ractive.on({\r\n            'new_tune': function(event) {\r\n                page(\"/editor\");\r\n            },\r\n            \"navigate_back\": function(event) {\r\n                window.history.back();\r\n            },\r\n            \"goto_p1\": (event) => {\r\n                console.log(\"p1\");\r\n            },\r\n            \"goto_p2\": (event) => {\r\n                console.log(\"p2\");\r\n            }\r\n        });\r\n    }\r\n \r\n    var ractive = Ractive.extend({\r\n      isolated: false,\r\n      template: template,\r\n      oninit: onInit\r\n    }); \r\n\r\n    return ractive;\r\n}; ","'use strict';\r\n\r\nvar $ = require(\"vendor\").jquery;\r\n\r\nvar\r\n    fade = require('scripts/transitions/ractive.transitions.fade'),\r\n    fly = require('scripts/transitions/ractive.transitions.fly'),\r\n    toastr = require('vendor').toastr;\r\n\r\n\r\nmodule.exports = function(ractive, context, page, urlcontext, user) {\r\n\r\n    ractive.on({\r\n        'new_tune': function(event) {\r\n            page(\"/editor\");\r\n        },\r\n        \"navigate_back\": function(event) {\r\n            page.show(\"/\");\r\n        }\r\n    });\r\n\r\n    ractive.on('view_tune', function(event) {\r\n        var tuneId = event.node.attributes[\"tune-id\"].value;\r\n        console.log(tuneId);\r\n        page(\"/editor?tuneid=\" + tuneId);\r\n    });\r\n\r\n    $.getJSON(\"/api/tunes\")\r\n        .then(function(data) {\r\n            ractive.set(\"tuneNames\", data);\r\n        });\r\n\r\n    ractive.set(\"filterTuneNames\", function(tuneNames, filter) {\r\n        if (filter.length <= 0) return tuneNames;\r\n        return tuneNames.filter(function(a) {\r\n            return a.name.toLowerCase().lastIndexOf(filter.toLowerCase(), 0) === 0;\r\n        });\r\n    });\r\n\r\n    // toastr.success(\"YAY\");\r\n};","module.exports = { v:1,\n  t:[ { t:7,\n      e:\"section\",\n      a:{ \"class\":\"page-view\",\n        id:\"view-viewer\" },\n      f:[ { t:7,\n          e:\"div\",\n          a:{ \"class\":\"header row coloured\" },\n          t1:\"fade\",\n          f:[ { t:7,\n              e:\"div\",\n              a:{ \"class\":\"central-menu\" },\n              f:[ { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"app-name\" },\n                  f:[ { t:7,\n                      e:\"img\",\n                      v:{ click:\"navigate_back\" },\n                      a:{ src:\"/images/logo.png\",\n                        \"class\":\"app-logo\",\n                        height:\"32px\" } } ] } ] },\n            \" \",\n            { t:8,\n              r:\"userbox\" } ] },\n        \" \",\n        { t:7,\n          e:\"div\",\n          a:{ \"class\":\"viewer-area\" },\n          f:[ { t:7,\n              e:\"div\",\n              a:{ \"class\":\"tune-information-card\" },\n              f:[ { t:7,\n                  e:\"div\",\n                  a:{ \"class\":\"card\" },\n                  f:[ { t:7,\n                      e:\"h1\",\n                      f:[ { t:2,\n                          r:\"tune.name\" } ] },\n                    \" \",\n                    { t:7,\n                      e:\"div\",\n                      a:{ style:\" float: right; position: static; margin-top: -42px;\" },\n                      f:[ { t:4,\n                          n:50,\n                          r:\"playing\",\n                          f:[ { t:7,\n                              e:\"i\",\n                              v:{ click:\"toggle-stop-tune\" },\n                              a:{ \"class\":\"fa fa-stop\",\n                                style:\"cursor: pointer\" } } ] },\n                        { t:4,\n                          n:51,\n                          f:[ { t:7,\n                              e:\"i\",\n                              v:{ click:\"toggle-play-tune\" },\n                              a:{ \"class\":\"fa fa-play\",\n                                style:\"cursor: pointer\" } } ],\n                          r:\"playing\" } ] },\n                    \" \",\n                    { t:7,\n                      e:\"h2\",\n                      f:[ { t:2,\n                          r:\"tune.settings.rhythm\" },\n                        \" \",\n                        { t:2,\n                          r:\"tune.settings.key.note\" },\n                        { t:7,\n                          e:\"small\",\n                          f:[ { t:2,\n                              r:\"tune.settings.key.mode\" } ] } ] },\n                    \" \",\n                    { t:7,\n                      e:\"p\",\n                      f:[ \"Added by \",\n                        { t:7,\n                          e:\"strong\",\n                          f:[ \"Tim Hollies\" ] },\n                        \" on \",\n                        { t:2,\n                          r:\"tune.metadata.createdOn\" } ] },\n                    \" \",\n                    { t:7,\n                      e:\"div\",\n                      a:{ \"class\":\"icon-button-panel\" },\n                      f:[ { t:7,\n                          e:\"i\",\n                          v:{ click:\"edit_tune\" },\n                          a:{ \"class\":\"fa fa-pencil-square-o\" } },\n                        \" \",\n                        { t:7,\n                          e:\"i\",\n                          a:{ \"class\":\"fa fa-floppy-o\" } },\n                        \" \",\n                        { t:7,\n                          e:\"i\",\n                          a:{ \"class\":\"fa fa-download\" } } ] } ] } ] },\n            \" \",\n            { t:7,\n              e:\"div\",\n              a:{ \"class\":\"row editor viewer\",\n                id:\"fullscreenZone\" },\n              t1:\"fade\",\n              f:[ { t:7,\n                  e:\"div\",\n                  a:{ id:\"canvas\" },\n                  f:[  ] } ] } ] } ] } ] }","'use strict';\r\n\r\nvar \r\n    fade = require('scripts/transitions/ractive.transitions.fade'),\r\n    fly = require('scripts/transitions/ractive.transitions.fly'),\r\n\r\n    screenfull = require('vendor').screenfull,\r\n    queryString = require('vendor').queryString,\r\n\r\n    engine = require('engine/engine'),\r\n\r\n    ABCParser = engine.parser,\r\n    ABCRenderer = engine.render,\r\n    diff = engine.diff,\r\n    ABCLayout = engine.layout,\r\n    AudioRenderer = require('engine/audio_render'),\r\n\r\n    AudioEngine = require('engine/audio/audio'),\r\n\r\n    tunePlayer = require('engine/audio/myplayer');\r\n\r\n\r\nvar template = require(\"./viewer.html\");\r\n\r\nmodule.exports = function(r) {\r\n\r\n    var onInit = function() {\r\n\r\n        var ractive = this;\r\n\r\n        var parameters = queryString.parse(ractive.get(\"url\").querystring);\r\n\r\n        var parser = ABCParser(ractive),\r\n        layout = ABCLayout(ractive),\r\n        renderer = ABCRenderer(ractive);\r\n\r\n        ractive.set(\"playing\", false);\r\n      \r\n        var tuneStopper = null;\r\n\r\n        ractive.on({\r\n            show_fullscreen() {\r\n                var elem = document.getElementById('fullscreenZone');\r\n                if (screenfull.enabled) {\r\n                    screenfull.request(elem);\r\n                }\r\n            },\r\n            publish_tune() {\r\n                $.ajax({\r\n                    type: \"POST\",\r\n                    url: \"/api/tunes/publish\",\r\n                    data: {\r\n                        tuneId: ractive.get(\"tune\")._id\r\n                    }\r\n                }).then(function() {\r\n                    ractive.fire(\"tune_publish_success\");\r\n                    toastr.success(\"Tune published\", \"Success!\");\r\n                });\r\n            },\r\n            end_of_tune() {            \r\n                ractive.set(\"playing\", false);\r\n            },    \r\n            \"navigate_back\": function() {\r\n                window.history.back();\r\n            },\r\n            \"edit_tune\": () => { \r\n                ractive.fire(\"navigate_to_page\", \"/editor?tuneid=\" + ractive.get('tune')._id);\r\n            },\r\n            \"toggle-stop-tune\": () => {\r\n                if(tuneStopper !== null)tuneStopper();\r\n                ractive.set(\"playing\", false);\r\n            },\r\n            \"toggle-play-tune\": () => {\r\n\r\n                //AudioEngine.play();\r\n\r\n                tuneStopper = tunePlayer(AudioRenderer(doneThing));\r\n\r\n                ractive.set(\"playing\", true);\r\n            }\r\n        });\r\n\r\n        var doneThing = null;\r\n\r\n        if (parameters.tuneid) {\r\n\r\n            fetch(\"/api/tune/\" + parameters.tuneid)\r\n            .then(function(response) {\r\n                return response.json()\r\n            }).then(function(res) {\r\n\r\n                ractive.set(\"tune\", res);\r\n\r\n                var diffed = diff({\r\n                    newValue: res.raw,\r\n                    oldValue: \"\"\r\n                });\r\n                var parsed = diffed.map(parser);\r\n                var done = parsed.reduce(layout, 0);\r\n\r\n                doneThing = done;\r\n\r\n                renderer(done);\r\n                console.log(\"It WORKED!!\", res);\r\n\r\n\r\n\r\n            });\r\n        }\r\n\r\n        if(parameters.transpose) {\r\n            ractive.fire(\"transpose_change\", parseInt(parameters.transpose));\r\n        }\r\n\r\n        window.getTune = () => {\r\n            var tune = doneThing;\r\n\r\n            var outTune = [];\r\n\r\n            tune.scoreLines.forEach((line) => {\r\n\r\n                line.symbols\r\n                .filter((symbol) => symbol.type === \"note\")\r\n                .forEach((note) => {\r\n                    outTune.push([note.pitch + ((note.octave - 4) * 12), note.noteLength * 16])\r\n                });\r\n            });\r\n\r\n            return outTune;\r\n        }\r\n    }\r\n\r\n    var ractive = Ractive.extend({\r\n      isolated: false,\r\n      template: template,\r\n      oninit: onInit\r\n    }); \r\n\r\n    return ractive;\r\n\r\n};","/* Example definition of a simple mode that understands a subset of\r\n * JavaScript:\r\n */\r\nvar CodeMirror = require('codemirror'),\r\n  CodeMirrorSimple = require('./scripts/codemirror_simple');\r\n\r\nCodeMirror.defineSimpleMode(\"abc\", {\r\n  // The start state contains the rules that are intially used\r\n  start: [\r\n    // The regex matches the token, the token property contains the type\r\n    {regex: /\\|/, token: \"barline\"},\r\n    {regex: /(X|T|Z|S|R|M|L|K):/, token: \"header-indicator\", next: \"header\"},\r\n    {regex: /[0-9]+/, token: \"note-length\"},\r\n    {regex: /`/, token: \"backtick\"},\r\n    // You can match multiple tokens at once. Note that the captured\r\n    // groups must span the whole string in this case\r\n    //{regex: /(function)(\\s+)([a-z$][\\w$]*)/,\r\n     //token: [\"keyword\", null, \"variable-2\"]},\r\n    // Rules are matched in the order in which they appear, so there is\r\n    // no ambiguity between this one and the one above\r\n    //{regex: /(?:function|var|return|if|for|while|else|do|this)\\b/,\r\n    // token: \"keyword\"},\r\n    //{regex: /true|false|null|undefined/, token: \"atom\"},\r\n    //{regex: /0x[a-f\\d]+|[-+]?(?:\\.\\d+|\\d+\\.?\\d*)(?:e[-+]?\\d+)?/i,\r\n    // token: \"number\"},\r\n    //{regex: /\\/\\/.*/, token: \"comment\"},\r\n    //{regex: /\\/(?:[^\\\\]|\\\\.)*?\\//, token: \"variable-3\"},\r\n    // A next property will cause the mode to move to a different state\r\n   // {regex: /\\/\\*/, token: \"comment\", next: \"comment\"},\r\n    //{regex: /[-+\\/*=<>!]+/, token: \"operator\"},\r\n    // indent and dedent properties guide autoindentation\r\n    //{regex: /[\\{\\[\\(]/, indent: true},\r\n    //{regex: /[\\}\\]\\)]/, dedent: true},\r\n    //{regex: /[a-z$][\\w$]*/, token: \"variable\"},\r\n    // You can embed other modes with the mode property. This rule\r\n    // causes all code between << and >> to be highlighted with the XML\r\n    // mode.\r\n    //{regex: /<</, token: \"meta\", mode: {spec: \"xml\", end: />>/}}\r\n  ],\r\n  // The multi-line comment state.\r\n  //comment: [\r\n  //  {regex: /.*?\\*\\//, token: \"comment\", next: \"start\"},\r\n  //  {regex: /.*/, token: \"comment\"}\r\n  //],\r\n  header: [\r\n    {regex: /.*/, token: \"header-text\", next: \"start\"},\r\n  ],\r\n  // The meta property contains global information about the mode. It\r\n  // can contain properties like lineComment, which are supported by\r\n  // all modes, and also directives like dontIndentStates, which are\r\n  // specific to simple modes.\r\n  meta: {\r\n    //dontIndentStates: [\"comment\"],\r\n    lineComment: \"//\"\r\n  }\r\n});\r\n","'use strict';\r\n\r\nvar base64 = require('base64-js');\r\nvar _ = require('lodash');\r\n\r\nvar midiGen = require('./midi');\r\n\r\nvar dispatcher = require('../dispatcher');\r\n\r\nvar context = new AudioContext();\r\nvar source = 0;\r\nvar audioBufferSize = 8192;\r\nvar waveBuffer;\r\nvar midiFileBuffer;\r\nvar read_wave_bytes = 0;\r\nvar song = 0;\r\nvar midijs_url = \"\";\r\n\r\nvar num_missing = 0;\r\nvar midiFileArray;\r\nvar stream;\r\nvar rval;\r\n\r\nfunction get_next_wave(ev) {\r\n    // collect new wave data from libtimidity into waveBuffer\r\n    read_wave_bytes = Module.ccall('mid_song_read_wave', 'number', ['number', 'number', 'number', 'number'], [song, waveBuffer, audioBufferSize * 2, false]);\r\n    if (0 == read_wave_bytes) {\r\n        dispatcher.send(\"end_of_tune\");\r\n        stop();\r\n        return;\r\n    }\r\n\r\n    var max_i16 = Math.pow(2, 15);\r\n    for (var i = 0; i < audioBufferSize; i++) {\r\n        if (i < read_wave_bytes) {\r\n            // convert PCM data from C sint16 to JavaScript number (range -1.0 .. +1.0)\r\n            ev.outputBuffer.getChannelData(0)[i] = Module.getValue(waveBuffer + 2 * i, 'i16') / max_i16;\r\n        } else {\r\n\r\n            ev.outputBuffer.getChannelData(0)[i] = 0; // fill end of buffer with zeroes, may happen at the end of a piece\r\n        }\r\n    }\r\n}\r\n\r\nfunction loadMissingPatch(url, path, filename) {\r\n\r\n    var request = new XMLHttpRequest();\r\n    request.open('GET', path + filename, true);\r\n    request.responseType = 'arraybuffer';\r\n\r\n    request.onerror = function() {\r\n        // MIDIjs.message_callback(\"Error: Cannot retrieve patch file \" + path + filename);\r\n    }\r\n\r\n    request.onload = function() {\r\n        if (200 != request.status) {\r\n            //MIDIjs.message_callback(\"Error: Cannot retrieve patch filee \" + path + filename + \" : \" + request.status);\r\n            return;\r\n        }\r\n\r\n        num_missing--;\r\n        FS.createDataFile('pat/', filename, new Int8Array(request.response), true, true);\r\n        //MIDIjs.message_callback(\"Loading instruments: \" + num_missing);\r\n        if (num_missing == 0) {\r\n            stream = Module.ccall('mid_istream_open_mem', 'number', ['number', 'number', 'number'], [midiFileBuffer, midiFileArray.length, false]);\r\n            var MID_AUDIO_S16LSB = 0x8010; // signed 16-bit samples\r\n            var options = Module.ccall('mid_create_options', 'number', ['number', 'number', 'number', 'number'], [context.sampleRate, MID_AUDIO_S16LSB, 1, audioBufferSize * 2]);\r\n            song = Module.ccall('mid_song_load', 'number', ['number', 'number'], [stream, options]);\r\n            rval = Module.ccall('mid_istream_close', 'number', ['number'], [stream]);\r\n            Module.ccall('mid_song_start', 'void', ['number'], [song]);\r\n\r\n            // create script Processor with buffer of size audioBufferSize and a single output channel\r\n            source = context.createScriptProcessor(audioBufferSize, 0, 1);\r\n            waveBuffer = Module._malloc(audioBufferSize * 2);\r\n            source.onaudioprocess = get_next_wave; // add eventhandler for next buffer full of audio data\r\n            source.connect(context.destination); // connect the source to the context's destination (the speakers)\r\n        }\r\n    }\r\n    request.send();\r\n}\r\n\r\nvar play = function (base64) {\r\n\r\n    midiFileArray = base64;\r\n    midiFileBuffer = Module._malloc(midiFileArray.length);\r\n    Module.writeArrayToMemory(midiFileArray, midiFileBuffer);\r\n\r\n    rval = Module.ccall('mid_init', 'number', [], []);\r\n    stream = Module.ccall('mid_istream_open_mem', 'number', ['number', 'number', 'number'], [midiFileBuffer, midiFileArray.length, false]);\r\n    var MID_AUDIO_S16LSB = 0x8010; // signed 16-bit samples\r\n    var options = Module.ccall('mid_create_options', 'number', ['number', 'number', 'number', 'number'], [context.sampleRate, MID_AUDIO_S16LSB, 1, audioBufferSize * 2]);\r\n    song = Module.ccall('mid_song_load', 'number', ['number', 'number'], [stream, options]);\r\n    rval = Module.ccall('mid_istream_close', 'number', ['number'], [stream]);\r\n\r\n    num_missing = Module.ccall('mid_song_get_num_missing_instruments', 'number', ['number'], [song]);\r\n    if (0 < num_missing) {\r\n        for (var i = 0; i < num_missing; i++) {\r\n            var missingPatch = Module.ccall('mid_song_get_missing_instrument', 'string', ['number', 'number'], [song, i]);\r\n            loadMissingPatch(\"\", \"/pat/\", missingPatch);\r\n        }\r\n    } else {\r\n        Module.ccall('mid_song_start', 'void', ['number'], [song]);\r\n        // create script Processor with auto buffer size and a single output channel\r\n        source = context.createScriptProcessor(audioBufferSize, 0, 1);\r\n        waveBuffer = Module._malloc(audioBufferSize * 2);\r\n        source.onaudioprocess = get_next_wave; // add eventhandler for next buffer full of audio data\r\n        source.connect(context.destination); // connect the source to the context's destination (the speakers)\r\n    }\r\n\r\n}\r\n\r\nvar stop = function () {\r\n    if (source) {\r\n        // terminate playback\r\n        source.disconnect();\r\n\r\n        // hack: without this, Firfox 25 keeps firing the onaudioprocess callback\r\n        source.onaudioprocess = 0;\r\n\r\n        source = 0;\r\n\r\n        // free libtimitdiy ressources\r\n        Module._free(waveBuffer);\r\n        Module._free(midiFileBuffer);\r\n        Module.ccall('mid_song_free', 'void', ['number'], [song]);\r\n        song = 0;\r\n        Module.ccall('mid_exit', 'void', [], []);\r\n        source = 0;\r\n    }\r\n}\r\n\r\nvar playTune = function (tuneData) {\r\n    var noteEvents = [];\r\n    tuneData.forEach(function(note) {\r\n        noteEvents.push(midiGen.MidiEvent.noteOn( { pitch: note[0], duration: 16 }));\r\n        noteEvents.push(midiGen.MidiEvent.noteOff( { pitch: note[0], duration: note[1] }));\r\n    });\r\n\r\n    // Create a track that contains the events to play the notes above\r\n    var track = new midiGen.MidiTrack({ events: noteEvents });\r\n\r\n    var song  = midiGen.MidiWriter({ tracks: [track] });\r\n\r\n    var convertDataURIToBinary = function (raw) {\r\n      var rawLength = raw.length;\r\n      var array = new Uint8Array(new ArrayBuffer(rawLength));\r\n     \r\n      for(var i = 0; i < rawLength; i++) {\r\n        array[i] = raw.charCodeAt(i);\r\n      }\r\n      return array;\r\n    }\r\n\r\n    // Creates an object that contains the final MIDI track in base64 and some\r\n    // useful methods.\r\n    var song = convertDataURIToBinary(song);\r\n\r\n    play(song);\r\n};\r\n\r\n\r\nmodule.exports = {\r\n    play: playTune,\r\n    stop: stop\r\n}","/*jslint es5: true, laxbreak: true */\n\nvar AP = Array.prototype;\n\n// Create a mock console object to void undefined errors if the console object\n// is not defined.\nif(window !== undefined) {\n    if (!window.console || !console.firebug) {\n        var names = [\"log\", \"debug\", \"info\", \"warn\", \"error\"];\n\n        window.console = {};\n        for (var i = 0; i < names.length; ++i) {\n            window.console[names[i]] = function() {};\n        }\n    }\n}\n\nvar DEFAULT_VOLUME   = 90;\nvar DEFAULT_DURATION = 128;\nvar DEFAULT_CHANNEL  = 0;\n\n// These are the different values that compose a MID header. They are already\n// expressed in their string form, so no useless conversion has to take place\n// since they are constants.\n\nvar HDR_CHUNKID     = \"MThd\";\nvar HDR_CHUNK_SIZE  = \"\\x00\\x00\\x00\\x06\"; // Header size for SMF\nvar HDR_TYPE0       = \"\\x00\\x00\"; // Midi Type 0 id\nvar HDR_TYPE1       = \"\\x00\\x01\"; // Midi Type 1 id\nvar HDR_SPEED       = \"\\x00\\x80\"; // Defaults to 128 ticks per beat\n\n// Midi event codes\nvar EVT_NOTE_OFF           = 0x8;\nvar EVT_NOTE_ON            = 0x9;\nvar EVT_AFTER_TOUCH        = 0xA;\nvar EVT_CONTROLLER         = 0xB;\nvar EVT_PROGRAM_CHANGE     = 0xC;\nvar EVT_CHANNEL_AFTERTOUCH = 0xD;\nvar EVT_PITCH_BEND         = 0xE;\n\nvar META_SEQUENCE   = 0x00;\nvar META_TEXT       = 0x01;\nvar META_COPYRIGHT  = 0x02;\nvar META_TRACK_NAME = 0x03;\nvar META_INSTRUMENT = 0x04;\nvar META_LYRIC      = 0x05;\nvar META_MARKER     = 0x06;\nvar META_CUE_POINT  = 0x07;\nvar META_CHANNEL_PREFIX = 0x20;\nvar META_END_OF_TRACK   = 0x2f;\nvar META_TEMPO      = 0x51;\nvar META_SMPTE      = 0x54;\nvar META_TIME_SIG   = 0x58;\nvar META_KEY_SIG    = 0x59;\nvar META_SEQ_EVENT  = 0x7f;\n\n// This is the conversion table from notes to its MIDI number. Provided for\n// convenience, it is not used in this code.\nvar noteTable = { \"G9\": 0x7F, \"Gb9\": 0x7E, \"F9\": 0x7D, \"E9\": 0x7C, \"Eb9\": 0x7B,\n\"D9\": 0x7A, \"Db9\": 0x79, \"C9\": 0x78, \"B8\": 0x77, \"Bb8\": 0x76, \"A8\": 0x75, \"Ab8\": 0x74,\n\"G8\": 0x73, \"Gb8\": 0x72, \"F8\": 0x71, \"E8\": 0x70, \"Eb8\": 0x6F, \"D8\": 0x6E, \"Db8\": 0x6D,\n\"C8\": 0x6C, \"B7\": 0x6B, \"Bb7\": 0x6A, \"A7\": 0x69, \"Ab7\": 0x68, \"G7\": 0x67, \"Gb7\": 0x66,\n\"F7\": 0x65, \"E7\": 0x64, \"Eb7\": 0x63, \"D7\": 0x62, \"Db7\": 0x61, \"C7\": 0x60, \"B6\": 0x5F,\n\"Bb6\": 0x5E, \"A6\": 0x5D, \"Ab6\": 0x5C, \"G6\": 0x5B, \"Gb6\": 0x5A, \"F6\": 0x59, \"E6\": 0x58,\n\"Eb6\": 0x57, \"D6\": 0x56, \"Db6\": 0x55, \"C6\": 0x54, \"B5\": 0x53, \"Bb5\": 0x52, \"A5\": 0x51,\n\"Ab5\": 0x50, \"G5\": 0x4F, \"Gb5\": 0x4E, \"F5\": 0x4D, \"E5\": 0x4C, \"Eb5\": 0x4B, \"D5\": 0x4A,\n\"Db5\": 0x49, \"C5\": 0x48, \"B4\": 0x47, \"Bb4\": 0x46, \"A4\": 0x45, \"Ab4\": 0x44, \"G4\": 0x43,\n\"Gb4\": 0x42, \"F4\": 0x41, \"E4\": 0x40, \"Eb4\": 0x3F, \"D4\": 0x3E, \"Db4\": 0x3D, \"C4\": 0x3C,\n\"B3\": 0x3B, \"Bb3\": 0x3A, \"A3\": 0x39, \"Ab3\": 0x38, \"G3\": 0x37, \"Gb3\": 0x36, \"F3\": 0x35,\n\"E3\": 0x34, \"Eb3\": 0x33, \"D3\": 0x32, \"Db3\": 0x31, \"C3\": 0x30, \"B2\": 0x2F, \"Bb2\": 0x2E,\n\"A2\": 0x2D, \"Ab2\": 0x2C, \"G2\": 0x2B, \"Gb2\": 0x2A, \"F2\": 0x29, \"E2\": 0x28, \"Eb2\": 0x27,\n\"D2\": 0x26, \"Db2\": 0x25, \"C2\": 0x24, \"B1\": 0x23, \"Bb1\": 0x22, \"A1\": 0x21, \"Ab1\": 0x20,\n\"G1\": 0x1F, \"Gb1\": 0x1E, \"F1\": 0x1D, \"E1\": 0x1C, \"Eb1\": 0x1B, \"D1\": 0x1A, \"Db1\": 0x19,\n\"C1\": 0x18, \"B0\": 0x17, \"Bb0\": 0x16, \"A0\": 0x15, \"Ab0\": 0x14, \"G0\": 0x13, \"Gb0\": 0x12,\n\"F0\": 0x11, \"E0\": 0x10, \"Eb0\": 0x0F, \"D0\": 0x0E, \"Db0\": 0x0D, \"C0\": 0x0C };\n\n// Helper functions\n\n/*\n * Converts a string into an array of ASCII char codes for every character of\n * the string.\n *\n * @param str {String} String to be converted\n * @returns array with the charcode values of the string\n */\nfunction StringToNumArray(str) {\n    return AP.map.call(str, function(char) {\n        return char.charCodeAt(0);\n    });\n}\n\n/*\n * Converts an array of bytes to a string of hexadecimal characters. Prepares\n * it to be converted into a base64 string.\n *\n * @param byteArray {Array} array of bytes that will be converted to a string\n * @returns hexadecimal string\n */\nfunction codes2Str(byteArray) {\n    return String.fromCharCode.apply(null, byteArray);\n}\n\n/*\n * Converts a String of hexadecimal values to an array of bytes. It can also\n * add remaining \"0\" nibbles in order to have enough bytes in the array as the\n * |finalBytes| parameter.\n *\n * @param str {String} string of hexadecimal values e.g. \"097B8A\"\n * @param finalBytes {Integer} Optional. The desired number of bytes that the returned array should contain\n * @returns array of nibbles.\n */\n\nfunction str2Bytes(str, finalBytes) {\n    if (finalBytes) {\n        while ((str.length / 2) < finalBytes) { str = \"0\" + str; }\n    }\n\n    var bytes = [];\n    for (var i=str.length-1; i>=0; i = i-2) {\n        var chars = i === 0 ? str[i] : str[i-1] + str[i];\n        bytes.unshift(parseInt(chars, 16));\n    }\n\n    return bytes;\n}\n\nfunction isArray(obj) {\n    return !!(obj && obj.concat && obj.unshift && !obj.callee);\n}\n\n\n/**\n * Translates number of ticks to MIDI timestamp format, returning an array of\n * bytes with the time values. Midi has a very particular time to express time,\n * take a good look at the spec before ever touching this function.\n *\n * @param ticks {Integer} Number of ticks to be translated\n * @returns Array of bytes that form the MIDI time value\n */\nvar translateTickTime = function(ticks) {\n    var buffer = ticks & 0x7F;\n\n    while (ticks = ticks >> 7) {\n        buffer <<= 8;\n        buffer |= ((ticks & 0x7F) | 0x80);\n    }\n\n    var bList = [];\n    while (true) {\n        bList.push(buffer & 0xff);\n\n        if (buffer & 0x80) { buffer >>= 8; }\n        else { break; }\n    }\n    return bList;\n};\n\n/*\n * This is the function that assembles the MIDI file. It writes the\n * necessary constants for the MIDI header and goes through all the tracks, appending\n * their data to the final MIDI stream.\n * It returns an object with the final values in hex and in base64, and with\n * some useful methods to play an manipulate the resulting MIDI stream.\n *\n * @param config {Object} Configuration object. It contains the tracks, tempo\n * and other values necessary to generate the MIDI stream.\n *\n * @returns An object with the hex and base64 resulting streams, as well as\n * with some useful methods.\n */\n\nvar MidiWriter = function(config) {\n    if (config) {\n        var tracks  = config.tracks || [];\n        // Number of tracks in hexadecimal\n        var tracksLength = tracks.length.toString(16);\n\n        // This variable will hold the whole midi stream and we will add every\n        // chunk of MIDI data to it in the next lines.\n        var hexMidi = HDR_CHUNKID + HDR_CHUNK_SIZE + HDR_TYPE0;\n\n        // Appends the number of tracks expressed in 2 bytes, as the MIDI\n        // standard requires.\n        hexMidi += codes2Str(str2Bytes(tracksLength, 2));\n        hexMidi += HDR_SPEED;\n        // Goes through the tracks appending the hex strings that compose them.\n        tracks.forEach(function(trk) { hexMidi += codes2Str(trk.toBytes()); });\n\n        return hexMidi;\n\n    } else {\n        throw new Error(\"No parameters have been passed to MidiWriter.\");\n    }\n};\n\n\n\n\n\n\n\n\n\n\n\n/*\n * Generic MidiEvent object. This object is used to create standard MIDI events\n * (note Meta events nor SysEx events). It is passed a |params| object that may\n * contain the keys time, type, channel, param1 and param2. Note that only the\n * type, channel and param1 are strictly required. If the time is not provided,\n * a time of 0 will be assumed.\n *\n * @param {object} params Object containing the properties of the event.\n */\nvar MidiEvent = function(params) {\n    if (params &&\n        (params.type    !== null || params.type    !== undefined) &&\n        (params.channel !== null || params.channel !== undefined) &&\n        (params.param1  !== null || params.param1  !== undefined)) {\n        this.setTime(params.time);\n        this.setType(params.type);\n        this.setChannel(params.channel);\n        this.setParam1(params.param1);\n        this.setParam2(params.param2);\n    } else {\n        throw new Error(\"Not enough parameters to create an event.\");\n    }\n};\n\n/**\n * Returns an event of the type NOTE_ON taking the values passed and falling\n * back to defaults if they are not specified.\n *\n * @param note {Note || String} Note object or string\n * @param time {Number} Duration of the note in ticks\n * @returns MIDI event with type NOTE_ON for the note specified\n */\nMidiEvent.noteOn = function(note, duration) {\n    return new MidiEvent({\n        time:    note.duration || duration || 0,\n        type:    EVT_NOTE_ON,\n        channel: note.channel || DEFAULT_CHANNEL,\n        param1:  note.pitch   || note,\n        param2:  note.volume  || DEFAULT_VOLUME\n    });\n};\n\n/**\n * Returns an event of the type NOTE_OFF taking the values passed and falling\n * back to defaults if they are not specified.\n *\n * @param note {Note || String} Note object or string\n * @param time {Number} Duration of the note in ticks\n * @returns MIDI event with type NOTE_OFF for the note specified\n */\n\nMidiEvent.noteOff = function(note, duration) {\n    return new MidiEvent({\n        time:    note.duration || duration || 0,\n        type:    EVT_NOTE_OFF,\n        channel: note.channel || DEFAULT_CHANNEL,\n        param1:  note.pitch   || note,\n        param2:  note.volume  || DEFAULT_VOLUME\n    });\n};\n\n\nMidiEvent.prototype = {\n    type: 0,\n    channel: 0,\n    time: 0,\n    setTime: function(ticks) {\n        // The 0x00 byte is always the last one. This is how Midi\n        // interpreters know that the time measure specification ends and the\n        // rest of the event signature starts.\n\n        this.time = translateTickTime(ticks || 0);\n    },\n    setType: function(type) {\n        if (type < EVT_NOTE_OFF || type > EVT_PITCH_BEND) {\n            throw new Error(\"Trying to set an unknown event: \" + type);\n        }\n\n        this.type = type;\n    },\n    setChannel: function(channel) {\n        if (channel < 0 || channel > 15) {\n            throw new Error(\"Channel is out of bounds.\");\n        }\n\n        this.channel = channel;\n    },\n    setParam1: function(p) {\n        this.param1 = p;\n    },\n    setParam2: function(p) {\n        this.param2 = p;\n    },\n    toBytes: function() {\n        var byteArray = [];\n\n        var typeChannelByte =\n            parseInt(this.type.toString(16) + this.channel.toString(16), 16);\n\n        byteArray.push.apply(byteArray, this.time);\n        byteArray.push(typeChannelByte);\n        byteArray.push(this.param1);\n\n        // Some events don't have a second parameter\n        if (this.param2 !== undefined && this.param2 !== null) {\n            byteArray.push(this.param2);\n        }\n        return byteArray;\n    }\n};\n\n\n///\n/// META EVENT\n///\n\nvar MetaEvent = function(params) {\n    if (params) {\n        this.setType(params.type);\n        this.setData(params.data);\n    }\n};\n\nMetaEvent.prototype = {\n    setType: function(t) {\n        this.type = t;\n    },\n    setData: function(d) {\n        this.data = d;\n    },\n    toBytes: function() {\n        if (!this.type || !this.data) {\n            throw new Error(\"Type or data for meta-event not specified.\");\n        }\n\n        var byteArray = [0xff, this.type];\n\n        // If data is an array, we assume that it contains several bytes. We\n        // apend them to byteArray.\n        if (isArray(this.data)) {\n            AP.push.apply(byteArray, this.data);\n        }\n\n        return byteArray;\n    }\n};\n\n///\n/// MIDI TRACK\n///\n\nvar MidiTrack = function(cfg) {\n    this.events = [];\n    for (var p in cfg) {\n        if (cfg.hasOwnProperty(p)) {\n            // Get the setter for the property. The property is capitalized.\n            // Probably a try/catch should go here.\n            this[\"set\" + p.charAt(0).toUpperCase() + p.substring(1)](cfg[p]);\n        }\n    }\n};\n\n//\"MTrk\" Marks the start of the track data\nMidiTrack.TRACK_START = [0x4d, 0x54, 0x72, 0x6b];\nMidiTrack.TRACK_END   = [0x0, 0xFF, 0x2F, 0x0];\n\nMidiTrack.prototype = {\n    /*\n     * Adds an event to the track.\n     *\n     * @param event {MidiEvent} Event to add to the track\n     * @returns the track where the event has been added\n     */\n    addEvent: function(event) {\n        this.events.push(event);\n        return this;\n    },\n    setEvents: function(events) {\n        AP.push.apply(this.events, events);\n        return this;\n    },\n    /*\n     * Adds a text meta-event to the track.\n     *\n     * @param type {Number} type of the text meta-event\n     * @param text {String} Optional. Text of the meta-event.\n     * @returns the track where the event ahs been added\n     */\n    setText: function(type, text) {\n        // If the param text is not specified, it is assumed that a generic\n        // text is wanted and that the type parameter is the actual text to be\n        // used.\n        if (!text) {\n            type = META_TEXT;\n            text = type;\n        }\n        return this.addEvent(new MetaEvent({ type: type, data: text }));\n    },\n    // The following are setters for different kinds of text in MIDI, they all\n    // use the |setText| method as a proxy.\n    setCopyright:  function(text) { return this.setText(META_COPYRIGHT, text);  },\n    setTrackName:  function(text) { return this.setText(META_TRACK_NAME, text); },\n    setInstrument: function(text) { return this.setText(META_INSTRUMENT, text); },\n    setLyric:      function(text) { return this.setText(META_LYRIC, text);      },\n    setMarker:     function(text) { return this.setText(META_MARKER, text);     },\n    setCuePoint:   function(text) { return this.setText(META_CUE_POINT, text);  },\n\n    setTempo: function(tempo) {\n        this.addEvent(new MetaEvent({ type: META_TEMPO, data: tempo }));\n    },\n    setTimeSig: function() {\n        // TBD\n    },\n    setKeySig: function() {\n        // TBD\n    },\n\n    toBytes: function() {\n        var trackLength = 0;\n        var eventBytes = [];\n        var startBytes = MidiTrack.TRACK_START;\n        var endBytes   = MidiTrack.TRACK_END;\n\n        /*\n         * Adds the bytes of an event to the eventBytes array and add the\n         * amount of bytes to |trackLength|.\n         *\n         * @param event {MidiEvent} MIDI event we want the bytes from.\n         */\n        var addEventBytes = function(event) {\n            var bytes = event.toBytes();\n            trackLength += bytes.length;\n            AP.push.apply(eventBytes, bytes);\n        };\n\n        this.events.forEach(addEventBytes);\n\n        // Add the end-of-track bytes to the sum of bytes for the track, since\n        // they are counted (unlike the start-of-track ones).\n        trackLength += endBytes.length;\n\n        // Makes sure that track length will fill up 4 bytes with 0s in case\n        // the length is less than that (the usual case).\n        var lengthBytes = str2Bytes(trackLength.toString(16), 4);\n\n        return startBytes.concat(lengthBytes, eventBytes, endBytes);\n    }\n};\n\n\nmodule.exports = {\n    MidiWriter,\n    MidiEvent,\n    MetaEvent,\n    MidiTrack,\n    noteTable\n};","var Base64 = require('base64-arraybuffer');\r\nvar _ = require('lodash');\r\nvar Timer = require('clockmaker').Timer;\r\n\r\nvar note = {};\r\n\r\nvar notes = [\"C\", \"Db\", \"D\", \"Eb\", \"E\", \"F\", \"Gb\", \"G\", \"Ab\", \"A\", \"Bb\", \"B\"];\r\n\r\nvar context = new AudioContext();\r\n\r\nfetch(\"/pat/acoustic_grand_piano-mp3.json\")\r\n.then(function(response) {\r\n  return response.json()\r\n}).then(function(res) {\r\n\r\n  _.forOwn(res, function(val, key){\r\n    var base64 = val.split(\",\")[1];\r\n    var buffer = Base64.decode(base64);    \r\n    context.decodeAudioData(buffer, function(decodedData) {\r\n     note[key] = decodedData;\r\n   });\r\n  });  \r\n});\r\n\r\nvar RhythmSample = {\r\n};\r\n\r\nRhythmSample.play = function(tuneData) {\r\n\r\n  var sources = [];\r\n\r\n  function playSound(buffer, time, length) {\r\n    var source = context.createBufferSource();\r\n    var gainNode = context.createGain();\r\n    gainNode.gain.linearRampToValueAtTime(0.5, time+length);\r\n    gainNode.gain.linearRampToValueAtTime(0, time+length+0.5);\r\n    source.buffer = buffer;\r\n    // Connect the source to the gain node.\r\n    source.connect(gainNode);\r\n    // Connect the gain node to the destination.\r\n    gainNode.connect(context.destination);\r\n    if (!source.start)\r\n      source.start = source.noteOn;\r\n    source.start(time);\r\n\r\n    sources.push(source);\r\n  }\r\n\r\n  var kick = note.A4;\r\n  var snare = note.A5;\r\n  var hihat = note.C4;\r\n\r\n  // We'll start playing the rhythm 100 milliseconds from \"now\"\r\n  var startTime = context.currentTime + 0.100;\r\n  var tempo = 80; // BPM (beats per minute)\r\n  var eighthNoteTime = (60 / tempo) / 2;\r\n\r\n  var offset = 0;\r\n\r\n  // Play 2 bars of the following:\r\n  for (var bar = 0; bar < tuneData.length; bar++) {\r\n\r\n    var octave = Math.floor((tuneData[bar][0]-24)/12);\r\n    var noteId = tuneData[bar][0] - 24 - (octave * 12);\r\n\r\n    playSound(note[notes[noteId] + (octave+1)], startTime + offset, tuneData[bar][1] /120);\r\n    offset += tuneData[bar][1] /120;\r\n    /*var time = startTime + bar * 8 * eighthNoteTime;\r\n    console.log(\"TIME\", time)\r\n    // Play the bass (kick) drum on beats 1, 5\r\n    playSound(kick, time);\r\n    playSound(kick, time + 4 * eighthNoteTime);\r\n\r\n    // Play the snare drum on beats 3, 7\r\n    playSound(snare, time + 2 * eighthNoteTime);\r\n    playSound(snare, time + 6 * eighthNoteTime);\r\n\r\n    // Play the hi-hat every eighthh note.\r\n    for (var i = 0; i < 8; ++i) {\r\n      playSound(hihat, time + i * eighthNoteTime);\r\n    }*/\r\n  }\r\n\r\n  var currentPosition = 0;\r\n  var firstNote = document.getElementById(\"note_0\");\r\n  firstNote.classList.add(\"selected-note\");\r\n  var lastHighlightedNote = firstNote;\r\n  var timer = new Timer(function(timer) {\r\n    currentPosition++;\r\n    //console.log(\"woo note\", tuneData[currentPosition][2]);\r\n    \r\n    if(lastHighlightedNote !== null)lastHighlightedNote.classList.remove(\"selected-note\");\r\n    var thisNote = document.getElementById(\"note_\" + tuneData[currentPosition][2]);\r\n    thisNote.classList.add(\"selected-note\");\r\n    lastHighlightedNote = thisNote;\r\n\r\n    if(currentPosition >= tuneData.length) {\r\n      timer.stop();\r\n      return;\r\n    }\r\n    timer.setDelay(tuneData[currentPosition][1] * 1000 / 120);\r\n  }, tuneData[0], {\r\n    repeat: true\r\n  }).start();\r\n\r\n  return function() {\r\n    timer.stop();\r\n    if(lastHighlightedNote !== null)lastHighlightedNote.classList.remove(\"selected-note\");\r\n    sources.forEach(function(source) {\r\n      source.stop();\r\n    });\r\n  }\r\n};\r\n\r\nvar playTune = function(tuneData) {\r\n\r\n\r\n\r\n  console.log(tuneData);\r\n  \r\n  var currentPosition = 0;\r\n/*\r\n  console.log(buffer);\r\n\r\n\r\n  var offset = 0;\r\n  for(var i = 0; i<1; i++) {\r\n\r\n    var source = context.createBufferSource(); // creates a sound source\r\n    //var gainNode = context.createGain();\r\n    source.connect(context.destination);\r\n      //gainNode.gain.linearRampToValueAtTime(0, 0.2);\r\n    source.buffer = note;                    // tell the source which sound to play\r\n    //gainNode.connect();       // connect the source to the context's destination (the speakers)\r\n    source.start(offset);\r\n    offset += tuneData[i][1] * 10;\r\n  }\r\n                          // play the source now\r\n                          */\r\n                          return RhythmSample.play(tuneData);\r\n\r\n                        }\r\n\r\n                        module.exports = playTune;"," \r\nvar data_tables = require('./data_tables.js');\r\n\r\n//transforms a tune into an array that can be played by the audio system\r\nvar audioRender = (tune) => {\r\n\tvar outTune = [];\r\n\r\n\tvar \r\n\t\tkeyModifier = data_tables.getKeyModifiers(tune.tuneSettings.key);\r\n\r\n\tvar allSymbols = tune.parsedLines.filter(function(line) { \r\n\t\treturn line.type === \"drawable\";\r\n\t}).reduce(function(alreadyParsed, line) {\r\n\t\treturn alreadyParsed.concat(line.symbols);\r\n\t}, []);\r\n\r\n\tvar \r\n\t\ti = 0,\r\n\t\trepeating = false,\r\n\t\trepeatLocation = -1,\r\n\t\ttotalLength = 0;\r\n\r\n\twhile(i < allSymbols.length) {\r\n\r\n\t\tvar syb = allSymbols[i];\r\n\r\n\t\tif(syb.type === \"note\") {\r\n\t\t\tvar pitch = syb.pitch + ((syb.octave - 4) * 12);\r\n\t\t\tswitch(syb.accidental)\r\n\t\t\t{\r\n\t\t\t\tcase \"^\": {\r\n\t\t\t\t\tpitch += 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase \"^^\": {\r\n\t\t\t\t\tpitch += 2;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase \"_\": {\r\n\t\t\t\t\tpitch -= 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase \"__\": {\r\n\t\t\t\t\tpitch -= 2;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(syb.accidental !== \"=\" && _.indexOf(keyModifier.notes, syb.note.toUpperCase()) !== -1) pitch += keyModifier.mod;\r\n\t\t\toutTune.push([pitch, syb.noteLength * 16, syb.renderNoteId])\r\n\t\t\ttotalLength += syb.noteLength * 16;\r\n\t\t}\r\n\r\n\t\tif(syb.type === \"barline\") {\r\n\t\t\tif(syb.subType === \"repeat_start\") {\r\n\t\t\t\trepeating = true;\r\n\t\t\t\trepeatLocation = i;\r\n\t\t\t}\r\n\t\t\tif(syb.subType === \"repeat_end\") {\r\n\t\t\t\tif(repeating) {\r\n\t\t\t\t\trepeating = false;\r\n\t\t\t\t\ti = repeatLocation;\r\n\t\t\t\t\trepeatLocation = -1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\trepeating = true;\r\n\t\t\t\t\trepeatLocation = i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\ti++;\r\n\t}\r\n\r\n\treturn outTune;\r\n}\r\n\r\nmodule.exports = audioRender;","'use strict';\r\n\r\nvar data_tables = {},\r\n    dispatcher = require('./dispatcher'),\r\n    zazate = require('zazate.js'),\r\n    _ = require('lodash');\r\n\r\ndata_tables[\"notes\"] = {\r\n    \"C\": {\r\n        octave: 4,\r\n        pitch: 60,\r\n        pos: 0\r\n    },\r\n    \"D\": {\r\n        octave: 4,\r\n        pitch: 62,\r\n        pos: 1\r\n    },\r\n    \"E\": {\r\n        octave: 4,\r\n        pitch: 64,\r\n        pos: 2\r\n    },\r\n    \"F\": {\r\n        octave: 4,\r\n        pitch: 65,\r\n        pos: 3\r\n    },\r\n    \"G\": {\r\n        octave: 4,\r\n        pitch: 67,\r\n        pos: 4\r\n    },\r\n    \"A\": {\r\n        octave: 4,\r\n        pitch: 69,\r\n        pos: 5\r\n    },\r\n    \"B\": {\r\n        octave: 4,\r\n        pitch: 71,\r\n        pos: 6\r\n    },\r\n    \"c\": {\r\n        octave: 5,\r\n        pitch: 60,\r\n        pos: 0\r\n    },\r\n    \"d\": {\r\n        octave: 5,\r\n        pitch: 62,\r\n        pos: 1\r\n    },\r\n    \"e\": {\r\n        octave: 5,\r\n        pitch: 64,\r\n        pos: 2\r\n    },\r\n    \"f\": {\r\n        octave: 5,\r\n        pitch: 65,\r\n        pos: 3\r\n    },\r\n    \"g\": {\r\n        octave: 5,\r\n        pitch: 67,\r\n        pos: 4\r\n    },\r\n    \"a\": {\r\n        octave: 5,\r\n        pitch: 69,\r\n        pos: 5\r\n    },\r\n    \"b\": {\r\n        octave: 5,\r\n        pitch: 71,\r\n        pos: 6\r\n    },\r\n};\r\n\r\ndata_tables.symbol_width = {\r\n    \"note\": function(note) {\r\n        return Math.log(note.noteLength + 1);\r\n        //return note.noteLength * 1;//* 1.618;\r\n    },\r\n    \"rest\": 1,\r\n    \"beat_rest\": 1,\r\n    \"barline\": 0.25,\r\n    \"space\": 0,\r\n    \"chord_annotation\": 0\r\n};\r\n\r\ndata_tables.mode_map = {\r\n    \"\": \"maj\",\r\n    \"ion\": \"maj\",\r\n    \"maj\": \"maj\",\r\n\r\n    \"m\": \"min\",\r\n    \"min\": \"min\",\r\n    \"aeo\": \"min\",\r\n\r\n    \"mix\": \"mix\",\r\n    \"dor\": \"dor\",\r\n    \"phr\": \"phr\",\r\n    \"lyd\": \"lyd\",\r\n    \"loc\": \"loc\"\r\n};\r\n\r\ndata_tables.keySig = {\r\n    \"C\": {\r\n        \"maj\": \"0\",\r\n        \"min\": \"-3\",\r\n        \"mix\": \"-1\",\r\n        \"dor\": \"-2\",\r\n        \"phr\": \"-4\",\r\n        \"lyd\": \"1\",\r\n        \"loc\": \"-5\"\r\n    },\r\n    \"C#\": {\r\n        \"maj\": \"7\",\r\n        \"min\": \"4\",\r\n        \"mix\": \"6\",\r\n        \"dor\": \"5\",\r\n        \"phr\": \"3\",\r\n        \"lyd\": \"NOPE\",\r\n        \"loc\": \"2\"\r\n    },\r\n    \"Db\": {\r\n        \"maj\": \"-5\",\r\n        \"min\": \"NOPE\",\r\n        \"mix\": \"-6\",\r\n        \"dor\": \"-7\",\r\n        \"phr\": \"NOPE\",\r\n        \"lyd\": \"-4\",\r\n        \"loc\": \"NOPE\"\r\n    },\r\n    \"D\": {\r\n        \"maj\": \"2\",\r\n        \"min\": \"-1\",\r\n        \"mix\": \"1\",\r\n        \"dor\": \"0\",\r\n        \"phr\": \"-2\",\r\n        \"lyd\": \"3\",\r\n        \"loc\": \"-3\"\r\n    },\r\n    \"D#\": {\r\n        \"maj\": \"6\",\r\n        \"min\": \"NOPE\",\r\n        \"mix\": \"NOPE\",\r\n        \"dor\": \"7\",\r\n        \"phr\": \"5\",\r\n        \"lyd\": \"\",\r\n        \"loc\": \"4\"\r\n    },\r\n    \"Eb\": {\r\n        \"maj\": \"-3\",\r\n        \"min\": \"-6\",\r\n        \"mix\": \"-4\",\r\n        \"dor\": \"-5\",\r\n        \"phr\": \"-7\",\r\n        \"lyd\": \"-2\",\r\n        \"loc\": \"NOPE\"\r\n    },\r\n    \"E\": {\r\n        \"maj\": \"4\",\r\n        \"min\": \"1\",\r\n        \"mix\": \"3\",\r\n        \"dor\": \"2\",\r\n        \"phr\": \"0\",\r\n        \"lyd\": \"5\",\r\n        \"loc\": \"-1\"\r\n    },\r\n    \"E#\": {\r\n        \"maj\": \"NOPE\",\r\n        \"min\": \"NOPE\",\r\n        \"mix\": \"NOPE\",\r\n        \"dor\": \"NOPE\",\r\n        \"phr\": \"7\",\r\n        \"lyd\": \"NOPE\",\r\n        \"loc\": \"6\"\r\n    },\r\n    \"Fb\": {\r\n        \"maj\": \"NOPE\",\r\n        \"min\": \"NOPE\",\r\n        \"mix\": \"NOPE\",\r\n        \"dor\": \"NOPE\",\r\n        \"phr\": \"NOPE\",\r\n        \"lyd\": \"-7\",\r\n        \"loc\": \"NOPE\"\r\n    },\r\n    \"F\": {\r\n        \"maj\": \"-1\",\r\n        \"min\": \"-4\",\r\n        \"mix\": \"-2\",\r\n        \"dor\": \"-3\",\r\n        \"phr\": \"-5\",\r\n        \"lyd\": \"0\",\r\n        \"loc\": \"-6\"\r\n    },\r\n    \"F#\": {\r\n        \"maj\": \"6\",\r\n        \"min\": \"3\",\r\n        \"mix\": \"5\",\r\n        \"dor\": \"4\",\r\n        \"phr\": \"2\",\r\n        \"lyd\": \"7\",\r\n        \"loc\": \"1\"\r\n    },\r\n    \"Gb\": {\r\n        \"maj\": \"-6\",\r\n        \"min\": \"NOPE\",\r\n        \"mix\": \"-7\",\r\n        \"dor\": \"NOPE\",\r\n        \"phr\": \"NOPE\",\r\n        \"lyd\": \"-5\",\r\n        \"loc\": \"NOPE\"\r\n    },\r\n    \"G\": {\r\n        \"maj\": \"1\",\r\n        \"min\": \"-2\",\r\n        \"mix\": \"0\",\r\n        \"dor\": \"-1\",\r\n        \"phr\": \"-3\",\r\n        \"lyd\": \"2\",\r\n        \"loc\": \"-4\"\r\n    },\r\n    \"G#\": {\r\n        \"maj\": \"NOPE\",\r\n        \"min\": \"5\",\r\n        \"mix\": \"7\",\r\n        \"dor\": \"6\",\r\n        \"phr\": \"4\",\r\n        \"lyd\": \"NOPE\",\r\n        \"loc\": \"3\"\r\n    },\r\n    \"Ab\": {\r\n        \"maj\": \"-4\",\r\n        \"min\": \"-7\",\r\n        \"mix\": \"-5\",\r\n        \"dor\": \"-6\",\r\n        \"phr\": \"NOPE\",\r\n        \"lyd\": \"-3\",\r\n        \"loc\": \"NOPE\"\r\n    },\r\n    \"A\": {\r\n        \"maj\": \"3\",\r\n        \"min\": \"0\",\r\n        \"mix\": \"2\",\r\n        \"dor\": \"1\",\r\n        \"phr\": \"-1\",\r\n        \"lyd\": \"4\",\r\n        \"loc\": \"-2\"\r\n    },\r\n    \"A#\": {\r\n        \"maj\": \"NOPE\",\r\n        \"min\": \"7\",\r\n        \"mix\": \"NOPE\",\r\n        \"dor\": \"NOPE\",\r\n        \"phr\": \"6\",\r\n        \"lyd\": \"NOPE\",\r\n        \"loc\": \"5\"\r\n    },\r\n    \"Bb\": {\r\n        \"maj\": \"-2\",\r\n        \"min\": \"-5\",\r\n        \"mix\": \"-3\",\r\n        \"dor\": \"-4\",\r\n        \"phr\": \"-6\",\r\n        \"lyd\": \"-1\",\r\n        \"loc\": \"-7\"\r\n    },\r\n    \"B\": {\r\n        \"maj\": \"5\",\r\n        \"min\": \"2\",\r\n        \"mix\": \"4\",\r\n        \"dor\": \"3\",\r\n        \"phr\": \"1\",\r\n        \"lyd\": \"6\",\r\n        \"loc\": \"0\"\r\n    },\r\n    \"B#\": {\r\n        \"maj\": \"NOPE\",\r\n        \"min\": \"NOPE\",\r\n        \"mix\": \"NOPE\",\r\n        \"dor\": \"NOPE\",\r\n        \"phr\": \"NOPE\",\r\n        \"lyd\": \"NOPE\",\r\n        \"loc\": \"7\"\r\n    },\r\n    \"Cb\": {\r\n        \"maj\": \"-7\",\r\n        \"min\": \"NOPE\",\r\n        \"mix\": \"NOPE\",\r\n        \"dor\": \"NOPE\",\r\n        \"phr\": \"NOPE\",\r\n        \"lyd\": \"-6\",\r\n        \"loc\": \"NOPE\"\r\n    }\r\n};\r\n\r\nvar majorMode = {\r\n    \"-7\": \"Cb\",\r\n    \"-6\": \"Gb\",\r\n    \"-5\": \"Db\",\r\n    \"-4\": \"Ab\",\r\n    \"-3\": \"Eb\",\r\n    \"-2\": \"Bb\",\r\n    \"-1\": \"F\",\r\n    \"0\": \"C\",\r\n    \"1\": \"G\", \r\n    \"2\": \"D\",\r\n    \"3\": \"A\",\r\n    \"4\": \"E\",\r\n    \"5\": \"B\",\r\n    \"6\": \"F#\",\r\n    \"7\": \"C#\"\r\n};\r\n\r\ndata_tables.normaliseMode = function (mode) { return mode.toLowerCase().substr(0, 3); }\r\n\r\ndata_tables.toMajorMode = function (note, mode) {\r\n    var norm = data_tables.normaliseMode(mode);\r\n    var middle = data_tables.mode_map[norm];\r\n    var key = majorMode[data_tables.keySig[note][middle]];\r\n\r\n    var chords = [];\r\n\r\n    chords.push(zazate.chords.I(key));\r\n    chords.push(zazate.chords.II(key));\r\n    chords.push(zazate.chords.III(key));\r\n    chords.push(zazate.chords.IV(key));\r\n    chords.push(zazate.chords.V(key));\r\n    chords.push(zazate.chords.VI(key));\r\n    chords.push(zazate.chords.VII(key));\r\n\r\n    var indexOfRootNote = _.findIndex(chords, function (c) { return c[0] === note; });\r\n\r\n    while(indexOfRootNote > 0) {\r\n        indexOfRootNote--;\r\n        chords.push(chords.shift());\r\n    }\r\n\r\n    return chords.map(function (c) { return zazate.chords.determine(c, true)[0]; });\r\n};\r\n\r\ndata_tables.gkm = data_tables.getKeyModifiers = function (key) {\r\n    var norm = data_tables.normaliseMode(key.mode);\r\n    var middle = data_tables.mode_map[norm];\r\n    var meh = parseInt(data_tables.keySig[key.note][middle]);\r\n\r\n    console.log(meh);\r\n\r\n    if(meh > 0) {\r\n        var range = _.range(-1, meh-1);\r\n        return {\r\n            mod: 1,\r\n            notes: range.map(function (r) { return majorMode[r]; })\r\n        };\r\n    }\r\n\r\n    if(meh < 0) {\r\n        var range = _.range(5, meh+5, -1);\r\n        return {\r\n            mod: -1,\r\n            notes: range.map(function (r) { return majorMode[r]; })\r\n        }\r\n    }\r\n\r\n    return {\r\n        mod: 0,\r\n        notes: []\r\n    };\r\n};\r\n\r\n\r\ndata_tables.getKeySig = function (note, mode) {\r\n    var \r\n        normalisedMode = data_tables.mode_map[data_tables.normaliseMode(mode)];\r\n\r\n    return parseInt(data_tables.keySig[note][normalisedMode]);\r\n};\r\n\r\ndata_tables.flats = [6, 9, 5, 8, 4, 7, 3];\r\ndata_tables.sharps = [10, 7, 11, 8, 5, 9, 6];\r\n\r\n//not all note lengths can be represented with a single note\r\ndata_tables.allowed_note_lengths = [1, 2, 3, 4, 6, 7, 8, 12, 14, 16, 24, 28];\r\n\r\nmodule.exports = data_tables;"," var\r\n     enums = require('./types'),\r\n     JsDiff = require('diff'),\r\n     LineCollection = require('./types/LineCollection').LineCollection;\r\n\r\n\r\nvar Diff = function(change) {\r\n    console.log(change.newValue);\r\n\r\n     var diff = JsDiff.diffLines(change.oldValue, change.newValue);\r\n\r\n     //ensure deletions are before additions in changes\r\n     for (var i = 0; i < diff.length; i++) {\r\n\r\n         if (diff[i].added && diff[i + 1] && diff[i + 1].removed) {\r\n             var swap = diff[i];\r\n             diff[i] = diff[i + 1];\r\n             diff[i + 1] = swap;\r\n         }\r\n     }\r\n\r\n     var lineCount = 0;\r\n     var output = [];\r\n\r\n     for (var i = 0; i < diff.length; i++) {\r\n         var item = diff[i],\r\n             newlines = 0,\r\n             split = [];\r\n\r\n         split = item.value.split(/\\r\\n|\\r|\\n/);\r\n\r\n         if (split[split.length - 1] === '') {\r\n             split = split.slice(0, split.length - 1);\r\n         }\r\n\r\n         newlines = split.length;\r\n\r\n         item.lineno = lineCount;\r\n\r\n         var newLineCollection = new LineCollection(item.lineno, item.value,\r\n            item.added ? 'ADD' : item.removed ? 'DEL' : 'NONE');\r\n\r\n         if (!item.removed) {\r\n             lineCount += newlines;\r\n         }\r\n\r\n         if(newLineCollection.action != 'NONE')output.push(newLineCollection);\r\n     }\r\n\r\n     return output;\r\n };\r\n\r\nmodule.exports = Diff;\r\n","'use strict';\r\n\r\nvar _ = require('lodash');\r\n\r\nvar subscribers = new Map(),\r\n    afterSubscribers = new Map();\r\n\r\nvar disconnectId = 0;\r\n\r\nfunction send(eventName, data) {\r\n\r\n    if (!subscribers.has(eventName)) {\r\n    \t//console.log(\"No subscribers for \" + eventName, data);\r\n    }\r\n\r\n    _(subscribers.get(eventName)).forEach(function(sub) {\r\n        sub.f(data);\r\n    });\r\n\r\n    _(afterSubscribers.get(eventName)).forEach(function(sub) {\r\n        sub.f(data);\r\n    });\r\n}\r\n\r\nfunction subscribeEvent(subList, eventName, func) {\r\n\r\n    var connection = {\r\n        id: disconnectId,\r\n        f: func\r\n    };\r\n\r\n    disconnectId++;\r\n\r\n    if (subList.has(eventName)) {\r\n        subList.get(eventName).push(connection)\r\n    } else {\r\n        subList.set(eventName, [connection]);\r\n    }\r\n\r\n    return disconnectId - 1;\r\n}\r\n\r\nfunction on(eventName, func) {\r\n    if(_.isObject(eventName) && func === undefined) {\r\n        for(var propt in eventName){\r\n            subscribeEvent(subscribers, propt, eventName[propt]);\r\n        }\r\n    } else {\r\n        return subscribeEvent(subscribers, eventName, func);\r\n    }    \r\n}\r\n\r\nfunction off(id) {\r\n\r\n    subscribers.forEach(function(value, key) {\r\n      var toRemove = _.findIndex(value, function (v) { return v.id === id });\r\n        if(toRemove !== -1) {\r\n            value.splice(toRemove, 1);\r\n        }\r\n    });\r\n}\r\n\r\nfunction after(eventName, func) {\r\n    if(_.isObject(eventName) && func === undefined) {\r\n        for(var propt in eventName){\r\n            subscribeEvent(afterSubscribers, propt, eventName[propt]);\r\n        }\r\n    } else {\r\n        subscribeEvent(afterSubscribers, eventName, func);\r\n    }    \r\n}\r\n\r\nmodule.exports = {\r\n    on: on,\r\n    off: off,\r\n    send: send,\r\n    after: after\r\n};","'use strict';\r\n\r\nmodule.exports = {\r\n\tparser: require('./parser'),\r\n\tdiff: require('./diff'),\r\n\trender: require('./render'),\r\n\tlayout: require('./layout'),\r\n\t\r\n\r\n\t//dispatcher: require('./dispatcher'),\r\n\t//audio: require('./audio/audio'),\r\n\t//audioRender: require('./audio_render')\r\n};","var \r\nenums = require('./types'),\r\ndata_tables = require('./data_tables'),\r\n_ = require('lodash'),\r\ndispatcher = require('./dispatcher'),\r\nAbcBeam = require('./types/AbcBeam'),\r\nsprings = require('./springs');\r\n\r\nvar ABCLayout = function (dispatcher) {\r\n\r\n    var parsedLines = [];\r\n    var tuneSettings = {\r\n        key: {\r\n            note: \"C\",\r\n            mode: \"Major\"\r\n        },\r\n        measure: {\r\n            top: 4,\r\n            bottom: 4\r\n        },\r\n        title: \"Untitled Tune\"\r\n    };\r\n\r\n    var layoutDrawableLine = function(line) {\r\n\r\n        if(line.symbols.length === 0)return line;\r\n\r\n        var\r\n        posMod = 1 / (line.weight + 1),\r\n        totalOffset = 0,\r\n        beamList = [],\r\n        beamDepth = 0,\r\n        lastNote = null;\r\n\r\n        var totalFixedWidth = 0,\r\n            totalSpringConstant = 0;\r\n\r\n        if(_.last(line.symbols).type === \"barline\") {\r\n            posMod = 1 / (line.weight);\r\n        }\r\n\r\n        for (var i = 0; i < line.symbols.length; i++) {\r\n\r\n            if(line.symbols[i].type === \"tie\" || line.symbols[i].type === \"varient-section\" || line.symbols[i].type == \"slur\") continue;\r\n\r\n            var currentSymbol = line.symbols[i];\r\n\r\n            //////////////////////////NEW//////////////////////////\r\n\r\n            if(springs[currentSymbol.type] !== undefined) {\r\n                if(currentSymbol.subType !== undefined) {\r\n                    if(springs[currentSymbol.type][currentSymbol.subType] !== undefined) {\r\n                        totalFixedWidth += (currentSymbol.fixedWidth = springs[currentSymbol.type][currentSymbol.subType]);\r\n                    }\r\n                } else {\r\n                    totalFixedWidth += (currentSymbol.fixedWidth = springs[currentSymbol.type]);\r\n                }                \r\n            }\r\n\r\n            if(!(i === line.symbols.length - 1 && line.symbols[i].type === \"barline\")) {\r\n                if (_.isFunction(data_tables.symbol_width[currentSymbol.type])) {\r\n                    totalSpringConstant += (currentSymbol.springConstant = data_tables.symbol_width[currentSymbol.type](currentSymbol));\r\n                } else {\r\n                    totalSpringConstant += (currentSymbol.springConstant = data_tables.symbol_width[currentSymbol.type]);\r\n                }\r\n            }\r\n\r\n            ///////////////////////////////////////////////////////\r\n\r\n            currentSymbol.xp = totalOffset;\r\n            if(i === line.symbols.length - 1 && currentSymbol.type === \"barline\") {\r\n                currentSymbol.xp = 1;\r\n                currentSymbol.align = 2;\r\n            }     \r\n\r\n            if (_.isFunction(data_tables.symbol_width[currentSymbol.type])) {\r\n                totalOffset += (data_tables.symbol_width[currentSymbol.type](currentSymbol)) * posMod;\r\n            } else {\r\n                totalOffset += (data_tables.symbol_width[currentSymbol.type] * posMod);\r\n            }\r\n\r\n            if (currentSymbol.type === \"note\") {\r\n                currentSymbol.truepos = currentSymbol.pos + (7 * (currentSymbol.octave - 4));\r\n                currentSymbol.y = 40 - (currentSymbol.truepos * 4);\r\n                currentSymbol.beams = [];\r\n            }\r\n\r\n            if (currentSymbol.beamDepth !== undefined && currentSymbol.beamDepth < 0) {\r\n               if(currentSymbol.type === \"note\")beamList.push(currentSymbol);\r\n               beamDepth = currentSymbol.beamDepth;\r\n           } else {\r\n                //draw beam\r\n                //if(currentSymbol.type === \"note\")beamList.push(currentSymbol);\r\n                if (beamList.length > 1) lastNote.beams.push(new AbcBeam(beamList));\r\n                beamList = [];\r\n                beamDepth = 0;\r\n            }\r\n\r\n            if(currentSymbol.type === \"note\") lastNote = currentSymbol;\r\n        }\r\n\r\n        if (beamList.length > 0) {\r\n            //draw beam\r\n            if (beamList.length > 1) lastNote.beams.push(new AbcBeam(beamList));\r\n            beamList = [];\r\n            beamDepth = 0;\r\n        }\r\n\r\n        line.totalFixedWidth = totalFixedWidth;\r\n        line.totalSpringConstant = totalSpringConstant;\r\n\r\n        return line;\r\n    }\r\n\r\n    var handleDataLineSwitch = {\r\n        title(data) {\r\n            tuneSettings.title = data;\r\n            dispatcher.fire(\"change_tune_title\", data);\r\n        },\r\n\r\n        rhythm(data) {\r\n            tuneSettings.rhythm = data;\r\n            dispatcher.fire(\"change_rhythm\", data);\r\n        },\r\n\r\n        key(data) {\r\n            tuneSettings.key = data;\r\n            dispatcher.fire(\"change_key\", data);\r\n        },\r\n\r\n        timesig(data) {\r\n            tuneSettings.measure = data;\r\n            dispatcher.fire(\"change_timesig\", data);\r\n        },\r\n\r\n        notelength(data) {\r\n            tuneSettings.noteLength = data;\r\n            dispatcher.fire(\"change_notelength\", data);\r\n        },\r\n\r\n        number(data) {\r\n            tuneSettings.number = data;\r\n        },\r\n\r\n        transcriber(data) {\r\n            tuneSettings.transcriber = data;\r\n        },\r\n\r\n        source(data) {\r\n            tuneSettings.source = data;\r\n        },\r\n    };\r\n\r\n    function handleDataLine(line) {\r\n        handleDataLineSwitch[line.symbols[0].type](line.symbols[0].data);   \r\n        return line;    \r\n    }\r\n\r\n    var handleAction = {\r\n        ADD ( lineCollection ) {\r\n\r\n\r\n            var layoutedLines = lineCollection.lines.map(function(line) {\r\n                if(line.type === \"drawable\") return layoutDrawableLine(line);\r\n                if(line.type === \"data\") return handleDataLine(line);\r\n                return line;\r\n            });\r\n\r\n            if (layoutedLines.length > 0) {\r\n                var args = [layoutedLines[0].id, 0].concat(layoutedLines);\r\n                Array.prototype.splice.apply(parsedLines, args);\r\n            }\r\n\r\n        },\r\n\r\n        \r\n        DEL ( lineCollection ) {\r\n\r\n            if (lineCollection.lines.length > 0) {\r\n                var removed_lines = parsedLines.splice(lineCollection.lines[0].id, lineCollection.lines.length);\r\n\r\n                for (var i = lineCollection.lines[0].id; i < parsedLines.length; i++) {\r\n                    parsedLines[i].id -= lineCollection.lines.length;\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    return function(oldScoreLines, lineCollection) {\r\n\r\n        handleAction[lineCollection.action](lineCollection);\r\n\r\n        return  {\r\n            tuneSettings: tuneSettings,\r\n            parsedLines: parsedLines\r\n        };\r\n\r\n    }\r\n}\r\n\r\nmodule.exports = ABCLayout;","'use strict';\r\n\r\nvar\r\n    _ = require('lodash'),\r\n    Lexer = require('lex'),\r\n    dispatcher = require('./dispatcher');\r\n\r\n//////////////////////\r\n// HELPER FUNCTIONS //\r\n//////////////////////\r\nvar simpleType = function(name) {\r\n    return function() {\r\n        return {\r\n            type: name\r\n        };\r\n    }\r\n}\r\n\r\nvar charCountInString = function(string, character) {\r\n    return string.split(character).length - 1;\r\n}\r\n\r\nvar addSimpleStringInformationField = function(spec, key, type) {\r\n    spec.start[key + \": *([^\\n]*)\\n?\"] = function(data) {\r\n        return {\r\n            type_class: \"data\",\r\n            type: type,\r\n            data: data\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\nfunction LexerException(message, line, char) {\r\n    this.message = message;\r\n    this.line = line;\r\n    this.char = char;\r\n    this.name = \"LexerException\";\r\n}  \r\n\r\n\r\n////////////////////////////////\r\n//            LEXER           //\r\n////////////////////////////////\r\n\r\nvar lexer = new Lexer(function (char) {\r\n    throw new LexerException(`Unexpected '${char}'`, 0, this.index);\r\n});\r\n\r\n///////////\r\n// NOTES //\r\n///////////\r\nlexer.addRule(/([A-Ga-g])/, function(note) {\r\n    return {\r\n        type: \"note\",\r\n        subType: \"letter\",\r\n        data: note\r\n    }\r\n});\r\n\r\n///////////\r\n// RESTS //\r\n///////////\r\nlexer.addRule(/z/, function() {\r\n    return {\r\n        type: \"rest\",\r\n        subType: \"visible\",\r\n        data: \"short\"\r\n    }\r\n}).addRule(/x/, function() {\r\n    return {\r\n        type: \"rest\",\r\n        subType: \"invisible\",\r\n        data: \"short\"\r\n    }\r\n}).addRule(/Z/, function() {\r\n    return {\r\n        type: \"rest\",\r\n        subType: \"visible\",\r\n        data: \"long\"\r\n    }\r\n}).addRule(/X/, function() {\r\n    return {\r\n        type: \"rest\",\r\n        subType: \"invisible\",\r\n        data: \"long\"\r\n    }\r\n});\r\n\r\n///////////////////////////////\r\n// NOTE AND REST DECORATIONS //\r\n///////////////////////////////\r\nlexer.addRule(/([0-9]+)\\/?([0-9]+)?/, function(all, notelength, notedenom) {\r\n    return {\r\n        type: \"note\",\r\n        subType: \"length\",\r\n        data: (notedenom && notedenom.length > 0) ? parseFloat(notelength) / parseFloat(notedenom) : parseInt(notelength),\r\n    }\r\n}).addRule(/\\/([0-9]+)/, function(all, notedenom) {\r\n    return {\r\n        type: \"note\",\r\n        subType: \"length\",\r\n        data: 1 / parseFloat(notedenom),\r\n    }\r\n}).addRule(/\\/+/, function(all) {\r\n    return {\r\n        type: \"note\",\r\n        subType: \"length\",\r\n        data: 1/all.length,\r\n    }\r\n}).addRule(/([',]+)/, function(pitchModifier) {\r\n    return {\r\n        type: \"note\",\r\n        subType: \"pitch\",\r\n        data: charCountInString(pitchModifier, \"'\") - charCountInString(pitchModifier, \",\")\r\n    }\r\n}).addRule(/(_|\\^|=|__|\\^\\^)/, function(accidental) {\r\n    return {\r\n        type: \"note\",\r\n        subType: \"accidental\",\r\n        data: accidental\r\n    }\r\n}).addRule(/\"([^\"]+)\"/, function(match, data) {\r\n    return {\r\n        type: \"note\",\r\n        subType: \"chord_annotation\",\r\n        data: data\r\n    }\r\n}).addRule(/!([^!]+)!/, function(data) {\r\n    return {\r\n        type: \"note\",\r\n        subType: \"decoration\",\r\n        data: data\r\n    }\r\n}).addRule(/~/, function(data) {\r\n    return {\r\n        type: \"note\",\r\n        subType: \"decoration\",\r\n        data: data\r\n    }\r\n}).addRule(/>{1,3}/, function(data) {\r\n    return {\r\n        type: \"broken-rhythm\",\r\n        subType: \"right\",\r\n        data: data.length\r\n    }\r\n}).addRule(/<{1,3}/, function(data) {\r\n    return {\r\n        type: \"broken-rhythm\",\r\n        subType: \"left\",\r\n        data: data.length\r\n    }\r\n});\r\n\r\n///////////////\r\n// BAR LINES //\r\n///////////////\r\n///\r\n/// v indicates how the type of barline effects varient endings\r\n/// #0 -> No effect\r\n/// #1 -> Ends a varient ending\r\n/// #2 -> Starts a varient ending\r\n///\r\nlexer.addRule(/\\|/, function() {\r\n    return {\r\n        type: \"barline\",\r\n        subtype: \"normal\",\r\n        v: 0\r\n    }\r\n}).addRule(/\\|\\]/, function() {\r\n    return {\r\n        type: \"barline\",\r\n        subtype: \"heavy_end\",\r\n        v: 1\r\n    }\r\n}).addRule(/\\|\\|/, function() {\r\n    return {\r\n        type: \"barline\",\r\n        subtype: \"double\",\r\n        v: 1\r\n    }\r\n}).addRule(/\\[\\|/, function() {\r\n    return {\r\n        type: \"barline\",\r\n        subtype: \"heavy_start\",\r\n        v: 1\r\n    }\r\n}).addRule(/:\\|/, function() {\r\n    return {\r\n        type: \"barline\",\r\n        subtype: \"repeat_end\",\r\n        v: 1\r\n    }\r\n}).addRule(/\\|:/, function() {\r\n    return {\r\n        type: \"barline\",\r\n        subtype: \"repeat_start\",\r\n        v: 0\r\n    }\r\n}).addRule(/::/, function() {\r\n    return {\r\n        type: \"barline\",\r\n        subtype: \"double_repeat\",\r\n        v: 1\r\n    }\r\n}).addRule(/\\[([0-9]+)/, function (all, sectionNumber) {\r\n    return {\r\n        type: \"varient_section\",\r\n        subtype: \"start_section\",\r\n        data: sectionNumber,\r\n        v: 2\r\n    };\r\n}).addRule(/\\[\"([a-z A-Z0-9]+)\"/, function (all, sectionName) {\r\n    return {\r\n        type: \"varient_section\",\r\n        subtype: \"start_section\",\r\n        data: sectionName,\r\n        v: 2\r\n    };\r\n}).addRule(/\\|([0-9]+)/, function (all, sectionNumber) {\r\n    return {\r\n        type: \"varient_section\",\r\n        subtype: \"start_section\",\r\n        data: sectionNumber,\r\n        v: 2\r\n    };\r\n});\r\n\r\n/////////////////\r\n// NOTE GROUPS //\r\n/////////////////\r\nlexer.addRule(/\\[/, function() {\r\n    return {\r\n        type: \"chord_start\"\r\n    }\r\n}).addRule(/\\]/, function() {\r\n    return {\r\n        type: \"chord_stop\"\r\n    }\r\n\r\n}).addRule(/{/, function() {\r\n    return {\r\n        type: \"grace_start\"\r\n    }\r\n}).addRule(/}/, function() {\r\n    return {\r\n        type: \"grace_stop\"\r\n    }\r\n}).addRule(/\\(([2-9])/, function(all, size) {\r\n    return {\r\n        type: \"tuplet_start\",\r\n        data: parseInt(size)\r\n    }\r\n}).addRule(/\\(/, function() {\r\n    return {\r\n        type: \"slur_start\"\r\n    }\r\n}).addRule(/\\)/, function() {\r\n    return {\r\n        type: \"slur_stop\"\r\n    }\r\n}).addRule(/-/, function () {\r\n    return {\r\n        type: \"tie\"\r\n    }\r\n});\r\n\r\n//////////////////\r\n// DATA FIELDS  //\r\n//////////////////\r\n\r\nlexer.addRule(/T: *([\\w ',?]+)\\s*$/, function(match, title) {\r\n    return {\r\n        type: \"data\",\r\n        subtype: \"title\",\r\n        data: title\r\n    }\r\n});\r\n\r\nlexer.addRule(/X: *([0-9]+)\\s*$/, function(match, num) {\r\n    return {\r\n        type: \"data\",\r\n        subtype: \"number\",\r\n        data: num\r\n    }\r\n});\r\n\r\nlexer.addRule(/R: *([\\w ]+)\\s*$/, function(match, rhythm) {\r\n    return {\r\n        type: \"data\",\r\n        subtype: \"rhythm\",\r\n        data: rhythm\r\n    }\r\n});\r\n\r\nlexer.addRule(/S: *([\\w \\/:\\.#]+)\\s*$/, function(match, source) {\r\n    return {\r\n        type: \"data\",\r\n        subtype: \"source\",\r\n        data: source\r\n    }\r\n});\r\n\r\nlexer.addRule(/Z: *([\\w \\/:\\.#]+)\\s*$/, function(match, source) {\r\n    return {\r\n        type: \"data\",\r\n        subtype: \"transcriber\",\r\n        data: source\r\n    }\r\n});\r\n\r\nlexer.addRule(/M: *([0-9]+)\\/([0-9]+)\\s*$/, function(match, top, bottom) {\r\n    return {\r\n        type: \"data\",\r\n        subtype: \"timesig\",\r\n        data: {\r\n            top: top,\r\n            bottom: bottom\r\n        }\r\n    }\r\n});\r\n\r\nlexer.addRule(/L: *([0-9]+)\\/([0-9])\\s*$/, function(match, top, bottom) {\r\n    return {\r\n        type: \"data\",\r\n        subtype: \"notelength\",\r\n        data: parseInt(top) / parseInt(bottom)\r\n    }\r\n});\r\n\r\nlexer.addRule(/K: *([A-G][#|b]?) ?([\\w]*)\\s*$/, function(match, note, mode) {\r\n    return {\r\n        type: \"data\",\r\n        subtype: \"key\",\r\n        data: {\r\n            note: note,\r\n            mode: mode\r\n        }\r\n    }\r\n});\r\n\r\n///////////\r\n// OTHER //\r\n///////////\r\nlexer.addRule(/ /, function() {\r\n    return {\r\n        type: \"space\"\r\n    }\r\n}).addRule(/`/, function() {\r\n    return {\r\n        type: \"beam\"\r\n    }\r\n});\r\n\r\n\r\nmodule.exports = function(dispatcher, input, lineId) {\r\n    lexer.setInput(input);\r\n    var output = [];\r\n\r\n    do {  \r\n        var data = undefined;\r\n        try {\r\n            data = lexer.lex();\r\n            if(data !== undefined)output.push(data);\r\n        } catch(e) {\r\n            \r\n            var error = {\r\n                line: lineId,\r\n                message: e.message,\r\n                severity: 1,\r\n                char: e.char,\r\n                type: \"LEXERERROR\"\r\n            };\r\n\r\n            console.log(error);\r\n\r\n            dispatcher.fire(\"abc_error\", error);\r\n\r\n            break;\r\n        }           \r\n    } while(data != undefined);\r\n\r\n    return output;\r\n}","'use strict';\r\n\r\nvar\r\n    lexer = require('./lexer.js'),\r\n    data_tables = require('./data_tables.js'),\r\n    _ = require('lodash'),\r\n    enums = require('./types'),\r\n    dispatcher = require('./dispatcher'),\r\n\r\n    AbcNote = require(\"./types/AbcSymbol\").AbcNote,\r\n    AbcRest = require(\"./types/AbcSymbol\").AbcRest,\r\n    AbcSymbol = require(\"./types/AbcSymbol\").AbcSymbol,\r\n    AbcChord = require(\"./types/AbcChord\").AbcChord;\r\n\r\nfunction ParserException(message) {\r\n    this.message = message;\r\n    this.name = \"ParserException\";\r\n}    \r\n\r\nvar ABCParser = function(dispatcher, transposeAmount) {\r\n\r\n    //the typecache is to get the type of deleted rows without having to reparse\r\n    var typecache = [];\r\n    // var dicache = [];\r\n\r\n    var drawableIndex = 0;\r\n    var maxStartId = 0;\r\n\r\n    var noteLengthModifier = 0.125;\r\n\r\n    dispatcher.on(\"change_notelength\", function(data) {\r\n        noteLengthModifier = data;\r\n    });\r\n\r\n    var transpose = transposeAmount || 0;\r\n\r\n    //parse a note\r\n    function parseNote(lexer, parsed) {\r\n\r\n        var newNote = new AbcNote();\r\n\r\n        while (lexer[0] && lexer[0].subType === \"chord_annotation\") {\r\n            newNote.chord = new AbcChord(lexer[0].data);\r\n            lexer.shift();\r\n        }\r\n\r\n        while (lexer[0] && lexer[0].subType === \"decoration\") {\r\n            newNote.decorations.push(lexer[0]);\r\n            lexer.shift();\r\n        }\r\n\r\n        if (lexer[0].subType == \"accidental\") {\r\n            newNote.accidental = lexer.shift().data;\r\n        }\r\n\r\n        if (!lexer[0] || lexer[0].subType !== \"letter\") {\r\n            lexer.shift();\r\n            return new ParserException(\"Missing note name\");\r\n        }\r\n\r\n        if (lexer[0] && lexer[0].subType == \"letter\") {\r\n            newNote.note = lexer.shift().data;\r\n\r\n            newNote.pitch = data_tables.notes[newNote.note].pitch + transpose;\r\n            newNote.octave = data_tables.notes[newNote.note].octave;\r\n            newNote.pos = data_tables.notes[newNote.note].pos + transpose;\r\n\r\n        }\r\n\r\n        if (lexer[0] && lexer[0].subType == \"pitch\") {\r\n            newNote.octave += lexer.shift().data;\r\n        }\r\n\r\n        if (lexer[0] && lexer[0].subType == \"length\") {\r\n            newNote.noteLength = lexer.shift().data * (noteLengthModifier / 0.125);\r\n        }\r\n\r\n        newNote.beamDepth = Math.floor(Math.log2(newNote.noteLength)) - 1;\r\n        newNote.weight = data_tables.symbol_width.note(newNote);\r\n\r\n        if(parsed === undefined || newNote.weight === undefined) {\r\n            console.log(\"DAMN\");\r\n        }\r\n\r\n        parsed.weight += newNote.weight;\r\n        parsed.symbols.push(newNote);\r\n\r\n        return newNote;\r\n    }\r\n\r\n    //parse a rest\r\n    function parseRest(lexer) {\r\n        var newRest = new AbcRest();\r\n\r\n        newRest.visible = lexer[0].subType === \"visible\";\r\n        newRest.subType = lexer[0].data === \"short\" ? \"beat_rest\" : \"bar_rest\";\r\n\r\n        lexer.shift();\r\n\r\n        if (lexer[0] && lexer[0].subType == \"length\") {\r\n            newRest.restLength = lexer.shift().data;\r\n        }\r\n\r\n        return newRest;\r\n    }\r\n\r\n    /**\r\n     * Parses a group of notes\r\n     * @param  {Array} The output array for the entire parse process\r\n     * @param  {Array} The input array of lexed tokens\r\n     * @param  {String} The name of the type of note group\r\n     * @param  {String} The type of token that starts the note group\r\n     * @param  {String} The type of token that ends the note group\r\n     * @return {Boolean} Returns TRUE if the specified note group was found\r\n     */\r\n    function noteGroup(parsed, lexed, name, start, stop) {\r\n        if (lexed[0].type === start) {\r\n            lexed.shift();\r\n\r\n            var groupNotes = [];\r\n\r\n            while (lexed.length > 0 && lexed[0].type != stop) {\r\n                if (lexed[0].type === \"note\") {\r\n                    groupNotes.push(parseNote(lexed));\r\n                    continue;\r\n                } else {\r\n                    /*throw new*/\r\n                    groupNotes.push(new ParserException(\"Only notes are allowed in \" + name + \"s\"));\r\n                    lexed.shift();\r\n                    continue;\r\n                }\r\n            }\r\n\r\n            parsed.push({\r\n                type: name,\r\n                type_class: \"drawable\",\r\n                notes: groupNotes\r\n            });\r\n\r\n            lexed.shift();\r\n            return true;\r\n        }\r\n\r\n        if (lexed[0].type === stop) {\r\n            parsed.push(new ParserException(\"Closing \" + name + \" found before starting it\"));\r\n            lexed.shift();\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    function parseSlur(parsed, lexed) {\r\n        if (lexed[0].type === \"slur_start\") {\r\n            lexed.shift();\r\n\r\n            var groupNotes = [];\r\n\r\n            while (lexed.length > 0 && lexed[0].type != \"slur_stop\") {\r\n                if (lexed[0].type === \"note\") {\r\n                    var parsedNote = parseNote(lexed, parsed);\r\n                    groupNotes.push(parsedNote);\r\n                     continue;\r\n                } else {\r\n                    /*throw new*/\r\n                    groupNotes.push(new ParserException(\"Only notes are allowed in slurs\"));\r\n                    lexed.shift();\r\n                    continue;\r\n                }\r\n            }\r\n\r\n            parsed.symbols.push({\r\n                type: \"slur\",\r\n                type_class: \"drawable\",\r\n                notes: groupNotes\r\n            });\r\n\r\n            lexed.shift();\r\n            return true;\r\n        }\r\n\r\n        if (lexed[0].type === \"slur_stop\") {\r\n            parsed.push(new ParserException(\"Closing slur found before starting it\"));\r\n            lexed.shift();\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    var parseBarline = function (lexed, parsed) {\r\n\r\n        var symbol = lexed.shift();\r\n\r\n        var newBarline = new AbcSymbol('barline', 1);\r\n        newBarline.subType = symbol.subtype;\r\n\r\n        parsed.symbols.push(newBarline);\r\n        parsed.weight += data_tables.symbol_width[\"barline\"];\r\n\r\n        return symbol.v;\r\n    };\r\n\r\n    /**\r\n     * A recursive decent parser that combines lexed tokens into a meaningful data structure\r\n     * @param  {Array} An array of lexed tokens\r\n     * @return {Array} An array of parsed symbols\r\n     */\r\n    function parse(lexed, line) {\r\n\r\n        var parsed = {\r\n            symbols: [],\r\n            weight: 0\r\n        };\r\n\r\n        var \r\n            currentVarientEnding = null,\r\n            tupletBuffer = [],\r\n            tupletCount = 0,\r\n            tupletValue = 0;\r\n\r\n        while (lexed.length > 0) {\r\n\r\n            if (lexed[0].type === \"data\") {\r\n                var lexedToken = lexed.shift();\r\n                parsed.symbols.push({\r\n                    type_class: \"data\",\r\n                    type: lexedToken.subtype,\r\n                    data: lexedToken.data\r\n                });\r\n\r\n                continue;\r\n            }\r\n\r\n            if (lexed[0].type === \"beam\") {\r\n                lexed.shift();\r\n                continue;\r\n            }\r\n\r\n            // if (lexed[0].type === \"chord_annotation\") {\r\n            //     parsed.symbols.push({\r\n            //         type_class: \"drawable\",\r\n            //         type: \"chord_annotation\",\r\n            //         text: lexed[0].data\r\n            //     });\r\n            //     lexed.shift();\r\n            //     continue;\r\n            // }\r\n            if (lexed[0].type === \"tuplet_start\") {\r\n                tupletCount = lexed[0].data;\r\n                tupletValue = lexed[0].data;\r\n                lexed.shift();\r\n                continue;\r\n            }\r\n\r\n            if (lexed[0].type === \"note\") {\r\n                parseNote(lexed, parsed);\r\n\r\n                if(currentVarientEnding !== null && currentVarientEnding.start === null) {\r\n                    currentVarientEnding.start = _.last(parsed.symbols);\r\n                }\r\n\r\n                if(tupletCount > 0) {\r\n                    tupletBuffer.push(_.last(parsed.symbols));\r\n                    tupletCount--;\r\n\r\n                    if(tupletCount === 0) {\r\n\r\n                        tupletBuffer.forEach(function(note) {\r\n                            note.noteLength = (note.noteLength / tupletValue) * 2;\r\n                            //note.weight = data_tables.symbol_width.note(note);\r\n                        });\r\n\r\n                        line.tuplets.push({\r\n                            notes: tupletBuffer,\r\n                            value: tupletValue\r\n                        });\r\n                        tupletBuffer = [];\r\n                    }\r\n                }\r\n\r\n                continue;\r\n            }\r\n\r\n            if (lexed[0].type === \"rest\") {\r\n                parsed.symbols.push(parseRest(lexed));\r\n                parsed.weight += 1;\r\n                continue;\r\n            }\r\n\r\n            if (lexed[0].type === \"space\") {\r\n                parsed.symbols.push(new AbcSymbol(\"space\", 0));\r\n                lexed.shift();\r\n                continue;\r\n            }\r\n\r\n            if(lexed[0].type === \"varient_section\") {\r\n                var symbol = lexed.shift();\r\n\r\n                currentVarientEnding = {\r\n                    start: null,\r\n                    name: symbol.data,\r\n                    end: null\r\n                };\r\n\r\n                continue;\r\n            }\r\n\r\n            if (noteGroup(parsed, lexed, \"chord\", \"chord_start\", \"chord_stop\")) continue;\r\n            if (parseSlur(parsed, lexed)) continue;\r\n            if (noteGroup(parsed, lexed, \"grace\", \"grace_start\", \"grace_stop\")) continue;\r\n\r\n            if (lexed[0].type === \"barline\") {\r\n\r\n                if(parseBarline(lexed, parsed) === 1) {\r\n\r\n                    if(line.firstEndingEnder === null) line.firstEndingEnder = _.last(parsed.symbols);\r\n\r\n                    if(currentVarientEnding !== null) {\r\n                        currentVarientEnding.end = _.last(parsed.symbols);\r\n                        line.endings.push(currentVarientEnding);\r\n                        currentVarientEnding = null;\r\n                    }\r\n                }\r\n\r\n                \r\n                continue;\r\n            }\r\n\r\n            if(lexed[0].type === \"tie\") {\r\n\r\n                lexed.shift();\r\n\r\n                //the last parsed symbol must be a note\r\n                if(_.last(parsed.symbols).type === \"note\") {\r\n                    \r\n                    var tie = {\r\n                        type: \"tie\",\r\n                        start: _.last(parsed.symbols)\r\n                    };\r\n\r\n                    //eat the barline if required\r\n                    if (lexed[0].type === \"barline\")parseBarline(lexed, parsed);\r\n\r\n                    if (lexed[0].type === \"note\") {\r\n                        parseNote(lexed, parsed);\r\n                    } else {\r\n                        //THROW ERROR\r\n                        continue;\r\n                    }\r\n\r\n                    tie.end = _.last(parsed.symbols);\r\n\r\n                    parsed.symbols.push(tie);\r\n                } else {\r\n                    //THROW ERROR\r\n                    continue;\r\n                }\r\n\r\n                continue;\r\n            }\r\n\r\n            console.log(`PARSER ERROR: UNKNOWN ${lexed[0]}`);\r\n            lexed.shift();\r\n        }\r\n\r\n        if(currentVarientEnding !== null) {\r\n            line.endings.push(currentVarientEnding);\r\n            line.endWithEndingBar = true;\r\n        }\r\n\r\n        //console.log(\"PARSED\", parsed);\r\n        return parsed;\r\n    }\r\n\r\n    function processAddedLine(line) {\r\n\r\n       // try {\r\n\r\n            //TODO: are these defaults defined in an odd place??\r\n            if (line.raw.length === 0) {\r\n                line.type = \"drawable\";\r\n                // line.di = drawableIndex++;\r\n                line.symbols = [];\r\n                line.weight = 0;\r\n            }\r\n\r\n            var lexed = lexer(dispatcher, line.raw, line.id);\r\n\r\n            if (lexed.length > 0) {\r\n\r\n                var parseOutput = parse(lexed, line);\r\n\r\n                line.symbols = parseOutput.symbols;\r\n                line.weight = parseOutput.weight;\r\n\r\n                if (!(parseOutput.symbols.length === 1 && parseOutput.symbols[0].type_class === \"data\")) {\r\n                    line.type = \"drawable\";\r\n                    // line.di = drawableIndex++;\r\n                } else {\r\n                    line.type = \"data\";\r\n                }\r\n            } else {\r\n                line.type = typecache[line.id-1] === \"drawable\" ? \"drawable\" : \"blank\";\r\n                line.symbols = [];\r\n            }\r\n\r\n        //typecache.set(line.id, line.type);\r\n        typecache.splice(line.id, 0, line.type);\r\n        //dicache.set(line.id, line.di);\r\n        // dicache.splice(line.id, 0, line.di);\r\n\r\n\r\n        // if(line.type === \"drawable\") {\r\n        //     line.di = line.id - (_.findIndex(typecache, function(val) { return val === \"drawable\"; }));\r\n        // }\r\n    }\r\n\r\n    var processDeletedLine = function(line) {\r\n        line.type = typecache[line.id];\r\n        // if (line.type === \"drawable\") {\r\n            // line.di = dicache[line.id];\r\n        // }\r\n\r\n        typecache.splice(line.id, 1);\r\n        // dicache.splice(line.id, 1);\r\n    }\r\n\r\n    return function (lineCollection) {\r\n\r\n        if (lineCollection.startId < maxStartId) {      \r\n            drawableIndex = 0;\r\n            for(var i=0; i<lineCollection.startId; i++) {\r\n                if (typecache[i] === \"drawable\") drawableIndex++;\r\n            }\r\n        } \r\n\r\n        if(lineCollection.startId > maxStartId) {\r\n            for(var i = maxStartId; i<lineCollection.startId; i++) {\r\n                if (typecache[i] === \"drawable\") drawableIndex++;\r\n            }\r\n        }\r\n\r\n        maxStartId = lineCollection.startId + lineCollection.count;\r\n\r\n        if (lineCollection.action === \"ADD\") {\r\n            lineCollection.lines.forEach(processAddedLine);\r\n        }\r\n\r\n        if (lineCollection.action === \"DEL\") {\r\n            _.forEachRight(lineCollection.lines, processDeletedLine);\r\n        }\r\n\r\n        console.log(\"FIRST DRAWABLE IS\", 1 + _.findIndex(typecache, function(val) { return val === \"drawable\"; }), typecache)\r\n\r\n        return lineCollection;\r\n    };\r\n\r\n};\r\n\r\nmodule.exports = ABCParser;","'use strict';\r\n\r\nvar s = require('virtual-dom/virtual-hyperscript/svg'),\r\n    h = require('virtual-dom/h'),\r\n    createElement = require('virtual-dom/create-element'),\r\n    draw = require('./rendering/stave_symbols.js'),\r\n    diff = require('virtual-dom/diff'),\r\n    patch = require('virtual-dom/patch');\r\n\r\nvar ABCRenderer = function () {\r\n\r\n    var\r\n    previousNodeTree = null,\r\n    settings = null,\r\n    nextLineStartsWithEnding = false,\r\n    currentRenderNoteId = 0;\r\n\r\n    var renderLine = function (line, drawnLineIndex, lineIndex) {        \r\n\r\n        var lineGroup = s(`g#line-${lineIndex}`, {\r\n            transform: `translate(100,${32 + drawnLineIndex * 96})`,\r\n            class: \"svgTuneLine\"\r\n        });\r\n\r\n        var leadInGroup = s(\"g\");\r\n        lineGroup.children.push(draw.stave(), leadInGroup);\r\n\r\n        var clef = draw.treble_clef();\r\n        var keySig = draw.keysig(settings.key, clef.width, line.id);\r\n\r\n        if(keySig === false) return;\r\n\r\n        leadInGroup.children.push(clef.node, keySig.node);\r\n\r\n        var leadInWidth = clef.width + keySig.width;\r\n\r\n        if (drawnLineIndex === 0) {\r\n            var timeSig = draw.timesig(settings.measure.top, settings.measure.bottom, clef.width + keySig.width);\r\n            leadInGroup.children.push(timeSig.node);\r\n            leadInWidth += timeSig.width;\r\n        }\r\n\r\n        var symbolsGroup = s(\"g\", { transform: `translate(${leadInWidth},0)`});\r\n        \r\n\r\n        var \r\n        noteAreaWidth = 800 - leadInWidth;\r\n\r\n        /////////////////NEW///////////////////\r\n        var springLength = noteAreaWidth - line.totalFixedWidth;\r\n        console.log(springLength);\r\n        var springMod = springLength / line.totalSpringConstant;\r\n        console.log(springMod); \r\n\r\n\r\n        var xPos = 0;\r\n        //////////////////////////////////////\r\n\r\n        for (let i = 0; i < line.symbols.length; i++) {\r\n            line.symbols[i].renderedXPos = xPos;\r\n            if(line.symbols[i].type === \"note\") {\r\n                line.symbols[i].renderNoteId = currentRenderNoteId++;\r\n            }   \r\n            symbolsGroup.children.push(draw[line.symbols[i].type](line.symbols[i], xPos/*line.symbols[i].xp * noteAreaWidth*/, noteAreaWidth));\r\n            xPos += (line.symbols[i].fixedWidth + springMod * line.symbols[i].springConstant);\r\n        }\r\n\r\n        console.log(xPos, noteAreaWidth);\r\n\r\n        for(let i = 0; i < line.endings.length; i++) {\r\n            symbolsGroup.children.push(draw.varientEndings(line.endings[i], noteAreaWidth, false));\r\n        }\r\n\r\n        for(let i = 0; i < line.tuplets.length; i++) {\r\n            symbolsGroup.children.push(draw.tuplets(line.tuplets[i], noteAreaWidth));\r\n        }\r\n\r\n        if(nextLineStartsWithEnding) {\r\n            symbolsGroup.children.push(draw.varientEndings({\r\n                name: \"\",\r\n                start: {\r\n                    xp: 0\r\n                },\r\n                end: line.firstEndingEnder\r\n            }, noteAreaWidth, true));\r\n        }\r\n\r\n        nextLineStartsWithEnding = line.endWithEndingBar;\r\n\r\n        lineGroup.children.push(symbolsGroup);\r\n\r\n        return lineGroup;\r\n    }\r\n\r\n    return function (tuneData) {\r\n\r\n        settings = tuneData.tuneSettings;\r\n        currentRenderNoteId = 0;\r\n\r\n        var \r\n        doc = s(\"svg#tuneSVGCanvas\", {\r\n            viewBox: \"0 0 1000 800\",\r\n            width: \"100%\",\r\n                //height: \"100%\"\r\n            }),\r\n        nextLineStartsWithEnding = false;\r\n\r\n        var drawnLines = 0;\r\n        tuneData.parsedLines.forEach(function(line, i) {\r\n            if(line.type === \"drawable\") doc.children.push(renderLine(line, drawnLines++, i));            \r\n        });\r\n\r\n        var topDiv = h(\"div.render-div\", [\r\n            h(\"div.tune-header\", [\r\n                h(\"h2\", [settings.title]),\r\n                h(\"p.abc-tune-rhythm\", [settings.rhythm])\r\n                ]),\r\n            h(\"div.tune-body\", [doc])\r\n            ]);\r\n\r\n        if(previousNodeTree === undefined) {\r\n            document.getElementById(\"canvas\").innerHTML = '';\r\n            document.getElementById(\"canvas\").appendChild(createElement(topDiv));\r\n        } else {\r\n            document.getElementById(\"canvas\").innerHTML = '';\r\n            document.getElementById(\"canvas\").appendChild(createElement(topDiv));\r\n            //var patchData = diff(previousNodeTree, topDiv);\r\n            //patch(document.getElementById(\"canvas\").firstChild, patchData);            \r\n        }\r\n\r\n        var svgs = document.getElementById(\"tuneSVGCanvas\");\r\n        var canvasElement = document.getElementById(\"canvas\");\r\n\r\n        var scrollDist = canvasElement.scrollTop;\r\n        svgs.viewBox.baseVal.height = svgs.getBBox().height + 100;\r\n        canvasElement.scrollTop = scrollDist;\r\n\r\n\r\n\r\n        previousNodeTree = topDiv;    \r\n    };\r\n};\r\n\r\n\r\n\r\nmodule.exports = ABCRenderer;","var s = require('virtual-dom/virtual-hyperscript/svg'),\r\n    h = require('virtual-dom/h'),\r\n    createElement = require('virtual-dom/create-element');\r\n\r\nmodule.exports = {\r\n\tselectionBox: function() {\r\n\t\tvar markerRect = s(\"rect\", {\r\n            x: -20,\r\n            y: -4,\r\n            width: 6,\r\n            height: 40,\r\n            fill: 'orange',\r\n            class: 'lineIndicatorRect'\r\n        });\r\n\r\n        return createElement(markerRect);\r\n\t}\r\n};","module.exports = {\r\n    \"0\": {\r\n        \"w\": 10.78,\r\n        \"h\": 14.959,\r\n        \"d\": \"M4.83,-14.97c0.33,-0.03,1.11,0,1.47,0.06c1.68,0.36,2.97,1.59,3.78,3.6c1.2,2.97,0.81,6.96,-0.9,9.27c-0.78,1.08,-1.71,1.71,-2.91,1.95c-0.45,0.09,-1.32,0.09,-1.77,0c-0.81,-0.18,-1.47,-0.51,-2.07,-1.02c-2.34,-2.07,-3.15,-6.72,-1.74,-10.2c0.87,-2.16,2.28,-3.42,4.14,-3.66zm1.11,0.87c-0.21,-0.06,-0.69,-0.09,-0.87,-0.06c-0.54,0.12,-0.87,0.42,-1.17,0.99c-0.36,0.66,-0.51,1.56,-0.6,3c-0.03,0.75,-0.03,4.59,0,5.31c0.09,1.5,0.27,2.4,0.6,3.06c0.24,0.48,0.57,0.78,0.96,0.9c0.27,0.09,0.78,0.09,1.05,0c0.39,-0.12,0.72,-0.42,0.96,-0.9c0.33,-0.66,0.51,-1.56,0.6,-3.06c0.03,-0.72,0.03,-4.56,0,-5.31c-0.09,-1.47,-0.27,-2.37,-0.6,-3.03c-0.24,-0.48,-0.54,-0.78,-0.93,-0.9z\"\r\n    },\r\n    \"1\": {\r\n        \"w\": 8.94,\r\n        \"h\": 15.058,\r\n        \"d\": \"M3.3,-15.06c0.06,-0.06,0.21,-0.03,0.66,0.15c0.81,0.39,1.08,0.39,1.83,0.03c0.21,-0.09,0.39,-0.15,0.42,-0.15c0.12,0,0.21,0.09,0.27,0.21c0.06,0.12,0.06,0.33,0.06,5.94c0,3.93,0,5.85,0.03,6.03c0.06,0.36,0.15,0.69,0.27,0.96c0.36,0.75,0.93,1.17,1.68,1.26c0.3,0.03,0.39,0.09,0.39,0.3c0,0.15,-0.03,0.18,-0.09,0.24c-0.06,0.06,-0.09,0.06,-0.48,0.06c-0.42,0,-0.69,-0.03,-2.1,-0.24c-0.9,-0.15,-1.77,-0.15,-2.67,0c-1.41,0.21,-1.68,0.24,-2.1,0.24c-0.39,0,-0.42,0,-0.48,-0.06c-0.06,-0.06,-0.06,-0.09,-0.06,-0.24c0,-0.21,0.06,-0.27,0.36,-0.3c0.75,-0.09,1.32,-0.51,1.68,-1.26c0.12,-0.27,0.21,-0.6,0.27,-0.96c0.03,-0.18,0.03,-1.59,0.03,-4.29c0,-3.87,0,-4.05,-0.06,-4.14c-0.09,-0.15,-0.18,-0.24,-0.39,-0.24c-0.12,0,-0.15,0.03,-0.21,0.06c-0.03,0.06,-0.45,0.99,-0.96,2.13c-0.48,1.14,-0.9,2.1,-0.93,2.16c-0.06,0.15,-0.21,0.24,-0.33,0.24c-0.24,0,-0.42,-0.18,-0.42,-0.39c0,-0.06,3.27,-7.62,3.33,-7.74z\"\r\n    },\r\n    \"2\": {\r\n        \"w\": 10.764,\r\n        \"h\": 14.993,\r\n        \"d\": \"M4.23,-14.97c0.57,-0.06,1.68,0,2.34,0.18c0.69,0.18,1.5,0.54,2.01,0.9c1.35,0.96,1.95,2.25,1.77,3.81c-0.15,1.35,-0.66,2.34,-1.68,3.15c-0.6,0.48,-1.44,0.93,-3.12,1.65c-1.32,0.57,-1.8,0.81,-2.37,1.14c-0.57,0.33,-0.57,0.33,-0.24,0.27c0.39,-0.09,1.26,-0.09,1.68,0c0.72,0.15,1.41,0.45,2.1,0.9c0.99,0.63,1.86,0.87,2.55,0.75c0.24,-0.06,0.42,-0.15,0.57,-0.3c0.12,-0.09,0.3,-0.42,0.3,-0.51c0,-0.09,0.12,-0.21,0.24,-0.24c0.18,-0.03,0.39,0.12,0.39,0.3c0,0.12,-0.15,0.57,-0.3,0.87c-0.54,1.02,-1.56,1.74,-2.79,2.01c-0.42,0.09,-1.23,0.09,-1.62,0.03c-0.81,-0.18,-1.32,-0.45,-2.01,-1.11c-0.45,-0.45,-0.63,-0.57,-0.96,-0.69c-0.84,-0.27,-1.89,0.12,-2.25,0.9c-0.12,0.21,-0.21,0.54,-0.21,0.72c0,0.12,-0.12,0.21,-0.27,0.24c-0.15,0,-0.27,-0.03,-0.33,-0.15c-0.09,-0.21,0.09,-1.08,0.33,-1.71c0.24,-0.66,0.66,-1.26,1.29,-1.89c0.45,-0.45,0.9,-0.81,1.92,-1.56c1.29,-0.93,1.89,-1.44,2.34,-1.98c0.87,-1.05,1.26,-2.19,1.2,-3.63c-0.06,-1.29,-0.39,-2.31,-0.96,-2.91c-0.36,-0.33,-0.72,-0.51,-1.17,-0.54c-0.84,-0.03,-1.53,0.42,-1.59,1.05c-0.03,0.33,0.12,0.6,0.57,1.14c0.45,0.54,0.54,0.87,0.42,1.41c-0.15,0.63,-0.54,1.11,-1.08,1.38c-0.63,0.33,-1.2,0.33,-1.83,0c-0.24,-0.12,-0.33,-0.18,-0.54,-0.39c-0.18,-0.18,-0.27,-0.3,-0.36,-0.51c-0.24,-0.45,-0.27,-0.84,-0.21,-1.38c0.12,-0.75,0.45,-1.41,1.02,-1.98c0.72,-0.72,1.74,-1.17,2.85,-1.32z\"\r\n    },\r\n    \"3\": {\r\n        \"w\": 9.735,\r\n        \"h\": 14.967,\r\n        \"d\": \"M3.78,-14.97c0.3,-0.03,1.41,0,1.83,0.06c2.22,0.3,3.51,1.32,3.72,2.91c0.03,0.33,0.03,1.26,-0.03,1.65c-0.12,0.84,-0.48,1.47,-1.05,1.77c-0.27,0.15,-0.36,0.24,-0.45,0.39c-0.09,0.21,-0.09,0.36,0,0.57c0.09,0.15,0.18,0.24,0.51,0.39c0.75,0.42,1.23,1.14,1.41,2.13c0.06,0.42,0.06,1.35,0,1.71c-0.18,0.81,-0.48,1.38,-1.02,1.95c-0.75,0.72,-1.8,1.2,-3.18,1.38c-0.42,0.06,-1.56,0.06,-1.95,0c-1.89,-0.33,-3.18,-1.29,-3.51,-2.64c-0.03,-0.12,-0.03,-0.33,-0.03,-0.6c0,-0.36,0,-0.42,0.06,-0.63c0.12,-0.3,0.27,-0.51,0.51,-0.75c0.24,-0.24,0.45,-0.39,0.75,-0.51c0.21,-0.06,0.27,-0.06,0.6,-0.06c0.33,0,0.39,0,0.6,0.06c0.3,0.12,0.51,0.27,0.75,0.51c0.36,0.33,0.57,0.75,0.6,1.2c0,0.21,0,0.27,-0.06,0.42c-0.09,0.18,-0.12,0.24,-0.54,0.54c-0.51,0.36,-0.63,0.54,-0.6,0.87c0.06,0.54,0.54,0.9,1.38,0.99c0.36,0.06,0.72,0.03,0.96,-0.06c0.81,-0.27,1.29,-1.23,1.44,-2.79c0.03,-0.45,0.03,-1.95,-0.03,-2.37c-0.09,-0.75,-0.33,-1.23,-0.75,-1.44c-0.33,-0.18,-0.45,-0.18,-1.98,-0.18c-1.35,0,-1.41,0,-1.5,-0.06c-0.18,-0.12,-0.24,-0.39,-0.12,-0.6c0.12,-0.15,0.15,-0.15,1.68,-0.15c1.5,0,1.62,0,1.89,-0.15c0.18,-0.09,0.42,-0.36,0.54,-0.57c0.18,-0.42,0.27,-0.9,0.3,-1.95c0.03,-1.2,-0.06,-1.8,-0.36,-2.37c-0.24,-0.48,-0.63,-0.81,-1.14,-0.96c-0.3,-0.06,-1.08,-0.06,-1.38,0.03c-0.6,0.15,-0.9,0.42,-0.96,0.84c-0.03,0.3,0.06,0.45,0.63,0.84c0.33,0.24,0.42,0.39,0.45,0.63c0.03,0.72,-0.57,1.5,-1.32,1.65c-1.05,0.27,-2.1,-0.57,-2.1,-1.65c0,-0.45,0.15,-0.96,0.39,-1.38c0.12,-0.21,0.54,-0.63,0.81,-0.81c0.57,-0.42,1.38,-0.69,2.25,-0.81z\"\r\n    },\r\n    \"4\": {\r\n        \"w\": 11.795,\r\n        \"h\": 14.994,\r\n        \"d\": \"M8.64,-14.94c0.27,-0.09,0.42,-0.12,0.54,-0.03c0.09,0.06,0.15,0.21,0.15,0.3c-0.03,0.06,-1.92,2.31,-4.23,5.04c-2.31,2.73,-4.23,4.98,-4.26,5.01c-0.03,0.06,0.12,0.06,2.55,0.06l2.61,0l0,-2.37c0,-2.19,0.03,-2.37,0.06,-2.46c0.03,-0.06,0.21,-0.18,0.57,-0.42c1.08,-0.72,1.38,-1.08,1.86,-2.16c0.12,-0.3,0.24,-0.54,0.27,-0.57c0.12,-0.12,0.39,-0.06,0.45,0.12c0.06,0.09,0.06,0.57,0.06,3.96l0,3.9l1.08,0c1.05,0,1.11,0,1.2,0.06c0.24,0.15,0.24,0.54,0,0.69c-0.09,0.06,-0.15,0.06,-1.2,0.06l-1.08,0l0,0.33c0,0.57,0.09,1.11,0.3,1.53c0.36,0.75,0.93,1.17,1.68,1.26c0.3,0.03,0.39,0.09,0.39,0.3c0,0.15,-0.03,0.18,-0.09,0.24c-0.06,0.06,-0.09,0.06,-0.48,0.06c-0.42,0,-0.69,-0.03,-2.1,-0.24c-0.9,-0.15,-1.77,-0.15,-2.67,0c-1.41,0.21,-1.68,0.24,-2.1,0.24c-0.39,0,-0.42,0,-0.48,-0.06c-0.06,-0.06,-0.06,-0.09,-0.06,-0.24c0,-0.21,0.06,-0.27,0.36,-0.3c0.75,-0.09,1.32,-0.51,1.68,-1.26c0.21,-0.42,0.3,-0.96,0.3,-1.53l0,-0.33l-2.7,0c-2.91,0,-2.85,0,-3.09,-0.15c-0.18,-0.12,-0.3,-0.39,-0.27,-0.54c0.03,-0.06,0.18,-0.24,0.33,-0.45c0.75,-0.9,1.59,-2.07,2.13,-3.03c0.33,-0.54,0.84,-1.62,1.05,-2.16c0.57,-1.41,0.84,-2.64,0.9,-4.05c0.03,-0.63,0.06,-0.72,0.24,-0.81l0.12,-0.06l0.45,0.12c0.66,0.18,1.02,0.24,1.47,0.27c0.6,0.03,1.23,-0.09,2.01,-0.33z\"\r\n    },\r\n    \"5\": {\r\n        \"w\": 10.212,\r\n        \"h\": 14.997,\r\n        \"d\": \"M1.02,-14.94c0.12,-0.09,0.03,-0.09,1.08,0.06c2.49,0.36,4.35,0.36,6.96,-0.06c0.57,-0.09,0.66,-0.06,0.81,0.06c0.15,0.18,0.12,0.24,-0.15,0.51c-1.29,1.26,-3.24,2.04,-5.58,2.31c-0.6,0.09,-1.2,0.12,-1.71,0.12c-0.39,0,-0.45,0,-0.57,0.06c-0.09,0.06,-0.15,0.12,-0.21,0.21l-0.06,0.12l0,1.65l0,1.65l0.21,-0.21c0.66,-0.57,1.41,-0.96,2.19,-1.14c0.33,-0.06,1.41,-0.06,1.95,0c2.61,0.36,4.02,1.74,4.26,4.14c0.03,0.45,0.03,1.08,-0.03,1.44c-0.18,1.02,-0.78,2.01,-1.59,2.7c-0.72,0.57,-1.62,1.02,-2.49,1.2c-1.38,0.27,-3.03,0.06,-4.2,-0.54c-1.08,-0.54,-1.71,-1.32,-1.86,-2.28c-0.09,-0.69,0.09,-1.29,0.57,-1.74c0.24,-0.24,0.45,-0.39,0.75,-0.51c0.21,-0.06,0.27,-0.06,0.6,-0.06c0.33,0,0.39,0,0.6,0.06c0.3,0.12,0.51,0.27,0.75,0.51c0.36,0.33,0.57,0.75,0.6,1.2c0,0.21,0,0.27,-0.06,0.42c-0.09,0.18,-0.12,0.24,-0.54,0.54c-0.18,0.12,-0.36,0.3,-0.42,0.33c-0.36,0.42,-0.18,0.99,0.36,1.26c0.51,0.27,1.47,0.36,2.01,0.27c0.93,-0.21,1.47,-1.17,1.65,-2.91c0.06,-0.45,0.06,-1.89,0,-2.31c-0.15,-1.2,-0.51,-2.1,-1.05,-2.55c-0.21,-0.18,-0.54,-0.36,-0.81,-0.39c-0.3,-0.06,-0.84,-0.03,-1.26,0.06c-0.93,0.18,-1.65,0.6,-2.16,1.2c-0.15,0.21,-0.27,0.3,-0.39,0.3c-0.15,0,-0.3,-0.09,-0.36,-0.18c-0.06,-0.09,-0.06,-0.15,-0.06,-3.66c0,-3.39,0,-3.57,0.06,-3.66c0.03,-0.06,0.09,-0.15,0.15,-0.18z\"\r\n    },\r\n    \"6\": {\r\n        \"w\": 9.956,\r\n        \"h\": 14.982,\r\n        \"d\": \"M4.98,-14.97c0.36,-0.03,1.2,0,1.59,0.06c0.9,0.15,1.68,0.51,2.25,1.05c0.57,0.51,0.87,1.23,0.84,1.98c-0.03,0.51,-0.21,0.9,-0.6,1.26c-0.24,0.24,-0.45,0.39,-0.75,0.51c-0.21,0.06,-0.27,0.06,-0.6,0.06c-0.33,0,-0.39,0,-0.6,-0.06c-0.3,-0.12,-0.51,-0.27,-0.75,-0.51c-0.39,-0.36,-0.57,-0.78,-0.57,-1.26c0,-0.27,0,-0.3,0.09,-0.42c0.03,-0.09,0.18,-0.21,0.3,-0.3c0.12,-0.09,0.3,-0.21,0.39,-0.27c0.09,-0.06,0.21,-0.18,0.27,-0.24c0.06,-0.12,0.09,-0.15,0.09,-0.33c0,-0.18,-0.03,-0.24,-0.09,-0.36c-0.24,-0.39,-0.75,-0.6,-1.38,-0.57c-0.54,0.03,-0.9,0.18,-1.23,0.48c-0.81,0.72,-1.08,2.16,-0.96,5.37l0,0.63l0.3,-0.12c0.78,-0.27,1.29,-0.33,2.1,-0.27c1.47,0.12,2.49,0.54,3.27,1.29c0.48,0.51,0.81,1.11,0.96,1.89c0.06,0.27,0.06,0.42,0.06,0.93c0,0.54,0,0.69,-0.06,0.96c-0.15,0.78,-0.48,1.38,-0.96,1.89c-0.54,0.51,-1.17,0.87,-1.98,1.08c-1.14,0.3,-2.4,0.33,-3.24,0.03c-1.5,-0.48,-2.64,-1.89,-3.27,-4.02c-0.36,-1.23,-0.51,-2.82,-0.42,-4.08c0.3,-3.66,2.28,-6.3,4.95,-6.66zm0.66,7.41c-0.27,-0.09,-0.81,-0.12,-1.08,-0.06c-0.72,0.18,-1.08,0.69,-1.23,1.71c-0.06,0.54,-0.06,3,0,3.54c0.18,1.26,0.72,1.77,1.8,1.74c0.39,-0.03,0.63,-0.09,0.9,-0.27c0.66,-0.42,0.9,-1.32,0.9,-3.24c0,-2.22,-0.36,-3.12,-1.29,-3.42z\"\r\n    },\r\n    \"7\": {\r\n        \"w\": 10.561,\r\n        \"h\": 15.093,\r\n        \"d\": \"M0.21,-14.97c0.21,-0.06,0.45,0,0.54,0.15c0.06,0.09,0.06,0.15,0.06,0.39c0,0.24,0,0.33,0.06,0.42c0.06,0.12,0.21,0.24,0.27,0.24c0.03,0,0.12,-0.12,0.24,-0.21c0.96,-1.2,2.58,-1.35,3.99,-0.42c0.15,0.12,0.42,0.3,0.54,0.45c0.48,0.39,0.81,0.57,1.29,0.6c0.69,0.03,1.5,-0.3,2.13,-0.87c0.09,-0.09,0.27,-0.3,0.39,-0.45c0.12,-0.15,0.24,-0.27,0.3,-0.3c0.18,-0.06,0.39,0.03,0.51,0.21c0.06,0.18,0.06,0.24,-0.27,0.72c-0.18,0.24,-0.54,0.78,-0.78,1.17c-2.37,3.54,-3.54,6.27,-3.87,9c-0.03,0.33,-0.03,0.66,-0.03,1.26c0,0.9,0,1.08,0.15,1.89c0.06,0.45,0.06,0.48,0.03,0.6c-0.06,0.09,-0.21,0.21,-0.3,0.21c-0.03,0,-0.27,-0.06,-0.54,-0.15c-0.84,-0.27,-1.11,-0.3,-1.65,-0.3c-0.57,0,-0.84,0.03,-1.56,0.27c-0.6,0.18,-0.69,0.21,-0.81,0.15c-0.12,-0.06,-0.21,-0.18,-0.21,-0.3c0,-0.15,0.6,-1.44,1.2,-2.61c1.14,-2.22,2.73,-4.68,5.1,-8.01c0.21,-0.27,0.36,-0.48,0.33,-0.48c0,0,-0.12,0.06,-0.27,0.12c-0.54,0.3,-0.99,0.39,-1.56,0.39c-0.75,0.03,-1.2,-0.18,-1.83,-0.75c-0.99,-0.9,-1.83,-1.17,-2.31,-0.72c-0.18,0.15,-0.36,0.51,-0.45,0.84c-0.06,0.24,-0.06,0.33,-0.09,1.98c0,1.62,-0.03,1.74,-0.06,1.8c-0.15,0.24,-0.54,0.24,-0.69,0c-0.06,-0.09,-0.06,-0.15,-0.06,-3.57c0,-3.42,0,-3.48,0.06,-3.57c0.03,-0.06,0.09,-0.12,0.15,-0.15z\"\r\n    },\r\n    \"8\": {\r\n        \"w\": 10.926,\r\n        \"h\": 14.989,\r\n        \"d\": \"M4.98,-14.97c0.33,-0.03,1.02,-0.03,1.32,0c1.32,0.12,2.49,0.6,3.21,1.32c0.39,0.39,0.66,0.81,0.78,1.29c0.09,0.36,0.09,1.08,0,1.44c-0.21,0.84,-0.66,1.59,-1.59,2.55l-0.3,0.3l0.27,0.18c1.47,0.93,2.31,2.31,2.25,3.75c-0.03,0.75,-0.24,1.35,-0.63,1.95c-0.45,0.66,-1.02,1.14,-1.83,1.53c-1.8,0.87,-4.2,0.87,-6,0.03c-1.62,-0.78,-2.52,-2.16,-2.46,-3.66c0.06,-0.99,0.54,-1.77,1.8,-2.97c0.54,-0.51,0.54,-0.54,0.48,-0.57c-0.39,-0.27,-0.96,-0.78,-1.2,-1.14c-0.75,-1.11,-0.87,-2.4,-0.3,-3.6c0.69,-1.35,2.25,-2.25,4.2,-2.4zm1.53,0.69c-0.42,-0.09,-1.11,-0.12,-1.38,-0.06c-0.3,0.06,-0.6,0.18,-0.81,0.3c-0.21,0.12,-0.6,0.51,-0.72,0.72c-0.51,0.87,-0.42,1.89,0.21,2.52c0.21,0.21,0.36,0.3,1.95,1.23c0.96,0.54,1.74,0.99,1.77,1.02c0.09,0,0.63,-0.6,0.99,-1.11c0.21,-0.36,0.48,-0.87,0.57,-1.23c0.06,-0.24,0.06,-0.36,0.06,-0.72c0,-0.45,-0.03,-0.66,-0.15,-0.99c-0.39,-0.81,-1.29,-1.44,-2.49,-1.68zm-1.44,8.07l-1.89,-1.08c-0.03,0,-0.18,0.15,-0.39,0.33c-1.2,1.08,-1.65,1.95,-1.59,3c0.09,1.59,1.35,2.85,3.21,3.24c0.33,0.06,0.45,0.06,0.93,0.06c0.63,0,0.81,-0.03,1.29,-0.27c0.9,-0.42,1.47,-1.41,1.41,-2.4c-0.06,-0.66,-0.39,-1.29,-0.9,-1.65c-0.12,-0.09,-1.05,-0.63,-2.07,-1.23z\"\r\n    },\r\n    \"9\": {\r\n        \"w\": 9.959,\r\n        \"h\": 14.986,\r\n        \"d\": \"M4.23,-14.97c0.42,-0.03,1.29,0,1.62,0.06c0.51,0.12,0.93,0.3,1.38,0.57c1.53,1.02,2.52,3.24,2.73,5.94c0.18,2.55,-0.48,4.98,-1.83,6.57c-1.05,1.26,-2.4,1.89,-3.93,1.83c-1.23,-0.06,-2.31,-0.45,-3.03,-1.14c-0.57,-0.51,-0.87,-1.23,-0.84,-1.98c0.03,-0.51,0.21,-0.9,0.6,-1.26c0.24,-0.24,0.45,-0.39,0.75,-0.51c0.21,-0.06,0.27,-0.06,0.6,-0.06c0.33,0,0.39,0,0.6,0.06c0.3,0.12,0.51,0.27,0.75,0.51c0.39,0.36,0.57,0.78,0.57,1.26c0,0.27,0,0.3,-0.09,0.42c-0.03,0.09,-0.18,0.21,-0.3,0.3c-0.12,0.09,-0.3,0.21,-0.39,0.27c-0.09,0.06,-0.21,0.18,-0.27,0.24c-0.06,0.12,-0.06,0.15,-0.06,0.33c0,0.18,0,0.24,0.06,0.36c0.24,0.39,0.75,0.6,1.38,0.57c0.54,-0.03,0.9,-0.18,1.23,-0.48c0.81,-0.72,1.08,-2.16,0.96,-5.37l0,-0.63l-0.3,0.12c-0.78,0.27,-1.29,0.33,-2.1,0.27c-1.47,-0.12,-2.49,-0.54,-3.27,-1.29c-0.48,-0.51,-0.81,-1.11,-0.96,-1.89c-0.06,-0.27,-0.06,-0.42,-0.06,-0.96c0,-0.51,0,-0.66,0.06,-0.93c0.15,-0.78,0.48,-1.38,0.96,-1.89c0.15,-0.12,0.33,-0.27,0.42,-0.36c0.69,-0.51,1.62,-0.81,2.76,-0.93zm1.17,0.66c-0.21,-0.06,-0.57,-0.06,-0.81,-0.03c-0.78,0.12,-1.26,0.69,-1.41,1.74c-0.12,0.63,-0.15,1.95,-0.09,2.79c0.12,1.71,0.63,2.4,1.77,2.46c1.08,0.03,1.62,-0.48,1.8,-1.74c0.06,-0.54,0.06,-3,0,-3.54c-0.15,-1.05,-0.51,-1.53,-1.26,-1.68z\"\r\n    },\r\n    \"rests.whole\": {\r\n        \"w\": 11.25,\r\n        \"h\": 4.68,\r\n        \"d\": \"M0.06,0.03l0.09,-0.06l5.46,0l5.49,0l0.09,0.06l0.06,0.09l0,2.19l0,2.19l-0.06,0.09l-0.09,0.06l-5.49,0l-5.46,0l-0.09,-0.06l-0.06,-0.09l0,-2.19l0,-2.19z\"\r\n    },\r\n    \"rests.half\": {\r\n        \"w\": 11.25,\r\n        \"h\": 4.68,\r\n        \"d\": \"M0.06,-4.62l0.09,-0.06l5.46,0l5.49,0l0.09,0.06l0.06,0.09l0,2.19l0,2.19l-0.06,0.09l-0.09,0.06l-5.49,0l-5.46,0l-0.09,-0.06l-0.06,-0.09l0,-2.19l0,-2.19z\"\r\n    },\r\n    \"rests.quarter\": {\r\n        \"w\": 7.888,\r\n        \"h\": 21.435,\r\n        \"d\": \"M1.89,-11.82c0.12,-0.06,0.24,-0.06,0.36,-0.03c0.09,0.06,4.74,5.58,4.86,5.82c0.21,0.39,0.15,0.78,-0.15,1.26c-0.24,0.33,-0.72,0.81,-1.62,1.56c-0.45,0.36,-0.87,0.75,-0.96,0.84c-0.93,0.99,-1.14,2.49,-0.6,3.63c0.18,0.39,0.27,0.48,1.32,1.68c1.92,2.25,1.83,2.16,1.83,2.34c0,0.18,-0.18,0.36,-0.36,0.39c-0.15,0,-0.27,-0.06,-0.48,-0.27c-0.75,-0.75,-2.46,-1.29,-3.39,-1.08c-0.45,0.09,-0.69,0.27,-0.9,0.69c-0.12,0.3,-0.21,0.66,-0.24,1.14c-0.03,0.66,0.09,1.35,0.3,2.01c0.15,0.42,0.24,0.66,0.45,0.96c0.18,0.24,0.18,0.33,0.03,0.42c-0.12,0.06,-0.18,0.03,-0.45,-0.3c-1.08,-1.38,-2.07,-3.36,-2.4,-4.83c-0.27,-1.05,-0.15,-1.77,0.27,-2.07c0.21,-0.12,0.42,-0.15,0.87,-0.15c0.87,0.06,2.1,0.39,3.3,0.9l0.39,0.18l-1.65,-1.95c-2.52,-2.97,-2.61,-3.09,-2.7,-3.27c-0.09,-0.24,-0.12,-0.48,-0.03,-0.75c0.15,-0.48,0.57,-0.96,1.83,-2.01c0.45,-0.36,0.84,-0.72,0.93,-0.78c0.69,-0.75,1.02,-1.8,0.9,-2.79c-0.06,-0.33,-0.21,-0.84,-0.39,-1.11c-0.09,-0.15,-0.45,-0.6,-0.81,-1.05c-0.36,-0.42,-0.69,-0.81,-0.72,-0.87c-0.09,-0.18,0,-0.42,0.21,-0.51z\"\r\n    },\r\n    \"rests.8th\": {\r\n        \"w\": 7.534,\r\n        \"h\": 13.883,\r\n        \"d\": \"M1.68,-6.12c0.66,-0.09,1.23,0.09,1.68,0.51c0.27,0.3,0.39,0.54,0.57,1.26c0.09,0.33,0.18,0.66,0.21,0.72c0.12,0.27,0.33,0.45,0.6,0.48c0.12,0,0.18,0,0.33,-0.09c0.39,-0.18,1.32,-1.29,1.68,-1.98c0.09,-0.21,0.24,-0.3,0.39,-0.3c0.12,0,0.27,0.09,0.33,0.18c0.03,0.06,-0.27,1.11,-1.86,6.42c-1.02,3.48,-1.89,6.39,-1.92,6.42c0,0.03,-0.12,0.12,-0.24,0.15c-0.18,0.09,-0.21,0.09,-0.45,0.09c-0.24,0,-0.3,0,-0.48,-0.06c-0.09,-0.06,-0.21,-0.12,-0.21,-0.15c-0.06,-0.03,0.15,-0.57,1.68,-4.92c0.96,-2.67,1.74,-4.89,1.71,-4.89l-0.51,0.15c-1.08,0.36,-1.74,0.48,-2.55,0.48c-0.66,0,-0.84,-0.03,-1.32,-0.27c-1.32,-0.63,-1.77,-2.16,-1.02,-3.3c0.33,-0.45,0.84,-0.81,1.38,-0.9z\"\r\n    },\r\n    \"rests.16th\": {\r\n        \"w\": 9.724,\r\n        \"h\": 21.383,\r\n        \"d\": \"M3.33,-6.12c0.66,-0.09,1.23,0.09,1.68,0.51c0.27,0.3,0.39,0.54,0.57,1.26c0.09,0.33,0.18,0.66,0.21,0.72c0.15,0.39,0.57,0.57,0.87,0.42c0.39,-0.18,1.2,-1.23,1.62,-2.07c0.06,-0.15,0.24,-0.24,0.36,-0.24c0.12,0,0.27,0.09,0.33,0.18c0.03,0.06,-0.45,1.86,-2.67,10.17c-1.5,5.55,-2.73,10.14,-2.76,10.17c-0.03,0.03,-0.12,0.12,-0.24,0.15c-0.18,0.09,-0.21,0.09,-0.45,0.09c-0.24,0,-0.3,0,-0.48,-0.06c-0.09,-0.06,-0.21,-0.12,-0.21,-0.15c-0.06,-0.03,0.12,-0.57,1.44,-4.92c0.81,-2.67,1.47,-4.86,1.47,-4.89c-0.03,0,-0.27,0.06,-0.54,0.15c-1.08,0.36,-1.77,0.48,-2.58,0.48c-0.66,0,-0.84,-0.03,-1.32,-0.27c-1.32,-0.63,-1.77,-2.16,-1.02,-3.3c0.72,-1.05,2.22,-1.23,3.06,-0.42c0.3,0.33,0.42,0.6,0.6,1.38c0.09,0.45,0.21,0.78,0.33,0.9c0.09,0.09,0.27,0.18,0.45,0.21c0.12,0,0.18,0,0.33,-0.09c0.33,-0.15,1.02,-0.93,1.41,-1.59c0.12,-0.21,0.18,-0.39,0.39,-1.08c0.66,-2.1,1.17,-3.84,1.17,-3.87c0,0,-0.21,0.06,-0.42,0.15c-0.51,0.15,-1.2,0.33,-1.68,0.42c-0.33,0.06,-0.51,0.06,-0.96,0.06c-0.66,0,-0.84,-0.03,-1.32,-0.27c-1.32,-0.63,-1.77,-2.16,-1.02,-3.3c0.33,-0.45,0.84,-0.81,1.38,-0.9z\"\r\n    },\r\n    \"rests.32nd\": {\r\n        \"w\": 11.373,\r\n        \"h\": 28.883,\r\n        \"d\": \"M4.23,-13.62c0.66,-0.09,1.23,0.09,1.68,0.51c0.27,0.3,0.39,0.54,0.57,1.26c0.09,0.33,0.18,0.66,0.21,0.72c0.12,0.27,0.33,0.45,0.6,0.48c0.12,0,0.18,0,0.27,-0.06c0.33,-0.21,0.99,-1.11,1.44,-1.98c0.09,-0.24,0.21,-0.33,0.39,-0.33c0.12,0,0.27,0.09,0.33,0.18c0.03,0.06,-0.57,2.67,-3.21,13.89c-1.8,7.62,-3.3,13.89,-3.3,13.92c-0.03,0.06,-0.12,0.12,-0.24,0.18c-0.21,0.09,-0.24,0.09,-0.48,0.09c-0.24,0,-0.3,0,-0.48,-0.06c-0.09,-0.06,-0.21,-0.12,-0.21,-0.15c-0.06,-0.03,0.09,-0.57,1.23,-4.92c0.69,-2.67,1.26,-4.86,1.29,-4.89c0,-0.03,-0.12,-0.03,-0.48,0.12c-1.17,0.39,-2.22,0.57,-3,0.54c-0.42,-0.03,-0.75,-0.12,-1.11,-0.3c-1.32,-0.63,-1.77,-2.16,-1.02,-3.3c0.72,-1.05,2.22,-1.23,3.06,-0.42c0.3,0.33,0.42,0.6,0.6,1.38c0.09,0.45,0.21,0.78,0.33,0.9c0.12,0.09,0.3,0.18,0.48,0.21c0.12,0,0.18,0,0.3,-0.09c0.42,-0.21,1.29,-1.29,1.56,-1.89c0.03,-0.12,1.23,-4.59,1.23,-4.65c0,-0.03,-0.18,0.03,-0.39,0.12c-0.63,0.18,-1.2,0.36,-1.74,0.45c-0.39,0.06,-0.54,0.06,-1.02,0.06c-0.66,0,-0.84,-0.03,-1.32,-0.27c-1.32,-0.63,-1.77,-2.16,-1.02,-3.3c0.72,-1.05,2.22,-1.23,3.06,-0.42c0.3,0.33,0.42,0.6,0.6,1.38c0.09,0.45,0.21,0.78,0.33,0.9c0.18,0.18,0.51,0.27,0.72,0.15c0.3,-0.12,0.69,-0.57,1.08,-1.17c0.42,-0.6,0.39,-0.51,1.05,-3.03c0.33,-1.26,0.6,-2.31,0.6,-2.34c0,0,-0.21,0.03,-0.45,0.12c-0.57,0.18,-1.14,0.33,-1.62,0.42c-0.33,0.06,-0.51,0.06,-0.96,0.06c-0.66,0,-0.84,-0.03,-1.32,-0.27c-1.32,-0.63,-1.77,-2.16,-1.02,-3.3c0.33,-0.45,0.84,-0.81,1.38,-0.9z\"\r\n    },\r\n    \"rests.64th\": {\r\n        \"w\": 12.453,\r\n        \"h\": 36.383,\r\n        \"d\": \"M5.13,-13.62c0.66,-0.09,1.23,0.09,1.68,0.51c0.27,0.3,0.39,0.54,0.57,1.26c0.15,0.63,0.21,0.81,0.33,0.96c0.18,0.21,0.54,0.3,0.75,0.18c0.24,-0.12,0.63,-0.66,1.08,-1.56c0.33,-0.66,0.39,-0.72,0.6,-0.72c0.12,0,0.27,0.09,0.33,0.18c0.03,0.06,-0.69,3.66,-3.54,17.64c-1.95,9.66,-3.57,17.61,-3.57,17.64c-0.03,0.06,-0.12,0.12,-0.24,0.18c-0.21,0.09,-0.24,0.09,-0.48,0.09c-0.24,0,-0.3,0,-0.48,-0.06c-0.09,-0.06,-0.21,-0.12,-0.21,-0.15c-0.06,-0.03,0.06,-0.57,1.05,-4.95c0.6,-2.7,1.08,-4.89,1.08,-4.92c0,0,-0.24,0.06,-0.51,0.15c-0.66,0.24,-1.2,0.36,-1.77,0.48c-0.42,0.06,-0.57,0.06,-1.05,0.06c-0.69,0,-0.87,-0.03,-1.35,-0.27c-1.32,-0.63,-1.77,-2.16,-1.02,-3.3c0.72,-1.05,2.22,-1.23,3.06,-0.42c0.3,0.33,0.42,0.6,0.6,1.38c0.09,0.45,0.21,0.78,0.33,0.9c0.09,0.09,0.27,0.18,0.45,0.21c0.21,0.03,0.39,-0.09,0.72,-0.42c0.45,-0.45,1.02,-1.26,1.17,-1.65c0.03,-0.09,0.27,-1.14,0.54,-2.34c0.27,-1.2,0.48,-2.19,0.51,-2.22c0,-0.03,-0.09,-0.03,-0.48,0.12c-1.17,0.39,-2.22,0.57,-3,0.54c-0.42,-0.03,-0.75,-0.12,-1.11,-0.3c-1.32,-0.63,-1.77,-2.16,-1.02,-3.3c0.36,-0.54,0.96,-0.87,1.65,-0.93c0.54,-0.03,1.02,0.15,1.41,0.54c0.27,0.3,0.39,0.54,0.57,1.26c0.09,0.33,0.18,0.66,0.21,0.72c0.15,0.39,0.57,0.57,0.9,0.42c0.36,-0.18,1.2,-1.26,1.47,-1.89c0.03,-0.09,0.3,-1.2,0.57,-2.43l0.51,-2.28l-0.54,0.18c-1.11,0.36,-1.8,0.48,-2.61,0.48c-0.66,0,-0.84,-0.03,-1.32,-0.27c-1.32,-0.63,-1.77,-2.16,-1.02,-3.3c0.36,-0.54,0.96,-0.87,1.65,-0.93c0.54,-0.03,1.02,0.15,1.41,0.54c0.27,0.3,0.39,0.54,0.57,1.26c0.15,0.63,0.21,0.81,0.33,0.96c0.21,0.21,0.54,0.3,0.75,0.18c0.36,-0.18,0.93,-0.93,1.29,-1.68c0.12,-0.24,0.18,-0.48,0.63,-2.55l0.51,-2.31c0,-0.03,-0.18,0.03,-0.39,0.12c-1.14,0.36,-2.1,0.54,-2.82,0.51c-0.42,-0.03,-0.75,-0.12,-1.11,-0.3c-1.32,-0.63,-1.77,-2.16,-1.02,-3.3c0.33,-0.45,0.84,-0.81,1.38,-0.9z\"\r\n    },\r\n    \"rests.128th\": {\r\n        \"w\": 12.992,\r\n        \"h\": 43.883,\r\n        \"d\": \"M6.03,-21.12c0.66,-0.09,1.23,0.09,1.68,0.51c0.27,0.3,0.39,0.54,0.57,1.26c0.09,0.33,0.18,0.66,0.21,0.72c0.12,0.27,0.33,0.45,0.6,0.48c0.21,0,0.33,-0.06,0.54,-0.36c0.15,-0.21,0.54,-0.93,0.78,-1.47c0.15,-0.33,0.18,-0.39,0.3,-0.48c0.18,-0.09,0.45,0,0.51,0.15c0.03,0.09,-7.11,42.75,-7.17,42.84c-0.03,0.03,-0.15,0.09,-0.24,0.15c-0.18,0.06,-0.24,0.06,-0.45,0.06c-0.24,0,-0.3,0,-0.48,-0.06c-0.09,-0.06,-0.21,-0.12,-0.21,-0.15c-0.06,-0.03,0.03,-0.57,0.84,-4.98c0.51,-2.7,0.93,-4.92,0.9,-4.92c0,0,-0.15,0.06,-0.36,0.12c-0.78,0.27,-1.62,0.48,-2.31,0.57c-0.15,0.03,-0.54,0.03,-0.81,0.03c-0.66,0,-0.84,-0.03,-1.32,-0.27c-1.32,-0.63,-1.77,-2.16,-1.02,-3.3c0.36,-0.54,0.96,-0.87,1.65,-0.93c0.54,-0.03,1.02,0.15,1.41,0.54c0.27,0.3,0.39,0.54,0.57,1.26c0.09,0.33,0.18,0.66,0.21,0.72c0.12,0.27,0.33,0.45,0.63,0.48c0.12,0,0.18,0,0.3,-0.09c0.42,-0.21,1.14,-1.11,1.5,-1.83c0.12,-0.27,0.12,-0.27,0.54,-2.52c0.24,-1.23,0.42,-2.25,0.39,-2.25c0,0,-0.24,0.06,-0.51,0.18c-1.26,0.39,-2.25,0.57,-3.06,0.54c-0.42,-0.03,-0.75,-0.12,-1.11,-0.3c-1.32,-0.63,-1.77,-2.16,-1.02,-3.3c0.36,-0.54,0.96,-0.87,1.65,-0.93c0.54,-0.03,1.02,0.15,1.41,0.54c0.27,0.3,0.39,0.54,0.57,1.26c0.15,0.63,0.21,0.81,0.33,0.96c0.18,0.21,0.51,0.3,0.75,0.18c0.36,-0.15,1.05,-0.99,1.41,-1.77l0.15,-0.3l0.42,-2.25c0.21,-1.26,0.42,-2.28,0.39,-2.28l-0.51,0.15c-1.11,0.39,-1.89,0.51,-2.7,0.51c-0.66,0,-0.84,-0.03,-1.32,-0.27c-1.32,-0.63,-1.77,-2.16,-1.02,-3.3c0.36,-0.54,0.96,-0.87,1.65,-0.93c0.54,-0.03,1.02,0.15,1.41,0.54c0.27,0.3,0.39,0.54,0.57,1.26c0.15,0.63,0.21,0.81,0.33,0.96c0.18,0.18,0.48,0.27,0.72,0.21c0.33,-0.12,1.14,-1.26,1.41,-1.95c0,-0.09,0.21,-1.11,0.45,-2.34c0.21,-1.2,0.39,-2.22,0.39,-2.28c0.03,-0.03,0,-0.03,-0.45,0.12c-0.57,0.18,-1.2,0.33,-1.71,0.42c-0.3,0.06,-0.51,0.06,-0.93,0.06c-0.66,0,-0.84,-0.03,-1.32,-0.27c-1.32,-0.63,-1.77,-2.16,-1.02,-3.3c0.36,-0.54,0.96,-0.87,1.65,-0.93c0.54,-0.03,1.02,0.15,1.41,0.54c0.27,0.3,0.39,0.54,0.57,1.26c0.09,0.33,0.18,0.66,0.21,0.72c0.12,0.27,0.33,0.45,0.6,0.48c0.18,0,0.36,-0.09,0.57,-0.33c0.33,-0.36,0.78,-1.14,0.93,-1.56c0.03,-0.12,0.24,-1.2,0.45,-2.4c0.24,-1.2,0.42,-2.22,0.42,-2.28c0.03,-0.03,0,-0.03,-0.39,0.09c-1.05,0.36,-1.8,0.48,-2.58,0.48c-0.63,0,-0.84,-0.03,-1.29,-0.27c-1.32,-0.63,-1.77,-2.16,-1.02,-3.3c0.33,-0.45,0.84,-0.81,1.38,-0.9z\"\r\n    },\r\n    \"accidentals.sharp\": {\r\n        \"w\": 8.25,\r\n        \"h\": 22.462,\r\n        \"d\": \"M5.73,-11.19c0.21,-0.12,0.54,-0.03,0.66,0.24c0.06,0.12,0.06,0.21,0.06,2.31c0,1.23,0,2.22,0.03,2.22c0,0,0.27,-0.12,0.6,-0.24c0.69,-0.27,0.78,-0.3,0.96,-0.15c0.21,0.15,0.21,0.18,0.21,1.38c0,1.02,0,1.11,-0.06,1.2c-0.03,0.06,-0.09,0.12,-0.12,0.15c-0.06,0.03,-0.42,0.21,-0.84,0.36l-0.75,0.33l-0.03,2.43c0,1.32,0,2.43,0.03,2.43c0,0,0.27,-0.12,0.6,-0.24c0.69,-0.27,0.78,-0.3,0.96,-0.15c0.21,0.15,0.21,0.18,0.21,1.38c0,1.02,0,1.11,-0.06,1.2c-0.03,0.06,-0.09,0.12,-0.12,0.15c-0.06,0.03,-0.42,0.21,-0.84,0.36l-0.75,0.33l-0.03,2.52c0,2.28,-0.03,2.55,-0.06,2.64c-0.21,0.36,-0.72,0.36,-0.93,0c-0.03,-0.09,-0.06,-0.33,-0.06,-2.43l0,-2.31l-1.29,0.51l-1.26,0.51l0,2.43c0,2.58,0,2.52,-0.15,2.67c-0.06,0.09,-0.27,0.18,-0.36,0.18c-0.12,0,-0.33,-0.09,-0.39,-0.18c-0.15,-0.15,-0.15,-0.09,-0.15,-2.43c0,-1.23,0,-2.22,-0.03,-2.22c0,0,-0.27,0.12,-0.6,0.24c-0.69,0.27,-0.78,0.3,-0.96,0.15c-0.21,-0.15,-0.21,-0.18,-0.21,-1.38c0,-1.02,0,-1.11,0.06,-1.2c0.03,-0.06,0.09,-0.12,0.12,-0.15c0.06,-0.03,0.42,-0.21,0.84,-0.36l0.78,-0.33l0,-2.43c0,-1.32,0,-2.43,-0.03,-2.43c0,0,-0.27,0.12,-0.6,0.24c-0.69,0.27,-0.78,0.3,-0.96,0.15c-0.21,-0.15,-0.21,-0.18,-0.21,-1.38c0,-1.02,0,-1.11,0.06,-1.2c0.03,-0.06,0.09,-0.12,0.12,-0.15c0.06,-0.03,0.42,-0.21,0.84,-0.36l0.78,-0.33l0,-2.52c0,-2.28,0.03,-2.55,0.06,-2.64c0.21,-0.36,0.72,-0.36,0.93,0c0.03,0.09,0.06,0.33,0.06,2.43l0.03,2.31l1.26,-0.51l1.26,-0.51l0,-2.43c0,-2.28,0,-2.43,0.06,-2.55c0.06,-0.12,0.12,-0.18,0.27,-0.24zm-0.33,10.65l0,-2.43l-1.29,0.51l-1.26,0.51l0,2.46l0,2.43l0.09,-0.03c0.06,-0.03,0.63,-0.27,1.29,-0.51l1.17,-0.48l0,-2.46z\"\r\n    },\r\n    \"accidentals.halfsharp\": {\r\n        \"w\": 5.25,\r\n        \"h\": 20.174,\r\n        \"d\": \"M2.43,-10.05c0.21,-0.12,0.54,-0.03,0.66,0.24c0.06,0.12,0.06,0.21,0.06,2.01c0,1.05,0,1.89,0.03,1.89l0.72,-0.48c0.69,-0.48,0.69,-0.51,0.87,-0.51c0.15,0,0.18,0.03,0.27,0.09c0.21,0.15,0.21,0.18,0.21,1.41c0,1.11,-0.03,1.14,-0.09,1.23c-0.03,0.03,-0.48,0.39,-1.02,0.75l-0.99,0.66l0,2.37c0,1.32,0,2.37,0.03,2.37l0.72,-0.48c0.69,-0.48,0.69,-0.51,0.87,-0.51c0.15,0,0.18,0.03,0.27,0.09c0.21,0.15,0.21,0.18,0.21,1.41c0,1.11,-0.03,1.14,-0.09,1.23c-0.03,0.03,-0.48,0.39,-1.02,0.75l-0.99,0.66l0,2.25c0,1.95,0,2.28,-0.06,2.37c-0.06,0.12,-0.12,0.21,-0.24,0.27c-0.27,0.12,-0.54,0.03,-0.69,-0.24c-0.06,-0.12,-0.06,-0.21,-0.06,-2.01c0,-1.05,0,-1.89,-0.03,-1.89l-0.72,0.48c-0.69,0.48,-0.69,0.48,-0.87,0.48c-0.15,0,-0.18,0,-0.27,-0.06c-0.21,-0.15,-0.21,-0.18,-0.21,-1.41c0,-1.11,0.03,-1.14,0.09,-1.23c0.03,-0.03,0.48,-0.39,1.02,-0.75l0.99,-0.66l0,-2.37c0,-1.32,0,-2.37,-0.03,-2.37l-0.72,0.48c-0.69,0.48,-0.69,0.48,-0.87,0.48c-0.15,0,-0.18,0,-0.27,-0.06c-0.21,-0.15,-0.21,-0.18,-0.21,-1.41c0,-1.11,0.03,-1.14,0.09,-1.23c0.03,-0.03,0.48,-0.39,1.02,-0.75l0.99,-0.66l0,-2.25c0,-2.13,0,-2.28,0.06,-2.4c0.06,-0.12,0.12,-0.18,0.27,-0.24z\"\r\n    },\r\n    \"accidentals.nat\": {\r\n        \"w\": 5.411,\r\n        \"h\": 22.8,\r\n        \"d\": \"M0.204,-11.4c0.24,-0.06,0.78,0,0.99,0.15c0.03,0.03,0.03,0.48,0,2.61c-0.03,1.44,-0.03,2.61,-0.03,2.61c0,0.03,0.75,-0.09,1.68,-0.24c0.96,-0.18,1.71,-0.27,1.74,-0.27c0.15,0.03,0.27,0.15,0.36,0.3l0.06,0.12l0.09,8.67c0.09,6.96,0.12,8.67,0.09,8.67c-0.03,0.03,-0.12,0.06,-0.21,0.09c-0.24,0.09,-0.72,0.09,-0.96,0c-0.09,-0.03,-0.18,-0.06,-0.21,-0.09c-0.03,-0.03,-0.03,-0.48,0,-2.61c0.03,-1.44,0.03,-2.61,0.03,-2.61c0,-0.03,-0.75,0.09,-1.68,0.24c-0.96,0.18,-1.71,0.27,-1.74,0.27c-0.15,-0.03,-0.27,-0.15,-0.36,-0.3l-0.06,-0.15l-0.09,-7.53c-0.06,-4.14,-0.09,-8.04,-0.12,-8.67l0,-1.11l0.15,-0.06c0.09,-0.03,0.21,-0.06,0.27,-0.09zm3.75,8.4c0,-0.33,0,-0.42,-0.03,-0.42c-0.12,0,-2.79,0.45,-2.79,0.48c-0.03,0,-0.09,6.3,-0.09,6.33c0.03,0,2.79,-0.45,2.82,-0.48c0,0,0.09,-4.53,0.09,-5.91z\"\r\n    },\r\n    \"accidentals.flat\": {\r\n        \"w\": 6.75,\r\n        \"h\": 18.801,\r\n        \"d\": \"M-0.36,-14.07c0.33,-0.06,0.87,0,1.08,0.15c0.06,0.03,0.06,0.36,-0.03,5.25c-0.06,2.85,-0.09,5.19,-0.09,5.19c0,0.03,0.12,-0.03,0.24,-0.12c0.63,-0.42,1.41,-0.66,2.19,-0.72c0.81,-0.03,1.47,0.21,2.04,0.78c0.57,0.54,0.87,1.26,0.93,2.04c0.03,0.57,-0.09,1.08,-0.36,1.62c-0.42,0.81,-1.02,1.38,-2.82,2.61c-1.14,0.78,-1.44,1.02,-1.8,1.44c-0.18,0.18,-0.39,0.39,-0.45,0.42c-0.27,0.18,-0.57,0.15,-0.81,-0.06c-0.06,-0.09,-0.12,-0.18,-0.15,-0.27c-0.03,-0.06,-0.09,-3.27,-0.18,-8.34c-0.09,-4.53,-0.15,-8.58,-0.18,-9.03l0,-0.78l0.12,-0.06c0.06,-0.03,0.18,-0.09,0.27,-0.12zm3.18,11.01c-0.21,-0.12,-0.54,-0.15,-0.81,-0.06c-0.54,0.15,-0.99,0.63,-1.17,1.26c-0.06,0.3,-0.12,2.88,-0.06,3.87c0.03,0.42,0.03,0.81,0.06,0.9l0.03,0.12l0.45,-0.39c0.63,-0.54,1.26,-1.17,1.56,-1.59c0.3,-0.42,0.6,-0.99,0.72,-1.41c0.18,-0.69,0.09,-1.47,-0.18,-2.07c-0.15,-0.3,-0.33,-0.51,-0.6,-0.63z\"\r\n    },\r\n    \"accidentals.halfflat\": {\r\n        \"w\": 6.728,\r\n        \"h\": 18.801,\r\n        \"d\": \"M4.83,-14.07c0.33,-0.06,0.87,0,1.08,0.15c0.06,0.03,0.06,0.6,-0.12,9.06c-0.09,5.55,-0.15,9.06,-0.18,9.12c-0.03,0.09,-0.09,0.18,-0.15,0.27c-0.24,0.21,-0.54,0.24,-0.81,0.06c-0.06,-0.03,-0.27,-0.24,-0.45,-0.42c-0.36,-0.42,-0.66,-0.66,-1.8,-1.44c-1.23,-0.84,-1.83,-1.32,-2.25,-1.77c-0.66,-0.78,-0.96,-1.56,-0.93,-2.46c0.09,-1.41,1.11,-2.58,2.4,-2.79c0.3,-0.06,0.84,-0.03,1.23,0.06c0.54,0.12,1.08,0.33,1.53,0.63c0.12,0.09,0.24,0.15,0.24,0.12c0,0,-0.12,-8.37,-0.18,-9.75l0,-0.66l0.12,-0.06c0.06,-0.03,0.18,-0.09,0.27,-0.12zm-1.65,10.95c-0.6,-0.18,-1.08,0.09,-1.38,0.69c-0.27,0.6,-0.36,1.38,-0.18,2.07c0.12,0.42,0.42,0.99,0.72,1.41c0.3,0.42,0.93,1.05,1.56,1.59l0.48,0.39l0,-0.12c0.03,-0.09,0.03,-0.48,0.06,-0.9c0.03,-0.57,0.03,-1.08,0,-2.22c-0.03,-1.62,-0.03,-1.62,-0.24,-2.07c-0.21,-0.42,-0.6,-0.75,-1.02,-0.84z\"\r\n    },\r\n    \"accidentals.dblflat\": {\r\n        \"w\": 11.613,\r\n        \"h\": 18.804,\r\n        \"d\": \"M-0.36,-14.07c0.33,-0.06,0.87,0,1.08,0.15c0.06,0.03,0.06,0.33,-0.03,4.89c-0.06,2.67,-0.09,5.01,-0.09,5.22l0,0.36l0.15,-0.15c0.36,-0.3,0.75,-0.51,1.2,-0.63c0.33,-0.09,0.96,-0.09,1.26,-0.03c0.27,0.09,0.63,0.27,0.87,0.45l0.21,0.15l0,-0.27c0,-0.15,-0.03,-2.43,-0.09,-5.1c-0.09,-4.56,-0.09,-4.86,-0.03,-4.89c0.15,-0.12,0.39,-0.15,0.72,-0.15c0.3,0,0.54,0.03,0.69,0.15c0.06,0.03,0.06,0.33,-0.03,4.95c-0.06,2.7,-0.09,5.04,-0.09,5.22l0.03,0.3l0.21,-0.15c0.69,-0.48,1.44,-0.69,2.28,-0.69c0.51,0,0.78,0.03,1.2,0.21c1.32,0.63,2.01,2.28,1.53,3.69c-0.21,0.57,-0.51,1.02,-1.05,1.56c-0.42,0.42,-0.81,0.72,-1.92,1.5c-1.26,0.87,-1.5,1.08,-1.86,1.5c-0.39,0.45,-0.54,0.54,-0.81,0.51c-0.18,0,-0.21,0,-0.33,-0.06l-0.21,-0.21l-0.06,-0.12l-0.03,-0.99c-0.03,-0.54,-0.03,-1.29,-0.06,-1.68l0,-0.69l-0.21,0.24c-0.36,0.42,-0.75,0.75,-1.8,1.62c-1.02,0.84,-1.2,0.99,-1.44,1.38c-0.36,0.51,-0.54,0.6,-0.9,0.51c-0.15,-0.03,-0.39,-0.27,-0.42,-0.42c-0.03,-0.06,-0.09,-3.27,-0.18,-8.34c-0.09,-4.53,-0.15,-8.58,-0.18,-9.03l0,-0.78l0.12,-0.06c0.06,-0.03,0.18,-0.09,0.27,-0.12zm2.52,10.98c-0.18,-0.09,-0.48,-0.12,-0.66,-0.06c-0.39,0.15,-0.69,0.54,-0.84,1.14c-0.06,0.24,-0.06,0.39,-0.09,1.74c-0.03,1.44,0,2.73,0.06,3.18l0.03,0.15l0.27,-0.27c0.93,-0.96,1.5,-1.95,1.74,-3.06c0.06,-0.27,0.06,-0.39,0.06,-0.96c0,-0.54,0,-0.69,-0.06,-0.93c-0.09,-0.51,-0.27,-0.81,-0.51,-0.93zm5.43,0c-0.18,-0.09,-0.51,-0.12,-0.72,-0.06c-0.54,0.12,-0.96,0.63,-1.17,1.26c-0.06,0.3,-0.12,2.88,-0.06,3.9c0.03,0.42,0.03,0.81,0.06,0.9l0.03,0.12l0.36,-0.3c0.42,-0.36,1.02,-0.96,1.29,-1.29c0.36,-0.45,0.66,-0.99,0.81,-1.41c0.42,-1.23,0.15,-2.76,-0.6,-3.12z\"\r\n    },\r\n    \"accidentals.dblsharp\": {\r\n        \"w\": 7.961,\r\n        \"h\": 7.977,\r\n        \"d\": \"M-0.186,-3.96c0.06,-0.03,0.12,-0.06,0.15,-0.06c0.09,0,2.76,0.27,2.79,0.3c0.12,0.03,0.15,0.12,0.15,0.51c0.06,0.96,0.24,1.59,0.57,2.1c0.06,0.09,0.15,0.21,0.18,0.24l0.09,0.06l0.09,-0.06c0.03,-0.03,0.12,-0.15,0.18,-0.24c0.33,-0.51,0.51,-1.14,0.57,-2.1c0,-0.39,0.03,-0.45,0.12,-0.51c0.03,0,0.66,-0.09,1.44,-0.15c1.47,-0.15,1.5,-0.15,1.56,-0.03c0.03,0.06,0,0.42,-0.09,1.44c-0.09,0.72,-0.15,1.35,-0.15,1.38c0,0.03,-0.03,0.09,-0.06,0.12c-0.06,0.06,-0.12,0.09,-0.51,0.09c-1.08,0.06,-1.8,0.3,-2.28,0.75l-0.12,0.09l0.09,0.09c0.12,0.15,0.39,0.33,0.63,0.45c0.42,0.18,0.96,0.27,1.68,0.33c0.39,0,0.45,0.03,0.51,0.09c0.03,0.03,0.06,0.09,0.06,0.12c0,0.03,0.06,0.66,0.15,1.38c0.09,1.02,0.12,1.38,0.09,1.44c-0.06,0.12,-0.09,0.12,-1.56,-0.03c-0.78,-0.06,-1.41,-0.15,-1.44,-0.15c-0.09,-0.06,-0.12,-0.12,-0.12,-0.54c-0.06,-0.93,-0.24,-1.56,-0.57,-2.07c-0.06,-0.09,-0.15,-0.21,-0.18,-0.24l-0.09,-0.06l-0.09,0.06c-0.03,0.03,-0.12,0.15,-0.18,0.24c-0.33,0.51,-0.51,1.14,-0.57,2.07c0,0.42,-0.03,0.48,-0.12,0.54c-0.03,0,-0.66,0.09,-1.44,0.15c-1.47,0.15,-1.5,0.15,-1.56,0.03c-0.03,-0.06,0,-0.42,0.09,-1.44c0.09,-0.72,0.15,-1.35,0.15,-1.38c0,-0.03,0.03,-0.09,0.06,-0.12c0.06,-0.06,0.12,-0.09,0.51,-0.09c0.72,-0.06,1.26,-0.15,1.68,-0.33c0.24,-0.12,0.51,-0.3,0.63,-0.45l0.09,-0.09l-0.12,-0.09c-0.48,-0.45,-1.2,-0.69,-2.28,-0.75c-0.39,0,-0.45,-0.03,-0.51,-0.09c-0.03,-0.03,-0.06,-0.09,-0.06,-0.12c0,-0.03,-0.06,-0.63,-0.12,-1.38c-0.09,-0.72,-0.15,-1.35,-0.15,-1.38z\"\r\n    },\r\n    \"dots.dot\": {\r\n        \"w\": 3.45,\r\n        \"h\": 3.45,\r\n        \"d\": \"M1.32,-1.68c0.09,-0.03,0.27,-0.06,0.39,-0.06c0.96,0,1.74,0.78,1.74,1.71c0,0.96,-0.78,1.74,-1.71,1.74c-0.96,0,-1.74,-0.78,-1.74,-1.71c0,-0.78,0.54,-1.5,1.32,-1.68z\"\r\n    },\r\n    \"noteheads.dbl\": {\r\n        \"w\": 16.83,\r\n        \"h\": 8.145,\r\n        \"d\": \"M-0.69,-4.02c0.18,-0.09,0.36,-0.09,0.54,0c0.18,0.09,0.24,0.15,0.33,0.3c0.06,0.15,0.06,0.18,0.06,1.41l0,1.23l0.12,-0.18c0.72,-1.26,2.64,-2.31,4.86,-2.64c0.81,-0.15,1.11,-0.15,2.13,-0.15c0.99,0,1.29,0,2.1,0.15c0.75,0.12,1.38,0.27,2.04,0.54c1.35,0.51,2.34,1.26,2.82,2.1l0.12,0.18l0,-1.23c0,-1.2,0,-1.26,0.06,-1.38c0.09,-0.18,0.15,-0.24,0.33,-0.33c0.18,-0.09,0.36,-0.09,0.54,0c0.18,0.09,0.24,0.15,0.33,0.3l0.06,0.15l0,3.54l0,3.54l-0.06,0.15c-0.09,0.18,-0.15,0.24,-0.33,0.33c-0.18,0.09,-0.36,0.09,-0.54,0c-0.18,-0.09,-0.24,-0.15,-0.33,-0.33c-0.06,-0.12,-0.06,-0.18,-0.06,-1.38l0,-1.23l-0.12,0.18c-0.48,0.84,-1.47,1.59,-2.82,2.1c-0.84,0.33,-1.71,0.54,-2.85,0.66c-0.45,0.06,-2.16,0.06,-2.61,0c-1.14,-0.12,-2.01,-0.33,-2.85,-0.66c-1.35,-0.51,-2.34,-1.26,-2.82,-2.1l-0.12,-0.18l0,1.23c0,1.23,0,1.26,-0.06,1.38c-0.09,0.18,-0.15,0.24,-0.33,0.33c-0.18,0.09,-0.36,0.09,-0.54,0c-0.18,-0.09,-0.24,-0.15,-0.33,-0.33l-0.06,-0.15l0,-3.54c0,-3.48,0,-3.54,0.06,-3.66c0.09,-0.18,0.15,-0.24,0.33,-0.33zm7.71,0.63c-0.36,-0.06,-0.9,-0.06,-1.14,0c-0.3,0.03,-0.66,0.24,-0.87,0.42c-0.6,0.54,-0.9,1.62,-0.75,2.82c0.12,0.93,0.51,1.68,1.11,2.31c0.75,0.72,1.83,1.2,2.85,1.26c1.05,0.06,1.83,-0.54,2.1,-1.65c0.21,-0.9,0.12,-1.95,-0.24,-2.82c-0.36,-0.81,-1.08,-1.53,-1.95,-1.95c-0.3,-0.15,-0.78,-0.3,-1.11,-0.39z\"\r\n    },\r\n    \"noteheads.whole\": {\r\n        \"w\": 14.985,\r\n        \"h\": 8.097,\r\n        \"d\": \"M6.51,-4.05c0.51,-0.03,2.01,0,2.52,0.03c1.41,0.18,2.64,0.51,3.72,1.08c1.2,0.63,1.95,1.41,2.19,2.31c0.09,0.33,0.09,0.9,0,1.23c-0.24,0.9,-0.99,1.68,-2.19,2.31c-1.08,0.57,-2.28,0.9,-3.75,1.08c-0.66,0.06,-2.31,0.06,-2.97,0c-1.47,-0.18,-2.67,-0.51,-3.75,-1.08c-1.2,-0.63,-1.95,-1.41,-2.19,-2.31c-0.09,-0.33,-0.09,-0.9,0,-1.23c0.24,-0.9,0.99,-1.68,2.19,-2.31c1.2,-0.63,2.61,-0.99,4.23,-1.11zm0.57,0.66c-0.87,-0.15,-1.53,0,-2.04,0.51c-0.15,0.15,-0.24,0.27,-0.33,0.48c-0.24,0.51,-0.36,1.08,-0.33,1.77c0.03,0.69,0.18,1.26,0.42,1.77c0.6,1.17,1.74,1.98,3.18,2.22c1.11,0.21,1.95,-0.15,2.34,-0.99c0.24,-0.51,0.36,-1.08,0.33,-1.8c-0.06,-1.11,-0.45,-2.04,-1.17,-2.76c-0.63,-0.63,-1.47,-1.05,-2.4,-1.2z\"\r\n    },\r\n    \"noteheads.half\": {\r\n        \"w\": 10.37,\r\n        \"h\": 8.132,\r\n        \"d\": \"M7.44,-4.05c0.06,-0.03,0.27,-0.03,0.48,-0.03c1.05,0,1.71,0.24,2.1,0.81c0.42,0.6,0.45,1.35,0.18,2.4c-0.42,1.59,-1.14,2.73,-2.16,3.39c-1.41,0.93,-3.18,1.44,-5.4,1.53c-1.17,0.03,-1.89,-0.21,-2.28,-0.81c-0.42,-0.6,-0.45,-1.35,-0.18,-2.4c0.42,-1.59,1.14,-2.73,2.16,-3.39c0.63,-0.42,1.23,-0.72,1.98,-0.96c0.9,-0.3,1.65,-0.42,3.12,-0.54zm1.29,0.87c-0.27,-0.09,-0.63,-0.12,-0.9,-0.03c-0.72,0.24,-1.53,0.69,-3.27,1.8c-2.34,1.5,-3.3,2.25,-3.57,2.79c-0.36,0.72,-0.06,1.5,0.66,1.77c0.24,0.12,0.69,0.09,0.99,0c0.84,-0.3,1.92,-0.93,4.14,-2.37c1.62,-1.08,2.37,-1.71,2.61,-2.19c0.36,-0.72,0.06,-1.5,-0.66,-1.77z\"\r\n    },\r\n    \"noteheads.quarter\": {\r\n        \"w\": 9.81,\r\n        \"h\": 8.094,\r\n        \"d\": \"M6.09,-4.05c0.36,-0.03,1.2,0,1.53,0.06c1.17,0.24,1.89,0.84,2.16,1.83c0.06,0.18,0.06,0.3,0.06,0.66c0,0.45,0,0.63,-0.15,1.08c-0.66,2.04,-3.06,3.93,-5.52,4.38c-0.54,0.09,-1.44,0.09,-1.83,0.03c-1.23,-0.27,-1.98,-0.87,-2.25,-1.86c-0.06,-0.18,-0.06,-0.3,-0.06,-0.66c0,-0.45,0,-0.63,0.15,-1.08c0.24,-0.78,0.75,-1.53,1.44,-2.22c1.2,-1.2,2.85,-2.01,4.47,-2.22z\"\r\n    },\r\n    \"scripts.ufermata\": {\r\n        \"w\": 19.748,\r\n        \"h\": 11.289,\r\n        \"d\": \"M-0.75,-10.77c0.12,0,0.45,-0.03,0.69,-0.03c2.91,-0.03,5.55,1.53,7.41,4.35c1.17,1.71,1.95,3.72,2.43,6.03c0.12,0.51,0.12,0.57,0.03,0.69c-0.12,0.21,-0.48,0.27,-0.69,0.12c-0.12,-0.09,-0.18,-0.24,-0.27,-0.69c-0.78,-3.63,-3.42,-6.54,-6.78,-7.38c-0.78,-0.21,-1.2,-0.24,-2.07,-0.24c-0.63,0,-0.84,0,-1.2,0.06c-1.83,0.27,-3.42,1.08,-4.8,2.37c-1.41,1.35,-2.4,3.21,-2.85,5.19c-0.09,0.45,-0.15,0.6,-0.27,0.69c-0.21,0.15,-0.57,0.09,-0.69,-0.12c-0.09,-0.12,-0.09,-0.18,0.03,-0.69c0.33,-1.62,0.78,-3,1.47,-4.38c1.77,-3.54,4.44,-5.67,7.56,-5.97zm0.33,7.47c1.38,-0.3,2.58,0.9,2.31,2.25c-0.15,0.72,-0.78,1.35,-1.47,1.5c-1.38,0.27,-2.58,-0.93,-2.31,-2.31c0.15,-0.69,0.78,-1.29,1.47,-1.44z\"\r\n    },\r\n    \"scripts.dfermata\": {\r\n        \"w\": 19.744,\r\n        \"h\": 11.274,\r\n        \"d\": \"M-9.63,-0.42c0.15,-0.09,0.36,-0.06,0.51,0.03c0.12,0.09,0.18,0.24,0.27,0.66c0.78,3.66,3.42,6.57,6.78,7.41c0.78,0.21,1.2,0.24,2.07,0.24c0.63,0,0.84,0,1.2,-0.06c1.83,-0.27,3.42,-1.08,4.8,-2.37c1.41,-1.35,2.4,-3.21,2.85,-5.22c0.09,-0.42,0.15,-0.57,0.27,-0.66c0.21,-0.15,0.57,-0.09,0.69,0.12c0.09,0.12,0.09,0.18,-0.03,0.69c-0.33,1.62,-0.78,3,-1.47,4.38c-1.92,3.84,-4.89,6,-8.31,6c-3.42,0,-6.39,-2.16,-8.31,-6c-0.48,-0.96,-0.84,-1.92,-1.14,-2.97c-0.18,-0.69,-0.42,-1.74,-0.42,-1.92c0,-0.12,0.09,-0.27,0.24,-0.33zm9.21,0c1.2,-0.27,2.34,0.63,2.34,1.86c0,0.9,-0.66,1.68,-1.5,1.89c-1.38,0.27,-2.58,-0.93,-2.31,-2.31c0.15,-0.69,0.78,-1.29,1.47,-1.44z\"\r\n    },\r\n    \"scripts.sforzato\": {\r\n        \"w\": 13.5,\r\n        \"h\": 7.5,\r\n        \"d\": \"M-6.45,-3.69c0.06,-0.03,0.15,-0.06,0.18,-0.06c0.06,0,2.85,0.72,6.24,1.59l6.33,1.65c0.33,0.06,0.45,0.21,0.45,0.51c0,0.3,-0.12,0.45,-0.45,0.51l-6.33,1.65c-3.39,0.87,-6.18,1.59,-6.21,1.59c-0.21,0,-0.48,-0.24,-0.51,-0.45c0,-0.15,0.06,-0.36,0.18,-0.45c0.09,-0.06,0.87,-0.27,3.84,-1.05c2.04,-0.54,3.84,-0.99,4.02,-1.02c0.15,-0.06,1.14,-0.24,2.22,-0.42c1.05,-0.18,1.92,-0.36,1.92,-0.36c0,0,-0.87,-0.18,-1.92,-0.36c-1.08,-0.18,-2.07,-0.36,-2.22,-0.42c-0.18,-0.03,-1.98,-0.48,-4.02,-1.02c-2.97,-0.78,-3.75,-0.99,-3.84,-1.05c-0.12,-0.09,-0.18,-0.3,-0.18,-0.45c0.03,-0.15,0.15,-0.3,0.3,-0.39z\"\r\n    },\r\n    \"scripts.staccato\": {\r\n        \"w\": 2.989,\r\n        \"h\": 3.004,\r\n        \"d\": \"M-0.36,-1.47c0.93,-0.21,1.86,0.51,1.86,1.47c0,0.93,-0.87,1.65,-1.8,1.47c-0.54,-0.12,-1.02,-0.57,-1.14,-1.08c-0.21,-0.81,0.27,-1.65,1.08,-1.86z\"\r\n    },\r\n    \"scripts.tenuto\": {\r\n        \"w\": 8.985,\r\n        \"h\": 1.08,\r\n        \"d\": \"M-4.2,-0.48l0.12,-0.06l4.08,0l4.08,0l0.12,0.06c0.39,0.21,0.39,0.75,0,0.96l-0.12,0.06l-4.08,0l-4.08,0l-0.12,-0.06c-0.39,-0.21,-0.39,-0.75,0,-0.96z\"\r\n    },\r\n    \"scripts.umarcato\": {\r\n        \"w\": 7.5,\r\n        \"h\": 8.245,\r\n        \"d\": \"M-0.15,-8.19c0.15,-0.12,0.36,-0.03,0.45,0.15c0.21,0.42,3.45,7.65,3.45,7.71c0,0.12,-0.12,0.27,-0.21,0.3c-0.03,0.03,-0.51,0.03,-1.14,0.03c-1.05,0,-1.08,0,-1.17,-0.06c-0.09,-0.06,-0.24,-0.36,-1.17,-2.4c-0.57,-1.29,-1.05,-2.34,-1.08,-2.34c0,-0.03,-0.51,1.02,-1.08,2.34c-0.93,2.07,-1.08,2.34,-1.14,2.4c-0.06,0.03,-0.15,0.06,-0.18,0.06c-0.15,0,-0.33,-0.18,-0.33,-0.33c0,-0.06,3.24,-7.32,3.45,-7.71c0.03,-0.06,0.09,-0.15,0.15,-0.15z\"\r\n    },\r\n    \"scripts.dmarcato\": {\r\n        \"w\": 7.5,\r\n        \"h\": 8.25,\r\n        \"d\": \"M-3.57,0.03c0.03,0,0.57,-0.03,1.17,-0.03c1.05,0,1.08,0,1.17,0.06c0.09,0.06,0.24,0.36,1.17,2.4c0.57,1.29,1.05,2.34,1.08,2.34c0,0.03,0.51,-1.02,1.08,-2.34c0.93,-2.07,1.08,-2.34,1.14,-2.4c0.06,-0.03,0.15,-0.06,0.18,-0.06c0.15,0,0.33,0.18,0.33,0.33c0,0.09,-3.45,7.74,-3.54,7.83c-0.12,0.12,-0.3,0.12,-0.42,0c-0.09,-0.09,-3.54,-7.74,-3.54,-7.83c0,-0.09,0.12,-0.27,0.18,-0.3z\"\r\n    },\r\n    \"scripts.stopped\": {\r\n        \"w\": 8.295,\r\n        \"h\": 8.295,\r\n        \"d\": \"M-0.27,-4.08c0.18,-0.09,0.36,-0.09,0.54,0c0.18,0.09,0.24,0.15,0.33,0.3l0.06,0.15l0,1.5l0,1.47l1.47,0l1.5,0l0.15,0.06c0.15,0.09,0.21,0.15,0.3,0.33c0.09,0.18,0.09,0.36,0,0.54c-0.09,0.18,-0.15,0.24,-0.33,0.33c-0.12,0.06,-0.18,0.06,-1.62,0.06l-1.47,0l0,1.47l0,1.47l-0.06,0.15c-0.09,0.18,-0.15,0.24,-0.33,0.33c-0.18,0.09,-0.36,0.09,-0.54,0c-0.18,-0.09,-0.24,-0.15,-0.33,-0.33l-0.06,-0.15l0,-1.47l0,-1.47l-1.47,0c-1.44,0,-1.5,0,-1.62,-0.06c-0.18,-0.09,-0.24,-0.15,-0.33,-0.33c-0.09,-0.18,-0.09,-0.36,0,-0.54c0.09,-0.18,0.15,-0.24,0.33,-0.33l0.15,-0.06l1.47,0l1.47,0l0,-1.47c0,-1.44,0,-1.5,0.06,-1.62c0.09,-0.18,0.15,-0.24,0.33,-0.33z\"\r\n    },\r\n    \"scripts.upbow\": {\r\n        \"w\": 9.73,\r\n        \"h\": 15.608,\r\n        \"d\": \"M-4.65,-15.54c0.12,-0.09,0.36,-0.06,0.48,0.03c0.03,0.03,0.09,0.09,0.12,0.15c0.03,0.06,0.66,2.13,1.41,4.62c1.35,4.41,1.38,4.56,2.01,6.96l0.63,2.46l0.63,-2.46c0.63,-2.4,0.66,-2.55,2.01,-6.96c0.75,-2.49,1.38,-4.56,1.41,-4.62c0.06,-0.15,0.18,-0.21,0.36,-0.24c0.15,0,0.3,0.06,0.39,0.18c0.15,0.21,0.24,-0.18,-2.1,7.56c-1.2,3.96,-2.22,7.32,-2.25,7.41c0,0.12,-0.06,0.27,-0.09,0.3c-0.12,0.21,-0.6,0.21,-0.72,0c-0.03,-0.03,-0.09,-0.18,-0.09,-0.3c-0.03,-0.09,-1.05,-3.45,-2.25,-7.41c-2.34,-7.74,-2.25,-7.35,-2.1,-7.56c0.03,-0.03,0.09,-0.09,0.15,-0.12z\"\r\n    },\r\n    \"scripts.downbow\": {\r\n        \"w\": 11.22,\r\n        \"h\": 9.992,\r\n        \"d\": \"M-5.55,-9.93l0.09,-0.06l5.46,0l5.46,0l0.09,0.06l0.06,0.09l0,4.77c0,5.28,0,4.89,-0.18,5.01c-0.18,0.12,-0.42,0.06,-0.54,-0.12c-0.06,-0.09,-0.06,-0.18,-0.06,-2.97l0,-2.85l-4.83,0l-4.83,0l0,2.85c0,2.79,0,2.88,-0.06,2.97c-0.15,0.24,-0.51,0.24,-0.66,0c-0.06,-0.09,-0.06,-0.21,-0.06,-4.89l0,-4.77z\"\r\n    },\r\n    \"scripts.turn\": {\r\n        \"w\": 16.366,\r\n        \"h\": 7.893,\r\n        \"d\": \"M-4.77,-3.9c0.36,-0.06,1.05,-0.06,1.44,0.03c0.78,0.15,1.5,0.51,2.34,1.14c0.6,0.45,1.05,0.87,2.22,2.01c1.11,1.08,1.62,1.5,2.22,1.86c0.6,0.36,1.32,0.57,1.92,0.57c0.9,0,1.71,-0.57,1.89,-1.35c0.24,-0.93,-0.39,-1.89,-1.35,-2.1l-0.15,-0.06l-0.09,0.15c-0.03,0.09,-0.15,0.24,-0.24,0.33c-0.72,0.72,-2.04,0.54,-2.49,-0.36c-0.48,-0.93,0.03,-1.86,1.17,-2.19c0.3,-0.09,1.02,-0.09,1.35,0c0.99,0.27,1.74,0.87,2.25,1.83c0.69,1.41,0.63,3,-0.21,4.26c-0.21,0.3,-0.69,0.81,-0.99,1.02c-0.3,0.21,-0.84,0.45,-1.17,0.54c-1.23,0.36,-2.49,0.15,-3.72,-0.6c-0.75,-0.48,-1.41,-1.02,-2.85,-2.46c-1.11,-1.08,-1.62,-1.5,-2.22,-1.86c-0.6,-0.36,-1.32,-0.57,-1.92,-0.57c-0.9,0,-1.71,0.57,-1.89,1.35c-0.24,0.93,0.39,1.89,1.35,2.1l0.15,0.06l0.09,-0.15c0.03,-0.09,0.15,-0.24,0.24,-0.33c0.72,-0.72,2.04,-0.54,2.49,0.36c0.48,0.93,-0.03,1.86,-1.17,2.19c-0.3,0.09,-1.02,0.09,-1.35,0c-0.99,-0.27,-1.74,-0.87,-2.25,-1.83c-0.69,-1.41,-0.63,-3,0.21,-4.26c0.21,-0.3,0.69,-0.81,0.99,-1.02c0.48,-0.33,1.11,-0.57,1.74,-0.66z\"\r\n    },\r\n    \"scripts.trill\": {\r\n        \"w\": 17.963,\r\n        \"h\": 16.49,\r\n        \"d\": \"M-0.51,-16.02c0.12,-0.09,0.21,-0.18,0.21,-0.18l-0.81,4.02l-0.81,4.02c0.03,0,0.51,-0.27,1.08,-0.6c0.6,-0.3,1.14,-0.63,1.26,-0.66c1.14,-0.54,2.31,-0.6,3.09,-0.18c0.27,0.15,0.54,0.36,0.6,0.51l0.06,0.12l0.21,-0.21c0.9,-0.81,2.22,-0.99,3.12,-0.42c0.6,0.42,0.9,1.14,0.78,2.07c-0.15,1.29,-1.05,2.31,-1.95,2.25c-0.48,-0.03,-0.78,-0.3,-0.96,-0.81c-0.09,-0.27,-0.09,-0.9,-0.03,-1.2c0.21,-0.75,0.81,-1.23,1.59,-1.32l0.24,-0.03l-0.09,-0.12c-0.51,-0.66,-1.62,-0.63,-2.31,0.03c-0.39,0.42,-0.3,0.09,-1.23,4.77l-0.81,4.14c-0.03,0,-0.12,-0.03,-0.21,-0.09c-0.33,-0.15,-0.54,-0.18,-0.99,-0.18c-0.42,0,-0.66,0.03,-1.05,0.18c-0.12,0.06,-0.21,0.09,-0.21,0.09c0,-0.03,0.36,-1.86,0.81,-4.11c0.9,-4.47,0.87,-4.26,0.69,-4.53c-0.21,-0.36,-0.66,-0.51,-1.17,-0.36c-0.15,0.06,-2.22,1.14,-2.58,1.38c-0.12,0.09,-0.12,0.09,-0.21,0.6l-0.09,0.51l0.21,0.24c0.63,0.75,1.02,1.47,1.2,2.19c0.06,0.27,0.06,0.36,0.06,0.81c0,0.42,0,0.54,-0.06,0.78c-0.15,0.54,-0.33,0.93,-0.63,1.35c-0.18,0.24,-0.57,0.63,-0.81,0.78c-0.24,0.15,-0.63,0.36,-0.84,0.42c-0.27,0.06,-0.66,0.06,-0.87,0.03c-0.81,-0.18,-1.32,-1.05,-1.38,-2.46c-0.03,-0.6,0.03,-0.99,0.33,-2.46c0.21,-1.08,0.24,-1.32,0.21,-1.29c-1.2,0.48,-2.4,0.75,-3.21,0.72c-0.69,-0.06,-1.17,-0.3,-1.41,-0.72c-0.39,-0.75,-0.12,-1.8,0.66,-2.46c0.24,-0.18,0.69,-0.42,1.02,-0.51c0.69,-0.18,1.53,-0.15,2.31,0.09c0.3,0.09,0.75,0.3,0.99,0.45c0.12,0.09,0.15,0.09,0.15,0.03c0.03,-0.03,0.33,-1.59,0.72,-3.45c0.36,-1.86,0.66,-3.42,0.69,-3.45c0,-0.03,0.03,-0.03,0.21,0.03c0.21,0.06,0.27,0.06,0.48,0.06c0.42,-0.03,0.78,-0.18,1.26,-0.48c0.15,-0.12,0.36,-0.27,0.48,-0.39zm-5.73,7.68c-0.27,-0.03,-0.96,-0.06,-1.2,-0.03c-0.81,0.12,-1.35,0.57,-1.5,1.2c-0.18,0.66,0.12,1.14,0.75,1.29c0.66,0.12,1.92,-0.12,3.18,-0.66l0.33,-0.15l0.09,-0.39c0.06,-0.21,0.09,-0.42,0.09,-0.45c0,-0.03,-0.45,-0.3,-0.75,-0.45c-0.27,-0.15,-0.66,-0.27,-0.99,-0.36zm4.29,3.63c-0.24,-0.39,-0.51,-0.75,-0.51,-0.69c-0.06,0.12,-0.39,1.92,-0.45,2.28c-0.09,0.54,-0.12,1.14,-0.06,1.38c0.06,0.42,0.21,0.6,0.51,0.57c0.39,-0.06,0.75,-0.48,0.93,-1.14c0.09,-0.33,0.09,-1.05,0,-1.38c-0.09,-0.39,-0.24,-0.69,-0.42,-1.02z\"\r\n    },\r\n    \"scripts.segno\": {\r\n        \"w\": 15,\r\n        \"h\": 22.504,\r\n        \"d\": \"M-3.72,-11.22c0.78,-0.09,1.59,0.03,2.31,0.42c1.2,0.6,2.01,1.71,2.31,3.09c0.09,0.42,0.09,1.2,0.03,1.5c-0.15,0.45,-0.39,0.81,-0.66,0.93c-0.33,0.18,-0.84,0.21,-1.23,0.15c-0.81,-0.18,-1.32,-0.93,-1.26,-1.89c0.03,-0.36,0.09,-0.57,0.24,-0.9c0.15,-0.33,0.45,-0.6,0.72,-0.75c0.12,-0.06,0.18,-0.09,0.18,-0.12c0,-0.03,-0.03,-0.15,-0.09,-0.24c-0.18,-0.45,-0.54,-0.87,-0.96,-1.08c-1.11,-0.57,-2.34,-0.18,-2.88,0.9c-0.24,0.51,-0.33,1.11,-0.24,1.83c0.27,1.92,1.5,3.54,3.93,5.13c0.48,0.33,1.26,0.78,1.29,0.78c0.03,0,1.35,-2.19,2.94,-4.89l2.88,-4.89l0.84,0l0.87,0l-0.03,0.06c-0.15,0.21,-6.15,10.41,-6.15,10.44c0,0,0.21,0.15,0.48,0.27c2.61,1.47,4.35,3.03,5.13,4.65c1.14,2.34,0.51,5.07,-1.44,6.39c-0.66,0.42,-1.32,0.63,-2.13,0.69c-2.01,0.09,-3.81,-1.41,-4.26,-3.54c-0.09,-0.42,-0.09,-1.2,-0.03,-1.5c0.15,-0.45,0.39,-0.81,0.66,-0.93c0.33,-0.18,0.84,-0.21,1.23,-0.15c0.81,0.18,1.32,0.93,1.26,1.89c-0.03,0.36,-0.09,0.57,-0.24,0.9c-0.15,0.33,-0.45,0.6,-0.72,0.75c-0.12,0.06,-0.18,0.09,-0.18,0.12c0,0.03,0.03,0.15,0.09,0.24c0.18,0.45,0.54,0.87,0.96,1.08c1.11,0.57,2.34,0.18,2.88,-0.9c0.24,-0.51,0.33,-1.11,0.24,-1.83c-0.27,-1.92,-1.5,-3.54,-3.93,-5.13c-0.48,-0.33,-1.26,-0.78,-1.29,-0.78c-0.03,0,-1.35,2.19,-2.91,4.89l-2.88,4.89l-0.87,0l-0.87,0l0.03,-0.06c0.15,-0.21,6.15,-10.41,6.15,-10.44c0,0,-0.21,-0.15,-0.48,-0.3c-2.61,-1.44,-4.35,-3,-5.13,-4.62c-0.9,-1.89,-0.72,-4.02,0.48,-5.52c0.69,-0.84,1.68,-1.41,2.73,-1.53zm8.76,9.09c0.03,-0.03,0.15,-0.03,0.27,-0.03c0.33,0.03,0.57,0.18,0.72,0.48c0.09,0.18,0.09,0.57,0,0.75c-0.09,0.18,-0.21,0.3,-0.36,0.39c-0.15,0.06,-0.21,0.06,-0.39,0.06c-0.21,0,-0.27,0,-0.39,-0.06c-0.3,-0.15,-0.48,-0.45,-0.48,-0.75c0,-0.39,0.24,-0.72,0.63,-0.84zm-10.53,2.61c0.03,-0.03,0.15,-0.03,0.27,-0.03c0.33,0.03,0.57,0.18,0.72,0.48c0.09,0.18,0.09,0.57,0,0.75c-0.09,0.18,-0.21,0.3,-0.36,0.39c-0.15,0.06,-0.21,0.06,-0.39,0.06c-0.21,0,-0.27,0,-0.39,-0.06c-0.3,-0.15,-0.48,-0.45,-0.48,-0.75c0,-0.39,0.24,-0.72,0.63,-0.84z\"\r\n    },\r\n    \"scripts.coda\": {\r\n        \"w\": 16.035,\r\n        \"h\": 21.062,\r\n        \"d\": \"M-0.21,-10.47c0.18,-0.12,0.42,-0.06,0.54,0.12c0.06,0.09,0.06,0.18,0.06,1.5l0,1.38l0.18,0c0.39,0.06,0.96,0.24,1.38,0.48c1.68,0.93,2.82,3.24,3.03,6.12c0.03,0.24,0.03,0.45,0.03,0.45c0,0.03,0.6,0.03,1.35,0.03c1.5,0,1.47,0,1.59,0.18c0.09,0.12,0.09,0.3,0,0.42c-0.12,0.18,-0.09,0.18,-1.59,0.18c-0.75,0,-1.35,0,-1.35,0.03c0,0,0,0.21,-0.03,0.42c-0.24,3.15,-1.53,5.58,-3.45,6.36c-0.27,0.12,-0.72,0.24,-0.96,0.27l-0.18,0l0,1.38c0,1.32,0,1.41,-0.06,1.5c-0.15,0.24,-0.51,0.24,-0.66,0c-0.06,-0.09,-0.06,-0.18,-0.06,-1.5l0,-1.38l-0.18,0c-0.39,-0.06,-0.96,-0.24,-1.38,-0.48c-1.68,-0.93,-2.82,-3.24,-3.03,-6.15c-0.03,-0.21,-0.03,-0.42,-0.03,-0.42c0,-0.03,-0.6,-0.03,-1.35,-0.03c-1.5,0,-1.47,0,-1.59,-0.18c-0.09,-0.12,-0.09,-0.3,0,-0.42c0.12,-0.18,0.09,-0.18,1.59,-0.18c0.75,0,1.35,0,1.35,-0.03c0,0,0,-0.21,0.03,-0.45c0.24,-3.12,1.53,-5.55,3.45,-6.33c0.27,-0.12,0.72,-0.24,0.96,-0.27l0.18,0l0,-1.38c0,-1.53,0,-1.5,0.18,-1.62zm-0.18,6.93c0,-2.97,0,-3.15,-0.06,-3.15c-0.09,0,-0.51,0.15,-0.66,0.21c-0.87,0.51,-1.38,1.62,-1.56,3.51c-0.06,0.54,-0.12,1.59,-0.12,2.16l0,0.42l1.2,0l1.2,0l0,-3.15zm1.17,-3.06c-0.09,-0.03,-0.21,-0.06,-0.27,-0.09l-0.12,0l0,3.15l0,3.15l1.2,0l1.2,0l0,-0.81c-0.06,-2.4,-0.33,-3.69,-0.93,-4.59c-0.27,-0.39,-0.66,-0.69,-1.08,-0.81zm-1.17,10.14l0,-3.15l-1.2,0l-1.2,0l0,0.81c0.03,0.96,0.06,1.47,0.15,2.13c0.24,2.04,0.96,3.12,2.13,3.36l0.12,0l0,-3.15zm3.18,-2.34l0,-0.81l-1.2,0l-1.2,0l0,3.15l0,3.15l0.12,0c1.17,-0.24,1.89,-1.32,2.13,-3.36c0.09,-0.66,0.12,-1.17,0.15,-2.13z\"\r\n    },\r\n    \"scripts.comma\": {\r\n        \"w\": 3.042,\r\n        \"h\": 9.237,\r\n        \"d\": \"M1.14,-4.62c0.3,-0.12,0.69,-0.03,0.93,0.15c0.12,0.12,0.36,0.45,0.51,0.78c0.9,1.77,0.54,4.05,-1.08,6.75c-0.36,0.63,-0.87,1.38,-0.96,1.44c-0.18,0.12,-0.42,0.06,-0.54,-0.12c-0.09,-0.18,-0.09,-0.3,0.12,-0.6c0.96,-1.44,1.44,-2.97,1.38,-4.35c-0.06,-0.93,-0.3,-1.68,-0.78,-2.46c-0.27,-0.39,-0.33,-0.63,-0.24,-0.96c0.09,-0.27,0.36,-0.54,0.66,-0.63z\"\r\n    },\r\n    \"scripts.roll\": {\r\n        \"w\": 10.817,\r\n        \"h\": 6.125,\r\n        \"d\": \"M1.95,-6c0.21,-0.09,0.36,-0.09,0.57,0c0.39,0.15,0.63,0.39,1.47,1.35c0.66,0.75,0.78,0.87,1.08,1.05c0.75,0.45,1.65,0.42,2.4,-0.06c0.12,-0.09,0.27,-0.27,0.54,-0.6c0.42,-0.54,0.51,-0.63,0.69,-0.63c0.09,0,0.3,0.12,0.36,0.21c0.09,0.12,0.12,0.3,0.03,0.42c-0.06,0.12,-3.15,3.9,-3.3,4.08c-0.06,0.06,-0.18,0.12,-0.27,0.18c-0.27,0.12,-0.6,0.06,-0.99,-0.27c-0.27,-0.21,-0.42,-0.39,-1.08,-1.14c-0.63,-0.72,-0.81,-0.9,-1.17,-1.08c-0.36,-0.18,-0.57,-0.21,-0.99,-0.21c-0.39,0,-0.63,0.03,-0.93,0.18c-0.36,0.15,-0.51,0.27,-0.9,0.81c-0.24,0.27,-0.45,0.51,-0.48,0.54c-0.12,0.09,-0.27,0.06,-0.39,0c-0.24,-0.15,-0.33,-0.39,-0.21,-0.6c0.09,-0.12,3.18,-3.87,3.33,-4.02c0.06,-0.06,0.18,-0.15,0.24,-0.21z\"\r\n    },\r\n    \"scripts.prall\": {\r\n        \"w\": 15.011,\r\n        \"h\": 7.5,\r\n        \"d\": \"M-4.38,-3.69c0.06,-0.03,0.18,-0.06,0.24,-0.06c0.3,0,0.27,-0.03,1.89,1.95l1.53,1.83c0.03,0,0.57,-0.84,1.23,-1.83c1.14,-1.68,1.23,-1.83,1.35,-1.89c0.06,-0.03,0.18,-0.06,0.24,-0.06c0.3,0,0.27,-0.03,1.89,1.95l1.53,1.83l0.48,-0.69c0.51,-0.78,0.54,-0.84,0.69,-0.9c0.42,-0.18,0.87,0.15,0.81,0.6c-0.03,0.12,-0.3,0.51,-1.5,2.37c-1.38,2.07,-1.5,2.22,-1.62,2.28c-0.06,0.03,-0.18,0.06,-0.24,0.06c-0.3,0,-0.27,0.03,-1.89,-1.95l-1.53,-1.83c-0.03,0,-0.57,0.84,-1.23,1.83c-1.14,1.68,-1.23,1.83,-1.35,1.89c-0.06,0.03,-0.18,0.06,-0.24,0.06c-0.3,0,-0.27,0.03,-1.89,-1.95l-1.53,-1.83l-0.48,0.69c-0.51,0.78,-0.54,0.84,-0.69,0.9c-0.42,0.18,-0.87,-0.15,-0.81,-0.6c0.03,-0.12,0.3,-0.51,1.5,-2.37c1.38,-2.07,1.5,-2.22,1.62,-2.28z\"\r\n    },\r\n    \"scripts.mordent\": {\r\n        \"w\": 15.011,\r\n        \"h\": 10.012,\r\n        \"d\": \"M-0.21,-4.95c0.27,-0.15,0.63,0,0.75,0.27c0.06,0.12,0.06,0.24,0.06,1.44l0,1.29l0.57,-0.84c0.51,-0.75,0.57,-0.84,0.69,-0.9c0.06,-0.03,0.18,-0.06,0.24,-0.06c0.3,0,0.27,-0.03,1.89,1.95l1.53,1.83l0.48,-0.69c0.51,-0.78,0.54,-0.84,0.69,-0.9c0.42,-0.18,0.87,0.15,0.81,0.6c-0.03,0.12,-0.3,0.51,-1.5,2.37c-1.38,2.07,-1.5,2.22,-1.62,2.28c-0.06,0.03,-0.18,0.06,-0.24,0.06c-0.3,0,-0.27,0.03,-1.83,-1.89c-0.81,-0.99,-1.5,-1.8,-1.53,-1.86c-0.06,-0.03,-0.06,-0.03,-0.12,0.03c-0.06,0.06,-0.06,0.15,-0.06,2.28c0,1.95,0,2.25,-0.06,2.34c-0.18,0.45,-0.81,0.48,-1.05,0.03c-0.03,-0.06,-0.06,-0.24,-0.06,-1.41l0,-1.35l-0.57,0.84c-0.54,0.78,-0.6,0.87,-0.72,0.93c-0.06,0.03,-0.18,0.06,-0.24,0.06c-0.3,0,-0.27,0.03,-1.89,-1.95l-1.53,-1.83l-0.48,0.69c-0.51,0.78,-0.54,0.84,-0.69,0.9c-0.42,0.18,-0.87,-0.15,-0.81,-0.6c0.03,-0.12,0.3,-0.51,1.5,-2.37c1.38,-2.07,1.5,-2.22,1.62,-2.28c0.06,-0.03,0.18,-0.06,0.24,-0.06c0.3,0,0.27,-0.03,1.89,1.95l1.53,1.83c0.03,0,0.06,-0.06,0.09,-0.09c0.06,-0.12,0.06,-0.15,0.06,-2.28c0,-1.92,0,-2.22,0.06,-2.31c0.06,-0.15,0.15,-0.24,0.3,-0.3z\"\r\n    },\r\n    \"flags.u8th\": {\r\n        \"w\": 6.692,\r\n        \"h\": 22.59,\r\n        \"d\": \"M-0.42,3.75l0,-3.75l0.21,0l0.21,0l0,0.18c0,0.3,0.06,0.84,0.12,1.23c0.24,1.53,0.9,3.12,2.13,5.16l0.99,1.59c0.87,1.44,1.38,2.34,1.77,3.09c0.81,1.68,1.2,3.06,1.26,4.53c0.03,1.53,-0.21,3.27,-0.75,5.01c-0.21,0.69,-0.51,1.5,-0.6,1.59c-0.09,0.12,-0.27,0.21,-0.42,0.21c-0.15,0,-0.42,-0.12,-0.51,-0.21c-0.15,-0.18,-0.18,-0.42,-0.09,-0.66c0.15,-0.33,0.45,-1.2,0.57,-1.62c0.42,-1.38,0.6,-2.58,0.6,-3.9c0,-0.66,0,-0.81,-0.06,-1.11c-0.39,-2.07,-1.8,-4.26,-4.59,-7.14l-0.42,-0.45l-0.21,0l-0.21,0l0,-3.75z\"\r\n    },\r\n    \"flags.u16th\": {\r\n        \"w\": 6.693,\r\n        \"h\": 26.337,\r\n        \"d\": \"M-0.42,7.5l0,-7.5l0.21,0l0.21,0l0,0.39c0.06,1.08,0.39,2.19,0.99,3.39c0.45,0.9,0.87,1.59,1.95,3.12c1.29,1.86,1.77,2.64,2.22,3.57c0.45,0.93,0.72,1.8,0.87,2.64c0.06,0.51,0.06,1.5,0,1.92c-0.12,0.6,-0.3,1.2,-0.54,1.71l-0.09,0.24l0.18,0.45c0.51,1.2,0.72,2.22,0.69,3.42c-0.06,1.53,-0.39,3.03,-0.99,4.53c-0.3,0.75,-0.36,0.81,-0.57,0.9c-0.15,0.09,-0.33,0.06,-0.48,0c-0.18,-0.09,-0.27,-0.18,-0.33,-0.33c-0.09,-0.18,-0.06,-0.3,0.12,-0.75c0.66,-1.41,1.02,-2.88,1.08,-4.32c0,-0.6,-0.03,-1.05,-0.18,-1.59c-0.3,-1.2,-0.99,-2.4,-2.25,-3.87c-0.42,-0.48,-1.53,-1.62,-2.19,-2.22l-0.45,-0.42l-0.03,1.11l0,1.11l-0.21,0l-0.21,0l0,-7.5zm1.65,0.09c-0.3,-0.3,-0.69,-0.72,-0.9,-0.87l-0.33,-0.33l0,0.15c0,0.3,0.06,0.81,0.15,1.26c0.27,1.29,0.87,2.61,2.04,4.29c0.15,0.24,0.6,0.87,0.96,1.38l1.08,1.53l0.42,0.63c0.03,0,0.12,-0.36,0.21,-0.72c0.06,-0.33,0.06,-1.2,0,-1.62c-0.33,-1.71,-1.44,-3.48,-3.63,-5.7z\"\r\n    },\r\n    \"flags.u32nd\": {\r\n        \"w\": 6.697,\r\n        \"h\": 32.145,\r\n        \"d\": \"M-0.42,11.247l0,-11.25l0.21,0l0.21,0l0,0.36c0.09,1.68,0.69,3.27,2.07,5.46l0.87,1.35c1.02,1.62,1.47,2.37,1.86,3.18c0.48,1.02,0.78,1.92,0.93,2.88c0.06,0.48,0.06,1.5,0,1.89c-0.09,0.42,-0.21,0.87,-0.36,1.26l-0.12,0.3l0.15,0.39c0.69,1.56,0.84,2.88,0.54,4.38c-0.09,0.45,-0.27,1.08,-0.45,1.47l-0.12,0.24l0.18,0.36c0.33,0.72,0.57,1.56,0.69,2.34c0.12,1.02,-0.06,2.52,-0.42,3.84c-0.27,0.93,-0.75,2.13,-0.93,2.31c-0.18,0.15,-0.45,0.18,-0.66,0.09c-0.18,-0.09,-0.27,-0.18,-0.33,-0.33c-0.09,-0.18,-0.06,-0.3,0.06,-0.6c0.21,-0.36,0.42,-0.9,0.57,-1.38c0.51,-1.41,0.69,-3.06,0.48,-4.08c-0.15,-0.81,-0.57,-1.68,-1.2,-2.55c-0.72,-0.99,-1.83,-2.13,-3.3,-3.33l-0.48,-0.42l-0.03,1.53l0,1.56l-0.21,0l-0.21,0l0,-11.25zm1.26,-3.96c-0.27,-0.3,-0.54,-0.6,-0.66,-0.72l-0.18,-0.21l0,0.42c0.06,0.87,0.24,1.74,0.66,2.67c0.36,0.87,0.96,1.86,1.92,3.18c0.21,0.33,0.63,0.87,0.87,1.23c0.27,0.39,0.6,0.84,0.75,1.08l0.27,0.39l0.03,-0.12c0.12,-0.45,0.15,-1.05,0.09,-1.59c-0.27,-1.86,-1.38,-3.78,-3.75,-6.33zm-0.27,6.09c-0.27,-0.21,-0.48,-0.42,-0.51,-0.45c-0.06,-0.03,-0.06,-0.03,-0.06,0.21c0,0.9,0.3,2.04,0.81,3.09c0.48,1.02,0.96,1.77,2.37,3.63c0.6,0.78,1.05,1.44,1.29,1.77c0.06,0.12,0.15,0.21,0.15,0.18c0.03,-0.03,0.18,-0.57,0.24,-0.87c0.06,-0.45,0.06,-1.32,-0.03,-1.74c-0.09,-0.48,-0.24,-0.9,-0.51,-1.44c-0.66,-1.35,-1.83,-2.7,-3.75,-4.38z\"\r\n    },\r\n    \"flags.u64th\": {\r\n        \"w\": 6.682,\r\n        \"h\": 39.694,\r\n        \"d\": \"M-0.42,15l0,-15l0.21,0l0.21,0l0,0.36c0.06,1.2,0.39,2.37,1.02,3.66c0.39,0.81,0.84,1.56,1.8,3.09c0.81,1.26,1.05,1.68,1.35,2.22c0.87,1.5,1.35,2.79,1.56,4.08c0.06,0.54,0.06,1.56,-0.03,2.04c-0.09,0.48,-0.21,0.99,-0.36,1.35l-0.12,0.27l0.12,0.27c0.09,0.15,0.21,0.45,0.27,0.66c0.69,1.89,0.63,3.66,-0.18,5.46l-0.18,0.39l0.15,0.33c0.3,0.66,0.51,1.44,0.63,2.1c0.06,0.48,0.06,1.35,0,1.71c-0.15,0.57,-0.42,1.2,-0.78,1.68l-0.21,0.27l0.18,0.33c0.57,1.05,0.93,2.13,1.02,3.18c0.06,0.72,0,1.83,-0.21,2.79c-0.18,1.02,-0.63,2.34,-1.02,3.09c-0.15,0.33,-0.48,0.45,-0.78,0.3c-0.18,-0.09,-0.27,-0.18,-0.33,-0.33c-0.09,-0.18,-0.06,-0.3,0.03,-0.54c0.75,-1.5,1.23,-3.45,1.17,-4.89c-0.06,-1.02,-0.42,-2.01,-1.17,-3.15c-0.48,-0.72,-1.02,-1.35,-1.89,-2.22c-0.57,-0.57,-1.56,-1.5,-1.92,-1.77l-0.12,-0.09l0,1.68l0,1.68l-0.21,0l-0.21,0l0,-15zm0.93,-8.07c-0.27,-0.3,-0.48,-0.54,-0.51,-0.54c0,0,0,0.69,0.03,1.02c0.15,1.47,0.75,2.94,2.04,4.83l1.08,1.53c0.39,0.57,0.84,1.2,0.99,1.44c0.15,0.24,0.3,0.45,0.3,0.45c0,0,0.03,-0.09,0.06,-0.21c0.36,-1.59,-0.15,-3.33,-1.47,-5.4c-0.63,-0.93,-1.35,-1.83,-2.52,-3.12zm0.06,6.72c-0.24,-0.21,-0.48,-0.42,-0.51,-0.45l-0.06,-0.06l0,0.33c0,1.2,0.3,2.34,0.93,3.6c0.45,0.9,0.96,1.68,2.25,3.51c0.39,0.54,0.84,1.17,1.02,1.44c0.21,0.33,0.33,0.51,0.33,0.48c0.06,-0.09,0.21,-0.63,0.3,-0.99c0.06,-0.33,0.06,-0.45,0.06,-0.96c0,-0.6,-0.03,-0.84,-0.18,-1.35c-0.3,-1.08,-1.02,-2.28,-2.13,-3.57c-0.39,-0.45,-1.44,-1.47,-2.01,-1.98zm0,6.72c-0.24,-0.21,-0.48,-0.39,-0.51,-0.42l-0.06,-0.06l0,0.33c0,1.41,0.45,2.82,1.38,4.35c0.42,0.72,0.72,1.14,1.86,2.73c0.36,0.45,0.75,0.99,0.87,1.2c0.15,0.21,0.3,0.36,0.3,0.36c0.06,0,0.3,-0.48,0.39,-0.75c0.09,-0.36,0.12,-0.63,0.12,-1.05c-0.06,-1.05,-0.45,-2.04,-1.2,-3.18c-0.57,-0.87,-1.11,-1.53,-2.07,-2.49c-0.36,-0.33,-0.84,-0.78,-1.08,-1.02z\"\r\n    },\r\n    \"flags.d8th\": {\r\n        \"w\": 8.492,\r\n        \"h\": 21.691,\r\n        \"d\": \"M5.67,-21.63c0.24,-0.12,0.54,-0.06,0.69,0.15c0.06,0.06,0.21,0.36,0.39,0.66c0.84,1.77,1.26,3.36,1.32,5.1c0.03,1.29,-0.21,2.37,-0.81,3.63c-0.6,1.23,-1.26,2.13,-3.21,4.38c-1.35,1.53,-1.86,2.19,-2.4,2.97c-0.63,0.93,-1.11,1.92,-1.38,2.79c-0.15,0.54,-0.27,1.35,-0.27,1.8l0,0.15l-0.21,0l-0.21,0l0,-3.75l0,-3.75l0.21,0l0.21,0l0.48,-0.3c1.83,-1.11,3.12,-2.1,4.17,-3.12c0.78,-0.81,1.32,-1.53,1.71,-2.31c0.45,-0.93,0.6,-1.74,0.51,-2.88c-0.12,-1.56,-0.63,-3.18,-1.47,-4.68c-0.12,-0.21,-0.15,-0.33,-0.06,-0.51c0.06,-0.15,0.15,-0.24,0.33,-0.33z\"\r\n    },\r\n    \"flags.ugrace\": {\r\n        \"w\": 12.019,\r\n        \"h\": 9.954,\r\n        \"d\": \"M6.03,6.93c0.15,-0.09,0.33,-0.06,0.51,0c0.15,0.09,0.21,0.15,0.3,0.33c0.09,0.18,0.06,0.39,-0.03,0.54c-0.06,0.15,-10.89,8.88,-11.07,8.97c-0.15,0.09,-0.33,0.06,-0.48,0c-0.18,-0.09,-0.24,-0.15,-0.33,-0.33c-0.09,-0.18,-0.06,-0.39,0.03,-0.54c0.06,-0.15,10.89,-8.88,11.07,-8.97z\"\r\n    },\r\n    \"flags.dgrace\": {\r\n        \"w\": 15.12,\r\n        \"h\": 9.212,\r\n        \"d\": \"M-6.06,-15.93c0.18,-0.09,0.33,-0.12,0.48,-0.06c0.18,0.09,14.01,8.04,14.1,8.1c0.12,0.12,0.18,0.33,0.18,0.51c-0.03,0.21,-0.15,0.39,-0.36,0.48c-0.18,0.09,-0.33,0.12,-0.48,0.06c-0.18,-0.09,-14.01,-8.04,-14.1,-8.1c-0.12,-0.12,-0.18,-0.33,-0.18,-0.51c0.03,-0.21,0.15,-0.39,0.36,-0.48z\"\r\n    },\r\n    \"flags.d16th\": {\r\n        \"w\": 8.475,\r\n        \"h\": 22.591,\r\n        \"d\": \"M6.84,-22.53c0.27,-0.12,0.57,-0.06,0.72,0.15c0.15,0.15,0.33,0.87,0.45,1.56c0.06,0.33,0.06,1.35,0,1.65c-0.06,0.33,-0.15,0.78,-0.27,1.11c-0.12,0.33,-0.45,0.96,-0.66,1.32l-0.18,0.27l0.09,0.18c0.48,1.02,0.72,2.25,0.69,3.3c-0.06,1.23,-0.42,2.28,-1.26,3.45c-0.57,0.87,-0.99,1.32,-3,3.39c-1.56,1.56,-2.22,2.4,-2.76,3.45c-0.42,0.84,-0.66,1.8,-0.66,2.55l0,0.15l-0.21,0l-0.21,0l0,-7.5l0,-7.5l0.21,0l0.21,0l0,1.14l0,1.11l0.27,-0.15c1.11,-0.57,1.77,-0.99,2.52,-1.47c2.37,-1.56,3.69,-3.15,4.05,-4.83c0.03,-0.18,0.03,-0.39,0.03,-0.78c0,-0.6,-0.03,-0.93,-0.24,-1.5c-0.06,-0.18,-0.12,-0.39,-0.15,-0.45c-0.03,-0.24,0.12,-0.48,0.36,-0.6zm-0.63,7.5c-0.06,-0.18,-0.15,-0.36,-0.15,-0.36c-0.03,0,-0.03,0.03,-0.06,0.06c-0.06,0.12,-0.96,1.02,-1.95,1.98c-0.63,0.57,-1.26,1.17,-1.44,1.35c-1.53,1.62,-2.28,2.85,-2.55,4.32c-0.03,0.18,-0.03,0.54,-0.06,0.99l0,0.69l0.18,-0.09c0.93,-0.54,2.1,-1.29,2.82,-1.83c0.69,-0.51,1.02,-0.81,1.53,-1.29c1.86,-1.89,2.37,-3.66,1.68,-5.82z\"\r\n    },\r\n    \"flags.d32nd\": {\r\n        \"w\": 8.475,\r\n        \"h\": 29.191,\r\n        \"d\": \"M6.794,-29.13c0.27,-0.12,0.57,-0.06,0.72,0.15c0.12,0.12,0.27,0.63,0.36,1.11c0.33,1.59,0.06,3.06,-0.81,4.47l-0.18,0.27l0.09,0.15c0.12,0.24,0.33,0.69,0.45,1.05c0.63,1.83,0.45,3.57,-0.57,5.22l-0.18,0.3l0.15,0.27c0.42,0.87,0.6,1.71,0.57,2.61c-0.06,1.29,-0.48,2.46,-1.35,3.78c-0.54,0.81,-0.93,1.29,-2.46,3c-0.51,0.54,-1.05,1.17,-1.26,1.41c-1.56,1.86,-2.25,3.36,-2.37,5.01l0,0.33l-0.21,0l-0.21,0l0,-11.25l0,-11.25l0.21,0l0.21,0l0,1.35l0.03,1.35l0.78,-0.39c1.38,-0.69,2.34,-1.26,3.24,-1.92c1.38,-1.02,2.28,-2.13,2.64,-3.21c0.15,-0.48,0.18,-0.72,0.18,-1.29c0,-0.57,-0.06,-0.9,-0.24,-1.47c-0.06,-0.18,-0.12,-0.39,-0.15,-0.45c-0.03,-0.24,0.12,-0.48,0.36,-0.6zm-0.63,7.2c-0.09,-0.18,-0.12,-0.21,-0.12,-0.15c-0.03,0.09,-1.02,1.08,-2.04,2.04c-1.17,1.08,-1.65,1.56,-2.07,2.04c-0.84,0.96,-1.38,1.86,-1.68,2.76c-0.21,0.57,-0.27,0.99,-0.3,1.65l0,0.54l0.66,-0.33c3.57,-1.86,5.49,-3.69,5.94,-5.7c0.06,-0.39,0.06,-1.2,-0.03,-1.65c-0.06,-0.39,-0.24,-0.9,-0.36,-1.2zm-0.06,7.2c-0.06,-0.15,-0.12,-0.33,-0.15,-0.45l-0.06,-0.18l-0.18,0.21l-1.83,1.83c-0.87,0.9,-1.77,1.8,-1.95,2.01c-1.08,1.29,-1.62,2.31,-1.89,3.51c-0.06,0.3,-0.06,0.51,-0.09,0.93l0,0.57l0.09,-0.06c0.75,-0.45,1.89,-1.26,2.52,-1.74c0.81,-0.66,1.74,-1.53,2.22,-2.16c1.26,-1.53,1.68,-3.06,1.32,-4.47z\"\r\n    },\r\n    \"flags.d64th\": {\r\n        \"w\": 8.485,\r\n        \"h\": 32.932,\r\n        \"d\": \"M7.08,-32.88c0.3,-0.12,0.66,-0.03,0.78,0.24c0.18,0.33,0.27,2.1,0.15,2.64c-0.09,0.39,-0.21,0.78,-0.39,1.08l-0.15,0.3l0.09,0.27c0.03,0.12,0.09,0.45,0.12,0.69c0.27,1.44,0.18,2.55,-0.3,3.6l-0.12,0.33l0.06,0.42c0.27,1.35,0.33,2.82,0.21,3.63c-0.12,0.6,-0.3,1.23,-0.57,1.8l-0.15,0.27l0.03,0.42c0.06,1.02,0.06,2.7,0.03,3.06c-0.15,1.47,-0.66,2.76,-1.74,4.41c-0.45,0.69,-0.75,1.11,-1.74,2.37c-1.05,1.38,-1.5,1.98,-1.95,2.73c-0.93,1.5,-1.38,2.82,-1.44,4.2l0,0.42l-0.21,0l-0.21,0l0,-15l0,-15l0.21,0l0.21,0l0,1.86l0,1.89c0,0,0.21,-0.03,0.45,-0.09c2.22,-0.39,4.08,-1.11,5.19,-2.01c0.63,-0.54,1.02,-1.14,1.2,-1.8c0.06,-0.3,0.06,-1.14,-0.03,-1.65c-0.03,-0.18,-0.06,-0.39,-0.09,-0.48c-0.03,-0.24,0.12,-0.48,0.36,-0.6zm-0.45,6.15c-0.03,-0.18,-0.06,-0.42,-0.06,-0.54l-0.03,-0.18l-0.33,0.3c-0.42,0.36,-0.87,0.72,-1.68,1.29c-1.98,1.38,-2.25,1.59,-2.85,2.16c-0.75,0.69,-1.23,1.44,-1.47,2.19c-0.15,0.45,-0.18,0.63,-0.21,1.35l0,0.66l0.39,-0.18c1.83,-0.9,3.45,-1.95,4.47,-2.91c0.93,-0.9,1.53,-1.83,1.74,-2.82c0.06,-0.33,0.06,-0.87,0.03,-1.32zm-0.27,4.86c-0.03,-0.21,-0.06,-0.36,-0.06,-0.36c0,-0.03,-0.12,0.09,-0.24,0.24c-0.39,0.48,-0.99,1.08,-2.16,2.19c-1.47,1.38,-1.92,1.83,-2.46,2.49c-0.66,0.87,-1.08,1.74,-1.29,2.58c-0.09,0.42,-0.15,0.87,-0.15,1.44l0,0.54l0.48,-0.33c1.5,-1.02,2.58,-1.89,3.51,-2.82c1.47,-1.47,2.25,-2.85,2.4,-4.26c0.03,-0.39,0.03,-1.17,-0.03,-1.71zm-0.66,7.68c0.03,-0.15,0.03,-0.6,0.03,-0.99l0,-0.72l-0.27,0.33l-1.74,1.98c-1.77,1.92,-2.43,2.76,-2.97,3.9c-0.51,1.02,-0.72,1.77,-0.75,2.91c0,0.63,0,0.63,0.06,0.6c0.03,-0.03,0.3,-0.27,0.63,-0.54c0.66,-0.6,1.86,-1.8,2.31,-2.31c1.65,-1.89,2.52,-3.54,2.7,-5.16z\"\r\n    },\r\n    \"clefs.C\": {\r\n        \"w\": 20.31,\r\n        \"h\": 29.97,\r\n        \"d\": \"M0.06,-14.94l0.09,-0.06l1.92,0l1.92,0l0.09,0.06l0.06,0.09l0,14.85l0,14.82l-0.06,0.09l-0.09,0.06l-1.92,0l-1.92,0l-0.09,-0.06l-0.06,-0.09l0,-14.82l0,-14.85zm5.37,0c0.09,-0.06,0.09,-0.06,0.57,-0.06c0.45,0,0.45,0,0.54,0.06l0.06,0.09l0,7.14l0,7.11l0.09,-0.06c0.18,-0.18,0.72,-0.84,0.96,-1.2c0.3,-0.45,0.66,-1.17,0.84,-1.65c0.36,-0.9,0.57,-1.83,0.6,-2.79c0.03,-0.48,0.03,-0.54,0.09,-0.63c0.12,-0.18,0.36,-0.21,0.54,-0.12c0.18,0.09,0.21,0.15,0.24,0.66c0.06,0.87,0.21,1.56,0.57,2.22c0.51,1.02,1.26,1.68,2.22,1.92c0.21,0.06,0.33,0.06,0.78,0.06c0.45,0,0.57,0,0.84,-0.06c0.45,-0.12,0.81,-0.33,1.08,-0.6c0.57,-0.57,0.87,-1.41,0.99,-2.88c0.06,-0.54,0.06,-3,0,-3.57c-0.21,-2.58,-0.84,-3.87,-2.16,-4.5c-0.48,-0.21,-1.17,-0.36,-1.77,-0.36c-0.69,0,-1.29,0.27,-1.5,0.72c-0.06,0.15,-0.06,0.21,-0.06,0.42c0,0.24,0,0.3,0.06,0.45c0.12,0.24,0.24,0.39,0.63,0.66c0.42,0.3,0.57,0.48,0.69,0.72c0.06,0.15,0.06,0.21,0.06,0.48c0,0.39,-0.03,0.63,-0.21,0.96c-0.3,0.6,-0.87,1.08,-1.5,1.26c-0.27,0.06,-0.87,0.06,-1.14,0c-0.78,-0.24,-1.44,-0.87,-1.65,-1.68c-0.12,-0.42,-0.09,-1.17,0.09,-1.71c0.51,-1.65,1.98,-2.82,3.81,-3.09c0.84,-0.09,2.46,0.03,3.51,0.27c2.22,0.57,3.69,1.8,4.44,3.75c0.36,0.93,0.57,2.13,0.57,3.36c0,1.44,-0.48,2.73,-1.38,3.81c-1.26,1.5,-3.27,2.43,-5.28,2.43c-0.48,0,-0.51,0,-0.75,-0.09c-0.15,-0.03,-0.48,-0.21,-0.78,-0.36c-0.69,-0.36,-0.87,-0.42,-1.26,-0.42c-0.27,0,-0.3,0,-0.51,0.09c-0.57,0.3,-0.81,0.9,-0.81,2.1c0,1.23,0.24,1.83,0.81,2.13c0.21,0.09,0.24,0.09,0.51,0.09c0.39,0,0.57,-0.06,1.26,-0.42c0.3,-0.15,0.63,-0.33,0.78,-0.36c0.24,-0.09,0.27,-0.09,0.75,-0.09c2.01,0,4.02,0.93,5.28,2.4c0.9,1.11,1.38,2.4,1.38,3.84c0,1.5,-0.3,2.88,-0.84,3.96c-0.78,1.59,-2.19,2.64,-4.17,3.15c-1.05,0.24,-2.67,0.36,-3.51,0.27c-1.83,-0.27,-3.3,-1.44,-3.81,-3.09c-0.18,-0.54,-0.21,-1.29,-0.09,-1.74c0.15,-0.6,0.63,-1.2,1.23,-1.47c0.36,-0.18,0.57,-0.21,0.99,-0.21c0.42,0,0.63,0.03,1.02,0.21c0.42,0.21,0.84,0.63,1.05,1.05c0.18,0.36,0.21,0.6,0.21,0.96c0,0.3,0,0.36,-0.06,0.51c-0.12,0.24,-0.27,0.42,-0.69,0.72c-0.57,0.42,-0.69,0.63,-0.69,1.08c0,0.24,0,0.3,0.06,0.45c0.12,0.21,0.3,0.39,0.57,0.54c0.42,0.18,0.87,0.21,1.53,0.15c1.08,-0.15,1.8,-0.57,2.34,-1.32c0.54,-0.75,0.84,-1.83,0.99,-3.51c0.06,-0.57,0.06,-3.03,0,-3.57c-0.12,-1.47,-0.42,-2.31,-0.99,-2.88c-0.27,-0.27,-0.63,-0.48,-1.08,-0.6c-0.27,-0.06,-0.39,-0.06,-0.84,-0.06c-0.45,0,-0.57,0,-0.78,0.06c-1.14,0.27,-2.01,1.17,-2.46,2.49c-0.21,0.57,-0.3,0.99,-0.33,1.65c-0.03,0.51,-0.06,0.57,-0.24,0.66c-0.12,0.06,-0.27,0.06,-0.39,0c-0.21,-0.09,-0.21,-0.15,-0.24,-0.75c-0.09,-1.92,-0.78,-3.72,-2.01,-5.19c-0.18,-0.21,-0.36,-0.42,-0.39,-0.45l-0.09,-0.06l0,7.11l0,7.14l-0.06,0.09c-0.09,0.06,-0.09,0.06,-0.54,0.06c-0.48,0,-0.48,0,-0.57,-0.06l-0.06,-0.09l0,-14.82l0,-14.85z\"\r\n    },\r\n    \"clefs.F\": {\r\n        \"w\": 20.153,\r\n        \"h\": 23.142,\r\n        \"d\": \"M6.3,-7.8c0.36,-0.03,1.65,0,2.13,0.03c3.6,0.42,6.03,2.1,6.93,4.86c0.27,0.84,0.36,1.5,0.36,2.58c0,0.9,-0.03,1.35,-0.18,2.16c-0.78,3.78,-3.54,7.08,-8.37,9.96c-1.74,1.05,-3.87,2.13,-6.18,3.12c-0.39,0.18,-0.75,0.33,-0.81,0.36c-0.06,0.03,-0.15,0.06,-0.18,0.06c-0.15,0,-0.33,-0.18,-0.33,-0.33c0,-0.15,0.06,-0.21,0.51,-0.48c3,-1.77,5.13,-3.21,6.84,-4.74c0.51,-0.45,1.59,-1.5,1.95,-1.95c1.89,-2.19,2.88,-4.32,3.15,-6.78c0.06,-0.42,0.06,-1.77,0,-2.19c-0.24,-2.01,-0.93,-3.63,-2.04,-4.71c-0.63,-0.63,-1.29,-1.02,-2.07,-1.2c-1.62,-0.39,-3.36,0.15,-4.56,1.44c-0.54,0.6,-1.05,1.47,-1.32,2.22l-0.09,0.21l0.24,-0.12c0.39,-0.21,0.63,-0.24,1.11,-0.24c0.3,0,0.45,0,0.66,0.06c1.92,0.48,2.85,2.55,1.95,4.38c-0.45,0.99,-1.41,1.62,-2.46,1.71c-1.47,0.09,-2.91,-0.87,-3.39,-2.25c-0.18,-0.57,-0.21,-1.32,-0.03,-2.28c0.39,-2.25,1.83,-4.2,3.81,-5.19c0.69,-0.36,1.59,-0.6,2.37,-0.69zm11.58,2.52c0.84,-0.21,1.71,0.3,1.89,1.14c0.3,1.17,-0.72,2.19,-1.89,1.89c-0.99,-0.21,-1.5,-1.32,-1.02,-2.25c0.18,-0.39,0.6,-0.69,1.02,-0.78zm0,7.5c0.84,-0.21,1.71,0.3,1.89,1.14c0.21,0.87,-0.3,1.71,-1.14,1.89c-0.87,0.21,-1.71,-0.3,-1.89,-1.14c-0.21,-0.84,0.3,-1.71,1.14,-1.89z\"\r\n    },\r\n    \"clefs.G\": {\r\n        \"w\": 19.051,\r\n        \"h\": 57.057,\r\n        \"d\": \"M9.69,-37.41c0.09,-0.09,0.24,-0.06,0.36,0c0.12,0.09,0.57,0.6,0.96,1.11c1.77,2.34,3.21,5.85,3.57,8.73c0.21,1.56,0.03,3.27,-0.45,4.86c-0.69,2.31,-1.92,4.47,-4.23,7.44c-0.3,0.39,-0.57,0.72,-0.6,0.75c-0.03,0.06,0,0.15,0.18,0.78c0.54,1.68,1.38,4.44,1.68,5.49l0.09,0.42l0.39,0c1.47,0.09,2.76,0.51,3.96,1.29c1.83,1.23,3.06,3.21,3.39,5.52c0.09,0.45,0.12,1.29,0.06,1.74c-0.09,1.02,-0.33,1.83,-0.75,2.73c-0.84,1.71,-2.28,3.06,-4.02,3.72l-0.33,0.12l0.03,1.26c0,1.74,-0.06,3.63,-0.21,4.62c-0.45,3.06,-2.19,5.49,-4.47,6.21c-0.57,0.18,-0.9,0.21,-1.59,0.21c-0.69,0,-1.02,-0.03,-1.65,-0.21c-1.14,-0.27,-2.13,-0.84,-2.94,-1.65c-0.99,-0.99,-1.56,-2.16,-1.71,-3.54c-0.09,-0.81,0.06,-1.53,0.45,-2.13c0.63,-0.99,1.83,-1.56,3,-1.53c1.5,0.09,2.64,1.32,2.73,2.94c0.06,1.47,-0.93,2.7,-2.37,2.97c-0.45,0.06,-0.84,0.03,-1.29,-0.09l-0.21,-0.09l0.09,0.12c0.39,0.54,0.78,0.93,1.32,1.26c1.35,0.87,3.06,1.02,4.35,0.36c1.44,-0.72,2.52,-2.28,2.97,-4.35c0.15,-0.66,0.24,-1.5,0.3,-3.03c0.03,-0.84,0.03,-2.94,0,-3c-0.03,0,-0.18,0,-0.36,0.03c-0.66,0.12,-0.99,0.12,-1.83,0.12c-1.05,0,-1.71,-0.06,-2.61,-0.3c-4.02,-0.99,-7.11,-4.35,-7.8,-8.46c-0.12,-0.66,-0.12,-0.99,-0.12,-1.83c0,-0.84,0,-1.14,0.15,-1.92c0.36,-2.28,1.41,-4.62,3.3,-7.29l2.79,-3.6c0.54,-0.66,0.96,-1.2,0.96,-1.23c0,-0.03,-0.09,-0.33,-0.18,-0.69c-0.96,-3.21,-1.41,-5.28,-1.59,-7.68c-0.12,-1.38,-0.15,-3.09,-0.06,-3.96c0.33,-2.67,1.38,-5.07,3.12,-7.08c0.36,-0.42,0.99,-1.05,1.17,-1.14zm2.01,4.71c-0.15,-0.3,-0.3,-0.54,-0.3,-0.54c-0.03,0,-0.18,0.09,-0.3,0.21c-2.4,1.74,-3.87,4.2,-4.26,7.11c-0.06,0.54,-0.06,1.41,-0.03,1.89c0.09,1.29,0.48,3.12,1.08,5.22c0.15,0.42,0.24,0.78,0.24,0.81c0,0.03,0.84,-1.11,1.23,-1.68c1.89,-2.73,2.88,-5.07,3.15,-7.53c0.09,-0.57,0.12,-1.74,0.06,-2.37c-0.09,-1.23,-0.27,-1.92,-0.87,-3.12zm-2.94,20.7c-0.21,-0.72,-0.39,-1.32,-0.42,-1.32c0,0,-1.2,1.47,-1.86,2.37c-2.79,3.63,-4.02,6.3,-4.35,9.3c-0.03,0.21,-0.03,0.69,-0.03,1.08c0,0.69,0,0.75,0.06,1.11c0.12,0.54,0.27,0.99,0.51,1.47c0.69,1.38,1.83,2.55,3.42,3.42c0.96,0.54,2.07,0.9,3.21,1.08c0.78,0.12,2.04,0.12,2.94,-0.03c0.51,-0.06,0.45,-0.03,0.42,-0.3c-0.24,-3.33,-0.72,-6.33,-1.62,-10.08c-0.09,-0.39,-0.18,-0.75,-0.18,-0.78c-0.03,-0.03,-0.42,0,-0.81,0.09c-0.9,0.18,-1.65,0.57,-2.22,1.14c-0.72,0.72,-1.08,1.65,-1.05,2.64c0.06,0.96,0.48,1.83,1.23,2.58c0.36,0.36,0.72,0.63,1.17,0.9c0.33,0.18,0.36,0.21,0.42,0.33c0.18,0.42,-0.18,0.9,-0.6,0.87c-0.18,-0.03,-0.84,-0.36,-1.26,-0.63c-0.78,-0.51,-1.38,-1.11,-1.86,-1.83c-1.77,-2.7,-0.99,-6.42,1.71,-8.19c0.3,-0.21,0.81,-0.48,1.17,-0.63c0.3,-0.09,1.02,-0.3,1.14,-0.3c0.06,0,0.09,0,0.09,-0.03c0.03,-0.03,-0.51,-1.92,-1.23,-4.26zm3.78,7.41c-0.18,-0.03,-0.36,-0.06,-0.39,-0.06c-0.03,0,0,0.21,0.18,1.02c0.75,3.18,1.26,6.3,1.5,9.09c0.06,0.72,0,0.69,0.51,0.42c0.78,-0.36,1.44,-0.96,1.98,-1.77c1.08,-1.62,1.2,-3.69,0.3,-5.55c-0.81,-1.62,-2.31,-2.79,-4.08,-3.15z\"\r\n    },\r\n    \"clefs.perc\": {\r\n        \"w\": 9.99,\r\n        \"h\": 14.97,\r\n        \"d\": \"M5.07,-7.44l0.09,-0.06l1.53,0l1.53,0l0.09,0.06l0.06,0.09l0,7.35l0,7.32l-0.06,0.09l-0.09,0.06l-1.53,0l-1.53,0l-0.09,-0.06l-0.06,-0.09l0,-7.32l0,-7.35zm6.63,0l0.09,-0.06l1.53,0l1.53,0l0.09,0.06l0.06,0.09l0,7.35l0,7.32l-0.06,0.09l-0.09,0.06l-1.53,0l-1.53,0l-0.09,-0.06l-0.06,-0.09l0,-7.32l0,-7.35z\"\r\n    },\r\n    \"timesig.common\": {\r\n        \"w\": 13.038,\r\n        \"h\": 15.697,\r\n        \"d\": \"M6.66,-7.826c0.72,-0.06,1.41,-0.03,1.98,0.09c1.2,0.27,2.34,0.96,3.09,1.92c0.63,0.81,1.08,1.86,1.14,2.73c0.06,1.02,-0.51,1.92,-1.44,2.22c-0.24,0.09,-0.3,0.09,-0.63,0.09c-0.33,0,-0.42,0,-0.63,-0.06c-0.66,-0.24,-1.14,-0.63,-1.41,-1.2c-0.15,-0.3,-0.21,-0.51,-0.24,-0.9c-0.06,-1.08,0.57,-2.04,1.56,-2.37c0.18,-0.06,0.27,-0.06,0.63,-0.06l0.45,0c0.06,0.03,0.09,0.03,0.09,0c0,0,-0.09,-0.12,-0.24,-0.27c-1.02,-1.11,-2.55,-1.68,-4.08,-1.5c-1.29,0.15,-2.04,0.69,-2.4,1.74c-0.36,0.93,-0.42,1.89,-0.42,5.37c0,2.97,0.06,3.96,0.24,4.77c0.24,1.08,0.63,1.68,1.41,2.07c0.81,0.39,2.16,0.45,3.18,0.09c1.29,-0.45,2.37,-1.53,3.03,-2.97c0.15,-0.33,0.33,-0.87,0.39,-1.17c0.09,-0.24,0.15,-0.36,0.3,-0.39c0.21,-0.03,0.42,0.15,0.39,0.36c-0.06,0.39,-0.42,1.38,-0.69,1.89c-0.96,1.8,-2.49,2.94,-4.23,3.18c-0.99,0.12,-2.58,-0.06,-3.63,-0.45c-0.96,-0.36,-1.71,-0.84,-2.4,-1.5c-1.11,-1.11,-1.8,-2.61,-2.04,-4.56c-0.06,-0.6,-0.06,-2.01,0,-2.61c0.24,-1.95,0.9,-3.45,2.01,-4.56c0.69,-0.66,1.44,-1.11,2.37,-1.47c0.63,-0.24,1.47,-0.42,2.22,-0.48z\"\r\n    },\r\n    \"timesig.cut\": {\r\n        \"w\": 13.038,\r\n        \"h\": 20.97,\r\n        \"d\": \"M6.24,-10.44c0.09,-0.06,0.09,-0.06,0.48,-0.06c0.36,0,0.36,0,0.45,0.06l0.06,0.09l0,1.23l0,1.26l0.27,0c1.26,0,2.49,0.45,3.48,1.29c1.05,0.87,1.8,2.28,1.89,3.48c0.06,1.02,-0.51,1.92,-1.44,2.22c-0.24,0.09,-0.3,0.09,-0.63,0.09c-0.33,0,-0.42,0,-0.63,-0.06c-0.66,-0.24,-1.14,-0.63,-1.41,-1.2c-0.15,-0.3,-0.21,-0.51,-0.24,-0.9c-0.06,-1.08,0.57,-2.04,1.56,-2.37c0.18,-0.06,0.27,-0.06,0.63,-0.06l0.45,0c0.06,0.03,0.09,0.03,0.09,0c0,-0.03,-0.45,-0.51,-0.66,-0.69c-0.87,-0.69,-1.83,-1.05,-2.94,-1.11l-0.42,0l0,7.17l0,7.14l0.42,0c0.69,-0.03,1.23,-0.18,1.86,-0.51c1.05,-0.51,1.89,-1.47,2.46,-2.7c0.15,-0.33,0.33,-0.87,0.39,-1.17c0.09,-0.24,0.15,-0.36,0.3,-0.39c0.21,-0.03,0.42,0.15,0.39,0.36c-0.03,0.24,-0.21,0.78,-0.39,1.2c-0.96,2.37,-2.94,3.9,-5.13,3.9l-0.3,0l0,1.26l0,1.23l-0.06,0.09c-0.09,0.06,-0.09,0.06,-0.45,0.06c-0.39,0,-0.39,0,-0.48,-0.06l-0.06,-0.09l0,-1.29l0,-1.29l-0.21,-0.03c-1.23,-0.21,-2.31,-0.63,-3.21,-1.29c-0.15,-0.09,-0.45,-0.36,-0.66,-0.57c-1.11,-1.11,-1.8,-2.61,-2.04,-4.56c-0.06,-0.6,-0.06,-2.01,0,-2.61c0.24,-1.95,0.93,-3.45,2.04,-4.59c0.42,-0.39,0.78,-0.66,1.26,-0.93c0.75,-0.45,1.65,-0.75,2.61,-0.9l0.21,-0.03l0,-1.29l0,-1.29zm-0.06,10.44c0,-5.58,0,-6.99,-0.03,-6.99c-0.15,0,-0.63,0.27,-0.87,0.45c-0.45,0.36,-0.75,0.93,-0.93,1.77c-0.18,0.81,-0.24,1.8,-0.24,4.74c0,2.97,0.06,3.96,0.24,4.77c0.24,1.08,0.66,1.68,1.41,2.07c0.12,0.06,0.3,0.12,0.33,0.15l0.09,0l0,-6.96z\"\r\n    },\r\n    \"f\": {\r\n        \"w\": 16.155,\r\n        \"h\": 19.445,\r\n        \"d\": \"M9.93,-14.28c1.53,-0.18,2.88,0.45,3.12,1.5c0.12,0.51,0,1.32,-0.27,1.86c-0.15,0.3,-0.42,0.57,-0.63,0.69c-0.69,0.36,-1.56,0.03,-1.83,-0.69c-0.09,-0.24,-0.09,-0.69,0,-0.87c0.06,-0.12,0.21,-0.24,0.45,-0.42c0.42,-0.24,0.57,-0.45,0.6,-0.72c0.03,-0.33,-0.09,-0.39,-0.63,-0.42c-0.3,0,-0.45,0,-0.6,0.03c-0.81,0.21,-1.35,0.93,-1.74,2.46c-0.06,0.27,-0.48,2.25,-0.48,2.31c0,0.03,0.39,0.03,0.9,0.03c0.72,0,0.9,0,0.99,0.06c0.42,0.15,0.45,0.72,0.03,0.9c-0.12,0.06,-0.24,0.06,-1.17,0.06l-1.05,0l-0.78,2.55c-0.45,1.41,-0.87,2.79,-0.96,3.06c-0.87,2.37,-2.37,4.74,-3.78,5.91c-1.05,0.9,-2.04,1.23,-3.09,1.08c-1.11,-0.18,-1.89,-0.78,-2.04,-1.59c-0.12,-0.66,0.15,-1.71,0.54,-2.19c0.69,-0.75,1.86,-0.54,2.22,0.39c0.06,0.15,0.09,0.27,0.09,0.48c0,0.24,-0.03,0.27,-0.12,0.42c-0.03,0.09,-0.15,0.18,-0.27,0.27c-0.09,0.06,-0.27,0.21,-0.36,0.27c-0.24,0.18,-0.36,0.36,-0.39,0.6c-0.03,0.33,0.09,0.39,0.63,0.42c0.42,0,0.63,-0.03,0.9,-0.15c0.6,-0.3,0.96,-0.96,1.38,-2.64c0.09,-0.42,0.63,-2.55,1.17,-4.77l1.02,-4.08c0,-0.03,-0.36,-0.03,-0.81,-0.03c-0.72,0,-0.81,0,-0.93,-0.06c-0.42,-0.18,-0.39,-0.75,0.03,-0.9c0.09,-0.06,0.27,-0.06,1.05,-0.06l0.96,0l0,-0.09c0.06,-0.18,0.3,-0.72,0.51,-1.17c1.2,-2.46,3.3,-4.23,5.34,-4.5z\"\r\n    },\r\n    \"m\": {\r\n        \"w\": 14.687,\r\n        \"h\": 9.126,\r\n        \"d\": \"M2.79,-8.91c0.09,0,0.3,-0.03,0.45,-0.03c0.24,0.03,0.3,0.03,0.45,0.12c0.36,0.15,0.63,0.54,0.75,1.02l0.03,0.21l0.33,-0.3c0.69,-0.69,1.38,-1.02,2.07,-1.02c0.27,0,0.33,0,0.48,0.06c0.21,0.09,0.48,0.36,0.63,0.6c0.03,0.09,0.12,0.27,0.18,0.42c0.03,0.15,0.09,0.27,0.12,0.27c0,0,0.09,-0.09,0.18,-0.21c0.33,-0.39,0.87,-0.81,1.29,-0.99c0.78,-0.33,1.47,-0.21,2.01,0.33c0.3,0.33,0.48,0.69,0.6,1.14c0.09,0.42,0.06,0.54,-0.54,3.06c-0.33,1.29,-0.57,2.4,-0.57,2.43c0,0.12,0.09,0.21,0.21,0.21c0.24,0,0.75,-0.3,1.2,-0.72c0.45,-0.39,0.6,-0.45,0.78,-0.27c0.18,0.18,0.09,0.36,-0.45,0.87c-1.05,0.96,-1.83,1.47,-2.58,1.71c-0.93,0.33,-1.53,0.21,-1.8,-0.33c-0.06,-0.15,-0.06,-0.21,-0.06,-0.45c0,-0.24,0.03,-0.48,0.6,-2.82c0.42,-1.71,0.6,-2.64,0.63,-2.79c0.03,-0.57,-0.3,-0.75,-0.84,-0.48c-0.24,0.12,-0.54,0.39,-0.66,0.63c-0.03,0.09,-0.42,1.38,-0.9,3c-0.9,3.15,-0.84,3,-1.14,3.15l-0.15,0.09l-0.78,0c-0.6,0,-0.78,0,-0.84,-0.06c-0.09,-0.03,-0.18,-0.18,-0.18,-0.27c0,-0.03,0.36,-1.38,0.84,-2.97c0.57,-2.04,0.81,-2.97,0.84,-3.12c0.03,-0.54,-0.3,-0.72,-0.84,-0.45c-0.24,0.12,-0.57,0.42,-0.66,0.63c-0.06,0.09,-0.51,1.44,-1.05,2.97c-0.51,1.56,-0.99,2.85,-0.99,2.91c-0.06,0.12,-0.21,0.24,-0.36,0.3c-0.12,0.06,-0.21,0.06,-0.9,0.06c-0.6,0,-0.78,0,-0.84,-0.06c-0.09,-0.03,-0.18,-0.18,-0.18,-0.27c0,-0.03,0.45,-1.38,0.99,-2.97c1.05,-3.18,1.05,-3.18,0.93,-3.45c-0.12,-0.27,-0.39,-0.3,-0.72,-0.15c-0.54,0.27,-1.14,1.17,-1.56,2.4c-0.06,0.15,-0.15,0.3,-0.18,0.36c-0.21,0.21,-0.57,0.27,-0.72,0.09c-0.09,-0.09,-0.06,-0.21,0.06,-0.63c0.48,-1.26,1.26,-2.46,2.01,-3.21c0.57,-0.54,1.2,-0.87,1.83,-1.02z\"\r\n    },\r\n    \"p\": {\r\n        \"w\": 14.689,\r\n        \"h\": 13.127,\r\n        \"d\": \"M1.92,-8.7c0.27,-0.09,0.81,-0.06,1.11,0.03c0.54,0.18,0.93,0.51,1.17,0.99c0.09,0.15,0.15,0.33,0.18,0.36l0,0.12l0.3,-0.27c0.66,-0.6,1.35,-1.02,2.13,-1.2c0.21,-0.06,0.33,-0.06,0.78,-0.06c0.45,0,0.51,0,0.84,0.09c1.29,0.33,2.07,1.32,2.25,2.79c0.09,0.81,-0.09,2.01,-0.45,2.79c-0.54,1.26,-1.86,2.55,-3.18,3.03c-0.45,0.18,-0.81,0.24,-1.29,0.24c-0.69,-0.03,-1.35,-0.18,-1.86,-0.45c-0.3,-0.15,-0.51,-0.18,-0.69,-0.09c-0.09,0.03,-0.18,0.09,-0.18,0.12c-0.09,0.12,-1.05,2.94,-1.05,3.06c0,0.24,0.18,0.48,0.51,0.63c0.18,0.06,0.54,0.15,0.75,0.15c0.21,0,0.36,0.06,0.42,0.18c0.12,0.18,0.06,0.42,-0.12,0.54c-0.09,0.03,-0.15,0.03,-0.78,0c-1.98,-0.15,-3.81,-0.15,-5.79,0c-0.63,0.03,-0.69,0.03,-0.78,0c-0.24,-0.15,-0.24,-0.57,0.03,-0.66c0.06,-0.03,0.48,-0.09,0.99,-0.12c0.87,-0.06,1.11,-0.09,1.35,-0.21c0.18,-0.06,0.33,-0.18,0.39,-0.3c0.06,-0.12,3.24,-9.42,3.27,-9.6c0.06,-0.33,0.03,-0.57,-0.15,-0.69c-0.09,-0.06,-0.12,-0.06,-0.3,-0.06c-0.69,0.06,-1.53,1.02,-2.28,2.61c-0.09,0.21,-0.21,0.45,-0.27,0.51c-0.09,0.12,-0.33,0.24,-0.48,0.24c-0.18,0,-0.36,-0.15,-0.36,-0.3c0,-0.24,0.78,-1.83,1.26,-2.55c0.72,-1.11,1.47,-1.74,2.28,-1.92zm5.37,1.47c-0.27,-0.12,-0.75,-0.03,-1.14,0.21c-0.75,0.48,-1.47,1.68,-1.89,3.15c-0.45,1.47,-0.42,2.34,0,2.7c0.45,0.39,1.26,0.21,1.83,-0.36c0.51,-0.51,0.99,-1.68,1.38,-3.27c0.3,-1.17,0.33,-1.74,0.15,-2.13c-0.09,-0.15,-0.15,-0.21,-0.33,-0.3z\"\r\n    },\r\n    \"r\": {\r\n        \"w\": 9.41,\r\n        \"h\": 9.132,\r\n        \"d\": \"M6.33,-9.12c0.27,-0.03,0.93,0,1.2,0.06c0.84,0.21,1.23,0.81,1.02,1.53c-0.24,0.75,-0.9,1.17,-1.56,0.96c-0.33,-0.09,-0.51,-0.3,-0.66,-0.75c-0.03,-0.12,-0.09,-0.24,-0.12,-0.3c-0.09,-0.15,-0.3,-0.24,-0.48,-0.24c-0.57,0,-1.38,0.54,-1.65,1.08c-0.06,0.15,-0.33,1.17,-0.9,3.27c-0.57,2.31,-0.81,3.12,-0.87,3.21c-0.03,0.06,-0.12,0.15,-0.18,0.21l-0.12,0.06l-0.81,0.03c-0.69,0,-0.81,0,-0.9,-0.03c-0.09,-0.06,-0.18,-0.21,-0.18,-0.3c0,-0.06,0.39,-1.62,0.9,-3.51c0.84,-3.24,0.87,-3.45,0.87,-3.72c0,-0.21,0,-0.27,-0.03,-0.36c-0.12,-0.15,-0.21,-0.24,-0.42,-0.24c-0.24,0,-0.45,0.15,-0.78,0.42c-0.33,0.36,-0.45,0.54,-0.72,1.14c-0.03,0.12,-0.21,0.24,-0.36,0.27c-0.12,0,-0.15,0,-0.24,-0.06c-0.18,-0.12,-0.18,-0.21,-0.06,-0.54c0.21,-0.57,0.42,-0.93,0.78,-1.32c0.54,-0.51,1.2,-0.81,1.95,-0.87c0.81,-0.03,1.53,0.3,1.92,0.87l0.12,0.18l0.09,-0.09c0.57,-0.45,1.41,-0.84,2.19,-0.96z\"\r\n    },\r\n    \"s\": {\r\n        \"w\": 6.632,\r\n        \"h\": 8.758,\r\n        \"d\": \"M4.47,-8.73c0.09,0,0.36,-0.03,0.57,-0.03c0.75,0.03,1.29,0.24,1.71,0.63c0.51,0.54,0.66,1.26,0.36,1.83c-0.24,0.42,-0.63,0.57,-1.11,0.42c-0.33,-0.09,-0.6,-0.36,-0.6,-0.57c0,-0.03,0.06,-0.21,0.15,-0.39c0.12,-0.21,0.15,-0.33,0.18,-0.48c0,-0.24,-0.06,-0.48,-0.15,-0.6c-0.15,-0.21,-0.42,-0.24,-0.75,-0.15c-0.27,0.06,-0.48,0.18,-0.69,0.36c-0.39,0.39,-0.51,0.96,-0.33,1.38c0.09,0.21,0.42,0.51,0.78,0.72c1.11,0.69,1.59,1.11,1.89,1.68c0.21,0.39,0.24,0.78,0.15,1.29c-0.18,1.2,-1.17,2.16,-2.52,2.52c-1.02,0.24,-1.95,0.12,-2.7,-0.42c-0.72,-0.51,-0.99,-1.47,-0.6,-2.19c0.24,-0.48,0.72,-0.63,1.17,-0.42c0.33,0.18,0.54,0.45,0.57,0.81c0,0.21,-0.03,0.3,-0.33,0.51c-0.33,0.24,-0.39,0.42,-0.27,0.69c0.06,0.15,0.21,0.27,0.45,0.33c0.3,0.09,0.87,0.09,1.2,0c0.75,-0.21,1.23,-0.72,1.29,-1.35c0.03,-0.42,-0.15,-0.81,-0.54,-1.2c-0.24,-0.24,-0.48,-0.42,-1.41,-1.02c-0.69,-0.42,-1.05,-0.93,-1.05,-1.47c0,-0.39,0.12,-0.87,0.3,-1.23c0.27,-0.57,0.78,-1.05,1.38,-1.35c0.24,-0.12,0.63,-0.27,0.9,-0.3z\"\r\n    },\r\n    \"z\": {\r\n        \"w\": 8.573,\r\n        \"h\": 8.743,\r\n        \"d\": \"M2.64,-7.95c0.36,-0.09,0.81,-0.03,1.71,0.27c0.78,0.21,0.96,0.27,1.74,0.3c0.87,0.06,1.02,0.03,1.38,-0.21c0.21,-0.15,0.33,-0.15,0.48,-0.06c0.15,0.09,0.21,0.3,0.15,0.45c-0.03,0.06,-1.26,1.26,-2.76,2.67l-2.73,2.55l0.54,0.03c0.54,0.03,0.72,0.03,2.01,0.15c0.36,0.03,0.9,0.06,1.2,0.09c0.66,0,0.81,-0.03,1.02,-0.24c0.3,-0.3,0.39,-0.72,0.27,-1.23c-0.06,-0.27,-0.06,-0.27,-0.03,-0.39c0.15,-0.3,0.54,-0.27,0.69,0.03c0.15,0.33,0.27,1.02,0.27,1.5c0,1.47,-1.11,2.7,-2.52,2.79c-0.57,0.03,-1.02,-0.09,-2.01,-0.51c-1.02,-0.42,-1.23,-0.48,-2.13,-0.54c-0.81,-0.06,-0.96,-0.03,-1.26,0.18c-0.12,0.06,-0.24,0.12,-0.27,0.12c-0.27,0,-0.45,-0.3,-0.36,-0.51c0.03,-0.06,1.32,-1.32,2.91,-2.79l2.88,-2.73c-0.03,0,-0.21,0.03,-0.42,0.06c-0.21,0.03,-0.78,0.09,-1.23,0.12c-1.11,0.12,-1.23,0.15,-1.95,0.27c-0.72,0.15,-1.17,0.18,-1.29,0.09c-0.27,-0.18,-0.21,-0.75,0.12,-1.26c0.39,-0.6,0.93,-1.02,1.59,-1.2z\"\r\n    },\r\n    \"+\": {\r\n        \"w\": 7.507,\r\n        \"h\": 7.515,\r\n        \"d\": \"M3.48,-11.19c0.18,-0.09,0.36,-0.09,0.54,0c0.18,0.09,0.24,0.15,0.33,0.3l0.06,0.15l0,1.29l0,1.29l1.29,0c1.23,0,1.29,0,1.41,0.06c0.06,0.03,0.15,0.09,0.18,0.12c0.12,0.09,0.21,0.33,0.21,0.48c0,0.15,-0.09,0.39,-0.21,0.48c-0.03,0.03,-0.12,0.09,-0.18,0.12c-0.12,0.06,-0.18,0.06,-1.41,0.06l-1.29,0l0,1.29c0,1.23,0,1.29,-0.06,1.41c-0.09,0.18,-0.15,0.24,-0.3,0.33c-0.21,0.09,-0.39,0.09,-0.57,0c-0.18,-0.09,-0.24,-0.15,-0.33,-0.33c-0.06,-0.12,-0.06,-0.18,-0.06,-1.41l0,-1.29l-1.29,0c-1.23,0,-1.29,0,-1.41,-0.06c-0.18,-0.09,-0.24,-0.15,-0.33,-0.33c-0.09,-0.18,-0.09,-0.36,0,-0.54c0.09,-0.18,0.15,-0.24,0.33,-0.33l0.15,-0.06l1.26,0l1.29,0l0,-1.29c0,-1.23,0,-1.29,0.06,-1.41c0.09,-0.18,0.15,-0.24,0.33,-0.33z\"\r\n    },\r\n    \",\": {\r\n        \"w\": 3.452,\r\n        \"h\": 8.143,\r\n        \"d\": \"M1.32,-3.36c0.57,-0.15,1.17,0.03,1.59,0.45c0.45,0.45,0.6,0.96,0.51,1.89c-0.09,1.23,-0.42,2.46,-0.99,3.93c-0.3,0.72,-0.72,1.62,-0.78,1.68c-0.18,0.21,-0.51,0.18,-0.66,-0.06c-0.03,-0.06,-0.06,-0.15,-0.06,-0.18c0,-0.06,0.12,-0.33,0.24,-0.63c0.84,-1.8,1.02,-2.61,0.69,-3.24c-0.12,-0.24,-0.27,-0.36,-0.75,-0.6c-0.36,-0.15,-0.42,-0.21,-0.6,-0.39c-0.69,-0.69,-0.69,-1.71,0,-2.4c0.21,-0.21,0.51,-0.39,0.81,-0.45z\"\r\n    },\r\n    \"-\": {\r\n        \"w\": 5.001,\r\n        \"h\": 0.81,\r\n        \"d\": \"M0.18,-5.34c0.09,-0.06,0.15,-0.06,2.31,-0.06c2.46,0,2.37,0,2.46,0.21c0.12,0.21,0.03,0.42,-0.15,0.54c-0.09,0.06,-0.15,0.06,-2.28,0.06c-2.16,0,-2.22,0,-2.31,-0.06c-0.27,-0.15,-0.27,-0.54,-0.03,-0.69z\"\r\n    },\r\n    \".\": {\r\n        \"w\": 3.413,\r\n        \"h\": 3.402,\r\n        \"d\": \"M1.32,-3.36c1.05,-0.27,2.1,0.57,2.1,1.65c0,1.08,-1.05,1.92,-2.1,1.65c-0.9,-0.21,-1.5,-1.14,-1.26,-2.04c0.12,-0.63,0.63,-1.11,1.26,-1.26z\"\r\n    },\r\n    \"stave\": {\r\n        \"d\": \"M0,0L800,0M0,8L800,8M0,16L800,16M0,24L800,24M0,32L800,32z\"\r\n    }\r\n};","'use strict';\r\n\r\nvar s = require('virtual-dom/virtual-hyperscript/svg');\r\n\r\nvar drawing_functions = {},\r\n    randomColor = require('randomcolor'),\r\n    glyphs = require('./glyphs'),\r\n    _ = require('lodash'),\r\n    data_tables = require(\"../data_tables\"),\r\n    dispatcher = require(\"../dispatcher\");\r\n\r\nvar\r\n    POS_SWITCH = 6,\r\n    MAX_GRAD = 0.05, \r\n    STEM_LENGTH = 28;\r\n\r\nvar transpose = 0;\r\ndispatcher.on(\"transpose_change\", function(data) {\r\n    transpose = data;\r\n});\r\n\r\n/**\r\n * Draws a stave of width 'width'\r\n * @param  {SVG.Group} line  [line group to draw the stave in]\r\n * @param  {Number} width [width of line]\r\n * @return {Undefined}\r\n */\r\n\r\nvar staveObject = s(\"path\", {\r\n    stroke: \"black\",\r\n    d: glyphs.stave.d\r\n});\r\n\r\ndrawing_functions.stave = function() {\r\n    return staveObject;\r\n}\r\n\r\nfunction ledgerLineCount(a) {\r\n    return ((Math.abs(a) / 2) >> 0) + 1;\r\n}\r\n\r\nfunction drawLedgerLines(currentNote, offset, colGroup) {\r\n    if (currentNote.truepos < 1) {\r\n        for (var i = 0, tar = ledgerLineCount(currentNote.truepos); i < tar; i++) {\r\n            colGroup.children.push(s(\"path\", {\r\n                stroke: 'black',\r\n                d: \"M0 0L14 0\",\r\n                transform: `translate(-2, ${32 + 8 * (i + 1)})`\r\n            }));\r\n        }\r\n    }\r\n\r\n    if (currentNote.truepos > 11) {\r\n        for (var i = 0, tar = ledgerLineCount(currentNote.truepos-12); i < tar; i++) {\r\n            colGroup.children.push(s(\"path\", {\r\n                stroke: 'black',\r\n                d: \"M0 0L14 0\",\r\n                //transform: `translate(6, ${0 - (8 * (i + 1))})`\r\n                transform: `translate(-2, ${0 - (8 * (i + 1))})`\r\n            }));\r\n        }\r\n    }\r\n}\r\n\r\ndrawing_functions.note = function (currentNote, offset, noteAreaWidth) {\r\n\r\n    //return;   \r\n\r\n    var colGroup = s(\"g\", {\r\n        transform: `translate(${offset},0)`\r\n    });\r\n\r\n    /*\r\n    var color = '#000',\r\n        stem_end = {\r\n            x: 0,\r\n            y: 0\r\n        },\r\n        stem_tail = null,\r\n        stem = null;\r\n\r\n    //invalid note length?\r\n    if (data_tables.allowed_note_lengths.indexOf(currentNote.notelength) === -1) {\r\n        console.log(\"INVALID NOTE LENGTH\");\r\n        for (var i = 0; i < data_tables.allowed_note_lengths.length; i++) {\r\n            if (currentNote.notelength > data_tables.allowed_note_lengths[i]) {\r\n                currentNote.notelength = data_tables.allowed_note_lengths[i - 1];\r\n                break;\r\n            }\r\n        }\r\n    }*/\r\n\r\n    if(currentNote.chord !== \"\") {\r\n        colGroup.children.push(s(\"text\", {\r\n           x: 0,\r\n           y: -20,\r\n           fill: \"black\",\r\n           transform: \"scale(0.8, 0.8)\"\r\n        }, [currentNote.chord.getText(transpose)]));\r\n    }\r\n\r\n    //ledger line\r\n    drawLedgerLines(currentNote, offset, colGroup);\r\n\r\n    var downstem = (currentNote.truepos >= POS_SWITCH || currentNote.forceStem === 1) && !(currentNote.forceStem === -1);\r\n\r\n    //DECORATIONS\r\n    if(currentNote.decorations.length > 0) {\r\n        for(var i=0; i<currentNote.decorations.length; i++) {\r\n            switch(currentNote.decorations[i].data) {\r\n                case \"~\": {\r\n                    var transform = \"\";\r\n\r\n                    var relativePositioning = downstem ? currentNote.y > 4 : currentNote.y > 16;\r\n\r\n                    if(relativePositioning) {\r\n                        transform = \"translate(0, -6)\";\r\n                    } else {\r\n                        transform = `translate(0, ${currentNote.y - 10})`\r\n                    }\r\n                    colGroup.children.push(s(\"path\", {\r\n                            d: glyphs[\"scripts.roll\"].d,\r\n                            fill: \"black\",\r\n                            transform\r\n                        }));\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    var noteDot, stem, accidental;\r\n\r\n    //noteDot = downstem ? s(\"g\", { class: \"noteHead\", transform: \"translate(10,0)\"}) : s(\"g\", { class: \"noteHead\"});\r\n    var elementName = `g#note_${currentNote.renderNoteId}`;\r\n     noteDot = downstem ? s(elementName, { class: \"noteHead\", transform: \"translate(0,0)\"}) : s(elementName, { class: \"noteHead\"});\r\n\r\n    //dotted note?\r\n    if ((2 * currentNote.noteLength) % 3 === 0) {\r\n        noteDot.children.push(s(\"ellipse\",{\r\n            rx: 2,\r\n            ry: 2,\r\n            cx: 14,\r\n            cy: currentNote.truepos % 2 === 0 ? -4 : 0,\r\n            fill: 'black'\r\n        }));\r\n    }\r\n\r\n    //double dotted note?\r\n    if ((4 * currentNote.noteLength) % 7 === 0) {\r\n        noteDot.children.push(s(\"ellipse\",{\r\n            rx: 2,\r\n            ry: 2,\r\n            cx: 14,\r\n            cy: 0,\r\n            fill: 'black'\r\n        }));\r\n        noteDot.children.push(s(\"ellipse\",{\r\n            rx: 2,\r\n            ry: 2,\r\n            cx: 18,\r\n            cy: 0,\r\n            fill: 'black'\r\n        }));\r\n    }    \r\n\r\n    var dotType;\r\n    //dot type\r\n    if (currentNote.noteLength < 4) {\r\n        dotType = glyphs[\"noteheads.quarter\"].d;\r\n    } else {\r\n        if (currentNote.noteLength < 8) {\r\n            dotType = glyphs[\"noteheads.half\"].d;\r\n        } else {\r\n            dotType = glyphs[\"noteheads.whole\"].d;\r\n        }\r\n    }\r\n\r\n    noteDot.children.push(s(\"path\", {\r\n        d: dotType\r\n    }));\r\n\r\n    \r\n    if (currentNote.noteLength < 8) {\r\n        if (downstem) {\r\n\r\n            //basic stem\r\n            stem = s(\"g\", {\r\n                transform: \"translate(0, 0)\"\r\n            });       \r\n \r\n            if(!currentNote.beamed) {\r\n                stem.children.push(s(\"path\", {\r\n                    stroke: 'black',\r\n                    d: `M0 ${currentNote.y+2}L0 ${currentNote.y + 28}`\r\n                }));\r\n\r\n                if(currentNote.noteLength === 1) {\r\n                    stem.children.push(s(\"path\", {\r\n                        d: glyphs[\"flags.d8th\"].d,\r\n                        fill: 'black',\r\n                        transform: `translate(0,${currentNote.y + 28})`\r\n                    }));\r\n                }\r\n            } else {\r\n                stem.children.push(s(\"path\", {\r\n                    stroke: 'black',\r\n                    d: `M0 ${currentNote.y}L0 ${currentNote.beamOffsetFactor}`\r\n                }));\r\n            }\r\n\r\n        } else {\r\n\r\n            stem = s(\"g\", {\r\n                transform: \"translate(10, 0)\"\r\n            });\r\n        \r\n            if(!currentNote.beamed) {\r\n                stem.children.push(s(\"path\", {\r\n                    stroke: 'black',\r\n                    d: `M0 ${currentNote.y-3}L0 ${currentNote.y - 32}`\r\n                }));\r\n\r\n                if(currentNote.noteLength === 1) {\r\n                    stem.children.push(s(\"path\", {\r\n                        d: glyphs[\"flags.u8th\"].d,\r\n                        fill: 'black',\r\n                        transform: `translate(0,${currentNote.y - 34})`\r\n                    }));\r\n                }\r\n            } else {\r\n                stem.children.push(s(\"path\", {\r\n                    stroke: 'black',\r\n                    d: `M0 ${currentNote.y-3}L0 ${currentNote.beamOffsetFactor}`\r\n                }));\r\n            }\r\n\r\n            /*\r\n            //curly bit for quavers            \r\n            if (currentNote.notelength == 1) {\r\n                stem_tail = noteGroup.path(glyphs[\"flags.u8th\"].d).attr({\r\n                    fill: 'black'\r\n                }).move(0, -24).scale(1);\r\n            }\r\n\r\n            //store point\r\n            stem_end.y = -24;*/\r\n        }\r\n    }\r\n\r\n    //accidentals\r\n\r\n    switch (currentNote.accidental) {\r\n        case \"_\":\r\n            accidental = s(\"path\", {\r\n                d: glyphs[\"accidentals.flat\"].d,\r\n                fill: \"black\",\r\n                transform: \"translate(-8, 0)\"\r\n            });\r\n            break;\r\n        case \"^\":\r\n            accidental = s(\"path\", {\r\n                d: glyphs[\"accidentals.sharp\"].d,\r\n                fill: \"black\",\r\n                transform: \"translate(-10, 0)\"\r\n            });           \r\n            break;\r\n        case \"=\":\r\n            accidental = s(\"path\", {\r\n                d: glyphs[\"accidentals.nat\"].d,\r\n                fill: \"black\",\r\n                transform: \"translate(-7, 0)\"\r\n            });\r\n            break;\r\n        case \"__\":\r\n            accidental = s(\"path\", {\r\n                d: glyphs[\"accidentals.dblflat\"].d,\r\n                fill: \"black\",\r\n                transform: \"translate(-6,-12)\"\r\n            });\r\n            break;\r\n        case \"^^\":\r\n            accidental = s(\"path\", {\r\n                d: glyphs[\"accidentals.dblsharp\"].d,\r\n                fill: \"black\",\r\n                transform: \"translate(-6,-12)\"\r\n            });\r\n            break;\r\n        default:\r\n    }/*\r\n\r\n    currentNote.stem_end = stem_end;\r\n\r\n    noteGroup.stem_tail = stem_tail;\r\n    noteGroup.stem = stem;\r\n    noteGroup.dot = noteDot;\r\n    currentNote.truepos = truepos;\r\n\r\n\r\n    currentNote.x = totalOffset;\r\n    currentNote.y = 28 - (truepos * 4);\r\n\r\n    noteGroup.move(currentNote.x, currentNote.y);*/\r\n\r\n    var noteGroup = s(\"g\", {\r\n        transform: `translate(0,${currentNote.y})`\r\n    }, [noteDot, accidental]);    \r\n\r\n    colGroup.children.push(noteGroup, stem);\r\n\r\n    if(currentNote.beams.length > 0) {\r\n        for(var i=0; i<currentNote.beams.length; i++) {\r\n            drawing_functions.beam(currentNote.beams[i], colGroup, noteAreaWidth);\r\n        }\r\n    }\r\n\r\n    return colGroup;\r\n};\r\n\r\ndrawing_functions.barline = function(currentSymbol, offset) {\r\n    var \r\n        barlineGroup = s(\"g\");\r\n\r\n    var rightAligned = currentSymbol.align === 2;\r\n\r\n    switch (currentSymbol.subType) {\r\n        case \"normal\":\r\n            barlineGroup.children.push(s(\"rect\", {\r\n                x: offset + 4 + (rightAligned ? 4 : 0),\r\n                width: 1,\r\n                height: 32,\r\n                fill: 'black'\r\n            }));\r\n            break;\r\n        case \"double\":\r\n            var alignment = currentSymbol.align === 2 ? -2 : 0;\r\n            barlineGroup.children.push(s(\"rect\", {\r\n                x: offset - 2 + alignment,\r\n                width: 1,\r\n                height: 32,\r\n                fill: 'black'\r\n            }));\r\n            barlineGroup.children.push(s(\"rect\", {\r\n                x: offset + 2 + alignment,\r\n                width: 1,\r\n                height: 32,\r\n                fill: 'black'\r\n            }));\r\n            break;\r\n\r\n        case \"repeat_start\":\r\n\r\n            barlineGroup.children.push(s(\"ellipse\",{\r\n                rx: 2,\r\n                ry: 2,\r\n                cx: offset + 12,\r\n                cy: 12,\r\n                fill: 'black'\r\n            }));\r\n\r\n            barlineGroup.children.push(s(\"ellipse\",{\r\n                rx: 2,\r\n                ry: 2,\r\n                cx: offset + 12,\r\n                cy: 20,\r\n                fill: 'black'\r\n            }));\r\n\r\n        case \"heavy_start\":\r\n\r\n            barlineGroup.children.push(s(\"rect\", {\r\n                x: offset - 2,\r\n                width: 4,\r\n                height: 32,\r\n                fill: 'black'\r\n            }));\r\n            barlineGroup.children.push(s(\"rect\", {\r\n                x: offset + 6,\r\n                width: 1,\r\n                height: 32,\r\n                fill: 'black'\r\n            }));\r\n            break;\r\n\r\n        case \"repeat_end\":\r\n\r\n            var alignment = currentSymbol.align === 2 ? -6 : 0;\r\n\r\n            barlineGroup.children.push(s(\"ellipse\",{\r\n                rx: 2,\r\n                ry: 2,\r\n                cx: offset - 12 + 20,\r\n                cy: 12,\r\n                fill: 'black'\r\n            }));\r\n\r\n            barlineGroup.children.push(s(\"ellipse\",{\r\n                rx: 2,\r\n                ry: 2,\r\n                cx: offset - 12 + 20,\r\n                cy: 20,\r\n                fill: 'black'\r\n            }));\r\n\r\n        case \"heavy_end\":\r\n\r\n            var alignment = currentSymbol.align === 2 ? -6 : 0;\r\n\r\n            barlineGroup.children.push(s(\"rect\", {\r\n                x: offset + 2 + 20 + alignment,\r\n                width: 4,\r\n                height: 32,\r\n                fill: 'black'\r\n            }));\r\n            barlineGroup.children.push(s(\"rect\", {\r\n                x: offset - 2 + 20  + alignment,\r\n                width: 1,\r\n                height: 32,\r\n                fill: 'black'\r\n            }));\r\n            break; \r\n\r\n        case \"double_repeat\":\r\n            barlineGroup.children.push(s(\"rect\", {\r\n                x: offset - 2,\r\n                width: 4,\r\n                height: 32,\r\n                fill: 'black'\r\n            }));\r\n            barlineGroup.children.push(s(\"rect\", {\r\n                x: offset + 5,\r\n                width: 1,\r\n                height: 32,\r\n                fill: 'black'\r\n            }));\r\n            barlineGroup.children.push(s(\"rect\", {\r\n                x: offset - 6,\r\n                width: 1,\r\n                height: 32,\r\n                fill: 'black'\r\n            }));\r\n\r\n            barlineGroup.children.push(s(\"ellipse\",{\r\n                rx: 2,\r\n                ry: 2,\r\n                cx: offset + 12,\r\n                cy: 12,\r\n                fill: 'black'\r\n            }));\r\n\r\n            barlineGroup.children.push(s(\"ellipse\",{\r\n                rx: 2,\r\n                ry: 2,\r\n                cx: offset + 12,\r\n                cy: 20,\r\n                fill: 'black'\r\n            }));\r\n\r\n            barlineGroup.children.push(s(\"ellipse\",{\r\n                rx: 2,\r\n                ry: 2,\r\n                cx: offset - 12,\r\n                cy: 12,\r\n                fill: 'black'\r\n            }));\r\n\r\n            barlineGroup.children.push(s(\"ellipse\",{\r\n                rx: 2,\r\n                ry: 2,\r\n                cx: offset - 12,\r\n                cy: 20,\r\n                fill: 'black'\r\n            }));\r\n            break;\r\n\r\n        default:\r\n    }\r\n\r\n    return barlineGroup;\r\n};\r\n\r\ndrawing_functions.chord_annotation = function(line, currentSymbol, totalOffset) {\r\n   /* return line.text(currentSymbol.text).font({\r\n        family: 'Helvetica',\r\n        size: 16,\r\n        anchor: 'middle',\r\n        leading: '1.5em'\r\n    }).move(totalOffset, -30).attr({\r\n        fill: 'black'\r\n    });*/\r\n};\r\n\r\ndrawing_functions.tie = function(currentSymbol, ignore, noteAreaWidth) {\r\n\r\n    var \r\n        startX = currentSymbol.start.xp * noteAreaWidth+4,\r\n        startY = currentSymbol.start.y + 8,\r\n        endX = currentSymbol.end.xp * noteAreaWidth+4,\r\n        endY = currentSymbol.end.y + 8;\r\n \r\n    var path = `M${startX} ${startY}C${startX+4} ${startY+14}, ${endX - 4} ${endY + 14}, ${endX} ${endY}C${endX+4} ${endY+12}, ${startX - 4} ${startY + 12}, ${startX} ${startY}`;\r\n\r\n    return s(\"path\", {\r\n        d: path,\r\n        stroke: 'black'\r\n    });\r\n};\r\n\r\ndrawing_functions.space = _.noop;\r\n\r\n/**\r\n * [beat_rest description]\r\n * @param  {[type]} line          [description]\r\n * @param  {[type]} currentSymbol [description]\r\n * @param  {[type]} totalOffset   [description]\r\n * @return {[type]}               [description]\r\n */\r\ndrawing_functions.beat_rest = function(line, currentSymbol, totalOffset) {\r\n    return line.path(glyphs[\"rests.quarter\"].d).attr({\r\n        fill: 'black'\r\n    }).move(totalOffset, 6);\r\n}\r\n\r\n/**\r\n * [treble_clef description]\r\n * @param  {[type]} line [description]\r\n * @return {[type]}      [description]\r\n */\r\n\r\nvar trebleClefObject = s(\"path\", {\r\n    fill: \"black\",\r\n    d: glyphs[\"clefs.G\"].d,\r\n    transform: \"translate(8, 24)\"\r\n});\r\n\r\ndrawing_functions.treble_clef = function(line) {\r\n    return {\r\n        node: trebleClefObject,\r\n        width: 40\r\n    };\r\n}\r\n\r\n/**\r\n * [timesig description]\r\n * @param  {[type]} line   [description]\r\n * @param  {[type]} top    [description]\r\n * @param  {[type]} bottom [description]\r\n * @return {[type]}        [description]\r\n */\r\ndrawing_functions.timesig = function(top, bottom, xoffset) {\r\n\r\n    var top_group = s(\"g\"),\r\n        bottom_group = s(\"g\"),\r\n        timeSig = s(\"g\", [top_group, bottom_group]);\r\n    //top\r\n\r\n    top.toString().split('').forEach(function(num, i) {\r\n        top_group.children.push(s(\"path\", {\r\n            fill: \"black\",\r\n            d: glyphs[num].d,\r\n            transform: [\"translate(\", xoffset + (i * 10), \",16)\"].join('')\r\n        }));\r\n    });\r\n\r\n    bottom.toString().split('').forEach(function(num, i) {\r\n        bottom_group.children.push(s(\"path\", {\r\n            fill: \"black\",\r\n            d: glyphs[num].d,\r\n            transform: [\"translate(\", xoffset + (i * 10), \",32)\"].join('')\r\n        }));\r\n    });\r\n    /*\r\n    var top_width = top_group.bbox().width,\r\n        bottom_width = bottom_group.bbox().width;\r\n\r\n    if (top_width > bottom_width) {\r\n        bottom_group.move((top_width - bottom_width) / 2, 0);\r\n    } else {\r\n        top_group.move((bottom_width - top_width) / 2, 0);\r\n    }\r\n*/\r\n    return {\r\n        node: timeSig,\r\n        width: 24\r\n    };\r\n}\r\n\r\nfunction sigmoid(a) {\r\n    return (1 / (Math.exp(0.05 * (14 - a)) + 1) * 96) - 32;\r\n}\r\n\r\n/**\r\n * [beam description]\r\n * @param  {[type]} line         [description]\r\n * @param  {[type]} beamed_notes [description]\r\n * @return {[type]}              [description]\r\n */\r\ndrawing_functions.beam = function(beam, group, noteAreaWidth) {\r\n\r\n    //var startX = -((beam.notes[beam.count - 1].xp - beam.notes[0].xp) * noteAreaWidth) + (beam.downBeam ? 0 : 10);\r\n    var startX = -(beam.notes[beam.count - 1].renderedXPos - beam.notes[0].renderedXPos) + (beam.downBeam ? 0 : 10);\r\n    var endY = beam.notes[beam.count - 1].beamOffsetFactor; \r\n    var startY = beam.notes[0].beamOffsetFactor;\r\n\r\n    if(beam.downBeam) {\r\n        group.children.push(s(\"path\", {\r\n            //d: `M${startX} ${startY}L10 ${endY}L10 ${endY-4}L${startX} ${startY-4}L${startX} ${startY}Z`\r\n            d: `M${startX} ${startY}L0 ${endY}L0 ${endY-4}L${startX} ${startY-4}L${startX} ${startY}Z`\r\n        }));\r\n    } else {\r\n        group.children.push(s(\"path\", {\r\n            d: `M${startX} ${startY}L10 ${endY}L10 ${endY+4}L${startX} ${startY+4}L${startX} ${startY}Z`\r\n        }));\r\n    }\r\n\r\n    for(var i=0; i<beam.notes.length; i++) {\r\n\r\n        var bm = beam.notes[i];\r\n\r\n        if(bm.beamDepth < -1) {\r\n\r\n            var tailsToDraw = Math.abs(bm.beamDepth) - 1;\r\n\r\n            for(var j=0; j<tailsToDraw; j++) {\r\n                var notePos = -(beam.notes[beam.count - 1].xp - bm.xp) * noteAreaWidth + (beam.downBeam ? 0 : 10);\r\n                var tailPosY = bm.beamOffsetFactor+6+(j*6);\r\n                group.children.push(s(\"path\", {\r\n                    d: `M${notePos} ${tailPosY}L${notePos} ${tailPosY+4}L${notePos-4} ${tailPosY+4}L${notePos-4} ${tailPosY}L${notePos} ${tailPosY}Z`\r\n                }));\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * [keysig description]\r\n * @param  {[type]} draw   [description]\r\n * @param  {[type]} keysig [description]\r\n * @return {[type]}        [description]\r\n */\r\ndrawing_functions.keysig = function(keysig, xoffset, lineId) {\r\n\r\n    var keySigGroup = s(\"g\");\r\n    var undefined;\r\n\r\n    var accidentals = data_tables.getKeySig(keysig.note, keysig.mode) + transpose;\r\n\r\n    \r\n    dispatcher.send(\"remove_abc_error\", \"KEYSIG\");\r\n\r\n    if(_.isNaN(accidentals)) {\r\n        var error = {\r\n            line: lineId,\r\n            message: `Malformed key signature: ${keysig.note + keysig.mode}`,\r\n            severity: 1,\r\n            type: \"KEYSIG\"\r\n        };\r\n\r\n        console.log(error);\r\n\r\n        dispatcher.send(\"abc_error\", error);\r\n\r\n        return false;\r\n    }\r\n\r\n    if (accidentals === 0) return {\r\n        node: keySigGroup,\r\n        width: 0\r\n    };\r\n\r\n    var dataset = accidentals > 0 ? data_tables.sharps : data_tables.flats;\r\n    var symbol = accidentals > 0 ? glyphs[\"accidentals.sharp\"].d : glyphs[\"accidentals.flat\"].d;    \r\n\r\n    for (var i = 0; i < Math.abs(accidentals); i++) {\r\n\r\n        keySigGroup.children.push(s(\"path\", {\r\n            d: symbol,\r\n            fill: \"black\",\r\n            transform: `translate(${xoffset + i * 8}, ${44 - ((dataset[i] + 1) * 4)})`\r\n        }));\r\n    }\r\n\r\n    return {\r\n        node: keySigGroup,\r\n        width: (Math.abs(accidentals) * 10) + 12\r\n    };\r\n};\r\n\r\ndrawing_functions.varientEndings = function (currentEnding, noteAreaWidth, continuation) {\r\n    var\r\n        startX = currentEnding.start.renderedXPos,//(currentEnding.start.xp * noteAreaWidth) - 8,\r\n        endX = currentEnding.end === null ? noteAreaWidth : currentEnding.end.renderedXPos,\r\n        path = \"\";\r\n        //path = `M${startX} -25L${startX} -40L${endX} -40L${endX} -25`;\r\n\r\n    path = continuation ? `M${startX} -40` : `M${startX} -25L${startX} -40`;\r\n    path = path + `L${endX} -40`;\r\n    path = currentEnding.end === null ? path : path + `L${endX} -25`;\r\n\r\n    var endingGroup = s(\"g\");\r\n\r\n    endingGroup.children.push(s(\"path\", {\r\n        d: path,\r\n        stroke: 'black',\r\n        fill: 'none'\r\n    }));\r\n\r\n    endingGroup.children.push(s(\"text\", {\r\n       x: 0,\r\n       y: 0,\r\n       fill: \"black\",\r\n       transform: `translate(${startX + 4}, -30)scale(0.5, 0.5)`\r\n    }, [currentEnding.name]));\r\n\r\n    return endingGroup;\r\n};\r\n\r\ndrawing_functions.slur = function(currentSymbol, ignore, noteAreaWidth) {\r\n\r\n    var \r\n        startX = currentSymbol.notes[0].xp * noteAreaWidth+4,\r\n        startY = currentSymbol.notes[0].y + 8,\r\n        endX = currentSymbol.notes[currentSymbol.notes.length - 1].xp * noteAreaWidth+4,\r\n        endY = currentSymbol.notes[currentSymbol.notes.length - 1].y + 8;\r\n \r\n    var path = `M${startX} ${startY}C${startX+4} ${startY+14}, ${endX - 4} ${endY + 14}, ${endX} ${endY}C${endX+4} ${endY+12}, ${startX - 4} ${startY + 12}, ${startX} ${startY}`;\r\n\r\n    return s(\"path\", {\r\n        d: path,\r\n        stroke: 'black'\r\n    });\r\n};\r\n\r\nvar restLengthMap = {\r\n    \"0.125\": \"rests.64th\",\r\n    \"0.25\": \"rests.32th\",\r\n    \"0.5\": \"rests.16th\",\r\n    \"1\": \"rests.8th\",\r\n    \"2\": \"rests.quarter\",\r\n    \"4\": \"rests.half\",\r\n    \"8\": \"rests.whole\",\r\n};\r\n\r\ndrawing_functions.rest = function(currentNote, offset, noteAreaWidth) {\r\n\r\n    var restLength = currentNote.restLength === undefined ? 1 : currentNote.restLength;\r\n\r\n    var colGroup = s(\"g\", {\r\n        transform: `translate(${offset},16)`\r\n    });\r\n\r\n    if(!currentNote.visible) return colGroup;\r\n\r\n    colGroup.children.push(s(\"path\", {\r\n        d: glyphs[restLengthMap[restLength]].d\r\n    }));\r\n\r\n    return colGroup;\r\n}\r\n\r\ndrawing_functions.tuplets = function(currentTuplet, noteAreaWidth) {\r\n\r\n    var middle = (currentTuplet.notes.length - 1) / 2;\r\n\r\n    var offset = currentTuplet.notes[middle].renderedXPos + (currentTuplet.notes[middle].forceStem === -1 ? 10 : 0);//xp * noteAreaWidth;\r\n\r\n    var tupletNumberY = currentTuplet.notes[middle].forceStem === -1 ?\r\n        currentTuplet.notes[middle].beamOffsetFactor - 10 :\r\n        currentTuplet.notes[middle].beamOffsetFactor + 10;\r\n\r\n    console.log(\"middle\", currentTuplet.notes[middle]);\r\n\r\n    var colGroup = s(\"g\", {\r\n        transform: `translate(${offset},${tupletNumberY})`\r\n    });\r\n\r\n    colGroup.children.push(s(\"text\", {\r\n       x: 0,\r\n       y: 0,\r\n       \"text-anchor\": \"middle\",\r\n       fill: \"black\",\r\n       transform: \"scale(0.5, 0.5)\",\r\n       \"font-weight\": \"bold\"\r\n    }, [currentTuplet.value.toString()]));\r\n\r\n    return colGroup;\r\n}\r\n\r\nmodule.exports = drawing_functions;","// CodeMirror, copyright (c) by Marijn Haverbeke and others\r\n// Distributed under an MIT license: http://codemirror.net/LICENSE\r\n\r\n(function(mod) {\r\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\r\n    mod(require('vendor').codeMirror);\r\n  else if (typeof define == \"function\" && define.amd) // AMD\r\n    define([\"../../lib/codemirror\"], mod);\r\n  else // Plain browser env\r\n    mod(CodeMirror);\r\n})(function(CodeMirror) {\r\n  \"use strict\";\r\n\r\n  CodeMirror.defineSimpleMode = function(name, states) {\r\n    CodeMirror.defineMode(name, function(config) {\r\n      return CodeMirror.simpleMode(config, states);\r\n    });\r\n  };\r\n\r\n  CodeMirror.simpleMode = function(config, states) {\r\n    ensureState(states, \"start\");\r\n    var states_ = {}, meta = states.meta || {}, hasIndentation = false;\r\n    for (var state in states) if (state != meta && states.hasOwnProperty(state)) {\r\n      var list = states_[state] = [], orig = states[state];\r\n      for (var i = 0; i < orig.length; i++) {\r\n        var data = orig[i];\r\n        list.push(new Rule(data, states));\r\n        if (data.indent || data.dedent) hasIndentation = true;\r\n      }\r\n    }\r\n    var mode = {\r\n      startState: function() {\r\n        return {state: \"start\", pending: null,\r\n                local: null, localState: null,\r\n                indent: hasIndentation ? [] : null};\r\n      },\r\n      copyState: function(state) {\r\n        var s = {state: state.state, pending: state.pending,\r\n                 local: state.local, localState: null,\r\n                 indent: state.indent && state.indent.slice(0)};\r\n        if (state.localState)\r\n          s.localState = CodeMirror.copyState(state.local.mode, state.localState);\r\n        if (state.stack)\r\n          s.stack = state.stack.slice(0);\r\n        for (var pers = state.persistentStates; pers; pers = pers.next)\r\n          s.persistentStates = {mode: pers.mode,\r\n                                spec: pers.spec,\r\n                                state: pers.state == state.localState ? s.localState : CodeMirror.copyState(pers.mode, pers.state),\r\n                                next: s.persistentStates};\r\n        return s;\r\n      },\r\n      token: tokenFunction(states_, config),\r\n      innerMode: function(state) { return state.local && {mode: state.local.mode, state: state.localState}; },\r\n      indent: indentFunction(states_, meta)\r\n    };\r\n    if (meta) for (var prop in meta) if (meta.hasOwnProperty(prop))\r\n      mode[prop] = meta[prop];\r\n    return mode;\r\n  };\r\n\r\n  function ensureState(states, name) {\r\n    if (!states.hasOwnProperty(name))\r\n      throw new Error(\"Undefined state \" + name + \"in simple mode\");\r\n  }\r\n\r\n  function toRegex(val, caret) {\r\n    if (!val) return /(?:)/;\r\n    var flags = \"\";\r\n    if (val instanceof RegExp) {\r\n      if (val.ignoreCase) flags = \"i\";\r\n      val = val.source;\r\n    } else {\r\n      val = String(val);\r\n    }\r\n    return new RegExp((caret === false ? \"\" : \"^\") + \"(?:\" + val + \")\", flags);\r\n  }\r\n\r\n  function asToken(val) {\r\n    if (!val) return null;\r\n    if (typeof val == \"string\") return val.replace(/\\./g, \" \");\r\n    var result = [];\r\n    for (var i = 0; i < val.length; i++)\r\n      result.push(val[i] && val[i].replace(/\\./g, \" \"));\r\n    return result;\r\n  }\r\n\r\n  function Rule(data, states) {\r\n    if (data.next || data.push) ensureState(states, data.next || data.push);\r\n    this.regex = toRegex(data.regex);\r\n    this.token = asToken(data.token);\r\n    this.data = data;\r\n  }\r\n\r\n  function tokenFunction(states, config) {\r\n    return function(stream, state) {\r\n      if (state.pending) {\r\n        var pend = state.pending.shift();\r\n        if (state.pending.length == 0) state.pending = null;\r\n        stream.pos += pend.text.length;\r\n        return pend.token;\r\n      }\r\n\r\n      if (state.local) {\r\n        if (state.local.end && stream.match(state.local.end)) {\r\n          var tok = state.local.endToken || null;\r\n          state.local = state.localState = null;\r\n          return tok;\r\n        } else {\r\n          var tok = state.local.mode.token(stream, state.localState), m;\r\n          if (state.local.endScan && (m = state.local.endScan.exec(stream.current())))\r\n            stream.pos = stream.start + m.index;\r\n          return tok;\r\n        }\r\n      }\r\n\r\n      var curState = states[state.state];\r\n      for (var i = 0; i < curState.length; i++) {\r\n        var rule = curState[i];\r\n        var matches = (!rule.data.sol || stream.sol()) && stream.match(rule.regex);\r\n        if (matches) {\r\n          if (rule.data.next) {\r\n            state.state = rule.data.next;\r\n          } else if (rule.data.push) {\r\n            (state.stack || (state.stack = [])).push(state.state);\r\n            state.state = rule.data.push;\r\n          } else if (rule.data.pop && state.stack && state.stack.length) {\r\n            state.state = state.stack.pop();\r\n          }\r\n\r\n          if (rule.data.mode)\r\n            enterLocalMode(config, state, rule.data.mode, rule.token);\r\n          if (rule.data.indent)\r\n            state.indent.push(stream.indentation() + config.indentUnit);\r\n          if (rule.data.dedent)\r\n            state.indent.pop();\r\n          if (matches.length > 2) {\r\n            state.pending = [];\r\n            for (var j = 2; j < matches.length; j++)\r\n              if (matches[j])\r\n                state.pending.push({text: matches[j], token: rule.token[j - 1]});\r\n            stream.backUp(matches[0].length - (matches[1] ? matches[1].length : 0));\r\n            return rule.token[0];\r\n          } else if (rule.token && rule.token.join) {\r\n            return rule.token[0];\r\n          } else {\r\n            return rule.token;\r\n          }\r\n        }\r\n      }\r\n      stream.next();\r\n      return null;\r\n    };\r\n  }\r\n\r\n  function cmp(a, b) {\r\n    if (a === b) return true;\r\n    if (!a || typeof a != \"object\" || !b || typeof b != \"object\") return false;\r\n    var props = 0;\r\n    for (var prop in a) if (a.hasOwnProperty(prop)) {\r\n      if (!b.hasOwnProperty(prop) || !cmp(a[prop], b[prop])) return false;\r\n      props++;\r\n    }\r\n    for (var prop in b) if (b.hasOwnProperty(prop)) props--;\r\n    return props == 0;\r\n  }\r\n\r\n  function enterLocalMode(config, state, spec, token) {\r\n    var pers;\r\n    if (spec.persistent) for (var p = state.persistentStates; p && !pers; p = p.next)\r\n      if (spec.spec ? cmp(spec.spec, p.spec) : spec.mode == p.mode) pers = p;\r\n    var mode = pers ? pers.mode : spec.mode || CodeMirror.getMode(config, spec.spec);\r\n    var lState = pers ? pers.state : CodeMirror.startState(mode);\r\n    if (spec.persistent && !pers)\r\n      state.persistentStates = {mode: mode, spec: spec.spec, state: lState, next: state.persistentStates};\r\n\r\n    state.localState = lState;\r\n    state.local = {mode: mode,\r\n                   end: spec.end && toRegex(spec.end),\r\n                   endScan: spec.end && spec.forceEnd !== false && toRegex(spec.end, false),\r\n                   endToken: token && token.join ? token[token.length - 1] : token};\r\n  }\r\n\r\n  function indexOf(val, arr) {\r\n    for (var i = 0; i < arr.length; i++) if (arr[i] === val) return true;\r\n  }\r\n\r\n  function indentFunction(states, meta) {\r\n    return function(state, textAfter, line) {\r\n      if (state.local && state.local.mode.indent)\r\n        return state.local.mode.indent(state.localState, textAfter, line);\r\n      if (state.indent == null || state.local || meta.dontIndentStates && indexOf(state.state, meta.dontIndentStates) > -1)\r\n        return CodeMirror.Pass;\r\n\r\n      var pos = state.indent.length - 1, rules = states[state.state];\r\n      scan: for (;;) {\r\n        for (var i = 0; i < rules.length; i++) {\r\n          var rule = rules[i];\r\n          if (rule.data.dedent && rule.data.dedentIfLineStart !== false) {\r\n            var m = rule.regex.exec(textAfter);\r\n            if (m && m[0]) {\r\n              pos--;\r\n              if (rule.next || rule.push) rules = states[rule.next || rule.push];\r\n              textAfter = textAfter.slice(m[0].length);\r\n              continue scan;\r\n            }\r\n          }\r\n        }\r\n        break;\r\n      }\r\n      return pos < 0 ? 0 : state.indent[pos];\r\n    };\r\n  }\r\n});","// Divvy v0.1.7\n// Copyright (2013) Rich Harris\n// Released under the MIT License\n\n// https://github.com/Rich-Harris/Divvy\n\n;(function ( global ) {\n\n\t'use strict';\n\nvar Divvy;\n\n(function () {\n\n\t'use strict';\n\n\tvar Block,\n\t\tControl,\n\n\t\t// touch support?\n\t\ttouch = ( 'ontouchstart' in document ),\n\n\t\t// shims for shit browsers\n\t\tindexOf,\n\t\taddClass,\n\t\tremoveClass,\n\t\ttrim,\n\n\t\t// internal helper functions\n\t\tgetState,\n\t\tsetState,\n\t\tcursor,\n\t\tfire,\n\t\tthrottle,\n\n\t\t// a few string constants\n\t\tROW = 'row',\n\t\tCOLUMN = 'column',\n\t\tLEFT = 'left',\n\t\tTOP = 'top',\n\t\tWIDTH = 'width',\n\t\tHEIGHT = 'height',\n\t\tVERTICAL = 'vertical',\n\t\tHORIZONTAL = 'horizontal',\n\t\tCLIENTX = 'clientX',\n\t\tCLIENTY = 'clientY';\n\n\n\n\tDivvy = function ( options ) {\n\t\tvar self = this, fragment, i, blocks, type, resizeHandler;\n\n\t\tthis.el = options.el;\n\t\tfragment = document.createDocumentFragment();\n\n\t\tif ( options.columns && options.rows ) {\n\t\t\tthrow new Error( 'You can\\'t have top level rows and top level columns - one or the other' );\n\t\t}\n\n\t\tif ( options.columns ) {\n\t\t\tthis.type = ROW;\n\t\t\tblocks = options.columns;\n\t\t} else if ( options.rows ) {\n\t\t\tthis.type = COLUMN;\n\t\t\tblocks = options.rows;\n\t\t}\n\n\t\tthis.blocks = {};\n\t\tthis.subs = {}; // events\n\n\t\tthis.min = options.min || 10;\n\n\t\tthis.root = new Block( this, this, fragment, 'divvy-0', { children: blocks }, 0, 100, this.type, { top: true, right: true, bottom: true, left: true });\n\t\taddClass( this.root.node, 'divvy-root' );\n\t\tthis.el.appendChild( fragment );\n\n\t\tif ( options.shakeOnResize !== false ) {\n\t\t\tresizeHandler = function () {\n\t\t\t\tself._changedSinceLastResize = {};\n\t\t\t\tself.shake();\n\t\t\t\tfire( self, 'resize', self._changedSinceLastResize );\n\t\t\t};\n\n\t\t\tif ( window.addEventListener ) {\n\t\t\t\twindow.addEventListener( 'resize', resizeHandler );\n\t\t\t} else if ( window.attachEvent ) {\n\t\t\t\twindow.attachEvent( 'onresize', resizeHandler );\n\t\t\t}\n\t\t}\n\n\t\tthis._changed = {};\n\t\tthis._changedSinceLastResize = {};\n\t\tthis.shake();\n\t};\n\n\tDivvy.prototype = {\n\t\tshake: function () {\n\t\t\tvar bcr = this.el.getBoundingClientRect();\n\n\t\t\tthis.bcr = {\n\t\t\t\tleft: bcr.left,\n\t\t\t\tright: bcr.right,\n\t\t\t\ttop: bcr.top,\n\t\t\t\tbottom: bcr.bottom,\n\t\t\t\twidth: bcr.right - bcr.left,\n\t\t\t\theight: bcr.bottom - bcr.top\n\t\t\t};\n\n\t\t\tif ( ( this.bcr.width === this.width ) && ( this.bcr.height === this.height ) ) {\n\t\t\t\treturn; // nothing to do\n\t\t\t}\n\n\t\t\tthis.width = this.bcr.width;\n\t\t\tthis.height = this.bcr.height;\n\n\t\t\tthis.pixelSize = this[ this.type === COLUMN ? HEIGHT : WIDTH ];\n\n\t\t\tthis.root.shake();\n\n\t\t\treturn this;\n\t\t},\n\n\t\tchanged: function () {\n\t\t\tvar changed = this._changed;\n\t\t\tthis._changed = {};\n\n\t\t\treturn changed;\n\t\t},\n\n\t\tgetState: function () {\n\t\t\tvar state = {};\n\n\t\t\tgetState( this.root, state );\n\t\t\treturn state;\n\t\t},\n\n\t\tsetState: function ( state ) {\n\t\t\tvar changed = {}, key;\n\n\t\t\tsetState( this, this.root, state, changed );\n\n\t\t\t// if any of the sizes have changed, fire a resize event...\n\t\t\tfor ( key in changed ) {\n\t\t\t\tif ( changed.hasOwnProperty( key ) ) {\n\t\t\t\t\tfire( this, 'resize', changed );\n\n\t\t\t\t\t// ...but only the one\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\n\t\tsave: function ( id ) {\n\t\t\tvar key, value;\n\n\t\t\tif ( !localStorage ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tkey = ( id ? 'divvy_' + id : 'divvy' );\n\t\t\tvalue = JSON.stringify( this.getState() );\n\n\t\t\tlocalStorage.setItem( key, value );\n\n\t\t\treturn this;\n\t\t},\n\n\t\trestore: function ( id ) {\n\t\t\tvar key, value;\n\n\t\t\tif ( !localStorage ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tkey = ( id ? 'divvy_' + id : 'divvy' );\n\t\t\tvalue = JSON.parse( localStorage.getItem( key ) );\n\n\t\t\tif ( value ) {\n\t\t\t\tthis.setState( value );\n\t\t\t}\n\n\t\t\treturn this;\n\t\t},\n\n\t\ton: function ( eventName, callback ) {\n\t\t\tvar self = this, subs;\n\n\t\t\tif ( !( subs = this.subs[ eventName ] ) ) {\n\t\t\t\tthis.subs[ eventName ] = [ callback ];\n\t\t\t} else {\n\t\t\t\tsubs[ subs.length ] = callback;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tcancel: function () {\n\t\t\t\t\tself.off( eventName, callback );\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\n\t\toff: function ( eventName, callback ) {\n\t\t\tvar index, subs;\n\n\t\t\tif ( !eventName ) {\n\t\t\t\t// remove all listeners\n\t\t\t\tthis.subs = {};\n\t\t\t\treturn this;\n\t\t\t}\n\n\t\t\tif ( !callback ) {\n\t\t\t\t// remove all listeners of eventName\n\t\t\t\tdelete this.subs[ eventName ];\n\t\t\t\treturn this;\n\t\t\t}\n\n\t\t\tif ( !( subs = this.subs[ eventName ] ) ) {\n\t\t\t\treturn this;\n\t\t\t}\n\n\t\t\tindex = subs.indexOf( callback );\n\n\t\t\tif ( index !== -1 ) {\n\t\t\t\tsubs.splice( index, 1 );\n\t\t\t\tif ( !subs.length ) {\n\t\t\t\t\tdelete this.subs[ eventName ];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn this;\n\t\t}\n\t};\n\n\n\t// internal helpers\n\tfire = function ( divvy, eventName ) {\n\t\tvar args, subs, i, len;\n\n\t\tsubs = divvy.subs[ eventName ];\n\n\t\tif ( !subs ) {\n\t\t\treturn;\n\t\t}\n\n\t\targs = Array.prototype.slice.call( arguments, 2 );\n\n\t\t// call is faster if we can use it instead of apply\n\t\tif ( !args.length ) {\n\t\t\tfor ( i=0, len=subs.length; i<len; i+=1 ) {\n\t\t\t\tsubs[i].call( divvy );\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tfor ( i=0, len=subs.length; i<len; i+=1 ) {\n\t\t\tsubs[i].apply( divvy, args );\n\t\t}\n\t\treturn divvy;\n\t};\n\n\tgetState = function ( block, state ) {\n\t\tvar i;\n\n\t\tstate[ block.id ] = [ block.start, block.size ];\n\n\t\tif ( !block.children ) {\n\t\t\treturn;\n\t\t}\n\n\t\ti = block.children.length;\n\t\twhile ( i-- ) {\n\t\t\tgetState( block.children[i], state );\n\t\t}\n\t};\n\n\tsetState = function ( divvy, block, state, changed, noShake ) {\n\t\tvar i, len, child, totalSize, blockState;\n\n\t\tblockState = state[ block.id ];\n\n\t\tif ( !blockState ) {\n\t\t\treturn; // something went wrong...\n\t\t}\n\n\t\tif ( block.start !== blockState[0] || block.size !== blockState[1] ) {\n\t\t\tdivvy._changed[ block.id ] = changed[ block.id ] = true;\n\t\t}\n\n\t\tblock.start = blockState[0];\n\t\tblock.size = blockState[1];\n\t\tblock.end = block.start + block.size;\n\n\t\tblock.node.style[ block.type === COLUMN ? LEFT : TOP ] = block.start + '%';\n\t\tblock.node.style[ block.type === COLUMN ? WIDTH : HEIGHT ] = block.size + '%';\n\n\t\tif ( block.children ) {\n\t\t\ttotalSize = 0;\n\t\t\tlen = block.children.length;\n\n\t\t\tfor ( i=0; i<len; i+=1 ) {\n\t\t\t\tchild = block.children[i];\n\n\t\t\t\tsetState( divvy, child, state, changed, true );\n\t\t\t\ttotalSize += child.size;\n\n\t\t\t\tif ( block.controls[i] ) {\n\t\t\t\t\tblock.controls[i].setPosition( totalSize );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ti = block.children.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tsetState( divvy, block.children[i], state, changed, true );\n\t\t\t}\n\t\t}\n\n\t\t//if ( !noShake ) {\n\t\t\tblock.shake();\n\t\t//}\n\t};\n\n\tcursor = function ( divvy, direction ) {\n\t\tif ( !direction ) {\n\t\t\tdivvy.el.style.cursor = divvy._cursor;\n\t\t\treturn;\n\t\t}\n\n\t\tdivvy._cursor = divvy.el.style.cursor;\n\t\tdivvy.el.style.cursor = direction + '-resize';\n\t};\n\n\n\t// internal constructors\n\tBlock = function ( divvy, parent, parentNode, id, data, start, size, type, edges ) {\n\t\tvar totalSize, i, total, childData, childSize, node, before, after, childEdges;\n\n\t\tthis.start = start;\n\t\tthis.size = size;\n\t\tthis.end = this.start + this.size;\n\n\t\tthis.type = type;\n\t\tthis.divvy = divvy;\n\t\tthis.parent = parent;\n\t\tthis.edges = edges;\n\n\t\tthis.min = data.min || divvy.min;\n\t\tthis.max = data.max;\n\n\t\t// were we given an existing node?\n\t\tif ( data.nodeType === 1 ) { // duck typing, blech. But of course IE fucks up if you do data instanceof Element...\n\t\t\tdata = { node: data };\n\t\t}\n\n\t\t// or an ID string?\n\t\tif ( typeof data === 'string' ) {\n\t\t\tdata = { id: data };\n\t\t}\n\n\t\t// ...or an array of children?\n\t\tif ( Object.prototype.toString.call( data ) === '[object Array]' ) {\n\t\t\tdata = { children: data };\n\t\t}\n\n\t\tthis.id = data.id || id;\n\n\n\t\tif ( data.children && data.children.length ) {\n\t\t\t// Branch block\n\t\t\tthis.node = document.createElement( 'div' );\n\t\t\taddClass( this.node, 'divvy-block' );\n\t\t\taddClass( this.node, 'divvy-branch' );\n\n\t\t\tthis.node.id = this.id;\n\t\t}\n\n\t\telse {\n\t\t\t// Leaf block\n\t\t\tthis.node = document.createElement( 'div' );\n\t\t\taddClass( this.node, 'divvy-block' );\n\t\t\taddClass( this.node, 'divvy-leaf' );\n\n\t\t\t// do we have an ID that references an existing node?\n\t\t\tif ( !data.node && data.id && ( node = document.getElementById( data.id ) ) ) {\n\t\t\t\tdata.node = node;\n\t\t\t}\n\n\t\t\tif ( data.node ) {\n\t\t\t\tthis.inner = data.node;\n\t\t\t} else {\n\t\t\t\tthis.inner = document.createElement( 'div' );\n\t\t\t}\n\n\t\t\taddClass( this.inner, 'divvy-inner' );\n\t\t\tthis.node.appendChild( this.inner );\n\n\t\t\tdivvy.blocks[ this.id ] = this.inner;\n\n\t\t\tthis.inner.id = this.id;\n\t\t}\n\n\t\tif ( edges.top ) { addClass( this.node, 'divvy-top' ); }\n\t\tif ( edges.right ) { addClass( this.node, 'divvy-right' ); }\n\t\tif ( edges.bottom ) { addClass( this.node, 'divvy-bottom' ); }\n\t\tif ( edges.left ) { addClass( this.node, 'divvy-left' ); }\n\n\t\tthis.node.style[ type === COLUMN ? LEFT : TOP ] = start + '%';\n\t\tthis.node.style[ type === COLUMN ? WIDTH : HEIGHT ] = size + '%';\n\n\t\tif ( data.children ) {\n\t\t\t// find total size of children\n\t\t\ttotalSize = 0;\n\n\t\t\ti = data.children.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\ttotalSize += data.children[i].size || 1;\n\t\t\t}\n\n\t\t\tthis.children = [];\n\t\t\tthis.controls = [];\n\n\t\t\ttotal = 0;\n\t\t\tfor ( i=0; i<data.children.length; i+=1 ) {\n\t\t\t\tchildData = data.children[i];\n\t\t\t\tchildSize = 100 * ( ( childData.size || 1 ) / totalSize );\n\n\t\t\t\tchildEdges = {};\n\t\t\t\tif ( type === COLUMN ) {\n\t\t\t\t\tchildEdges.top = edges.top && ( i === 0 );\n\t\t\t\t\tchildEdges.bottom = edges.bottom && ( i === ( data.children.length - 1 ) );\n\t\t\t\t\tchildEdges.left = edges.left;\n\t\t\t\t\tchildEdges.right = edges.right;\n\t\t\t\t} else {\n\t\t\t\t\tchildEdges.left = edges.left && ( i === 0 );\n\t\t\t\t\tchildEdges.right = edges.right && ( i === ( data.children.length - 1 ) );\n\t\t\t\t\tchildEdges.top = edges.top;\n\t\t\t\t\tchildEdges.bottom = edges.bottom;\n\t\t\t\t}\n\n\n\n\t\t\t\tthis.children[i] = new Block( divvy, this, this.node, ( id + i ), childData, total, childSize, type === COLUMN ? ROW : COLUMN, childEdges );\n\n\t\t\t\ttotal += childSize;\n\t\t\t}\n\n\t\t\tfor ( i=0; i<data.children.length - 1; i+=1 ) {\n\t\t\t\tbefore = this.children[i];\n\t\t\t\tafter = this.children[ i + 1 ];\n\t\t\t\tthis.controls[i] = new Control( divvy, this, this.node, before, after, type === ROW ? VERTICAL : HORIZONTAL );\n\t\t\t}\n\t\t}\n\n\t\tparentNode.appendChild( this.node );\n\t};\n\n\tBlock.prototype = {\n\t\tsetStart: function ( start ) {\n\t\t\tvar previousStart, previousSize, change, size;\n\n\t\t\tpreviousStart = this.start;\n\t\t\tpreviousSize = this.size;\n\n\t\t\tchange = start - previousStart;\n\t\t\tsize = previousSize - change;\n\n\t\t\tthis.node.style[ this.type === COLUMN ? LEFT : TOP ] = start + '%';\n\t\t\tthis.node.style[ this.type === COLUMN ? WIDTH : HEIGHT ] = size + '%';\n\n\t\t\tthis.start = start;\n\t\t\tthis.size = size;\n\n\t\t\tthis.shake();\n\t\t},\n\n\t\tsetEnd: function ( end ) {\n\t\t\tvar previousEnd, previousSize, change, size;\n\n\t\t\tpreviousEnd = this.end;\n\t\t\tpreviousSize = this.size;\n\n\t\t\tchange = end - previousEnd;\n\t\t\tsize = previousSize + change;\n\n\t\t\t//this.node.style[ this.type === COLUMN ? LEFT : TOP ] = start + '%';\n\t\t\tthis.node.style[ this.type === COLUMN ? WIDTH : HEIGHT ] = size + '%';\n\n\t\t\tthis.end = end;\n\t\t\tthis.size = size;\n\n\t\t\tthis.shake();\n\t\t},\n\n\t\tshake: function () {\n\t\t\tvar i, len, a, b, control, size, bcr;\n\n\t\t\tbcr = this.node.getBoundingClientRect();\n\n\t\t\tthis.bcr = {\n\t\t\t\tleft: bcr.left,\n\t\t\t\tright: bcr.right,\n\t\t\t\ttop: bcr.top,\n\t\t\t\tbottom: bcr.bottom,\n\t\t\t\twidth: bcr.right - bcr.left,\n\t\t\t\theight: bcr.bottom - bcr.top\n\t\t\t};\n\n\t\t\tif ( ( this.bcr.width === this.width ) && ( this.bcr.height === this.height ) ) {\n\t\t\t\treturn; // nothing to do, no need to shake children\n\t\t\t}\n\n\t\t\tthis.width = this.bcr.width;\n\t\t\tthis.height = this.bcr.height;\n\t\t\tthis.divvy._changed[ this.id ] = this.divvy._changedSinceLastResize[ this.id ] = true;\n\n\t\t\t// if we don't have any children, we don't need to go any further\n\t\t\tif ( !this.children ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.pixelSize = this.bcr[ this.type === COLUMN ? HEIGHT : WIDTH ];\n\n\t\t\t// enforce minima and maxima - first go forwards\n\t\t\tlen = this.children.length;\n\t\t\tfor ( i=0; i<len - 1; i+=1 ) {\n\t\t\t\ta = this.children[i];\n\t\t\t\tb = this.children[ i+1 ];\n\t\t\t\tcontrol = this.controls[i];\n\n\t\t\t\tsize = a.minPc();\n\t\t\t\tif ( a.size < size ) {\n\t\t\t\t\ta.setEnd( a.start + size );\n\t\t\t\t\tb.setStart( a.start + size );\n\t\t\t\t\tcontrol.setPosition( a.start + size );\n\t\t\t\t}\n\n\t\t\t\tsize = a.maxPc();\n\t\t\t\tif ( a.size > size ) {\n\t\t\t\t\ta.setEnd( a.start + size );\n\t\t\t\t\tb.setStart( a.start + size );\n\t\t\t\t\tcontrol.setPosition( a.start + size );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// then backwards\n\t\t\tfor ( i=len -1; i>0; i-=1 ) {\n\t\t\t\ta = this.children[ i-1 ];\n\t\t\t\tb = this.children[i];\n\t\t\t\tcontrol = this.controls[ i-1 ];\n\n\t\t\t\tsize = b.minPc();\n\t\t\t\tif ( b.size < size ) {\n\t\t\t\t\ta.setEnd( b.end - size );\n\t\t\t\t\tb.setStart( b.end - size );\n\t\t\t\t\tcontrol.setPosition( b.end - size );\n\t\t\t\t}\n\n\t\t\t\tsize = b.maxPc();\n\t\t\t\tif ( b.size > size ) {\n\t\t\t\t\ta.setEnd( b.end - size );\n\t\t\t\t\tb.setStart( b.end - size );\n\t\t\t\t\tcontrol.setPosition( b.end - size );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ti = this.children.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tthis.children[i].shake();\n\t\t\t}\n\t\t},\n\n\t\tminPc: function () {\n\t\t\tvar totalPixels;\n\n\t\t\t// calculate minimum % width from pixels\n\t\t\ttotalPixels = this.parent.pixelSize;\n\t\t\treturn ( this.min / totalPixels ) * 100;\n\t\t},\n\n\t\tmaxPc: function () {\n\t\t\tvar totalPixels;\n\n\t\t\tif ( !this.max ) {\n\t\t\t\treturn 100;\n\t\t\t}\n\n\t\t\t// calculate minimum % width from pixels\n\t\t\ttotalPixels = this.parent.pixelSize;\n\t\t\treturn ( this.max / totalPixels ) * 100;\n\t\t}\n\t};\n\n\n\tControl = function ( divvy, parent, parentNode, before, after, type ) {\n\t\tvar self = this, mousedownHandler;\n\n\t\tthis.divvy = divvy;\n\t\tthis.parent = parent;\n\t\tthis.before = before;\n\t\tthis.after = after;\n\t\tthis.type = type;\n\n\t\tthis.parentNode = parentNode;\n\n\t\tthis.node = document.createElement( 'div' );\n\t\taddClass( this.node, 'divvy-' + type + '-control' );\n\n\t\tif ( touch ) {\n\t\t\taddClass( this.node, 'divvy-touch-control' );\n\t\t}\n\n\t\t// initialise position to the start of the next block\n\t\tthis.setPosition( after.start );\n\n\t\tmousedownHandler = function ( event ) {\n\t\t\tvar start, min, max, afterEnd, move, up, cancel;\n\n\t\t\tif ( event.preventDefault ) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\n\t\t\t// constraints\n\t\t\tmin = Math.max( before.start + before.minPc(), after.end - after.maxPc() );\n\t\t\tmax = Math.min( before.start + before.maxPc(), after.end - after.minPc() );\n\n\t\t\tmove = function ( event ) {\n\t\t\t\tvar position;\n\n\t\t\t\tposition = self.getPosition( event[ type === VERTICAL ? CLIENTX : CLIENTY ] );\n\t\t\t\tposition = Math.max( min, Math.min( max, position ) );\n\n\t\t\t\tbefore.setEnd( position );\n\t\t\t\tafter.setStart( position );\n\n\t\t\t\tself.setPosition( position );\n\n\t\t\t\tfire( self.divvy, 'resize', self.divvy._changedSinceLastResize );\n\t\t\t\tself.divvy._changedSinceLastResize = {};\n\t\t\t};\n\n\t\t\tup = function ( event ) {\n\t\t\t\tself.setInactive();\n\t\t\t\tcancel();\n\t\t\t};\n\n\t\t\tcancel = function () {\n\t\t\t\tif ( document.removeEventListener ) {\n\t\t\t\t\tdocument.removeEventListener( 'mousemove', move );\n\t\t\t\t\tdocument.removeEventListener( 'mouseup', up );\n\t\t\t\t} else if ( document.detachEvent ) {\n\t\t\t\t\tdocument.detachEvent( 'onmousemove', move );\n\t\t\t\t\tdocument.detachEvent( 'onmouseup', up );\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tif ( document.addEventListener ) {\n\t\t\t\tdocument.addEventListener( 'mousemove', move );\n\t\t\t\tdocument.addEventListener( 'mouseup', up );\n\t\t\t} else if ( document.attachEvent ) {\n\t\t\t\tdocument.attachEvent( 'onmousemove', move = throttle( move ) );\n\t\t\t\tdocument.attachEvent( 'onmouseup', up );\n\t\t\t}\n\t\t};\n\n\t\tif ( this.node.addEventListener ) {\n\t\t\tthis.node.addEventListener( 'mousedown', mousedownHandler );\n\t\t} else if ( this.node.attachEvent ) {\n\t\t\tthis.node.attachEvent( 'onmousedown', mousedownHandler );\n\t\t}\n\n\t\tif ( touch ) {\n\t\t\tthis.node.addEventListener( 'touchstart', function ( event ) {\n\t\t\t\tvar touch, pos, finger, start, min, max, afterEnd, move, up, cancel;\n\n\t\t\t\tif ( event.touches.length !== 1 ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\ttouch = event.touches[0];\n\t\t\t\tfinger = touch.identifier;\n\n\t\t\t\tself.setActive();\n\n\t\t\t\t// constraints\n\t\t\t\tmin = Math.max( before.start + before.minPc(), after.end - after.maxPc() );\n\t\t\t\tmax = Math.min( before.start + before.maxPc(), after.end - after.minPc() );\n\n\t\t\t\tmove = function ( event ) {\n\t\t\t\t\tvar position, touch;\n\n\t\t\t\t\tif ( event.touches.length !== 1 || event.touches[0].identifier !== finger ) {\n\t\t\t\t\t\tcancel();\n\t\t\t\t\t}\n\n\t\t\t\t\ttouch = event.touches[0];\n\n\t\t\t\t\tposition = self.getPosition( touch[ type === VERTICAL ? CLIENTX : CLIENTY ] );\n\t\t\t\t\tposition = Math.max( min, Math.min( max, position ) );\n\n\t\t\t\t\tbefore.setEnd( position );\n\t\t\t\t\tafter.setStart( position );\n\n\t\t\t\t\tself.setPosition( position );\n\n\t\t\t\t\tfire( self.divvy, 'resize', self.divvy._changedSinceLastResize );\n\t\t\t\t\tself.divvy._changedSinceLastResize = {};\n\t\t\t\t};\n\n\t\t\t\tup = function ( event ) {\n\t\t\t\t\tself.setInactive();\n\t\t\t\t\tcancel();\n\t\t\t\t};\n\n\t\t\t\tcancel = function () {\n\t\t\t\t\twindow.removeEventListener( 'touchmove', move );\n\t\t\t\t\twindow.removeEventListener( 'touchend', up );\n\t\t\t\t\twindow.removeEventListener( 'touchcancel', up );\n\t\t\t\t};\n\n\t\t\t\twindow.addEventListener( 'touchmove', move );\n\t\t\t\twindow.addEventListener( 'touchend', up );\n\t\t\t\twindow.addEventListener( 'touchcancel', up );\n\t\t\t});\n\t\t}\n\n\t\tparentNode.appendChild( this.node );\n\t};\n\n\tControl.prototype = {\n\t\tsetActive: function ( pos ) {\n\t\t\taddClass( this.node, 'divvy-active' );\n\t\t\tcursor( this.divvy, this.type === VERTICAL ? 'ew' : 'ns' );\n\t\t},\n\n\t\tsetInactive: function ( pos ) {\n\t\t\tremoveClass( this.node, 'divvy-active' );\n\t\t\tcursor( this.divvy, false );\n\t\t},\n\n\t\tgetPosition: function ( px ) {\n\t\t\tvar bcr, bcrStart, bcrSize, position;\n\n\t\t\tbcr = this.parent.bcr;\n\t\t\tbcrStart = bcr[ this.type === VERTICAL ? LEFT : TOP ];\n\t\t\tbcrSize = bcr[ this.type === VERTICAL ? WIDTH : HEIGHT ];\n\n\t\t\tposition = 100 * ( px - bcrStart ) / bcrSize;\n\n\t\t\treturn position;\n\t\t},\n\n\t\tsetPosition: function ( pos ) {\n\t\t\tthis.node.style[ this.type === VERTICAL ? LEFT : TOP ] = pos + '%';\n\t\t\tthis.pos = pos;\n\t\t}\n\t};\n\n\n\t// shims\n\tindexOf = function ( needle, haystack ) {\n\t\tvar i, len;\n\n\t\tfor ( i=0, len=haystack.length; i<len; i+=1 ) {\n\t\t\tif ( haystack[i] === needle ) {\n\t\t\t\treturn needle;\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t};\n\n\ttrim = function ( str ) {\n\t\treturn str.replace( /^\\s*/, '' ).replace( /\\s*$/, '' );\n\t};\n\n\taddClass = function ( node, className ) {\n\t\tif ( node.classList && node.classList.add ) {\n\t\t\taddClass = function ( node, className ) {\n\t\t\t\tnode.classList.add( className );\n\t\t\t};\n\t\t}\n\n\t\telse {\n\t\t\taddClass = function ( node, className ) {\n\t\t\t\tvar classNames, index, i;\n\n\t\t\t\tclassNames = ( node.getAttribute( 'class' ) || '' ).split( ' ' );\n\n\t\t\t\ti = classNames.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tclassNames[i] = trim( classNames[i] );\n\t\t\t\t}\n\n\t\t\t\tif ( classNames.indexOf ) {\n\t\t\t\t\tindex = classNames.indexOf( className );\n\t\t\t\t} else {\n\t\t\t\t\tindex = indexOf( className, classNames );\n\t\t\t\t}\n\n\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\tnode.setAttribute( 'class', classNames.concat( className ).join( ' ' ) );\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\taddClass( node, className );\n\t};\n\n\tremoveClass = function ( node, className ) {\n\t\tif ( node.classList && node.classList.remove ) {\n\t\t\tremoveClass = function ( node, className ) {\n\t\t\t\tnode.classList.remove( className );\n\t\t\t};\n\t\t}\n\n\t\telse {\n\t\t\tremoveClass = function ( node, className ) {\n\t\t\t\tvar classNames, index, i;\n\n\t\t\t\tclassNames = ( node.getAttribute( 'class' ) || '' ).split( ' ' );\n\n\t\t\t\ti = classNames.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tclassNames[i] = trim( classNames[i] );\n\t\t\t\t}\n\n\t\t\t\tif ( classNames.indexOf ) {\n\t\t\t\t\tindex = classNames.indexOf( className );\n\t\t\t\t} else {\n\t\t\t\t\tindex = indexOf( className, classNames );\n\t\t\t\t}\n\n\t\t\t\tif ( index !== -1 ) {\n\t\t\t\t\tclassNames.splice( index, 1 );\n\t\t\t\t\tnode.setAttribute( 'class', classNames.join( ' ' ) );\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tremoveClass( node, className );\n\t};\n\n\tthrottle = function ( fn, wait ) {\n\t\tvar throttled, lastCalled;\n\n\t\twait = wait || 500;\n\n\t\tthrottled = function () {\n\t\t\tvar timeNow;\n\n\t\t\ttimeNow = new Date();\n\n\t\t\tif ( !lastCalled || ( timeNow - lastCalled ) > wait ) {\n\t\t\t\treturn fn.apply( this, arguments );\n\t\t\t\tlastCalled = timeNow;\n\t\t\t}\n\t\t};\n\n\t\treturn throttled;\n\t};\n\n}());\n\t// export as AMD\n\tif ( typeof define === 'function' && define.amd ) {\n\t\tdefine( function () { return Divvy; });\n\t}\n\n\t// export as CJS\n\telse if ( typeof module !== 'undefined' && module.exports ) {\n\t\tmodule.exports = Divvy;\n\t}\n\n\t// export as browser global\n\telse {\n\t\tglobal.Divvy = Divvy;\n\t}\n\n}( this ));\n","/*\r\n\r\n\tractive-transitions-fade\r\n\t========================\r\n\r\n\tVersion 0.1.2.\r\n\r\n\tThis plugin does exactly what it says on the tin - it fades elements\r\n\tin and out, using CSS transitions. You can control the following\r\n\tproperties: `duration`, `delay` and `easing` (which must be a valid\r\n\tCSS transition timing function, and defaults to `linear`).\r\n\r\n\tThe `duration` property is in milliseconds, and defaults to 300 (you\r\n\tcan also use `fast` or `slow` instead of a millisecond value, which\r\n\tequate to 200 and 600 respectively). As a shorthand, you can use\r\n\t`intro='fade:500'` instead of `intro='fade:{\"duration\":500}'` - this\r\n\tapplies to many other transition plugins as well.\r\n\r\n\tIf an element has an opacity other than 1 (whether directly, because\r\n\tof an inline style, or indirectly because of a CSS rule), it will be\r\n\trespected. You can override the target opacity of an intro fade by\r\n\tspecifying a `to` property between 0 and 1.\r\n\r\n\t==========================\r\n\r\n\tTroubleshooting: If you're using a module system in your app (AMD or\r\n\tsomething more nodey) then you may need to change the paths below,\r\n\twhere it says `require( 'Ractive' )` or `define([ 'Ractive' ]...)`.\r\n\r\n\t==========================\r\n\r\n\tUsage: Include this file on your page below Ractive, e.g:\r\n\r\n\t    <script src='lib/ractive.js'></script>\r\n\t    <script src='lib/ractive-transitions-fade.js'></script>\r\n\r\n\tOr, if you're using a module loader, require this module:\r\n\r\n\t    // requiring the plugin will 'activate' it - no need to use\r\n\t    // the return value\r\n\t    require( 'ractive-transitions-fade' );\r\n\r\n\tAdd a fade transition like so:\r\n\r\n\t    <div intro='fade'>this will fade in</div>\r\n\r\n*/\r\n\r\n(function ( global, factory ) {\r\n\r\n\t'use strict';\r\n\r\n\t// Common JS (i.e. browserify) environment\r\n\tif ( typeof module !== 'undefined' && module.exports && typeof require === 'function' ) {\r\n\t\tfactory( require( 'vendor' ).Ractive );\r\n\t}\r\n\r\n\t// AMD?\r\n\telse if ( typeof define === 'function' && define.amd ) {\r\n\t\tdefine([ 'ractive' ], factory );\r\n\t}\r\n\r\n\t// browser global\r\n\telse if ( global.Ractive ) {\r\n\t\tfactory( global.Ractive );\r\n\t}\r\n\r\n\telse {\r\n\t\tthrow new Error( 'Could not find Ractive! It must be loaded before the ractive-transitions-fade plugin' );\r\n\t}\r\n\r\n}( typeof window !== 'undefined' ? window : this, function ( Ractive ) {\r\n\r\n\t'use strict';\r\n\r\n\tvar fade, defaults;\r\n\r\n\tdefaults = {\r\n\t\tdelay: 0,\r\n\t\tduration: 300,\r\n\t\teasing: 'linear'\r\n\t};\r\n\r\n\tfade = function ( t, params ) {\r\n\t\tvar targetOpacity;\r\n\r\n\t\tparams = t.processParams( params, defaults );\r\n\r\n\t\tif ( t.isIntro ) {\r\n\t\t\ttargetOpacity = t.getStyle( 'opacity' );\r\n\t\t\tt.setStyle( 'opacity', 0 );\r\n\t\t} else {\r\n\t\t\ttargetOpacity = 0;\r\n\t\t}\r\n\r\n\t\tt.animateStyle( 'opacity', targetOpacity, params ).then( t.complete );\r\n\t};\r\n\r\n\tRactive.transitions.fade = fade;\r\n\r\n}));","/*\r\n\r\n\tractive-transitions-fly\r\n\t=======================\r\n\r\n\tVersion 0.1.3.\r\n\r\n\tThis transition uses CSS transforms to 'fly' elements to their\r\n\tnatural location on the page, fading in from transparent as they go.\r\n\tBy default, they will fly in from left.\r\n\r\n\t==========================\r\n\r\n\tTroubleshooting: If you're using a module system in your app (AMD or\r\n\tsomething more nodey) then you may need to change the paths below,\r\n\twhere it says `require( 'ractive' )` or `define([ 'ractive' ]...)`.\r\n\r\n\t==========================\r\n\r\n\tUsage: Include this file on your page below Ractive, e.g:\r\n\r\n\t    <script src='lib/ractive.js'></script>\r\n\t    <script src='lib/ractive-transitions-fly.js'></script>\r\n\r\n\tOr, if you're using a module loader, require this module:\r\n\r\n\t    // requiring the plugin will 'activate' it - no need to use\r\n\t    // the return value\r\n\t    require( 'ractive-transitions-fly' );\r\n\r\n\tYou can adjust the following parameters: `x`, `y`, `duration`,\r\n\t`delay` and `easing`.\r\n\r\n*/\r\n\r\n(function ( global, factory ) {\r\n\r\n\t'use strict';\r\n\r\n\t// Common JS (i.e. browserify) environment\r\n\tif ( typeof module !== 'undefined' && module.exports && typeof require === 'function' ) {\r\n\t\tfactory( require( 'vendor' ).Ractive );\r\n\t}\r\n\r\n\t// AMD?\r\n\telse if ( typeof define === 'function' && define.amd ) {\r\n\t\tdefine([ 'ractive' ], factory );\r\n\t}\r\n\r\n\t// browser global\r\n\telse if ( global.Ractive ) {\r\n\t\tfactory( global.Ractive );\r\n\t}\r\n\r\n\telse {\r\n\t\tthrow new Error( 'Could not find Ractive! It must be loaded before the ractive-transitions-fly plugin' );\r\n\t}\r\n\r\n}( typeof window !== 'undefined' ? window : this, function ( Ractive ) {\r\n\r\n\t'use strict';\r\n\r\n\tvar fly, addPx, defaults;\r\n\r\n\tdefaults = {\r\n\t\tduration: 400,\r\n\t\teasing: 'easeOut',\r\n\t\topacity: 0,\r\n\t\tx: -500,\r\n\t\ty: 0\r\n\t};\r\n\r\n\taddPx = function ( num ) {\r\n\t\tif ( num === 0 || typeof num === 'string' ) {\r\n\t\t\treturn num;\r\n\t\t}\r\n\r\n\t\treturn num + 'px';\r\n\t};\r\n\r\n\tfly = function ( t, params ) {\r\n\t\tvar x, y, offscreen, target;\r\n\r\n\t\tparams = t.processParams( params, defaults );\r\n\r\n\t\tx = addPx( params.x );\r\n\t\ty = addPx( params.y );\r\n\r\n\t\toffscreen = {\r\n\t\t\ttransform: 'translate(' + x + ',' + y + ')',\r\n\t\t\topacity: 0\r\n\t\t};\r\n\r\n\t\tif ( t.isIntro ) {\r\n\t\t\t// animate to the current style\r\n\t\t\ttarget = t.getStyle([ 'opacity', 'transform' ]);\r\n\r\n\t\t\t// set offscreen style\r\n\t\t\tt.setStyle( offscreen );\r\n\t\t} else {\r\n\t\t\ttarget = offscreen;\r\n\t\t}\r\n\r\n\t\tt.animateStyle( target, params ).then( t.complete );\r\n\t};\r\n\r\n\tRactive.transitions.fly = fly;\r\n\r\n}));","var data = {\r\n\tnote: 13,\r\n\tbarline: {\r\n\t\tnormal: 8,\r\n\t\trepeat_start: 16,\r\n\t\trepeat_end: 20\r\n\t},\r\n\trest: 13\r\n};\r\n\r\nmodule.exports = data;","'use strict';\r\n\r\nvar line_types = {\r\n\t\"drawable\": 0,\r\n\t\"data\": 1,\r\n\t\"hidden\": 2\r\n};\r\n\r\nvar line_actions = {\r\n\t\"delete\": 0,\r\n\t\"add\": 1,\r\n\t\"move\": 2,\r\n\t\"nothing\": 3\r\n};\r\n\r\nObject.freeze(line_types);\r\nObject.freeze(line_actions);\r\n\r\nmodule.exports = {\r\n\tline_types: line_types,\r\n\tline_actions: line_actions\r\n};","var\r\n    POS_SWITCH = 6;\r\n\r\nvar AbcBeam = function(notes) {\r\n\r\n\tvar hNote, lNote, hNoteIndex, lNoteIndex;\r\n\r\n    var avgPos = this.avgPos = notes.reduce(function(a, b, i) { \r\n\r\n    \tif(lNote === undefined || lNote.truepos > b.truepos) {\r\n            lNote = b;\r\n            lNoteIndex = i;\r\n        }\r\n\r\n    \tif(hNote === undefined || hNote.truepos < b.truepos) {\r\n            hNote = b;\r\n            hNoteIndex = i;\r\n        }\r\n\r\n    \treturn a + b.truepos; \r\n\r\n    }, 0) / notes.length;\r\n\r\n    var downBeam = this.downBeam = avgPos > POS_SWITCH;\r\n\r\n    notes.forEach(function(note) {\r\n    \tnote.forceStem = downBeam ? 1 : -1;\r\n    });\r\n\r\n    var baseNote = this.baseNote = this.downBeam ? lNote : hNote;\r\n    this.baseNoteIndex = this.downBeam ? lNoteIndex : hNoteIndex;\r\n\r\n    var x, y;\r\n    var sum_x = 0;\r\n    var sum_y = 0;\r\n    var sum_xy = 0;\r\n    var sum_xx = 0;\r\n    var count = 0;\r\n\r\n    for (var v = 0; v < notes.length; v++) {\r\n        x = notes[v].xp;//notes[v].truepos;\r\n        y = notes[v].truepos;\r\n        sum_x += x;\r\n        sum_y += y;\r\n        sum_xx += x*x;\r\n        sum_xy += x*y;\r\n        count++;\r\n    }\r\n\r\n    var m = ((count*sum_xy - sum_x*sum_y) / (count*sum_xx - sum_x*sum_x))*2;\r\n\r\n    notes.forEach(function(note) {\r\n        var xpDist = note.xp - baseNote.xp;\r\n        var heightDiff = Math.abs(note.y - baseNote.y);\r\n        note.beamOffsetFactor = (xpDist * -m) + baseNote.y + (downBeam ? 28 : -28);\r\n        note.beamed = true;\r\n    });\r\n\r\n    this.gradient = m;\r\n    this.depth = 0;\r\n    this.notes = notes;\r\n    this.count = notes.length;\r\n}\r\n\r\nAbcBeam.prototype.subType = \"\";\r\nAbcBeam.prototype.weight = 0;\r\n\r\nmodule.exports = AbcBeam;","////////////\r\n// Symbol //\r\n////////////\r\n\r\nvar chordRegex = /^([A-G](?:b|#)?)(m|min|maj|dim|aug|\\+|sus)?(2|4|7|9|13)?(\\/[A-G](?:b|#)?)?$/i;\r\n\r\nvar zaz = require('zazate.js');\r\n\r\nvar transposeNote = function (note, a) {\r\n\tvar transposedInt = zaz.notes.note_to_int(note.toUpperCase()) + a;\r\n\tvar hashed = ((transposedInt % 12) + 12) % 12;\r\n\treturn zaz.notes.int_to_note(hashed); \r\n}\r\n\r\nvar AbcChord = function(text) {\r\n    this.text = text;\r\n\r\n    var regexTestResult = chordRegex.exec(text);\r\n\r\n    if(regexTestResult === null) {\r\n    \tthis.parsed = false;\r\n    } else {\r\n    \tthis.parsed = true;\r\n\r\n    \tthis.note = regexTestResult[1];\r\n    \tthis.type = regexTestResult[2];\r\n    \tthis.number = regexTestResult[3];\r\n    \tthis.base = regexTestResult[4];\r\n    }\r\n\r\n    this.getText = function (transpose) {\r\n    \tif(!this.parsed || transpose === 0) return this.text;\r\n\r\n    \tvar output = transposeNote(this.note, transpose);\r\n    \tif(this.type) output += this.type;\r\n    \tif(this.number) output += this.number;\r\n    \tif(this.base) output += \"/\" + transposeNote(this.base.substr(1), transpose);\r\n   \t\treturn output; \t\r\n    };\r\n}\r\n\r\nmodule.exports = {\r\n    AbcChord: AbcChord,\r\n};","////////////\r\n// Symbol //\r\n////////////\r\n\r\nvar AbcSymbol = function(type) {\r\n    this.type = type;\r\n}\r\n\r\nAbcSymbol.prototype.subType = \"\";\r\nAbcSymbol.prototype.visible = true;\r\nAbcSymbol.prototype.xp = 0;\r\nAbcSymbol.prototype.align = 0;\r\n\r\nAbcSymbol.prototype.fixedWidth = 0;\r\nAbcSymbol.prototype.springConstant = 0;\r\n\r\n\r\nAbcSymbol.prototype.getX = function(leadInWidth, lineWidth) {\r\n    return (this.xp * (lineWidth - leadInWidth)) + leadInWidth;\r\n}\r\n\r\n\r\nvar AbcNote = function() {\r\n    AbcSymbol.call(this, \"note\");\r\n    this.decorations = [];\r\n}\r\n\r\nAbcNote.prototype = Object.create(AbcSymbol.prototype);\r\nAbcNote.prototype.beamDepth = 0;\r\nAbcNote.prototype.octave = 4;\r\nAbcNote.prototype.pitch = 0;\r\nAbcNote.prototype.pos = 0;\r\nAbcNote.prototype.truepos = 0;\r\nAbcNote.prototype.letter = \"\";\r\nAbcNote.prototype.accidentals = \"\";\r\nAbcNote.prototype.noteLength = 1;\r\nAbcNote.prototype.beams = [];\r\nAbcNote.prototype.forceStem = 0;\r\nAbcNote.prototype.beamOffsetFactor = 0;\r\nAbcNote.prototype.y = null;\r\nAbcNote.prototype.beamed = false;\r\nAbcNote.prototype.chord = \"\";\r\n\r\nvar AbcRest = function() {\r\n    AbcSymbol.call(this, \"rest\", 1);\r\n}\r\n\r\nAbcRest.prototype = Object.create(AbcSymbol.prototype);\r\nAbcRest.prototype.restLength = 1;\r\n\r\nmodule.exports = {\r\n    AbcNote: AbcNote,\r\n    AbcSymbol: AbcSymbol,\r\n    AbcRest: AbcRest\r\n};","/////////////\r\n// ABCLine //\r\n/////////////\r\n\r\nvar AbcLine = function(raw, id) {\r\n    this.raw = raw;\r\n    this.id = id;\r\n    this.endings = [];\r\n    this.tuplets = [];\r\n    this.firstEndingEnder = null;\r\n}\r\n\r\nAbcLine.prototype.type = \"hidden\";\r\nAbcLine.prototype.di = -1;\r\nAbcLine.prototype.parsed = [];\r\nAbcLine.prototype.weight = 0;\r\nAbcLine.prototype.error = false;\r\nAbcLine.prototype.changed = false;\r\nAbcLine.prototype.endWithEndingBar = false;\r\n\r\n///////////////////\r\n//LineCollection //\r\n///////////////////\r\n\r\nvar LineCollection = function(id, raw, action) {\r\n    \r\n    var split = raw.split(/\\r\\n|\\r|\\n/);\r\n\r\n    if (split[split.length - 1] === '') {\r\n        split = split.slice(0, split.length - 1);\r\n    }\r\n\r\n    this.lines = split.map(function(line, i) {\r\n        return new AbcLine(line, i + id);\r\n    });\r\n\r\n    this.count = this.lines.length;\r\n\r\n    this.action = action;\r\n\r\n    this.startId = id;\r\n};\r\n\r\nmodule.exports = {\r\n    LineCollection,\r\n    AbcLine\r\n};","'use strict';\r\n\r\n//polyfill \r\nrequire('isomorphic-fetch');\r\n\r\nmodule.exports = {\r\n\tlodash: require('lodash'),\r\n\tlex: require('lex'),\r\n\tRactive: require('ractive/ractive'),\r\n    \r\n    page: require('page'),\r\n    jsDiff: require('diff'),\r\n    codeMirror: require('codemirror'),\r\n    codeMirrorLint: require('codemirror/addon/lint/lint'),\r\n    filesaver: require('filesaver.js'),\r\n    combokeys: require('combokeys'),\r\n    screenfull: require('screenfull'),\r\n    zazate: require('zazate.js'),\r\n\r\n    queryString: require('query-string'),\r\n    sizzle: require('sizzle'),\r\n    domready: require('domready'),\r\n    sortable: require('sortablejs')\r\n};","/*\n * base64-arraybuffer\n * https://github.com/niklasvh/base64-arraybuffer\n *\n * Copyright (c) 2012 Niklas von Hertzen\n * Licensed under the MIT license.\n */\n(function(chars){\n  \"use strict\";\n\n  exports.encode = function(arraybuffer) {\n    var bytes = new Uint8Array(arraybuffer),\n    i, len = bytes.length, base64 = \"\";\n\n    for (i = 0; i < len; i+=3) {\n      base64 += chars[bytes[i] >> 2];\n      base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n      base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n      base64 += chars[bytes[i + 2] & 63];\n    }\n\n    if ((len % 3) === 2) {\n      base64 = base64.substring(0, base64.length - 1) + \"=\";\n    } else if (len % 3 === 1) {\n      base64 = base64.substring(0, base64.length - 2) + \"==\";\n    }\n\n    return base64;\n  };\n\n  exports.decode =  function(base64) {\n    var bufferLength = base64.length * 0.75,\n    len = base64.length, i, p = 0,\n    encoded1, encoded2, encoded3, encoded4;\n\n    if (base64[base64.length - 1] === \"=\") {\n      bufferLength--;\n      if (base64[base64.length - 2] === \"=\") {\n        bufferLength--;\n      }\n    }\n\n    var arraybuffer = new ArrayBuffer(bufferLength),\n    bytes = new Uint8Array(arraybuffer);\n\n    for (i = 0; i < len; i+=4) {\n      encoded1 = chars.indexOf(base64[i]);\n      encoded2 = chars.indexOf(base64[i+1]);\n      encoded3 = chars.indexOf(base64[i+2]);\n      encoded4 = chars.indexOf(base64[i+3]);\n\n      bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n      bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n      bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n\n    return arraybuffer;\n  };\n})(\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\");\n","var lookup = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n;(function (exports) {\n\t'use strict';\n\n  var Arr = (typeof Uint8Array !== 'undefined')\n    ? Uint8Array\n    : Array\n\n\tvar PLUS   = '+'.charCodeAt(0)\n\tvar SLASH  = '/'.charCodeAt(0)\n\tvar NUMBER = '0'.charCodeAt(0)\n\tvar LOWER  = 'a'.charCodeAt(0)\n\tvar UPPER  = 'A'.charCodeAt(0)\n\tvar PLUS_URL_SAFE = '-'.charCodeAt(0)\n\tvar SLASH_URL_SAFE = '_'.charCodeAt(0)\n\n\tfunction decode (elt) {\n\t\tvar code = elt.charCodeAt(0)\n\t\tif (code === PLUS ||\n\t\t    code === PLUS_URL_SAFE)\n\t\t\treturn 62 // '+'\n\t\tif (code === SLASH ||\n\t\t    code === SLASH_URL_SAFE)\n\t\t\treturn 63 // '/'\n\t\tif (code < NUMBER)\n\t\t\treturn -1 //no match\n\t\tif (code < NUMBER + 10)\n\t\t\treturn code - NUMBER + 26 + 26\n\t\tif (code < UPPER + 26)\n\t\t\treturn code - UPPER\n\t\tif (code < LOWER + 26)\n\t\t\treturn code - LOWER + 26\n\t}\n\n\tfunction b64ToByteArray (b64) {\n\t\tvar i, j, l, tmp, placeHolders, arr\n\n\t\tif (b64.length % 4 > 0) {\n\t\t\tthrow new Error('Invalid string. Length must be a multiple of 4')\n\t\t}\n\n\t\t// the number of equal signs (place holders)\n\t\t// if there are two placeholders, than the two characters before it\n\t\t// represent one byte\n\t\t// if there is only one, then the three characters before it represent 2 bytes\n\t\t// this is just a cheap hack to not do indexOf twice\n\t\tvar len = b64.length\n\t\tplaceHolders = '=' === b64.charAt(len - 2) ? 2 : '=' === b64.charAt(len - 1) ? 1 : 0\n\n\t\t// base64 is 4/3 + up to two characters of the original data\n\t\tarr = new Arr(b64.length * 3 / 4 - placeHolders)\n\n\t\t// if there are placeholders, only get up to the last complete 4 chars\n\t\tl = placeHolders > 0 ? b64.length - 4 : b64.length\n\n\t\tvar L = 0\n\n\t\tfunction push (v) {\n\t\t\tarr[L++] = v\n\t\t}\n\n\t\tfor (i = 0, j = 0; i < l; i += 4, j += 3) {\n\t\t\ttmp = (decode(b64.charAt(i)) << 18) | (decode(b64.charAt(i + 1)) << 12) | (decode(b64.charAt(i + 2)) << 6) | decode(b64.charAt(i + 3))\n\t\t\tpush((tmp & 0xFF0000) >> 16)\n\t\t\tpush((tmp & 0xFF00) >> 8)\n\t\t\tpush(tmp & 0xFF)\n\t\t}\n\n\t\tif (placeHolders === 2) {\n\t\t\ttmp = (decode(b64.charAt(i)) << 2) | (decode(b64.charAt(i + 1)) >> 4)\n\t\t\tpush(tmp & 0xFF)\n\t\t} else if (placeHolders === 1) {\n\t\t\ttmp = (decode(b64.charAt(i)) << 10) | (decode(b64.charAt(i + 1)) << 4) | (decode(b64.charAt(i + 2)) >> 2)\n\t\t\tpush((tmp >> 8) & 0xFF)\n\t\t\tpush(tmp & 0xFF)\n\t\t}\n\n\t\treturn arr\n\t}\n\n\tfunction uint8ToBase64 (uint8) {\n\t\tvar i,\n\t\t\textraBytes = uint8.length % 3, // if we have 1 byte left, pad 2 bytes\n\t\t\toutput = \"\",\n\t\t\ttemp, length\n\n\t\tfunction encode (num) {\n\t\t\treturn lookup.charAt(num)\n\t\t}\n\n\t\tfunction tripletToBase64 (num) {\n\t\t\treturn encode(num >> 18 & 0x3F) + encode(num >> 12 & 0x3F) + encode(num >> 6 & 0x3F) + encode(num & 0x3F)\n\t\t}\n\n\t\t// go through the array every three bytes, we'll deal with trailing stuff later\n\t\tfor (i = 0, length = uint8.length - extraBytes; i < length; i += 3) {\n\t\t\ttemp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])\n\t\t\toutput += tripletToBase64(temp)\n\t\t}\n\n\t\t// pad the end with zeros, but make sure to not forget the extra bytes\n\t\tswitch (extraBytes) {\n\t\t\tcase 1:\n\t\t\t\ttemp = uint8[uint8.length - 1]\n\t\t\t\toutput += encode(temp >> 2)\n\t\t\t\toutput += encode((temp << 4) & 0x3F)\n\t\t\t\toutput += '=='\n\t\t\t\tbreak\n\t\t\tcase 2:\n\t\t\t\ttemp = (uint8[uint8.length - 2] << 8) + (uint8[uint8.length - 1])\n\t\t\t\toutput += encode(temp >> 10)\n\t\t\t\toutput += encode((temp >> 4) & 0x3F)\n\t\t\t\toutput += encode((temp << 2) & 0x3F)\n\t\t\t\toutput += '='\n\t\t\t\tbreak\n\t\t}\n\n\t\treturn output\n\t}\n\n\texports.toByteArray = b64ToByteArray\n\texports.fromByteArray = uint8ToBase64\n}(typeof exports === 'undefined' ? (this.base64js = {}) : exports))\n","","(function (root, factory) {\n  \"use strict\";\n\n  // AMD\n  if (typeof define === 'function' && define.amd) {\n    define([], factory);\n  }\n  // CommonJS\n  else if (typeof exports === 'object') {\n    module.exports = factory();\n  }\n  // Browser\n  else {\n    var clockmaker = factory();\n\n    Object.keys(clockmaker).forEach(function(key) {\n      var exported = clockmaker[key];\n\n      var previous = root[key];\n\n      // every export gets a .noConflict() method to allow clients to restore\n      // the previous values for the overridden global scope keys\n      exported.noConflict = function() {\n        root[key] = previous;\n        return exported;\n      };\n\n      root[key] = exported;\n    });\n  }\n}(this, function () {\n  \"use strict\";\n\n  /** Function binder */\n  var __bind = function(fn, fnThis) {\n    return function() {\n      fn.apply(fnThis, arguments);\n    };\n  };\n\n\n  var Clockmaker = {};\n\n\n  /** \n   * Construct a new timer\n   *\n   * @param {Function} fn The handler function to invoke on each tick.\n   * @param {Number} delayMs The timer delay in milliseconds.\n   * @param {Object} [options] Additional options.\n   * @param {Object} [options.thisObj] The `this` object to invoke `fn` with. If ommitted then `fn` is used as `this`.\n   * @param {Boolean} [options.repeat] Whether the timer should keep repeating until we stop it.\n   * @param {Boolean} [options.async] Whether `fn` is asynchronous (i.e. accepts a callback).\n   * @param {Function} [options.onError] Function to call if `fn` throws an error.\n   *\n   * @return {Timer} A `Timer`.\n   */\n  var Timer = Clockmaker.Timer = function(fn, delayMs, options) {\n    if (!(this instanceof Timer)) {\n      return new Timer(fn, delayMs, options);\n    }\n\n    this._fn = fn;\n    this._delayMs = delayMs;\n\n    options = options || {};\n    this._fnThis = options.thisObj || this._fn;\n    this._repeat = !!options.repeat;\n    this._onError = options.onError;\n    this._async = !!options.async;\n\n    this._state = 'stopped';\n    this._timerHandle = null;\n    this._runCount = 0;\n\n    this._doTick = __bind(this._doTick, this);\n    this._doAfterTick = __bind(this._doAfterTick, this);\n  };\n\n\n\n  /**\n   * Schedule next timer tick.\n   */\n  Timer.prototype._scheduleNextTick = function() {\n    // currently stopped?\n    if ('stopped' === this._state) {\n      return;\n    }\n\n    // only do once?\n    if (0 < this._runCount && !this._repeat) {\n      this._state = 'stopped';\n      return;\n    }\n\n    this._timerHandle = setTimeout(this._doTick, this._delayMs);\n  };\n\n\n\n\n  /**\n   * Execute a timer tick, i.e. execute the callbak function.\n   */\n  Timer.prototype._doTick = function() {\n    this._runCount++;\n\n    try {\n      if (this._async) {\n        this._fn.call(this._fnThis, this, this._doAfterTick);\n      } else {\n        this._fn.call(this._fnThis, this);\n        this._doAfterTick();\n      }\n    } catch (err) {\n      this._doAfterTick(err);\n    }\n  };\n\n\n\n  /**\n   * Timer tick execution completed, now handle any errors.\n   */\n  Timer.prototype._doAfterTick = function(err) {\n    if (err && this._onError) {\n      this._onError(err);\n    }\n\n    this._scheduleNextTick();\n  };\n\n\n\n  /**\n   * Start the timer.\n   * @return {this}\n   */\n  Timer.prototype.start = function() {\n    if ('started' === this._state) {\n      return;\n    }\n\n    this._state = 'started';\n    this._scheduleNextTick();\n\n    return this;\n  };\n\n\n\n  /**\n   * Re-synchronise the tick schedule.\n   *\n   * This resets the internal timer to start from now.\n   *\n   * @return {this}\n   */\n  Timer.prototype.synchronize = function() {\n    if (this._timerHandle) {\n      clearTimeout(this._timerHandle);\n      this._timerHandle = null;\n    }\n\n    this._scheduleNextTick();\n\n    return this;\n  };\n\n\n\n\n  /**\n   * Stop the timer.\n   * @return {this}\n   */\n  Timer.prototype.stop = function() {\n    if (this._timerHandle) {\n      clearTimeout(this._timerHandle);\n      this._timerHandle = null;\n    }\n\n    this._state = 'stopped';\n\n    return this;\n  };\n\n\n\n  /**\n   * Set the timer delay in milliseconds.\n   * @return {this}\n   */\n  Timer.prototype.setDelay = function(delayMs) {\n    this._delayMs = delayMs;\n\n    return this;\n  };\n\n\n\n  /**\n   * Get the timer delay.\n   * @return {Integer} The current timer delay in milliseconds.\n   */\n  Timer.prototype.getDelay = function() {\n    return this._delayMs;\n  };\n\n\n\n  /**\n   * Get the no. of times the timer has ticked.\n   * @return {Integer} The no. of times the timer has ticked.\n   */\n  Timer.prototype.getNumTicks = function() {\n    return this._runCount;\n  };\n\n\n\n  /**\n   * Get whether this timer has stopped.\n   */\n  Timer.prototype.isStopped = function() {\n    return 'stopped' === this._state;\n  };\n\n\n\n\n  /**\n   * Manage a collection of `Timer` objects.\n   *\n   * @constructor\n   */\n  var Timers = Clockmaker.Timers = function() {\n    if (!(this instanceof Timers)) {\n      return new Timers();\n    }\n\n    this._timers = [];\n  };\n\n\n\n  /**\n   * Create a new timer and add it to this collection.\n   *\n   * @see Timer()\n\n   * @return {Timer} The new `Timer`, not yet started.\n   */\n  Timers.prototype.create = function(fn, delayMs, options) {\n    var t = new Timer(fn, delayMs, options);\n\n    this._timers.push(t);\n\n    return t;\n  };\n\n\n\n  /**\n   * Add a timer to this collection.\n   *\n   * @param {Timer} timer The timer.\n   * @return this\n   */\n  Timers.prototype.add = function(timer) {\n    this._timers.push(timer);\n    return this;\n  };\n\n\n\n  /**\n   * Start all the timers.\n   * @return this\n   */\n  Timers.prototype.start = function() {\n    this._timers.forEach(function(t) {\n      t.start();\n    });\n\n    return this;\n  };\n\n\n  /**\n   * Stop all the timers.\n   * @return this\n   */\n  Timers.prototype.stop = function() {\n    this._timers.forEach(function(t) {\n      t.stop();\n    });\n\n    return this;\n  };\n\n\n\n  return Clockmaker;\n\n}));\n\n\n\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n  var GUTTER_ID = \"CodeMirror-lint-markers\";\n\n  function showTooltip(e, content) {\n    var tt = document.createElement(\"div\");\n    tt.className = \"CodeMirror-lint-tooltip\";\n    tt.appendChild(content.cloneNode(true));\n    document.body.appendChild(tt);\n\n    function position(e) {\n      if (!tt.parentNode) return CodeMirror.off(document, \"mousemove\", position);\n      tt.style.top = Math.max(0, e.clientY - tt.offsetHeight - 5) + \"px\";\n      tt.style.left = (e.clientX + 5) + \"px\";\n    }\n    CodeMirror.on(document, \"mousemove\", position);\n    position(e);\n    if (tt.style.opacity != null) tt.style.opacity = 1;\n    return tt;\n  }\n  function rm(elt) {\n    if (elt.parentNode) elt.parentNode.removeChild(elt);\n  }\n  function hideTooltip(tt) {\n    if (!tt.parentNode) return;\n    if (tt.style.opacity == null) rm(tt);\n    tt.style.opacity = 0;\n    setTimeout(function() { rm(tt); }, 600);\n  }\n\n  function showTooltipFor(e, content, node) {\n    var tooltip = showTooltip(e, content);\n    function hide() {\n      CodeMirror.off(node, \"mouseout\", hide);\n      if (tooltip) { hideTooltip(tooltip); tooltip = null; }\n    }\n    var poll = setInterval(function() {\n      if (tooltip) for (var n = node;; n = n.parentNode) {\n        if (n == document.body) return;\n        if (!n) { hide(); break; }\n      }\n      if (!tooltip) return clearInterval(poll);\n    }, 400);\n    CodeMirror.on(node, \"mouseout\", hide);\n  }\n\n  function LintState(cm, options, hasGutter) {\n    this.marked = [];\n    this.options = options;\n    this.timeout = null;\n    this.hasGutter = hasGutter;\n    this.onMouseOver = function(e) { onMouseOver(cm, e); };\n  }\n\n  function parseOptions(cm, options) {\n    if (options instanceof Function) return {getAnnotations: options};\n    if (!options || options === true) options = {};\n    if (!options.getAnnotations) options.getAnnotations = cm.getHelper(CodeMirror.Pos(0, 0), \"lint\");\n    if (!options.getAnnotations) throw new Error(\"Required option 'getAnnotations' missing (lint addon)\");\n    return options;\n  }\n\n  function clearMarks(cm) {\n    var state = cm.state.lint;\n    if (state.hasGutter) cm.clearGutter(GUTTER_ID);\n    for (var i = 0; i < state.marked.length; ++i)\n      state.marked[i].clear();\n    state.marked.length = 0;\n  }\n\n  function makeMarker(labels, severity, multiple, tooltips) {\n    var marker = document.createElement(\"div\"), inner = marker;\n    marker.className = \"CodeMirror-lint-marker-\" + severity;\n    if (multiple) {\n      inner = marker.appendChild(document.createElement(\"div\"));\n      inner.className = \"CodeMirror-lint-marker-multiple\";\n    }\n\n    if (tooltips != false) CodeMirror.on(inner, \"mouseover\", function(e) {\n      showTooltipFor(e, labels, inner);\n    });\n\n    return marker;\n  }\n\n  function getMaxSeverity(a, b) {\n    if (a == \"error\") return a;\n    else return b;\n  }\n\n  function groupByLine(annotations) {\n    var lines = [];\n    for (var i = 0; i < annotations.length; ++i) {\n      var ann = annotations[i], line = ann.from.line;\n      (lines[line] || (lines[line] = [])).push(ann);\n    }\n    return lines;\n  }\n\n  function annotationTooltip(ann) {\n    var severity = ann.severity;\n    if (!severity) severity = \"error\";\n    var tip = document.createElement(\"div\");\n    tip.className = \"CodeMirror-lint-message-\" + severity;\n    tip.appendChild(document.createTextNode(ann.message));\n    return tip;\n  }\n\n  function startLinting(cm) {\n    var state = cm.state.lint, options = state.options;\n    var passOptions = options.options || options; // Support deprecated passing of `options` property in options\n    if (options.async)\n      options.getAnnotations(cm.getValue(), updateLinting, passOptions, cm);\n    else\n      updateLinting(cm, options.getAnnotations(cm.getValue(), passOptions, cm));\n  }\n\n  function updateLinting(cm, annotationsNotSorted) {\n    clearMarks(cm);\n    var state = cm.state.lint, options = state.options;\n\n    var annotations = groupByLine(annotationsNotSorted);\n\n    for (var line = 0; line < annotations.length; ++line) {\n      var anns = annotations[line];\n      if (!anns) continue;\n\n      var maxSeverity = null;\n      var tipLabel = state.hasGutter && document.createDocumentFragment();\n\n      for (var i = 0; i < anns.length; ++i) {\n        var ann = anns[i];\n        var severity = ann.severity;\n        if (!severity) severity = \"error\";\n        maxSeverity = getMaxSeverity(maxSeverity, severity);\n\n        if (options.formatAnnotation) ann = options.formatAnnotation(ann);\n        if (state.hasGutter) tipLabel.appendChild(annotationTooltip(ann));\n\n        if (ann.to) state.marked.push(cm.markText(ann.from, ann.to, {\n          className: \"CodeMirror-lint-mark-\" + severity,\n          __annotation: ann\n        }));\n      }\n\n      if (state.hasGutter)\n        cm.setGutterMarker(line, GUTTER_ID, makeMarker(tipLabel, maxSeverity, anns.length > 1,\n                                                       state.options.tooltips));\n    }\n    if (options.onUpdateLinting) options.onUpdateLinting(annotationsNotSorted, annotations, cm);\n  }\n\n  function onChange(cm) {\n    var state = cm.state.lint;\n    clearTimeout(state.timeout);\n    state.timeout = setTimeout(function(){startLinting(cm);}, state.options.delay || 500);\n  }\n\n  function popupSpanTooltip(ann, e) {\n    var target = e.target || e.srcElement;\n    showTooltipFor(e, annotationTooltip(ann), target);\n  }\n\n  function onMouseOver(cm, e) {\n    var target = e.target || e.srcElement;\n    if (!/\\bCodeMirror-lint-mark-/.test(target.className)) return;\n    var box = target.getBoundingClientRect(), x = (box.left + box.right) / 2, y = (box.top + box.bottom) / 2;\n    var spans = cm.findMarksAt(cm.coordsChar({left: x, top: y}, \"client\"));\n    for (var i = 0; i < spans.length; ++i) {\n      var ann = spans[i].__annotation;\n      if (ann) return popupSpanTooltip(ann, e);\n    }\n  }\n\n  CodeMirror.defineOption(\"lint\", false, function(cm, val, old) {\n    if (old && old != CodeMirror.Init) {\n      clearMarks(cm);\n      cm.off(\"change\", onChange);\n      CodeMirror.off(cm.getWrapperElement(), \"mouseover\", cm.state.lint.onMouseOver);\n      delete cm.state.lint;\n    }\n\n    if (val) {\n      var gutters = cm.getOption(\"gutters\"), hasLintGutter = false;\n      for (var i = 0; i < gutters.length; ++i) if (gutters[i] == GUTTER_ID) hasLintGutter = true;\n      var state = cm.state.lint = new LintState(cm, parseOptions(cm, val), hasLintGutter);\n      cm.on(\"change\", onChange);\n      if (state.options.tooltips != false)\n        CodeMirror.on(cm.getWrapperElement(), \"mouseover\", state.onMouseOver);\n\n      startLinting(cm);\n    }\n  });\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n// This is CodeMirror (http://codemirror.net), a code editor\n// implemented in JavaScript on top of the browser's DOM.\n//\n// You can find some technical background for some of the code below\n// at http://marijnhaverbeke.nl/blog/#cm-internals .\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    module.exports = mod();\n  else if (typeof define == \"function\" && define.amd) // AMD\n    return define([], mod);\n  else // Plain browser env\n    this.CodeMirror = mod();\n})(function() {\n  \"use strict\";\n\n  // BROWSER SNIFFING\n\n  // Kludges for bugs and behavior differences that can't be feature\n  // detected are enabled based on userAgent etc sniffing.\n\n  var gecko = /gecko\\/\\d/i.test(navigator.userAgent);\n  // ie_uptoN means Internet Explorer version N or lower\n  var ie_upto10 = /MSIE \\d/.test(navigator.userAgent);\n  var ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(navigator.userAgent);\n  var ie = ie_upto10 || ie_11up;\n  var ie_version = ie && (ie_upto10 ? document.documentMode || 6 : ie_11up[1]);\n  var webkit = /WebKit\\//.test(navigator.userAgent);\n  var qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(navigator.userAgent);\n  var chrome = /Chrome\\//.test(navigator.userAgent);\n  var presto = /Opera\\//.test(navigator.userAgent);\n  var safari = /Apple Computer/.test(navigator.vendor);\n  var khtml = /KHTML\\//.test(navigator.userAgent);\n  var mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(navigator.userAgent);\n  var phantom = /PhantomJS/.test(navigator.userAgent);\n\n  var ios = /AppleWebKit/.test(navigator.userAgent) && /Mobile\\/\\w+/.test(navigator.userAgent);\n  // This is woefully incomplete. Suggestions for alternative methods welcome.\n  var mobile = ios || /Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent);\n  var mac = ios || /Mac/.test(navigator.platform);\n  var windows = /win/i.test(navigator.platform);\n\n  var presto_version = presto && navigator.userAgent.match(/Version\\/(\\d*\\.\\d*)/);\n  if (presto_version) presto_version = Number(presto_version[1]);\n  if (presto_version && presto_version >= 15) { presto = false; webkit = true; }\n  // Some browsers use the wrong event properties to signal cmd/ctrl on OS X\n  var flipCtrlCmd = mac && (qtwebkit || presto && (presto_version == null || presto_version < 12.11));\n  var captureRightClick = gecko || (ie && ie_version >= 9);\n\n  // Optimize some code when these features are not used.\n  var sawReadOnlySpans = false, sawCollapsedSpans = false;\n\n  // EDITOR CONSTRUCTOR\n\n  // A CodeMirror instance represents an editor. This is the object\n  // that user code is usually dealing with.\n\n  function CodeMirror(place, options) {\n    if (!(this instanceof CodeMirror)) return new CodeMirror(place, options);\n\n    this.options = options = options ? copyObj(options) : {};\n    // Determine effective options based on given values and defaults.\n    copyObj(defaults, options, false);\n    setGuttersForLineNumbers(options);\n\n    var doc = options.value;\n    if (typeof doc == \"string\") doc = new Doc(doc, options.mode);\n    this.doc = doc;\n\n    var display = this.display = new Display(place, doc);\n    display.wrapper.CodeMirror = this;\n    updateGutters(this);\n    themeChanged(this);\n    if (options.lineWrapping)\n      this.display.wrapper.className += \" CodeMirror-wrap\";\n    if (options.autofocus && !mobile) focusInput(this);\n\n    this.state = {\n      keyMaps: [],  // stores maps added by addKeyMap\n      overlays: [], // highlighting overlays, as added by addOverlay\n      modeGen: 0,   // bumped when mode/overlay changes, used to invalidate highlighting info\n      overwrite: false, focused: false,\n      suppressEdits: false, // used to disable editing during key handlers when in readOnly mode\n      pasteIncoming: false, cutIncoming: false, // help recognize paste/cut edits in readInput\n      draggingText: false,\n      highlight: new Delayed() // stores highlight worker timeout\n    };\n\n    // Override magic textarea content restore that IE sometimes does\n    // on our hidden textarea on reload\n    if (ie && ie_version < 11) setTimeout(bind(resetInput, this, true), 20);\n\n    registerEventHandlers(this);\n    ensureGlobalHandlers();\n\n    startOperation(this);\n    this.curOp.forceUpdate = true;\n    attachDoc(this, doc);\n\n    if ((options.autofocus && !mobile) || activeElt() == display.input)\n      setTimeout(bind(onFocus, this), 20);\n    else\n      onBlur(this);\n\n    for (var opt in optionHandlers) if (optionHandlers.hasOwnProperty(opt))\n      optionHandlers[opt](this, options[opt], Init);\n    maybeUpdateLineNumberWidth(this);\n    for (var i = 0; i < initHooks.length; ++i) initHooks[i](this);\n    endOperation(this);\n  }\n\n  // DISPLAY CONSTRUCTOR\n\n  // The display handles the DOM integration, both for input reading\n  // and content drawing. It holds references to DOM nodes and\n  // display-related state.\n\n  function Display(place, doc) {\n    var d = this;\n\n    // The semihidden textarea that is focused when the editor is\n    // focused, and receives input.\n    var input = d.input = elt(\"textarea\", null, null, \"position: absolute; padding: 0; width: 1px; height: 1em; outline: none\");\n    // The textarea is kept positioned near the cursor to prevent the\n    // fact that it'll be scrolled into view on input from scrolling\n    // our fake cursor out of view. On webkit, when wrap=off, paste is\n    // very slow. So make the area wide instead.\n    if (webkit) input.style.width = \"1000px\";\n    else input.setAttribute(\"wrap\", \"off\");\n    // If border: 0; -- iOS fails to open keyboard (issue #1287)\n    if (ios) input.style.border = \"1px solid black\";\n    input.setAttribute(\"autocorrect\", \"off\"); input.setAttribute(\"autocapitalize\", \"off\"); input.setAttribute(\"spellcheck\", \"false\");\n\n    // Wraps and hides input textarea\n    d.inputDiv = elt(\"div\", [input], null, \"overflow: hidden; position: relative; width: 3px; height: 0px;\");\n    // The fake scrollbar elements.\n    d.scrollbarH = elt(\"div\", [elt(\"div\", null, null, \"height: 100%; min-height: 1px\")], \"CodeMirror-hscrollbar\");\n    d.scrollbarV = elt(\"div\", [elt(\"div\", null, null, \"min-width: 1px\")], \"CodeMirror-vscrollbar\");\n    // Covers bottom-right square when both scrollbars are present.\n    d.scrollbarFiller = elt(\"div\", null, \"CodeMirror-scrollbar-filler\");\n    // Covers bottom of gutter when coverGutterNextToScrollbar is on\n    // and h scrollbar is present.\n    d.gutterFiller = elt(\"div\", null, \"CodeMirror-gutter-filler\");\n    // Will contain the actual code, positioned to cover the viewport.\n    d.lineDiv = elt(\"div\", null, \"CodeMirror-code\");\n    // Elements are added to these to represent selection and cursors.\n    d.selectionDiv = elt(\"div\", null, null, \"position: relative; z-index: 1\");\n    d.cursorDiv = elt(\"div\", null, \"CodeMirror-cursors\");\n    // A visibility: hidden element used to find the size of things.\n    d.measure = elt(\"div\", null, \"CodeMirror-measure\");\n    // When lines outside of the viewport are measured, they are drawn in this.\n    d.lineMeasure = elt(\"div\", null, \"CodeMirror-measure\");\n    // Wraps everything that needs to exist inside the vertically-padded coordinate system\n    d.lineSpace = elt(\"div\", [d.measure, d.lineMeasure, d.selectionDiv, d.cursorDiv, d.lineDiv],\n                      null, \"position: relative; outline: none\");\n    // Moved around its parent to cover visible view.\n    d.mover = elt(\"div\", [elt(\"div\", [d.lineSpace], \"CodeMirror-lines\")], null, \"position: relative\");\n    // Set to the height of the document, allowing scrolling.\n    d.sizer = elt(\"div\", [d.mover], \"CodeMirror-sizer\");\n    // Behavior of elts with overflow: auto and padding is\n    // inconsistent across browsers. This is used to ensure the\n    // scrollable area is big enough.\n    d.heightForcer = elt(\"div\", null, null, \"position: absolute; height: \" + scrollerCutOff + \"px; width: 1px;\");\n    // Will contain the gutters, if any.\n    d.gutters = elt(\"div\", null, \"CodeMirror-gutters\");\n    d.lineGutter = null;\n    // Actual scrollable element.\n    d.scroller = elt(\"div\", [d.sizer, d.heightForcer, d.gutters], \"CodeMirror-scroll\");\n    d.scroller.setAttribute(\"tabIndex\", \"-1\");\n    // The element in which the editor lives.\n    d.wrapper = elt(\"div\", [d.inputDiv, d.scrollbarH, d.scrollbarV,\n                            d.scrollbarFiller, d.gutterFiller, d.scroller], \"CodeMirror\");\n\n    // Work around IE7 z-index bug (not perfect, hence IE7 not really being supported)\n    if (ie && ie_version < 8) { d.gutters.style.zIndex = -1; d.scroller.style.paddingRight = 0; }\n    // Needed to hide big blue blinking cursor on Mobile Safari\n    if (ios) input.style.width = \"0px\";\n    if (!webkit) d.scroller.draggable = true;\n    // Needed to handle Tab key in KHTML\n    if (khtml) { d.inputDiv.style.height = \"1px\"; d.inputDiv.style.position = \"absolute\"; }\n    // Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\n    if (ie && ie_version < 8) d.scrollbarH.style.minHeight = d.scrollbarV.style.minWidth = \"18px\";\n\n    if (place.appendChild) place.appendChild(d.wrapper);\n    else place(d.wrapper);\n\n    // Current rendered range (may be bigger than the view window).\n    d.viewFrom = d.viewTo = doc.first;\n    // Information about the rendered lines.\n    d.view = [];\n    // Holds info about a single rendered line when it was rendered\n    // for measurement, while not in view.\n    d.externalMeasured = null;\n    // Empty space (in pixels) above the view\n    d.viewOffset = 0;\n    d.lastSizeC = 0;\n    d.updateLineNumbers = null;\n\n    // Used to only resize the line number gutter when necessary (when\n    // the amount of lines crosses a boundary that makes its width change)\n    d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null;\n    // See readInput and resetInput\n    d.prevInput = \"\";\n    // Set to true when a non-horizontal-scrolling line widget is\n    // added. As an optimization, line widget aligning is skipped when\n    // this is false.\n    d.alignWidgets = false;\n    // Flag that indicates whether we expect input to appear real soon\n    // now (after some event like 'keypress' or 'input') and are\n    // polling intensively.\n    d.pollingFast = false;\n    // Self-resetting timeout for the poller\n    d.poll = new Delayed();\n\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n\n    // Tracks when resetInput has punted to just putting a short\n    // string into the textarea instead of the full selection.\n    d.inaccurateSelection = false;\n\n    // Tracks the maximum line length so that the horizontal scrollbar\n    // can be kept static when scrolling.\n    d.maxLine = null;\n    d.maxLineLength = 0;\n    d.maxLineChanged = false;\n\n    // Used for measuring wheel scrolling granularity\n    d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null;\n\n    // True when shift is held down.\n    d.shift = false;\n\n    // Used to track whether anything happened since the context menu\n    // was opened.\n    d.selForContextMenu = null;\n  }\n\n  // STATE UPDATES\n\n  // Used to get the editor into a consistent state again when options change.\n\n  function loadMode(cm) {\n    cm.doc.mode = CodeMirror.getMode(cm.options, cm.doc.modeOption);\n    resetModeState(cm);\n  }\n\n  function resetModeState(cm) {\n    cm.doc.iter(function(line) {\n      if (line.stateAfter) line.stateAfter = null;\n      if (line.styles) line.styles = null;\n    });\n    cm.doc.frontier = cm.doc.first;\n    startWorker(cm, 100);\n    cm.state.modeGen++;\n    if (cm.curOp) regChange(cm);\n  }\n\n  function wrappingChanged(cm) {\n    if (cm.options.lineWrapping) {\n      addClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      cm.display.sizer.style.minWidth = \"\";\n    } else {\n      rmClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      findMaxLine(cm);\n    }\n    estimateLineHeights(cm);\n    regChange(cm);\n    clearCaches(cm);\n    setTimeout(function(){updateScrollbars(cm);}, 100);\n  }\n\n  // Returns a function that estimates the height of a line, to use as\n  // first approximation until the line becomes visible (and is thus\n  // properly measurable).\n  function estimateHeight(cm) {\n    var th = textHeight(cm.display), wrapping = cm.options.lineWrapping;\n    var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3);\n    return function(line) {\n      if (lineIsHidden(cm.doc, line)) return 0;\n\n      var widgetsHeight = 0;\n      if (line.widgets) for (var i = 0; i < line.widgets.length; i++) {\n        if (line.widgets[i].height) widgetsHeight += line.widgets[i].height;\n      }\n\n      if (wrapping)\n        return widgetsHeight + (Math.ceil(line.text.length / perLine) || 1) * th;\n      else\n        return widgetsHeight + th;\n    };\n  }\n\n  function estimateLineHeights(cm) {\n    var doc = cm.doc, est = estimateHeight(cm);\n    doc.iter(function(line) {\n      var estHeight = est(line);\n      if (estHeight != line.height) updateLineHeight(line, estHeight);\n    });\n  }\n\n  function keyMapChanged(cm) {\n    var map = keyMap[cm.options.keyMap], style = map.style;\n    cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-keymap-\\S+/g, \"\") +\n      (style ? \" cm-keymap-\" + style : \"\");\n  }\n\n  function themeChanged(cm) {\n    cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, \"\") +\n      cm.options.theme.replace(/(^|\\s)\\s*/g, \" cm-s-\");\n    clearCaches(cm);\n  }\n\n  function guttersChanged(cm) {\n    updateGutters(cm);\n    regChange(cm);\n    setTimeout(function(){alignHorizontally(cm);}, 20);\n  }\n\n  // Rebuild the gutter elements, ensure the margin to the left of the\n  // code matches their width.\n  function updateGutters(cm) {\n    var gutters = cm.display.gutters, specs = cm.options.gutters;\n    removeChildren(gutters);\n    for (var i = 0; i < specs.length; ++i) {\n      var gutterClass = specs[i];\n      var gElt = gutters.appendChild(elt(\"div\", null, \"CodeMirror-gutter \" + gutterClass));\n      if (gutterClass == \"CodeMirror-linenumbers\") {\n        cm.display.lineGutter = gElt;\n        gElt.style.width = (cm.display.lineNumWidth || 1) + \"px\";\n      }\n    }\n    gutters.style.display = i ? \"\" : \"none\";\n    updateGutterSpace(cm);\n  }\n\n  function updateGutterSpace(cm) {\n    var width = cm.display.gutters.offsetWidth;\n    cm.display.sizer.style.marginLeft = width + \"px\";\n    cm.display.scrollbarH.style.left = cm.options.fixedGutter ? width + \"px\" : 0;\n  }\n\n  // Compute the character length of a line, taking into account\n  // collapsed ranges (see markText) that might hide parts, and join\n  // other lines onto it.\n  function lineLength(line) {\n    if (line.height == 0) return 0;\n    var len = line.text.length, merged, cur = line;\n    while (merged = collapsedSpanAtStart(cur)) {\n      var found = merged.find(0, true);\n      cur = found.from.line;\n      len += found.from.ch - found.to.ch;\n    }\n    cur = line;\n    while (merged = collapsedSpanAtEnd(cur)) {\n      var found = merged.find(0, true);\n      len -= cur.text.length - found.from.ch;\n      cur = found.to.line;\n      len += cur.text.length - found.to.ch;\n    }\n    return len;\n  }\n\n  // Find the longest line in the document.\n  function findMaxLine(cm) {\n    var d = cm.display, doc = cm.doc;\n    d.maxLine = getLine(doc, doc.first);\n    d.maxLineLength = lineLength(d.maxLine);\n    d.maxLineChanged = true;\n    doc.iter(function(line) {\n      var len = lineLength(line);\n      if (len > d.maxLineLength) {\n        d.maxLineLength = len;\n        d.maxLine = line;\n      }\n    });\n  }\n\n  // Make sure the gutters options contains the element\n  // \"CodeMirror-linenumbers\" when the lineNumbers option is true.\n  function setGuttersForLineNumbers(options) {\n    var found = indexOf(options.gutters, \"CodeMirror-linenumbers\");\n    if (found == -1 && options.lineNumbers) {\n      options.gutters = options.gutters.concat([\"CodeMirror-linenumbers\"]);\n    } else if (found > -1 && !options.lineNumbers) {\n      options.gutters = options.gutters.slice(0);\n      options.gutters.splice(found, 1);\n    }\n  }\n\n  // SCROLLBARS\n\n  function hScrollbarTakesSpace(cm) {\n    return cm.display.scroller.clientHeight - cm.display.wrapper.clientHeight < scrollerCutOff - 3;\n  }\n\n  // Prepare DOM reads needed to update the scrollbars. Done in one\n  // shot to minimize update/measure roundtrips.\n  function measureForScrollbars(cm) {\n    var scroll = cm.display.scroller;\n    return {\n      clientHeight: scroll.clientHeight,\n      barHeight: cm.display.scrollbarV.clientHeight,\n      scrollWidth: scroll.scrollWidth, clientWidth: scroll.clientWidth,\n      hScrollbarTakesSpace: hScrollbarTakesSpace(cm),\n      barWidth: cm.display.scrollbarH.clientWidth,\n      docHeight: Math.round(cm.doc.height + paddingVert(cm.display))\n    };\n  }\n\n  // Re-synchronize the fake scrollbars with the actual size of the\n  // content.\n  function updateScrollbars(cm, measure) {\n    if (!measure) measure = measureForScrollbars(cm);\n    var d = cm.display, sWidth = scrollbarWidth(d.measure);\n    var scrollHeight = measure.docHeight + scrollerCutOff;\n    var needsH = measure.scrollWidth > measure.clientWidth;\n    if (needsH && measure.scrollWidth <= measure.clientWidth + 1 &&\n        sWidth > 0 && !measure.hScrollbarTakesSpace)\n      needsH = false; // (Issue #2562)\n    var needsV = scrollHeight > measure.clientHeight;\n\n    if (needsV) {\n      d.scrollbarV.style.display = \"block\";\n      d.scrollbarV.style.bottom = needsH ? sWidth + \"px\" : \"0\";\n      // A bug in IE8 can cause this value to be negative, so guard it.\n      d.scrollbarV.firstChild.style.height =\n        Math.max(0, scrollHeight - measure.clientHeight + (measure.barHeight || d.scrollbarV.clientHeight)) + \"px\";\n    } else {\n      d.scrollbarV.style.display = \"\";\n      d.scrollbarV.firstChild.style.height = \"0\";\n    }\n    if (needsH) {\n      d.scrollbarH.style.display = \"block\";\n      d.scrollbarH.style.right = needsV ? sWidth + \"px\" : \"0\";\n      d.scrollbarH.firstChild.style.width =\n        (measure.scrollWidth - measure.clientWidth + (measure.barWidth || d.scrollbarH.clientWidth)) + \"px\";\n    } else {\n      d.scrollbarH.style.display = \"\";\n      d.scrollbarH.firstChild.style.width = \"0\";\n    }\n    if (needsH && needsV) {\n      d.scrollbarFiller.style.display = \"block\";\n      d.scrollbarFiller.style.height = d.scrollbarFiller.style.width = sWidth + \"px\";\n    } else d.scrollbarFiller.style.display = \"\";\n    if (needsH && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\n      d.gutterFiller.style.display = \"block\";\n      d.gutterFiller.style.height = sWidth + \"px\";\n      d.gutterFiller.style.width = d.gutters.offsetWidth + \"px\";\n    } else d.gutterFiller.style.display = \"\";\n\n    if (!cm.state.checkedOverlayScrollbar && measure.clientHeight > 0) {\n      if (sWidth === 0) {\n        var w = mac && !mac_geMountainLion ? \"12px\" : \"18px\";\n        d.scrollbarV.style.minWidth = d.scrollbarH.style.minHeight = w;\n        var barMouseDown = function(e) {\n          if (e_target(e) != d.scrollbarV && e_target(e) != d.scrollbarH)\n            operation(cm, onMouseDown)(e);\n        };\n        on(d.scrollbarV, \"mousedown\", barMouseDown);\n        on(d.scrollbarH, \"mousedown\", barMouseDown);\n      }\n      cm.state.checkedOverlayScrollbar = true;\n    }\n  }\n\n  // Compute the lines that are visible in a given viewport (defaults\n  // the the current scroll position). viewport may contain top,\n  // height, and ensure (see op.scrollToPos) properties.\n  function visibleLines(display, doc, viewport) {\n    var top = viewport && viewport.top != null ? Math.max(0, viewport.top) : display.scroller.scrollTop;\n    top = Math.floor(top - paddingTop(display));\n    var bottom = viewport && viewport.bottom != null ? viewport.bottom : top + display.wrapper.clientHeight;\n\n    var from = lineAtHeight(doc, top), to = lineAtHeight(doc, bottom);\n    // Ensure is a {from: {line, ch}, to: {line, ch}} object, and\n    // forces those lines into the viewport (if possible).\n    if (viewport && viewport.ensure) {\n      var ensureFrom = viewport.ensure.from.line, ensureTo = viewport.ensure.to.line;\n      if (ensureFrom < from)\n        return {from: ensureFrom,\n                to: lineAtHeight(doc, heightAtLine(getLine(doc, ensureFrom)) + display.wrapper.clientHeight)};\n      if (Math.min(ensureTo, doc.lastLine()) >= to)\n        return {from: lineAtHeight(doc, heightAtLine(getLine(doc, ensureTo)) - display.wrapper.clientHeight),\n                to: ensureTo};\n    }\n    return {from: from, to: Math.max(to, from + 1)};\n  }\n\n  // LINE NUMBERS\n\n  // Re-align line numbers and gutter marks to compensate for\n  // horizontal scrolling.\n  function alignHorizontally(cm) {\n    var display = cm.display, view = display.view;\n    if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) return;\n    var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft;\n    var gutterW = display.gutters.offsetWidth, left = comp + \"px\";\n    for (var i = 0; i < view.length; i++) if (!view[i].hidden) {\n      if (cm.options.fixedGutter && view[i].gutter)\n        view[i].gutter.style.left = left;\n      var align = view[i].alignable;\n      if (align) for (var j = 0; j < align.length; j++)\n        align[j].style.left = left;\n    }\n    if (cm.options.fixedGutter)\n      display.gutters.style.left = (comp + gutterW) + \"px\";\n  }\n\n  // Used to ensure that the line number gutter is still the right\n  // size for the current document size. Returns true when an update\n  // is needed.\n  function maybeUpdateLineNumberWidth(cm) {\n    if (!cm.options.lineNumbers) return false;\n    var doc = cm.doc, last = lineNumberFor(cm.options, doc.first + doc.size - 1), display = cm.display;\n    if (last.length != display.lineNumChars) {\n      var test = display.measure.appendChild(elt(\"div\", [elt(\"div\", last)],\n                                                 \"CodeMirror-linenumber CodeMirror-gutter-elt\"));\n      var innerW = test.firstChild.offsetWidth, padding = test.offsetWidth - innerW;\n      display.lineGutter.style.width = \"\";\n      display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding);\n      display.lineNumWidth = display.lineNumInnerWidth + padding;\n      display.lineNumChars = display.lineNumInnerWidth ? last.length : -1;\n      display.lineGutter.style.width = display.lineNumWidth + \"px\";\n      updateGutterSpace(cm);\n      return true;\n    }\n    return false;\n  }\n\n  function lineNumberFor(options, i) {\n    return String(options.lineNumberFormatter(i + options.firstLineNumber));\n  }\n\n  // Computes display.scroller.scrollLeft + display.gutters.offsetWidth,\n  // but using getBoundingClientRect to get a sub-pixel-accurate\n  // result.\n  function compensateForHScroll(display) {\n    return display.scroller.getBoundingClientRect().left - display.sizer.getBoundingClientRect().left;\n  }\n\n  // DISPLAY DRAWING\n\n  function DisplayUpdate(cm, viewport, force) {\n    var display = cm.display;\n\n    this.viewport = viewport;\n    // Store some values that we'll need later (but don't want to force a relayout for)\n    this.visible = visibleLines(display, cm.doc, viewport);\n    this.editorIsHidden = !display.wrapper.offsetWidth;\n    this.wrapperHeight = display.wrapper.clientHeight;\n    this.oldViewFrom = display.viewFrom; this.oldViewTo = display.viewTo;\n    this.oldScrollerWidth = display.scroller.clientWidth;\n    this.force = force;\n    this.dims = getDimensions(cm);\n  }\n\n  // Does the actual updating of the line display. Bails out\n  // (returning false) when there is nothing to be done and forced is\n  // false.\n  function updateDisplayIfNeeded(cm, update) {\n    var display = cm.display, doc = cm.doc;\n    if (update.editorIsHidden) {\n      resetView(cm);\n      return false;\n    }\n\n    // Bail out if the visible area is already rendered and nothing changed.\n    if (!update.force &&\n        update.visible.from >= display.viewFrom && update.visible.to <= display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo) &&\n        countDirtyView(cm) == 0)\n      return false;\n\n    if (maybeUpdateLineNumberWidth(cm)) {\n      resetView(cm);\n      update.dims = getDimensions(cm);\n    }\n\n    // Compute a suitable new viewport (from & to)\n    var end = doc.first + doc.size;\n    var from = Math.max(update.visible.from - cm.options.viewportMargin, doc.first);\n    var to = Math.min(end, update.visible.to + cm.options.viewportMargin);\n    if (display.viewFrom < from && from - display.viewFrom < 20) from = Math.max(doc.first, display.viewFrom);\n    if (display.viewTo > to && display.viewTo - to < 20) to = Math.min(end, display.viewTo);\n    if (sawCollapsedSpans) {\n      from = visualLineNo(cm.doc, from);\n      to = visualLineEndNo(cm.doc, to);\n    }\n\n    var different = from != display.viewFrom || to != display.viewTo ||\n      display.lastSizeC != update.wrapperHeight;\n    adjustView(cm, from, to);\n\n    display.viewOffset = heightAtLine(getLine(cm.doc, display.viewFrom));\n    // Position the mover div to align with the current scroll position\n    cm.display.mover.style.top = display.viewOffset + \"px\";\n\n    var toUpdate = countDirtyView(cm);\n    if (!different && toUpdate == 0 && !update.force &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo))\n      return false;\n\n    // For big changes, we hide the enclosing element during the\n    // update, since that speeds up the operations on most browsers.\n    var focused = activeElt();\n    if (toUpdate > 4) display.lineDiv.style.display = \"none\";\n    patchDisplay(cm, display.updateLineNumbers, update.dims);\n    if (toUpdate > 4) display.lineDiv.style.display = \"\";\n    // There might have been a widget with a focused element that got\n    // hidden or updated, if so re-focus it.\n    if (focused && activeElt() != focused && focused.offsetHeight) focused.focus();\n\n    // Prevent selection and cursors from interfering with the scroll\n    // width.\n    removeChildren(display.cursorDiv);\n    removeChildren(display.selectionDiv);\n\n    if (different) {\n      display.lastSizeC = update.wrapperHeight;\n      startWorker(cm, 400);\n    }\n\n    display.updateLineNumbers = null;\n\n    return true;\n  }\n\n  function postUpdateDisplay(cm, update) {\n    var force = update.force, viewport = update.viewport;\n    for (var first = true;; first = false) {\n      if (first && cm.options.lineWrapping && update.oldScrollerWidth != cm.display.scroller.clientWidth) {\n        force = true;\n      } else {\n        force = false;\n        // Clip forced viewport to actual scrollable area.\n        if (viewport && viewport.top != null)\n          viewport = {top: Math.min(cm.doc.height + paddingVert(cm.display) - scrollerCutOff -\n                                    cm.display.scroller.clientHeight, viewport.top)};\n        // Updated line heights might result in the drawn area not\n        // actually covering the viewport. Keep looping until it does.\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\n        if (update.visible.from >= cm.display.viewFrom && update.visible.to <= cm.display.viewTo)\n          break;\n      }\n      if (!updateDisplayIfNeeded(cm, update)) break;\n      updateHeightsInViewport(cm);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      setDocumentHeight(cm, barMeasure);\n      updateScrollbars(cm, barMeasure);\n    }\n\n    signalLater(cm, \"update\", cm);\n    if (cm.display.viewFrom != update.oldViewFrom || cm.display.viewTo != update.oldViewTo)\n      signalLater(cm, \"viewportChange\", cm, cm.display.viewFrom, cm.display.viewTo);\n  }\n\n  function updateDisplaySimple(cm, viewport) {\n    var update = new DisplayUpdate(cm, viewport);\n    if (updateDisplayIfNeeded(cm, update)) {\n      updateHeightsInViewport(cm);\n      postUpdateDisplay(cm, update);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      setDocumentHeight(cm, barMeasure);\n      updateScrollbars(cm, barMeasure);\n    }\n  }\n\n  function setDocumentHeight(cm, measure) {\n    cm.display.sizer.style.minHeight = cm.display.heightForcer.style.top = measure.docHeight + \"px\";\n    cm.display.gutters.style.height = Math.max(measure.docHeight, measure.clientHeight - scrollerCutOff) + \"px\";\n  }\n\n  function checkForWebkitWidthBug(cm, measure) {\n    // Work around Webkit bug where it sometimes reserves space for a\n    // non-existing phantom scrollbar in the scroller (Issue #2420)\n    if (cm.display.sizer.offsetWidth + cm.display.gutters.offsetWidth < cm.display.scroller.clientWidth - 1) {\n      cm.display.sizer.style.minHeight = cm.display.heightForcer.style.top = \"0px\";\n      cm.display.gutters.style.height = measure.docHeight + \"px\";\n    }\n  }\n\n  // Read the actual heights of the rendered lines, and update their\n  // stored heights to match.\n  function updateHeightsInViewport(cm) {\n    var display = cm.display;\n    var prevBottom = display.lineDiv.offsetTop;\n    for (var i = 0; i < display.view.length; i++) {\n      var cur = display.view[i], height;\n      if (cur.hidden) continue;\n      if (ie && ie_version < 8) {\n        var bot = cur.node.offsetTop + cur.node.offsetHeight;\n        height = bot - prevBottom;\n        prevBottom = bot;\n      } else {\n        var box = cur.node.getBoundingClientRect();\n        height = box.bottom - box.top;\n      }\n      var diff = cur.line.height - height;\n      if (height < 2) height = textHeight(display);\n      if (diff > .001 || diff < -.001) {\n        updateLineHeight(cur.line, height);\n        updateWidgetHeight(cur.line);\n        if (cur.rest) for (var j = 0; j < cur.rest.length; j++)\n          updateWidgetHeight(cur.rest[j]);\n      }\n    }\n  }\n\n  // Read and store the height of line widgets associated with the\n  // given line.\n  function updateWidgetHeight(line) {\n    if (line.widgets) for (var i = 0; i < line.widgets.length; ++i)\n      line.widgets[i].height = line.widgets[i].node.offsetHeight;\n  }\n\n  // Do a bulk-read of the DOM positions and sizes needed to draw the\n  // view, so that we don't interleave reading and writing to the DOM.\n  function getDimensions(cm) {\n    var d = cm.display, left = {}, width = {};\n    var gutterLeft = d.gutters.clientLeft;\n    for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\n      left[cm.options.gutters[i]] = n.offsetLeft + n.clientLeft + gutterLeft;\n      width[cm.options.gutters[i]] = n.clientWidth;\n    }\n    return {fixedPos: compensateForHScroll(d),\n            gutterTotalWidth: d.gutters.offsetWidth,\n            gutterLeft: left,\n            gutterWidth: width,\n            wrapperWidth: d.wrapper.clientWidth};\n  }\n\n  // Sync the actual display DOM structure with display.view, removing\n  // nodes for lines that are no longer in view, and creating the ones\n  // that are not there yet, and updating the ones that are out of\n  // date.\n  function patchDisplay(cm, updateNumbersFrom, dims) {\n    var display = cm.display, lineNumbers = cm.options.lineNumbers;\n    var container = display.lineDiv, cur = container.firstChild;\n\n    function rm(node) {\n      var next = node.nextSibling;\n      // Works around a throw-scroll bug in OS X Webkit\n      if (webkit && mac && cm.display.currentWheelTarget == node)\n        node.style.display = \"none\";\n      else\n        node.parentNode.removeChild(node);\n      return next;\n    }\n\n    var view = display.view, lineN = display.viewFrom;\n    // Loop over the elements in the view, syncing cur (the DOM nodes\n    // in display.lineDiv) with the view as we go.\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (lineView.hidden) {\n      } else if (!lineView.node) { // Not drawn yet\n        var node = buildLineElement(cm, lineView, lineN, dims);\n        container.insertBefore(node, cur);\n      } else { // Already drawn\n        while (cur != lineView.node) cur = rm(cur);\n        var updateNumber = lineNumbers && updateNumbersFrom != null &&\n          updateNumbersFrom <= lineN && lineView.lineNumber;\n        if (lineView.changes) {\n          if (indexOf(lineView.changes, \"gutter\") > -1) updateNumber = false;\n          updateLineForChanges(cm, lineView, lineN, dims);\n        }\n        if (updateNumber) {\n          removeChildren(lineView.lineNumber);\n          lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options, lineN)));\n        }\n        cur = lineView.node.nextSibling;\n      }\n      lineN += lineView.size;\n    }\n    while (cur) cur = rm(cur);\n  }\n\n  // When an aspect of a line changes, a string is added to\n  // lineView.changes. This updates the relevant part of the line's\n  // DOM structure.\n  function updateLineForChanges(cm, lineView, lineN, dims) {\n    for (var j = 0; j < lineView.changes.length; j++) {\n      var type = lineView.changes[j];\n      if (type == \"text\") updateLineText(cm, lineView);\n      else if (type == \"gutter\") updateLineGutter(cm, lineView, lineN, dims);\n      else if (type == \"class\") updateLineClasses(lineView);\n      else if (type == \"widget\") updateLineWidgets(lineView, dims);\n    }\n    lineView.changes = null;\n  }\n\n  // Lines with gutter elements, widgets or a background class need to\n  // be wrapped, and have the extra elements added to the wrapper div\n  function ensureLineWrapped(lineView) {\n    if (lineView.node == lineView.text) {\n      lineView.node = elt(\"div\", null, null, \"position: relative\");\n      if (lineView.text.parentNode)\n        lineView.text.parentNode.replaceChild(lineView.node, lineView.text);\n      lineView.node.appendChild(lineView.text);\n      if (ie && ie_version < 8) lineView.node.style.zIndex = 2;\n    }\n    return lineView.node;\n  }\n\n  function updateLineBackground(lineView) {\n    var cls = lineView.bgClass ? lineView.bgClass + \" \" + (lineView.line.bgClass || \"\") : lineView.line.bgClass;\n    if (cls) cls += \" CodeMirror-linebackground\";\n    if (lineView.background) {\n      if (cls) lineView.background.className = cls;\n      else { lineView.background.parentNode.removeChild(lineView.background); lineView.background = null; }\n    } else if (cls) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.background = wrap.insertBefore(elt(\"div\", null, cls), wrap.firstChild);\n    }\n  }\n\n  // Wrapper around buildLineContent which will reuse the structure\n  // in display.externalMeasured when possible.\n  function getLineContent(cm, lineView) {\n    var ext = cm.display.externalMeasured;\n    if (ext && ext.line == lineView.line) {\n      cm.display.externalMeasured = null;\n      lineView.measure = ext.measure;\n      return ext.built;\n    }\n    return buildLineContent(cm, lineView);\n  }\n\n  // Redraw the line's text. Interacts with the background and text\n  // classes because the mode may output tokens that influence these\n  // classes.\n  function updateLineText(cm, lineView) {\n    var cls = lineView.text.className;\n    var built = getLineContent(cm, lineView);\n    if (lineView.text == lineView.node) lineView.node = built.pre;\n    lineView.text.parentNode.replaceChild(built.pre, lineView.text);\n    lineView.text = built.pre;\n    if (built.bgClass != lineView.bgClass || built.textClass != lineView.textClass) {\n      lineView.bgClass = built.bgClass;\n      lineView.textClass = built.textClass;\n      updateLineClasses(lineView);\n    } else if (cls) {\n      lineView.text.className = cls;\n    }\n  }\n\n  function updateLineClasses(lineView) {\n    updateLineBackground(lineView);\n    if (lineView.line.wrapClass)\n      ensureLineWrapped(lineView).className = lineView.line.wrapClass;\n    else if (lineView.node != lineView.text)\n      lineView.node.className = \"\";\n    var textClass = lineView.textClass ? lineView.textClass + \" \" + (lineView.line.textClass || \"\") : lineView.line.textClass;\n    lineView.text.className = textClass || \"\";\n  }\n\n  function updateLineGutter(cm, lineView, lineN, dims) {\n    if (lineView.gutter) {\n      lineView.node.removeChild(lineView.gutter);\n      lineView.gutter = null;\n    }\n    var markers = lineView.line.gutterMarkers;\n    if (cm.options.lineNumbers || markers) {\n      var wrap = ensureLineWrapped(lineView);\n      var gutterWrap = lineView.gutter =\n        wrap.insertBefore(elt(\"div\", null, \"CodeMirror-gutter-wrapper\", \"position: absolute; left: \" +\n                              (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px\"),\n                          lineView.text);\n      if (cm.options.lineNumbers && (!markers || !markers[\"CodeMirror-linenumbers\"]))\n        lineView.lineNumber = gutterWrap.appendChild(\n          elt(\"div\", lineNumberFor(cm.options, lineN),\n              \"CodeMirror-linenumber CodeMirror-gutter-elt\",\n              \"left: \" + dims.gutterLeft[\"CodeMirror-linenumbers\"] + \"px; width: \"\n              + cm.display.lineNumInnerWidth + \"px\"));\n      if (markers) for (var k = 0; k < cm.options.gutters.length; ++k) {\n        var id = cm.options.gutters[k], found = markers.hasOwnProperty(id) && markers[id];\n        if (found)\n          gutterWrap.appendChild(elt(\"div\", [found], \"CodeMirror-gutter-elt\", \"left: \" +\n                                     dims.gutterLeft[id] + \"px; width: \" + dims.gutterWidth[id] + \"px\"));\n      }\n    }\n  }\n\n  function updateLineWidgets(lineView, dims) {\n    if (lineView.alignable) lineView.alignable = null;\n    for (var node = lineView.node.firstChild, next; node; node = next) {\n      var next = node.nextSibling;\n      if (node.className == \"CodeMirror-linewidget\")\n        lineView.node.removeChild(node);\n    }\n    insertLineWidgets(lineView, dims);\n  }\n\n  // Build a line's DOM representation from scratch\n  function buildLineElement(cm, lineView, lineN, dims) {\n    var built = getLineContent(cm, lineView);\n    lineView.text = lineView.node = built.pre;\n    if (built.bgClass) lineView.bgClass = built.bgClass;\n    if (built.textClass) lineView.textClass = built.textClass;\n\n    updateLineClasses(lineView);\n    updateLineGutter(cm, lineView, lineN, dims);\n    insertLineWidgets(lineView, dims);\n    return lineView.node;\n  }\n\n  // A lineView may contain multiple logical lines (when merged by\n  // collapsed spans). The widgets for all of them need to be drawn.\n  function insertLineWidgets(lineView, dims) {\n    insertLineWidgetsFor(lineView.line, lineView, dims, true);\n    if (lineView.rest) for (var i = 0; i < lineView.rest.length; i++)\n      insertLineWidgetsFor(lineView.rest[i], lineView, dims, false);\n  }\n\n  function insertLineWidgetsFor(line, lineView, dims, allowAbove) {\n    if (!line.widgets) return;\n    var wrap = ensureLineWrapped(lineView);\n    for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\n      var widget = ws[i], node = elt(\"div\", [widget.node], \"CodeMirror-linewidget\");\n      if (!widget.handleMouseEvents) node.ignoreEvents = true;\n      positionLineWidget(widget, node, lineView, dims);\n      if (allowAbove && widget.above)\n        wrap.insertBefore(node, lineView.gutter || lineView.text);\n      else\n        wrap.appendChild(node);\n      signalLater(widget, \"redraw\");\n    }\n  }\n\n  function positionLineWidget(widget, node, lineView, dims) {\n    if (widget.noHScroll) {\n      (lineView.alignable || (lineView.alignable = [])).push(node);\n      var width = dims.wrapperWidth;\n      node.style.left = dims.fixedPos + \"px\";\n      if (!widget.coverGutter) {\n        width -= dims.gutterTotalWidth;\n        node.style.paddingLeft = dims.gutterTotalWidth + \"px\";\n      }\n      node.style.width = width + \"px\";\n    }\n    if (widget.coverGutter) {\n      node.style.zIndex = 5;\n      node.style.position = \"relative\";\n      if (!widget.noHScroll) node.style.marginLeft = -dims.gutterTotalWidth + \"px\";\n    }\n  }\n\n  // POSITION OBJECT\n\n  // A Pos instance represents a position within the text.\n  var Pos = CodeMirror.Pos = function(line, ch) {\n    if (!(this instanceof Pos)) return new Pos(line, ch);\n    this.line = line; this.ch = ch;\n  };\n\n  // Compare two positions, return 0 if they are the same, a negative\n  // number when a is less, and a positive number otherwise.\n  var cmp = CodeMirror.cmpPos = function(a, b) { return a.line - b.line || a.ch - b.ch; };\n\n  function copyPos(x) {return Pos(x.line, x.ch);}\n  function maxPos(a, b) { return cmp(a, b) < 0 ? b : a; }\n  function minPos(a, b) { return cmp(a, b) < 0 ? a : b; }\n\n  // SELECTION / CURSOR\n\n  // Selection objects are immutable. A new one is created every time\n  // the selection changes. A selection is one or more non-overlapping\n  // (and non-touching) ranges, sorted, and an integer that indicates\n  // which one is the primary selection (the one that's scrolled into\n  // view, that getCursor returns, etc).\n  function Selection(ranges, primIndex) {\n    this.ranges = ranges;\n    this.primIndex = primIndex;\n  }\n\n  Selection.prototype = {\n    primary: function() { return this.ranges[this.primIndex]; },\n    equals: function(other) {\n      if (other == this) return true;\n      if (other.primIndex != this.primIndex || other.ranges.length != this.ranges.length) return false;\n      for (var i = 0; i < this.ranges.length; i++) {\n        var here = this.ranges[i], there = other.ranges[i];\n        if (cmp(here.anchor, there.anchor) != 0 || cmp(here.head, there.head) != 0) return false;\n      }\n      return true;\n    },\n    deepCopy: function() {\n      for (var out = [], i = 0; i < this.ranges.length; i++)\n        out[i] = new Range(copyPos(this.ranges[i].anchor), copyPos(this.ranges[i].head));\n      return new Selection(out, this.primIndex);\n    },\n    somethingSelected: function() {\n      for (var i = 0; i < this.ranges.length; i++)\n        if (!this.ranges[i].empty()) return true;\n      return false;\n    },\n    contains: function(pos, end) {\n      if (!end) end = pos;\n      for (var i = 0; i < this.ranges.length; i++) {\n        var range = this.ranges[i];\n        if (cmp(end, range.from()) >= 0 && cmp(pos, range.to()) <= 0)\n          return i;\n      }\n      return -1;\n    }\n  };\n\n  function Range(anchor, head) {\n    this.anchor = anchor; this.head = head;\n  }\n\n  Range.prototype = {\n    from: function() { return minPos(this.anchor, this.head); },\n    to: function() { return maxPos(this.anchor, this.head); },\n    empty: function() {\n      return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch;\n    }\n  };\n\n  // Take an unsorted, potentially overlapping set of ranges, and\n  // build a selection out of it. 'Consumes' ranges array (modifying\n  // it).\n  function normalizeSelection(ranges, primIndex) {\n    var prim = ranges[primIndex];\n    ranges.sort(function(a, b) { return cmp(a.from(), b.from()); });\n    primIndex = indexOf(ranges, prim);\n    for (var i = 1; i < ranges.length; i++) {\n      var cur = ranges[i], prev = ranges[i - 1];\n      if (cmp(prev.to(), cur.from()) >= 0) {\n        var from = minPos(prev.from(), cur.from()), to = maxPos(prev.to(), cur.to());\n        var inv = prev.empty() ? cur.from() == cur.head : prev.from() == prev.head;\n        if (i <= primIndex) --primIndex;\n        ranges.splice(--i, 2, new Range(inv ? to : from, inv ? from : to));\n      }\n    }\n    return new Selection(ranges, primIndex);\n  }\n\n  function simpleSelection(anchor, head) {\n    return new Selection([new Range(anchor, head || anchor)], 0);\n  }\n\n  // Most of the external API clips given positions to make sure they\n  // actually exist within the document.\n  function clipLine(doc, n) {return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1));}\n  function clipPos(doc, pos) {\n    if (pos.line < doc.first) return Pos(doc.first, 0);\n    var last = doc.first + doc.size - 1;\n    if (pos.line > last) return Pos(last, getLine(doc, last).text.length);\n    return clipToLen(pos, getLine(doc, pos.line).text.length);\n  }\n  function clipToLen(pos, linelen) {\n    var ch = pos.ch;\n    if (ch == null || ch > linelen) return Pos(pos.line, linelen);\n    else if (ch < 0) return Pos(pos.line, 0);\n    else return pos;\n  }\n  function isLine(doc, l) {return l >= doc.first && l < doc.first + doc.size;}\n  function clipPosArray(doc, array) {\n    for (var out = [], i = 0; i < array.length; i++) out[i] = clipPos(doc, array[i]);\n    return out;\n  }\n\n  // SELECTION UPDATES\n\n  // The 'scroll' parameter given to many of these indicated whether\n  // the new cursor position should be scrolled into view after\n  // modifying the selection.\n\n  // If shift is held or the extend flag is set, extends a range to\n  // include a given position (and optionally a second position).\n  // Otherwise, simply returns the range between the given positions.\n  // Used for cursor motion and such.\n  function extendRange(doc, range, head, other) {\n    if (doc.cm && doc.cm.display.shift || doc.extend) {\n      var anchor = range.anchor;\n      if (other) {\n        var posBefore = cmp(head, anchor) < 0;\n        if (posBefore != (cmp(other, anchor) < 0)) {\n          anchor = head;\n          head = other;\n        } else if (posBefore != (cmp(head, other) < 0)) {\n          head = other;\n        }\n      }\n      return new Range(anchor, head);\n    } else {\n      return new Range(other || head, head);\n    }\n  }\n\n  // Extend the primary selection range, discard the rest.\n  function extendSelection(doc, head, other, options) {\n    setSelection(doc, new Selection([extendRange(doc, doc.sel.primary(), head, other)], 0), options);\n  }\n\n  // Extend all selections (pos is an array of selections with length\n  // equal the number of selections)\n  function extendSelections(doc, heads, options) {\n    for (var out = [], i = 0; i < doc.sel.ranges.length; i++)\n      out[i] = extendRange(doc, doc.sel.ranges[i], heads[i], null);\n    var newSel = normalizeSelection(out, doc.sel.primIndex);\n    setSelection(doc, newSel, options);\n  }\n\n  // Updates a single range in the selection.\n  function replaceOneSelection(doc, i, range, options) {\n    var ranges = doc.sel.ranges.slice(0);\n    ranges[i] = range;\n    setSelection(doc, normalizeSelection(ranges, doc.sel.primIndex), options);\n  }\n\n  // Reset the selection to a single range.\n  function setSimpleSelection(doc, anchor, head, options) {\n    setSelection(doc, simpleSelection(anchor, head), options);\n  }\n\n  // Give beforeSelectionChange handlers a change to influence a\n  // selection update.\n  function filterSelectionChange(doc, sel) {\n    var obj = {\n      ranges: sel.ranges,\n      update: function(ranges) {\n        this.ranges = [];\n        for (var i = 0; i < ranges.length; i++)\n          this.ranges[i] = new Range(clipPos(doc, ranges[i].anchor),\n                                     clipPos(doc, ranges[i].head));\n      }\n    };\n    signal(doc, \"beforeSelectionChange\", doc, obj);\n    if (doc.cm) signal(doc.cm, \"beforeSelectionChange\", doc.cm, obj);\n    if (obj.ranges != sel.ranges) return normalizeSelection(obj.ranges, obj.ranges.length - 1);\n    else return sel;\n  }\n\n  function setSelectionReplaceHistory(doc, sel, options) {\n    var done = doc.history.done, last = lst(done);\n    if (last && last.ranges) {\n      done[done.length - 1] = sel;\n      setSelectionNoUndo(doc, sel, options);\n    } else {\n      setSelection(doc, sel, options);\n    }\n  }\n\n  // Set a new selection.\n  function setSelection(doc, sel, options) {\n    setSelectionNoUndo(doc, sel, options);\n    addSelectionToHistory(doc, doc.sel, doc.cm ? doc.cm.curOp.id : NaN, options);\n  }\n\n  function setSelectionNoUndo(doc, sel, options) {\n    if (hasHandler(doc, \"beforeSelectionChange\") || doc.cm && hasHandler(doc.cm, \"beforeSelectionChange\"))\n      sel = filterSelectionChange(doc, sel);\n\n    var bias = options && options.bias ||\n      (cmp(sel.primary().head, doc.sel.primary().head) < 0 ? -1 : 1);\n    setSelectionInner(doc, skipAtomicInSelection(doc, sel, bias, true));\n\n    if (!(options && options.scroll === false) && doc.cm)\n      ensureCursorVisible(doc.cm);\n  }\n\n  function setSelectionInner(doc, sel) {\n    if (sel.equals(doc.sel)) return;\n\n    doc.sel = sel;\n\n    if (doc.cm) {\n      doc.cm.curOp.updateInput = doc.cm.curOp.selectionChanged = true;\n      signalCursorActivity(doc.cm);\n    }\n    signalLater(doc, \"cursorActivity\", doc);\n  }\n\n  // Verify that the selection does not partially select any atomic\n  // marked ranges.\n  function reCheckSelection(doc) {\n    setSelectionInner(doc, skipAtomicInSelection(doc, doc.sel, null, false), sel_dontScroll);\n  }\n\n  // Return a selection that does not partially select any atomic\n  // ranges.\n  function skipAtomicInSelection(doc, sel, bias, mayClear) {\n    var out;\n    for (var i = 0; i < sel.ranges.length; i++) {\n      var range = sel.ranges[i];\n      var newAnchor = skipAtomic(doc, range.anchor, bias, mayClear);\n      var newHead = skipAtomic(doc, range.head, bias, mayClear);\n      if (out || newAnchor != range.anchor || newHead != range.head) {\n        if (!out) out = sel.ranges.slice(0, i);\n        out[i] = new Range(newAnchor, newHead);\n      }\n    }\n    return out ? normalizeSelection(out, sel.primIndex) : sel;\n  }\n\n  // Ensure a given position is not inside an atomic range.\n  function skipAtomic(doc, pos, bias, mayClear) {\n    var flipped = false, curPos = pos;\n    var dir = bias || 1;\n    doc.cantEdit = false;\n    search: for (;;) {\n      var line = getLine(doc, curPos.line);\n      if (line.markedSpans) {\n        for (var i = 0; i < line.markedSpans.length; ++i) {\n          var sp = line.markedSpans[i], m = sp.marker;\n          if ((sp.from == null || (m.inclusiveLeft ? sp.from <= curPos.ch : sp.from < curPos.ch)) &&\n              (sp.to == null || (m.inclusiveRight ? sp.to >= curPos.ch : sp.to > curPos.ch))) {\n            if (mayClear) {\n              signal(m, \"beforeCursorEnter\");\n              if (m.explicitlyCleared) {\n                if (!line.markedSpans) break;\n                else {--i; continue;}\n              }\n            }\n            if (!m.atomic) continue;\n            var newPos = m.find(dir < 0 ? -1 : 1);\n            if (cmp(newPos, curPos) == 0) {\n              newPos.ch += dir;\n              if (newPos.ch < 0) {\n                if (newPos.line > doc.first) newPos = clipPos(doc, Pos(newPos.line - 1));\n                else newPos = null;\n              } else if (newPos.ch > line.text.length) {\n                if (newPos.line < doc.first + doc.size - 1) newPos = Pos(newPos.line + 1, 0);\n                else newPos = null;\n              }\n              if (!newPos) {\n                if (flipped) {\n                  // Driven in a corner -- no valid cursor position found at all\n                  // -- try again *with* clearing, if we didn't already\n                  if (!mayClear) return skipAtomic(doc, pos, bias, true);\n                  // Otherwise, turn off editing until further notice, and return the start of the doc\n                  doc.cantEdit = true;\n                  return Pos(doc.first, 0);\n                }\n                flipped = true; newPos = pos; dir = -dir;\n              }\n            }\n            curPos = newPos;\n            continue search;\n          }\n        }\n      }\n      return curPos;\n    }\n  }\n\n  // SELECTION DRAWING\n\n  // Redraw the selection and/or cursor\n  function drawSelection(cm) {\n    var display = cm.display, doc = cm.doc, result = {};\n    var curFragment = result.cursors = document.createDocumentFragment();\n    var selFragment = result.selection = document.createDocumentFragment();\n\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      var range = doc.sel.ranges[i];\n      var collapsed = range.empty();\n      if (collapsed || cm.options.showCursorWhenSelecting)\n        drawSelectionCursor(cm, range, curFragment);\n      if (!collapsed)\n        drawSelectionRange(cm, range, selFragment);\n    }\n\n    // Move the hidden textarea near the cursor to prevent scrolling artifacts\n    if (cm.options.moveInputWithCursor) {\n      var headPos = cursorCoords(cm, doc.sel.primary().head, \"div\");\n      var wrapOff = display.wrapper.getBoundingClientRect(), lineOff = display.lineDiv.getBoundingClientRect();\n      result.teTop = Math.max(0, Math.min(display.wrapper.clientHeight - 10,\n                                          headPos.top + lineOff.top - wrapOff.top));\n      result.teLeft = Math.max(0, Math.min(display.wrapper.clientWidth - 10,\n                                           headPos.left + lineOff.left - wrapOff.left));\n    }\n\n    return result;\n  }\n\n  function showSelection(cm, drawn) {\n    removeChildrenAndAdd(cm.display.cursorDiv, drawn.cursors);\n    removeChildrenAndAdd(cm.display.selectionDiv, drawn.selection);\n    if (drawn.teTop != null) {\n      cm.display.inputDiv.style.top = drawn.teTop + \"px\";\n      cm.display.inputDiv.style.left = drawn.teLeft + \"px\";\n    }\n  }\n\n  function updateSelection(cm) {\n    showSelection(cm, drawSelection(cm));\n  }\n\n  // Draws a cursor for the given range\n  function drawSelectionCursor(cm, range, output) {\n    var pos = cursorCoords(cm, range.head, \"div\", null, null, !cm.options.singleCursorHeightPerLine);\n\n    var cursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor\"));\n    cursor.style.left = pos.left + \"px\";\n    cursor.style.top = pos.top + \"px\";\n    cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + \"px\";\n\n    if (pos.other) {\n      // Secondary cursor, shown when on a 'jump' in bi-directional text\n      var otherCursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor CodeMirror-secondarycursor\"));\n      otherCursor.style.display = \"\";\n      otherCursor.style.left = pos.other.left + \"px\";\n      otherCursor.style.top = pos.other.top + \"px\";\n      otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + \"px\";\n    }\n  }\n\n  // Draws the given range as a highlighted selection\n  function drawSelectionRange(cm, range, output) {\n    var display = cm.display, doc = cm.doc;\n    var fragment = document.createDocumentFragment();\n    var padding = paddingH(cm.display), leftSide = padding.left, rightSide = display.lineSpace.offsetWidth - padding.right;\n\n    function add(left, top, width, bottom) {\n      if (top < 0) top = 0;\n      top = Math.round(top);\n      bottom = Math.round(bottom);\n      fragment.appendChild(elt(\"div\", null, \"CodeMirror-selected\", \"position: absolute; left: \" + left +\n                               \"px; top: \" + top + \"px; width: \" + (width == null ? rightSide - left : width) +\n                               \"px; height: \" + (bottom - top) + \"px\"));\n    }\n\n    function drawForLine(line, fromArg, toArg) {\n      var lineObj = getLine(doc, line);\n      var lineLen = lineObj.text.length;\n      var start, end;\n      function coords(ch, bias) {\n        return charCoords(cm, Pos(line, ch), \"div\", lineObj, bias);\n      }\n\n      iterateBidiSections(getOrder(lineObj), fromArg || 0, toArg == null ? lineLen : toArg, function(from, to, dir) {\n        var leftPos = coords(from, \"left\"), rightPos, left, right;\n        if (from == to) {\n          rightPos = leftPos;\n          left = right = leftPos.left;\n        } else {\n          rightPos = coords(to - 1, \"right\");\n          if (dir == \"rtl\") { var tmp = leftPos; leftPos = rightPos; rightPos = tmp; }\n          left = leftPos.left;\n          right = rightPos.right;\n        }\n        if (fromArg == null && from == 0) left = leftSide;\n        if (rightPos.top - leftPos.top > 3) { // Different lines, draw top part\n          add(left, leftPos.top, null, leftPos.bottom);\n          left = leftSide;\n          if (leftPos.bottom < rightPos.top) add(left, leftPos.bottom, null, rightPos.top);\n        }\n        if (toArg == null && to == lineLen) right = rightSide;\n        if (!start || leftPos.top < start.top || leftPos.top == start.top && leftPos.left < start.left)\n          start = leftPos;\n        if (!end || rightPos.bottom > end.bottom || rightPos.bottom == end.bottom && rightPos.right > end.right)\n          end = rightPos;\n        if (left < leftSide + 1) left = leftSide;\n        add(left, rightPos.top, right - left, rightPos.bottom);\n      });\n      return {start: start, end: end};\n    }\n\n    var sFrom = range.from(), sTo = range.to();\n    if (sFrom.line == sTo.line) {\n      drawForLine(sFrom.line, sFrom.ch, sTo.ch);\n    } else {\n      var fromLine = getLine(doc, sFrom.line), toLine = getLine(doc, sTo.line);\n      var singleVLine = visualLine(fromLine) == visualLine(toLine);\n      var leftEnd = drawForLine(sFrom.line, sFrom.ch, singleVLine ? fromLine.text.length + 1 : null).end;\n      var rightStart = drawForLine(sTo.line, singleVLine ? 0 : null, sTo.ch).start;\n      if (singleVLine) {\n        if (leftEnd.top < rightStart.top - 2) {\n          add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);\n          add(leftSide, rightStart.top, rightStart.left, rightStart.bottom);\n        } else {\n          add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);\n        }\n      }\n      if (leftEnd.bottom < rightStart.top)\n        add(leftSide, leftEnd.bottom, null, rightStart.top);\n    }\n\n    output.appendChild(fragment);\n  }\n\n  // Cursor-blinking\n  function restartBlink(cm) {\n    if (!cm.state.focused) return;\n    var display = cm.display;\n    clearInterval(display.blinker);\n    var on = true;\n    display.cursorDiv.style.visibility = \"\";\n    if (cm.options.cursorBlinkRate > 0)\n      display.blinker = setInterval(function() {\n        display.cursorDiv.style.visibility = (on = !on) ? \"\" : \"hidden\";\n      }, cm.options.cursorBlinkRate);\n    else if (cm.options.cursorBlinkRate < 0)\n      display.cursorDiv.style.visibility = \"hidden\";\n  }\n\n  // HIGHLIGHT WORKER\n\n  function startWorker(cm, time) {\n    if (cm.doc.mode.startState && cm.doc.frontier < cm.display.viewTo)\n      cm.state.highlight.set(time, bind(highlightWorker, cm));\n  }\n\n  function highlightWorker(cm) {\n    var doc = cm.doc;\n    if (doc.frontier < doc.first) doc.frontier = doc.first;\n    if (doc.frontier >= cm.display.viewTo) return;\n    var end = +new Date + cm.options.workTime;\n    var state = copyState(doc.mode, getStateBefore(cm, doc.frontier));\n    var changedLines = [];\n\n    doc.iter(doc.frontier, Math.min(doc.first + doc.size, cm.display.viewTo + 500), function(line) {\n      if (doc.frontier >= cm.display.viewFrom) { // Visible\n        var oldStyles = line.styles;\n        var highlighted = highlightLine(cm, line, state, true);\n        line.styles = highlighted.styles;\n        var oldCls = line.styleClasses, newCls = highlighted.classes;\n        if (newCls) line.styleClasses = newCls;\n        else if (oldCls) line.styleClasses = null;\n        var ischange = !oldStyles || oldStyles.length != line.styles.length ||\n          oldCls != newCls && (!oldCls || !newCls || oldCls.bgClass != newCls.bgClass || oldCls.textClass != newCls.textClass);\n        for (var i = 0; !ischange && i < oldStyles.length; ++i) ischange = oldStyles[i] != line.styles[i];\n        if (ischange) changedLines.push(doc.frontier);\n        line.stateAfter = copyState(doc.mode, state);\n      } else {\n        processLine(cm, line.text, state);\n        line.stateAfter = doc.frontier % 5 == 0 ? copyState(doc.mode, state) : null;\n      }\n      ++doc.frontier;\n      if (+new Date > end) {\n        startWorker(cm, cm.options.workDelay);\n        return true;\n      }\n    });\n    if (changedLines.length) runInOp(cm, function() {\n      for (var i = 0; i < changedLines.length; i++)\n        regLineChange(cm, changedLines[i], \"text\");\n    });\n  }\n\n  // Finds the line to start with when starting a parse. Tries to\n  // find a line with a stateAfter, so that it can start with a\n  // valid state. If that fails, it returns the line with the\n  // smallest indentation, which tends to need the least context to\n  // parse correctly.\n  function findStartLine(cm, n, precise) {\n    var minindent, minline, doc = cm.doc;\n    var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100);\n    for (var search = n; search > lim; --search) {\n      if (search <= doc.first) return doc.first;\n      var line = getLine(doc, search - 1);\n      if (line.stateAfter && (!precise || search <= doc.frontier)) return search;\n      var indented = countColumn(line.text, null, cm.options.tabSize);\n      if (minline == null || minindent > indented) {\n        minline = search - 1;\n        minindent = indented;\n      }\n    }\n    return minline;\n  }\n\n  function getStateBefore(cm, n, precise) {\n    var doc = cm.doc, display = cm.display;\n    if (!doc.mode.startState) return true;\n    var pos = findStartLine(cm, n, precise), state = pos > doc.first && getLine(doc, pos-1).stateAfter;\n    if (!state) state = startState(doc.mode);\n    else state = copyState(doc.mode, state);\n    doc.iter(pos, n, function(line) {\n      processLine(cm, line.text, state);\n      var save = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo;\n      line.stateAfter = save ? copyState(doc.mode, state) : null;\n      ++pos;\n    });\n    if (precise) doc.frontier = pos;\n    return state;\n  }\n\n  // POSITION MEASUREMENT\n\n  function paddingTop(display) {return display.lineSpace.offsetTop;}\n  function paddingVert(display) {return display.mover.offsetHeight - display.lineSpace.offsetHeight;}\n  function paddingH(display) {\n    if (display.cachedPaddingH) return display.cachedPaddingH;\n    var e = removeChildrenAndAdd(display.measure, elt(\"pre\", \"x\"));\n    var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle;\n    var data = {left: parseInt(style.paddingLeft), right: parseInt(style.paddingRight)};\n    if (!isNaN(data.left) && !isNaN(data.right)) display.cachedPaddingH = data;\n    return data;\n  }\n\n  // Ensure the lineView.wrapping.heights array is populated. This is\n  // an array of bottom offsets for the lines that make up a drawn\n  // line. When lineWrapping is on, there might be more than one\n  // height.\n  function ensureLineHeights(cm, lineView, rect) {\n    var wrapping = cm.options.lineWrapping;\n    var curWidth = wrapping && cm.display.scroller.clientWidth;\n    if (!lineView.measure.heights || wrapping && lineView.measure.width != curWidth) {\n      var heights = lineView.measure.heights = [];\n      if (wrapping) {\n        lineView.measure.width = curWidth;\n        var rects = lineView.text.firstChild.getClientRects();\n        for (var i = 0; i < rects.length - 1; i++) {\n          var cur = rects[i], next = rects[i + 1];\n          if (Math.abs(cur.bottom - next.bottom) > 2)\n            heights.push((cur.bottom + next.top) / 2 - rect.top);\n        }\n      }\n      heights.push(rect.bottom - rect.top);\n    }\n  }\n\n  // Find a line map (mapping character offsets to text nodes) and a\n  // measurement cache for the given line number. (A line view might\n  // contain multiple lines when collapsed ranges are present.)\n  function mapFromLineView(lineView, line, lineN) {\n    if (lineView.line == line)\n      return {map: lineView.measure.map, cache: lineView.measure.cache};\n    for (var i = 0; i < lineView.rest.length; i++)\n      if (lineView.rest[i] == line)\n        return {map: lineView.measure.maps[i], cache: lineView.measure.caches[i]};\n    for (var i = 0; i < lineView.rest.length; i++)\n      if (lineNo(lineView.rest[i]) > lineN)\n        return {map: lineView.measure.maps[i], cache: lineView.measure.caches[i], before: true};\n  }\n\n  // Render a line into the hidden node display.externalMeasured. Used\n  // when measurement is needed for a line that's not in the viewport.\n  function updateExternalMeasurement(cm, line) {\n    line = visualLine(line);\n    var lineN = lineNo(line);\n    var view = cm.display.externalMeasured = new LineView(cm.doc, line, lineN);\n    view.lineN = lineN;\n    var built = view.built = buildLineContent(cm, view);\n    view.text = built.pre;\n    removeChildrenAndAdd(cm.display.lineMeasure, built.pre);\n    return view;\n  }\n\n  // Get a {top, bottom, left, right} box (in line-local coordinates)\n  // for a given character.\n  function measureChar(cm, line, ch, bias) {\n    return measureCharPrepared(cm, prepareMeasureForLine(cm, line), ch, bias);\n  }\n\n  // Find a line view that corresponds to the given line number.\n  function findViewForLine(cm, lineN) {\n    if (lineN >= cm.display.viewFrom && lineN < cm.display.viewTo)\n      return cm.display.view[findViewIndex(cm, lineN)];\n    var ext = cm.display.externalMeasured;\n    if (ext && lineN >= ext.lineN && lineN < ext.lineN + ext.size)\n      return ext;\n  }\n\n  // Measurement can be split in two steps, the set-up work that\n  // applies to the whole line, and the measurement of the actual\n  // character. Functions like coordsChar, that need to do a lot of\n  // measurements in a row, can thus ensure that the set-up work is\n  // only done once.\n  function prepareMeasureForLine(cm, line) {\n    var lineN = lineNo(line);\n    var view = findViewForLine(cm, lineN);\n    if (view && !view.text)\n      view = null;\n    else if (view && view.changes)\n      updateLineForChanges(cm, view, lineN, getDimensions(cm));\n    if (!view)\n      view = updateExternalMeasurement(cm, line);\n\n    var info = mapFromLineView(view, line, lineN);\n    return {\n      line: line, view: view, rect: null,\n      map: info.map, cache: info.cache, before: info.before,\n      hasHeights: false\n    };\n  }\n\n  // Given a prepared measurement object, measures the position of an\n  // actual character (or fetches it from the cache).\n  function measureCharPrepared(cm, prepared, ch, bias, varHeight) {\n    if (prepared.before) ch = -1;\n    var key = ch + (bias || \"\"), found;\n    if (prepared.cache.hasOwnProperty(key)) {\n      found = prepared.cache[key];\n    } else {\n      if (!prepared.rect)\n        prepared.rect = prepared.view.text.getBoundingClientRect();\n      if (!prepared.hasHeights) {\n        ensureLineHeights(cm, prepared.view, prepared.rect);\n        prepared.hasHeights = true;\n      }\n      found = measureCharInner(cm, prepared, ch, bias);\n      if (!found.bogus) prepared.cache[key] = found;\n    }\n    return {left: found.left, right: found.right,\n            top: varHeight ? found.rtop : found.top,\n            bottom: varHeight ? found.rbottom : found.bottom};\n  }\n\n  var nullRect = {left: 0, right: 0, top: 0, bottom: 0};\n\n  function measureCharInner(cm, prepared, ch, bias) {\n    var map = prepared.map;\n\n    var node, start, end, collapse;\n    // First, search the line map for the text node corresponding to,\n    // or closest to, the target character.\n    for (var i = 0; i < map.length; i += 3) {\n      var mStart = map[i], mEnd = map[i + 1];\n      if (ch < mStart) {\n        start = 0; end = 1;\n        collapse = \"left\";\n      } else if (ch < mEnd) {\n        start = ch - mStart;\n        end = start + 1;\n      } else if (i == map.length - 3 || ch == mEnd && map[i + 3] > ch) {\n        end = mEnd - mStart;\n        start = end - 1;\n        if (ch >= mEnd) collapse = \"right\";\n      }\n      if (start != null) {\n        node = map[i + 2];\n        if (mStart == mEnd && bias == (node.insertLeft ? \"left\" : \"right\"))\n          collapse = bias;\n        if (bias == \"left\" && start == 0)\n          while (i && map[i - 2] == map[i - 3] && map[i - 1].insertLeft) {\n            node = map[(i -= 3) + 2];\n            collapse = \"left\";\n          }\n        if (bias == \"right\" && start == mEnd - mStart)\n          while (i < map.length - 3 && map[i + 3] == map[i + 4] && !map[i + 5].insertLeft) {\n            node = map[(i += 3) + 2];\n            collapse = \"right\";\n          }\n        break;\n      }\n    }\n\n    var rect;\n    if (node.nodeType == 3) { // If it is a text node, use a range to retrieve the coordinates.\n      for (var i = 0; i < 4; i++) { // Retry a maximum of 4 times when nonsense rectangles are returned\n        while (start && isExtendingChar(prepared.line.text.charAt(mStart + start))) --start;\n        while (mStart + end < mEnd && isExtendingChar(prepared.line.text.charAt(mStart + end))) ++end;\n        if (ie && ie_version < 9 && start == 0 && end == mEnd - mStart) {\n          rect = node.parentNode.getBoundingClientRect();\n        } else if (ie && cm.options.lineWrapping) {\n          var rects = range(node, start, end).getClientRects();\n          if (rects.length)\n            rect = rects[bias == \"right\" ? rects.length - 1 : 0];\n          else\n            rect = nullRect;\n        } else {\n          rect = range(node, start, end).getBoundingClientRect() || nullRect;\n        }\n        if (rect.left || rect.right || start == 0) break;\n        end = start;\n        start = start - 1;\n        collapse = \"right\";\n      }\n      if (ie && ie_version < 11) rect = maybeUpdateRectForZooming(cm.display.measure, rect);\n    } else { // If it is a widget, simply get the box for the whole widget.\n      if (start > 0) collapse = bias = \"right\";\n      var rects;\n      if (cm.options.lineWrapping && (rects = node.getClientRects()).length > 1)\n        rect = rects[bias == \"right\" ? rects.length - 1 : 0];\n      else\n        rect = node.getBoundingClientRect();\n    }\n    if (ie && ie_version < 9 && !start && (!rect || !rect.left && !rect.right)) {\n      var rSpan = node.parentNode.getClientRects()[0];\n      if (rSpan)\n        rect = {left: rSpan.left, right: rSpan.left + charWidth(cm.display), top: rSpan.top, bottom: rSpan.bottom};\n      else\n        rect = nullRect;\n    }\n\n    var rtop = rect.top - prepared.rect.top, rbot = rect.bottom - prepared.rect.top;\n    var mid = (rtop + rbot) / 2;\n    var heights = prepared.view.measure.heights;\n    for (var i = 0; i < heights.length - 1; i++)\n      if (mid < heights[i]) break;\n    var top = i ? heights[i - 1] : 0, bot = heights[i];\n    var result = {left: (collapse == \"right\" ? rect.right : rect.left) - prepared.rect.left,\n                  right: (collapse == \"left\" ? rect.left : rect.right) - prepared.rect.left,\n                  top: top, bottom: bot};\n    if (!rect.left && !rect.right) result.bogus = true;\n    if (!cm.options.singleCursorHeightPerLine) { result.rtop = rtop; result.rbottom = rbot; }\n\n    return result;\n  }\n\n  // Work around problem with bounding client rects on ranges being\n  // returned incorrectly when zoomed on IE10 and below.\n  function maybeUpdateRectForZooming(measure, rect) {\n    if (!window.screen || screen.logicalXDPI == null ||\n        screen.logicalXDPI == screen.deviceXDPI || !hasBadZoomedRects(measure))\n      return rect;\n    var scaleX = screen.logicalXDPI / screen.deviceXDPI;\n    var scaleY = screen.logicalYDPI / screen.deviceYDPI;\n    return {left: rect.left * scaleX, right: rect.right * scaleX,\n            top: rect.top * scaleY, bottom: rect.bottom * scaleY};\n  }\n\n  function clearLineMeasurementCacheFor(lineView) {\n    if (lineView.measure) {\n      lineView.measure.cache = {};\n      lineView.measure.heights = null;\n      if (lineView.rest) for (var i = 0; i < lineView.rest.length; i++)\n        lineView.measure.caches[i] = {};\n    }\n  }\n\n  function clearLineMeasurementCache(cm) {\n    cm.display.externalMeasure = null;\n    removeChildren(cm.display.lineMeasure);\n    for (var i = 0; i < cm.display.view.length; i++)\n      clearLineMeasurementCacheFor(cm.display.view[i]);\n  }\n\n  function clearCaches(cm) {\n    clearLineMeasurementCache(cm);\n    cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null;\n    if (!cm.options.lineWrapping) cm.display.maxLineChanged = true;\n    cm.display.lineNumChars = null;\n  }\n\n  function pageScrollX() { return window.pageXOffset || (document.documentElement || document.body).scrollLeft; }\n  function pageScrollY() { return window.pageYOffset || (document.documentElement || document.body).scrollTop; }\n\n  // Converts a {top, bottom, left, right} box from line-local\n  // coordinates into another coordinate system. Context may be one of\n  // \"line\", \"div\" (display.lineDiv), \"local\"/null (editor), or \"page\".\n  function intoCoordSystem(cm, lineObj, rect, context) {\n    if (lineObj.widgets) for (var i = 0; i < lineObj.widgets.length; ++i) if (lineObj.widgets[i].above) {\n      var size = widgetHeight(lineObj.widgets[i]);\n      rect.top += size; rect.bottom += size;\n    }\n    if (context == \"line\") return rect;\n    if (!context) context = \"local\";\n    var yOff = heightAtLine(lineObj);\n    if (context == \"local\") yOff += paddingTop(cm.display);\n    else yOff -= cm.display.viewOffset;\n    if (context == \"page\" || context == \"window\") {\n      var lOff = cm.display.lineSpace.getBoundingClientRect();\n      yOff += lOff.top + (context == \"window\" ? 0 : pageScrollY());\n      var xOff = lOff.left + (context == \"window\" ? 0 : pageScrollX());\n      rect.left += xOff; rect.right += xOff;\n    }\n    rect.top += yOff; rect.bottom += yOff;\n    return rect;\n  }\n\n  // Coverts a box from \"div\" coords to another coordinate system.\n  // Context may be \"window\", \"page\", \"div\", or \"local\"/null.\n  function fromCoordSystem(cm, coords, context) {\n    if (context == \"div\") return coords;\n    var left = coords.left, top = coords.top;\n    // First move into \"page\" coordinate system\n    if (context == \"page\") {\n      left -= pageScrollX();\n      top -= pageScrollY();\n    } else if (context == \"local\" || !context) {\n      var localBox = cm.display.sizer.getBoundingClientRect();\n      left += localBox.left;\n      top += localBox.top;\n    }\n\n    var lineSpaceBox = cm.display.lineSpace.getBoundingClientRect();\n    return {left: left - lineSpaceBox.left, top: top - lineSpaceBox.top};\n  }\n\n  function charCoords(cm, pos, context, lineObj, bias) {\n    if (!lineObj) lineObj = getLine(cm.doc, pos.line);\n    return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, bias), context);\n  }\n\n  // Returns a box for a given cursor position, which may have an\n  // 'other' property containing the position of the secondary cursor\n  // on a bidi boundary.\n  function cursorCoords(cm, pos, context, lineObj, preparedMeasure, varHeight) {\n    lineObj = lineObj || getLine(cm.doc, pos.line);\n    if (!preparedMeasure) preparedMeasure = prepareMeasureForLine(cm, lineObj);\n    function get(ch, right) {\n      var m = measureCharPrepared(cm, preparedMeasure, ch, right ? \"right\" : \"left\", varHeight);\n      if (right) m.left = m.right; else m.right = m.left;\n      return intoCoordSystem(cm, lineObj, m, context);\n    }\n    function getBidi(ch, partPos) {\n      var part = order[partPos], right = part.level % 2;\n      if (ch == bidiLeft(part) && partPos && part.level < order[partPos - 1].level) {\n        part = order[--partPos];\n        ch = bidiRight(part) - (part.level % 2 ? 0 : 1);\n        right = true;\n      } else if (ch == bidiRight(part) && partPos < order.length - 1 && part.level < order[partPos + 1].level) {\n        part = order[++partPos];\n        ch = bidiLeft(part) - part.level % 2;\n        right = false;\n      }\n      if (right && ch == part.to && ch > part.from) return get(ch - 1);\n      return get(ch, right);\n    }\n    var order = getOrder(lineObj), ch = pos.ch;\n    if (!order) return get(ch);\n    var partPos = getBidiPartAt(order, ch);\n    var val = getBidi(ch, partPos);\n    if (bidiOther != null) val.other = getBidi(ch, bidiOther);\n    return val;\n  }\n\n  // Used to cheaply estimate the coordinates for a position. Used for\n  // intermediate scroll updates.\n  function estimateCoords(cm, pos) {\n    var left = 0, pos = clipPos(cm.doc, pos);\n    if (!cm.options.lineWrapping) left = charWidth(cm.display) * pos.ch;\n    var lineObj = getLine(cm.doc, pos.line);\n    var top = heightAtLine(lineObj) + paddingTop(cm.display);\n    return {left: left, right: left, top: top, bottom: top + lineObj.height};\n  }\n\n  // Positions returned by coordsChar contain some extra information.\n  // xRel is the relative x position of the input coordinates compared\n  // to the found position (so xRel > 0 means the coordinates are to\n  // the right of the character position, for example). When outside\n  // is true, that means the coordinates lie outside the line's\n  // vertical range.\n  function PosWithInfo(line, ch, outside, xRel) {\n    var pos = Pos(line, ch);\n    pos.xRel = xRel;\n    if (outside) pos.outside = true;\n    return pos;\n  }\n\n  // Compute the character position closest to the given coordinates.\n  // Input must be lineSpace-local (\"div\" coordinate system).\n  function coordsChar(cm, x, y) {\n    var doc = cm.doc;\n    y += cm.display.viewOffset;\n    if (y < 0) return PosWithInfo(doc.first, 0, true, -1);\n    var lineN = lineAtHeight(doc, y), last = doc.first + doc.size - 1;\n    if (lineN > last)\n      return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, true, 1);\n    if (x < 0) x = 0;\n\n    var lineObj = getLine(doc, lineN);\n    for (;;) {\n      var found = coordsCharInner(cm, lineObj, lineN, x, y);\n      var merged = collapsedSpanAtEnd(lineObj);\n      var mergedPos = merged && merged.find(0, true);\n      if (merged && (found.ch > mergedPos.from.ch || found.ch == mergedPos.from.ch && found.xRel > 0))\n        lineN = lineNo(lineObj = mergedPos.to.line);\n      else\n        return found;\n    }\n  }\n\n  function coordsCharInner(cm, lineObj, lineNo, x, y) {\n    var innerOff = y - heightAtLine(lineObj);\n    var wrongLine = false, adjust = 2 * cm.display.wrapper.clientWidth;\n    var preparedMeasure = prepareMeasureForLine(cm, lineObj);\n\n    function getX(ch) {\n      var sp = cursorCoords(cm, Pos(lineNo, ch), \"line\", lineObj, preparedMeasure);\n      wrongLine = true;\n      if (innerOff > sp.bottom) return sp.left - adjust;\n      else if (innerOff < sp.top) return sp.left + adjust;\n      else wrongLine = false;\n      return sp.left;\n    }\n\n    var bidi = getOrder(lineObj), dist = lineObj.text.length;\n    var from = lineLeft(lineObj), to = lineRight(lineObj);\n    var fromX = getX(from), fromOutside = wrongLine, toX = getX(to), toOutside = wrongLine;\n\n    if (x > toX) return PosWithInfo(lineNo, to, toOutside, 1);\n    // Do a binary search between these bounds.\n    for (;;) {\n      if (bidi ? to == from || to == moveVisually(lineObj, from, 1) : to - from <= 1) {\n        var ch = x < fromX || x - fromX <= toX - x ? from : to;\n        var xDiff = x - (ch == from ? fromX : toX);\n        while (isExtendingChar(lineObj.text.charAt(ch))) ++ch;\n        var pos = PosWithInfo(lineNo, ch, ch == from ? fromOutside : toOutside,\n                              xDiff < -1 ? -1 : xDiff > 1 ? 1 : 0);\n        return pos;\n      }\n      var step = Math.ceil(dist / 2), middle = from + step;\n      if (bidi) {\n        middle = from;\n        for (var i = 0; i < step; ++i) middle = moveVisually(lineObj, middle, 1);\n      }\n      var middleX = getX(middle);\n      if (middleX > x) {to = middle; toX = middleX; if (toOutside = wrongLine) toX += 1000; dist = step;}\n      else {from = middle; fromX = middleX; fromOutside = wrongLine; dist -= step;}\n    }\n  }\n\n  var measureText;\n  // Compute the default text height.\n  function textHeight(display) {\n    if (display.cachedTextHeight != null) return display.cachedTextHeight;\n    if (measureText == null) {\n      measureText = elt(\"pre\");\n      // Measure a bunch of lines, for browsers that compute\n      // fractional heights.\n      for (var i = 0; i < 49; ++i) {\n        measureText.appendChild(document.createTextNode(\"x\"));\n        measureText.appendChild(elt(\"br\"));\n      }\n      measureText.appendChild(document.createTextNode(\"x\"));\n    }\n    removeChildrenAndAdd(display.measure, measureText);\n    var height = measureText.offsetHeight / 50;\n    if (height > 3) display.cachedTextHeight = height;\n    removeChildren(display.measure);\n    return height || 1;\n  }\n\n  // Compute the default character width.\n  function charWidth(display) {\n    if (display.cachedCharWidth != null) return display.cachedCharWidth;\n    var anchor = elt(\"span\", \"xxxxxxxxxx\");\n    var pre = elt(\"pre\", [anchor]);\n    removeChildrenAndAdd(display.measure, pre);\n    var rect = anchor.getBoundingClientRect(), width = (rect.right - rect.left) / 10;\n    if (width > 2) display.cachedCharWidth = width;\n    return width || 10;\n  }\n\n  // OPERATIONS\n\n  // Operations are used to wrap a series of changes to the editor\n  // state in such a way that each change won't have to update the\n  // cursor and display (which would be awkward, slow, and\n  // error-prone). Instead, display updates are batched and then all\n  // combined and executed at once.\n\n  var operationGroup = null;\n\n  var nextOpId = 0;\n  // Start a new operation.\n  function startOperation(cm) {\n    cm.curOp = {\n      cm: cm,\n      viewChanged: false,      // Flag that indicates that lines might need to be redrawn\n      startHeight: cm.doc.height, // Used to detect need to update scrollbar\n      forceUpdate: false,      // Used to force a redraw\n      updateInput: null,       // Whether to reset the input textarea\n      typing: false,           // Whether this reset should be careful to leave existing text (for compositing)\n      changeObjs: null,        // Accumulated changes, for firing change events\n      cursorActivityHandlers: null, // Set of handlers to fire cursorActivity on\n      cursorActivityCalled: 0, // Tracks which cursorActivity handlers have been called already\n      selectionChanged: false, // Whether the selection needs to be redrawn\n      updateMaxLine: false,    // Set when the widest line needs to be determined anew\n      scrollLeft: null, scrollTop: null, // Intermediate scroll position, not pushed to DOM yet\n      scrollToPos: null,       // Used to scroll to a specific position\n      id: ++nextOpId           // Unique ID\n    };\n    if (operationGroup) {\n      operationGroup.ops.push(cm.curOp);\n    } else {\n      cm.curOp.ownsGroup = operationGroup = {\n        ops: [cm.curOp],\n        delayedCallbacks: []\n      };\n    }\n  }\n\n  function fireCallbacksForOps(group) {\n    // Calls delayed callbacks and cursorActivity handlers until no\n    // new ones appear\n    var callbacks = group.delayedCallbacks, i = 0;\n    do {\n      for (; i < callbacks.length; i++)\n        callbacks[i]();\n      for (var j = 0; j < group.ops.length; j++) {\n        var op = group.ops[j];\n        if (op.cursorActivityHandlers)\n          while (op.cursorActivityCalled < op.cursorActivityHandlers.length)\n            op.cursorActivityHandlers[op.cursorActivityCalled++](op.cm);\n      }\n    } while (i < callbacks.length);\n  }\n\n  // Finish an operation, updating the display and signalling delayed events\n  function endOperation(cm) {\n    var op = cm.curOp, group = op.ownsGroup;\n    if (!group) return;\n\n    try { fireCallbacksForOps(group); }\n    finally {\n      operationGroup = null;\n      for (var i = 0; i < group.ops.length; i++)\n        group.ops[i].cm.curOp = null;\n      endOperations(group);\n    }\n  }\n\n  // The DOM updates done when an operation finishes are batched so\n  // that the minimum number of relayouts are required.\n  function endOperations(group) {\n    var ops = group.ops;\n    for (var i = 0; i < ops.length; i++) // Read DOM\n      endOperation_R1(ops[i]);\n    for (var i = 0; i < ops.length; i++) // Write DOM (maybe)\n      endOperation_W1(ops[i]);\n    for (var i = 0; i < ops.length; i++) // Read DOM\n      endOperation_R2(ops[i]);\n    for (var i = 0; i < ops.length; i++) // Write DOM (maybe)\n      endOperation_W2(ops[i]);\n    for (var i = 0; i < ops.length; i++) // Read DOM\n      endOperation_finish(ops[i]);\n  }\n\n  function endOperation_R1(op) {\n    var cm = op.cm, display = cm.display;\n    if (op.updateMaxLine) findMaxLine(cm);\n\n    op.mustUpdate = op.viewChanged || op.forceUpdate || op.scrollTop != null ||\n      op.scrollToPos && (op.scrollToPos.from.line < display.viewFrom ||\n                         op.scrollToPos.to.line >= display.viewTo) ||\n      display.maxLineChanged && cm.options.lineWrapping;\n    op.update = op.mustUpdate &&\n      new DisplayUpdate(cm, op.mustUpdate && {top: op.scrollTop, ensure: op.scrollToPos}, op.forceUpdate);\n  }\n\n  function endOperation_W1(op) {\n    op.updatedDisplay = op.mustUpdate && updateDisplayIfNeeded(op.cm, op.update);\n  }\n\n  function endOperation_R2(op) {\n    var cm = op.cm, display = cm.display;\n    if (op.updatedDisplay) updateHeightsInViewport(cm);\n\n    op.barMeasure = measureForScrollbars(cm);\n\n    // If the max line changed since it was last measured, measure it,\n    // and ensure the document's width matches it.\n    // updateDisplay_W2 will use these properties to do the actual resizing\n    if (display.maxLineChanged && !cm.options.lineWrapping) {\n      op.adjustWidthTo = measureChar(cm, display.maxLine, display.maxLine.text.length).left + 3;\n      op.maxScrollLeft = Math.max(0, display.sizer.offsetLeft + op.adjustWidthTo +\n                                  scrollerCutOff - display.scroller.clientWidth);\n    }\n\n    if (op.updatedDisplay || op.selectionChanged)\n      op.newSelectionNodes = drawSelection(cm);\n  }\n\n  function endOperation_W2(op) {\n    var cm = op.cm;\n\n    if (op.adjustWidthTo != null) {\n      cm.display.sizer.style.minWidth = op.adjustWidthTo + \"px\";\n      if (op.maxScrollLeft < cm.doc.scrollLeft)\n        setScrollLeft(cm, Math.min(cm.display.scroller.scrollLeft, op.maxScrollLeft), true);\n      cm.display.maxLineChanged = false;\n    }\n\n    if (op.newSelectionNodes)\n      showSelection(cm, op.newSelectionNodes);\n    if (op.updatedDisplay)\n      setDocumentHeight(cm, op.barMeasure);\n    if (op.updatedDisplay || op.startHeight != cm.doc.height)\n      updateScrollbars(cm, op.barMeasure);\n\n    if (op.selectionChanged) restartBlink(cm);\n\n    if (cm.state.focused && op.updateInput)\n      resetInput(cm, op.typing);\n  }\n\n  function endOperation_finish(op) {\n    var cm = op.cm, display = cm.display, doc = cm.doc;\n\n    if (op.adjustWidthTo != null && Math.abs(op.barMeasure.scrollWidth - cm.display.scroller.scrollWidth) > 1)\n      updateScrollbars(cm);\n\n    if (op.updatedDisplay) postUpdateDisplay(cm, op.update);\n\n    // Abort mouse wheel delta measurement, when scrolling explicitly\n    if (display.wheelStartX != null && (op.scrollTop != null || op.scrollLeft != null || op.scrollToPos))\n      display.wheelStartX = display.wheelStartY = null;\n\n    // Propagate the scroll position to the actual DOM scroller\n    if (op.scrollTop != null && (display.scroller.scrollTop != op.scrollTop || op.forceScroll)) {\n      var top = Math.max(0, Math.min(display.scroller.scrollHeight - display.scroller.clientHeight, op.scrollTop));\n      display.scroller.scrollTop = display.scrollbarV.scrollTop = doc.scrollTop = top;\n    }\n    if (op.scrollLeft != null && (display.scroller.scrollLeft != op.scrollLeft || op.forceScroll)) {\n      var left = Math.max(0, Math.min(display.scroller.scrollWidth - display.scroller.clientWidth, op.scrollLeft));\n      display.scroller.scrollLeft = display.scrollbarH.scrollLeft = doc.scrollLeft = left;\n      alignHorizontally(cm);\n    }\n    // If we need to scroll a specific position into view, do so.\n    if (op.scrollToPos) {\n      var coords = scrollPosIntoView(cm, clipPos(doc, op.scrollToPos.from),\n                                     clipPos(doc, op.scrollToPos.to), op.scrollToPos.margin);\n      if (op.scrollToPos.isCursor && cm.state.focused) maybeScrollWindow(cm, coords);\n    }\n\n    // Fire events for markers that are hidden/unidden by editing or\n    // undoing\n    var hidden = op.maybeHiddenMarkers, unhidden = op.maybeUnhiddenMarkers;\n    if (hidden) for (var i = 0; i < hidden.length; ++i)\n      if (!hidden[i].lines.length) signal(hidden[i], \"hide\");\n    if (unhidden) for (var i = 0; i < unhidden.length; ++i)\n      if (unhidden[i].lines.length) signal(unhidden[i], \"unhide\");\n\n    if (display.wrapper.offsetHeight)\n      doc.scrollTop = cm.display.scroller.scrollTop;\n\n    // Apply workaround for two webkit bugs\n    if (op.updatedDisplay && webkit) {\n      if (cm.options.lineWrapping)\n        checkForWebkitWidthBug(cm, op.barMeasure); // (Issue #2420)\n      if (op.barMeasure.scrollWidth > op.barMeasure.clientWidth &&\n          op.barMeasure.scrollWidth < op.barMeasure.clientWidth + 1 &&\n          !hScrollbarTakesSpace(cm))\n        updateScrollbars(cm); // (Issue #2562)\n    }\n\n    // Fire change events, and delayed event handlers\n    if (op.changeObjs)\n      signal(cm, \"changes\", cm, op.changeObjs);\n  }\n\n  // Run the given function in an operation\n  function runInOp(cm, f) {\n    if (cm.curOp) return f();\n    startOperation(cm);\n    try { return f(); }\n    finally { endOperation(cm); }\n  }\n  // Wraps a function in an operation. Returns the wrapped function.\n  function operation(cm, f) {\n    return function() {\n      if (cm.curOp) return f.apply(cm, arguments);\n      startOperation(cm);\n      try { return f.apply(cm, arguments); }\n      finally { endOperation(cm); }\n    };\n  }\n  // Used to add methods to editor and doc instances, wrapping them in\n  // operations.\n  function methodOp(f) {\n    return function() {\n      if (this.curOp) return f.apply(this, arguments);\n      startOperation(this);\n      try { return f.apply(this, arguments); }\n      finally { endOperation(this); }\n    };\n  }\n  function docMethodOp(f) {\n    return function() {\n      var cm = this.cm;\n      if (!cm || cm.curOp) return f.apply(this, arguments);\n      startOperation(cm);\n      try { return f.apply(this, arguments); }\n      finally { endOperation(cm); }\n    };\n  }\n\n  // VIEW TRACKING\n\n  // These objects are used to represent the visible (currently drawn)\n  // part of the document. A LineView may correspond to multiple\n  // logical lines, if those are connected by collapsed ranges.\n  function LineView(doc, line, lineN) {\n    // The starting line\n    this.line = line;\n    // Continuing lines, if any\n    this.rest = visualLineContinued(line);\n    // Number of logical lines in this visual line\n    this.size = this.rest ? lineNo(lst(this.rest)) - lineN + 1 : 1;\n    this.node = this.text = null;\n    this.hidden = lineIsHidden(doc, line);\n  }\n\n  // Create a range of LineView objects for the given lines.\n  function buildViewArray(cm, from, to) {\n    var array = [], nextPos;\n    for (var pos = from; pos < to; pos = nextPos) {\n      var view = new LineView(cm.doc, getLine(cm.doc, pos), pos);\n      nextPos = pos + view.size;\n      array.push(view);\n    }\n    return array;\n  }\n\n  // Updates the display.view data structure for a given change to the\n  // document. From and to are in pre-change coordinates. Lendiff is\n  // the amount of lines added or subtracted by the change. This is\n  // used for changes that span multiple lines, or change the way\n  // lines are divided into visual lines. regLineChange (below)\n  // registers single-line changes.\n  function regChange(cm, from, to, lendiff) {\n    if (from == null) from = cm.doc.first;\n    if (to == null) to = cm.doc.first + cm.doc.size;\n    if (!lendiff) lendiff = 0;\n\n    var display = cm.display;\n    if (lendiff && to < display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers > from))\n      display.updateLineNumbers = from;\n\n    cm.curOp.viewChanged = true;\n\n    if (from >= display.viewTo) { // Change after\n      if (sawCollapsedSpans && visualLineNo(cm.doc, from) < display.viewTo)\n        resetView(cm);\n    } else if (to <= display.viewFrom) { // Change before\n      if (sawCollapsedSpans && visualLineEndNo(cm.doc, to + lendiff) > display.viewFrom) {\n        resetView(cm);\n      } else {\n        display.viewFrom += lendiff;\n        display.viewTo += lendiff;\n      }\n    } else if (from <= display.viewFrom && to >= display.viewTo) { // Full overlap\n      resetView(cm);\n    } else if (from <= display.viewFrom) { // Top overlap\n      var cut = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cut) {\n        display.view = display.view.slice(cut.index);\n        display.viewFrom = cut.lineN;\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    } else if (to >= display.viewTo) { // Bottom overlap\n      var cut = viewCuttingPoint(cm, from, from, -1);\n      if (cut) {\n        display.view = display.view.slice(0, cut.index);\n        display.viewTo = cut.lineN;\n      } else {\n        resetView(cm);\n      }\n    } else { // Gap in the middle\n      var cutTop = viewCuttingPoint(cm, from, from, -1);\n      var cutBot = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cutTop && cutBot) {\n        display.view = display.view.slice(0, cutTop.index)\n          .concat(buildViewArray(cm, cutTop.lineN, cutBot.lineN))\n          .concat(display.view.slice(cutBot.index));\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    }\n\n    var ext = display.externalMeasured;\n    if (ext) {\n      if (to < ext.lineN)\n        ext.lineN += lendiff;\n      else if (from < ext.lineN + ext.size)\n        display.externalMeasured = null;\n    }\n  }\n\n  // Register a change to a single line. Type must be one of \"text\",\n  // \"gutter\", \"class\", \"widget\"\n  function regLineChange(cm, line, type) {\n    cm.curOp.viewChanged = true;\n    var display = cm.display, ext = cm.display.externalMeasured;\n    if (ext && line >= ext.lineN && line < ext.lineN + ext.size)\n      display.externalMeasured = null;\n\n    if (line < display.viewFrom || line >= display.viewTo) return;\n    var lineView = display.view[findViewIndex(cm, line)];\n    if (lineView.node == null) return;\n    var arr = lineView.changes || (lineView.changes = []);\n    if (indexOf(arr, type) == -1) arr.push(type);\n  }\n\n  // Clear the view.\n  function resetView(cm) {\n    cm.display.viewFrom = cm.display.viewTo = cm.doc.first;\n    cm.display.view = [];\n    cm.display.viewOffset = 0;\n  }\n\n  // Find the view element corresponding to a given line. Return null\n  // when the line isn't visible.\n  function findViewIndex(cm, n) {\n    if (n >= cm.display.viewTo) return null;\n    n -= cm.display.viewFrom;\n    if (n < 0) return null;\n    var view = cm.display.view;\n    for (var i = 0; i < view.length; i++) {\n      n -= view[i].size;\n      if (n < 0) return i;\n    }\n  }\n\n  function viewCuttingPoint(cm, oldN, newN, dir) {\n    var index = findViewIndex(cm, oldN), diff, view = cm.display.view;\n    if (!sawCollapsedSpans || newN == cm.doc.first + cm.doc.size)\n      return {index: index, lineN: newN};\n    for (var i = 0, n = cm.display.viewFrom; i < index; i++)\n      n += view[i].size;\n    if (n != oldN) {\n      if (dir > 0) {\n        if (index == view.length - 1) return null;\n        diff = (n + view[index].size) - oldN;\n        index++;\n      } else {\n        diff = n - oldN;\n      }\n      oldN += diff; newN += diff;\n    }\n    while (visualLineNo(cm.doc, newN) != newN) {\n      if (index == (dir < 0 ? 0 : view.length - 1)) return null;\n      newN += dir * view[index - (dir < 0 ? 1 : 0)].size;\n      index += dir;\n    }\n    return {index: index, lineN: newN};\n  }\n\n  // Force the view to cover a given range, adding empty view element\n  // or clipping off existing ones as needed.\n  function adjustView(cm, from, to) {\n    var display = cm.display, view = display.view;\n    if (view.length == 0 || from >= display.viewTo || to <= display.viewFrom) {\n      display.view = buildViewArray(cm, from, to);\n      display.viewFrom = from;\n    } else {\n      if (display.viewFrom > from)\n        display.view = buildViewArray(cm, from, display.viewFrom).concat(display.view);\n      else if (display.viewFrom < from)\n        display.view = display.view.slice(findViewIndex(cm, from));\n      display.viewFrom = from;\n      if (display.viewTo < to)\n        display.view = display.view.concat(buildViewArray(cm, display.viewTo, to));\n      else if (display.viewTo > to)\n        display.view = display.view.slice(0, findViewIndex(cm, to));\n    }\n    display.viewTo = to;\n  }\n\n  // Count the number of lines in the view whose DOM representation is\n  // out of date (or nonexistent).\n  function countDirtyView(cm) {\n    var view = cm.display.view, dirty = 0;\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (!lineView.hidden && (!lineView.node || lineView.changes)) ++dirty;\n    }\n    return dirty;\n  }\n\n  // INPUT HANDLING\n\n  // Poll for input changes, using the normal rate of polling. This\n  // runs as long as the editor is focused.\n  function slowPoll(cm) {\n    if (cm.display.pollingFast) return;\n    cm.display.poll.set(cm.options.pollInterval, function() {\n      readInput(cm);\n      if (cm.state.focused) slowPoll(cm);\n    });\n  }\n\n  // When an event has just come in that is likely to add or change\n  // something in the input textarea, we poll faster, to ensure that\n  // the change appears on the screen quickly.\n  function fastPoll(cm) {\n    var missed = false;\n    cm.display.pollingFast = true;\n    function p() {\n      var changed = readInput(cm);\n      if (!changed && !missed) {missed = true; cm.display.poll.set(60, p);}\n      else {cm.display.pollingFast = false; slowPoll(cm);}\n    }\n    cm.display.poll.set(20, p);\n  }\n\n  // This will be set to an array of strings when copying, so that,\n  // when pasting, we know what kind of selections the copied text\n  // was made out of.\n  var lastCopied = null;\n\n  // Read input from the textarea, and update the document to match.\n  // When something is selected, it is present in the textarea, and\n  // selected (unless it is huge, in which case a placeholder is\n  // used). When nothing is selected, the cursor sits after previously\n  // seen text (can be empty), which is stored in prevInput (we must\n  // not reset the textarea when typing, because that breaks IME).\n  function readInput(cm) {\n    var input = cm.display.input, prevInput = cm.display.prevInput, doc = cm.doc;\n    // Since this is called a *lot*, try to bail out as cheaply as\n    // possible when it is clear that nothing happened. hasSelection\n    // will be the case when there is a lot of text in the textarea,\n    // in which case reading its value would be expensive.\n    if (!cm.state.focused || (hasSelection(input) && !prevInput) || isReadOnly(cm) || cm.options.disableInput)\n      return false;\n    // See paste handler for more on the fakedLastChar kludge\n    if (cm.state.pasteIncoming && cm.state.fakedLastChar) {\n      input.value = input.value.substring(0, input.value.length - 1);\n      cm.state.fakedLastChar = false;\n    }\n    var text = input.value;\n    // If nothing changed, bail.\n    if (text == prevInput && !cm.somethingSelected()) return false;\n    // Work around nonsensical selection resetting in IE9/10, and\n    // inexplicable appearance of private area unicode characters on\n    // some key combos in Mac (#2689).\n    if (ie && ie_version >= 9 && cm.display.inputHasSelection === text ||\n        mac && /[\\uf700-\\uf7ff]/.test(text)) {\n      resetInput(cm);\n      return false;\n    }\n\n    var withOp = !cm.curOp;\n    if (withOp) startOperation(cm);\n    cm.display.shift = false;\n\n    if (text.charCodeAt(0) == 0x200b && doc.sel == cm.display.selForContextMenu && !prevInput)\n      prevInput = \"\\u200b\";\n    // Find the part of the input that is actually new\n    var same = 0, l = Math.min(prevInput.length, text.length);\n    while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) ++same;\n    var inserted = text.slice(same), textLines = splitLines(inserted);\n\n    // When pasing N lines into N selections, insert one line per selection\n    var multiPaste = null;\n    if (cm.state.pasteIncoming && doc.sel.ranges.length > 1) {\n      if (lastCopied && lastCopied.join(\"\\n\") == inserted)\n        multiPaste = doc.sel.ranges.length % lastCopied.length == 0 && map(lastCopied, splitLines);\n      else if (textLines.length == doc.sel.ranges.length)\n        multiPaste = map(textLines, function(l) { return [l]; });\n    }\n\n    // Normal behavior is to insert the new text into every selection\n    for (var i = doc.sel.ranges.length - 1; i >= 0; i--) {\n      var range = doc.sel.ranges[i];\n      var from = range.from(), to = range.to();\n      // Handle deletion\n      if (same < prevInput.length)\n        from = Pos(from.line, from.ch - (prevInput.length - same));\n      // Handle overwrite\n      else if (cm.state.overwrite && range.empty() && !cm.state.pasteIncoming)\n        to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + lst(textLines).length));\n      var updateInput = cm.curOp.updateInput;\n      var changeEvent = {from: from, to: to, text: multiPaste ? multiPaste[i % multiPaste.length] : textLines,\n                         origin: cm.state.pasteIncoming ? \"paste\" : cm.state.cutIncoming ? \"cut\" : \"+input\"};\n      makeChange(cm.doc, changeEvent);\n      signalLater(cm, \"inputRead\", cm, changeEvent);\n      // When an 'electric' character is inserted, immediately trigger a reindent\n      if (inserted && !cm.state.pasteIncoming && cm.options.electricChars &&\n          cm.options.smartIndent && range.head.ch < 100 &&\n          (!i || doc.sel.ranges[i - 1].head.line != range.head.line)) {\n        var mode = cm.getModeAt(range.head);\n        var end = changeEnd(changeEvent);\n        if (mode.electricChars) {\n          for (var j = 0; j < mode.electricChars.length; j++)\n            if (inserted.indexOf(mode.electricChars.charAt(j)) > -1) {\n              indentLine(cm, end.line, \"smart\");\n              break;\n            }\n        } else if (mode.electricInput) {\n          if (mode.electricInput.test(getLine(doc, end.line).text.slice(0, end.ch)))\n            indentLine(cm, end.line, \"smart\");\n        }\n      }\n    }\n    ensureCursorVisible(cm);\n    cm.curOp.updateInput = updateInput;\n    cm.curOp.typing = true;\n\n    // Don't leave long text in the textarea, since it makes further polling slow\n    if (text.length > 1000 || text.indexOf(\"\\n\") > -1) input.value = cm.display.prevInput = \"\";\n    else cm.display.prevInput = text;\n    if (withOp) endOperation(cm);\n    cm.state.pasteIncoming = cm.state.cutIncoming = false;\n    return true;\n  }\n\n  // Reset the input to correspond to the selection (or to be empty,\n  // when not typing and nothing is selected)\n  function resetInput(cm, typing) {\n    var minimal, selected, doc = cm.doc;\n    if (cm.somethingSelected()) {\n      cm.display.prevInput = \"\";\n      var range = doc.sel.primary();\n      minimal = hasCopyEvent &&\n        (range.to().line - range.from().line > 100 || (selected = cm.getSelection()).length > 1000);\n      var content = minimal ? \"-\" : selected || cm.getSelection();\n      cm.display.input.value = content;\n      if (cm.state.focused) selectInput(cm.display.input);\n      if (ie && ie_version >= 9) cm.display.inputHasSelection = content;\n    } else if (!typing) {\n      cm.display.prevInput = cm.display.input.value = \"\";\n      if (ie && ie_version >= 9) cm.display.inputHasSelection = null;\n    }\n    cm.display.inaccurateSelection = minimal;\n  }\n\n  function focusInput(cm) {\n    if (cm.options.readOnly != \"nocursor\" && (!mobile || activeElt() != cm.display.input))\n      cm.display.input.focus();\n  }\n\n  function ensureFocus(cm) {\n    if (!cm.state.focused) { focusInput(cm); onFocus(cm); }\n  }\n\n  function isReadOnly(cm) {\n    return cm.options.readOnly || cm.doc.cantEdit;\n  }\n\n  // EVENT HANDLERS\n\n  // Attach the necessary event handlers when initializing the editor\n  function registerEventHandlers(cm) {\n    var d = cm.display;\n    on(d.scroller, \"mousedown\", operation(cm, onMouseDown));\n    // Older IE's will not fire a second mousedown for a double click\n    if (ie && ie_version < 11)\n      on(d.scroller, \"dblclick\", operation(cm, function(e) {\n        if (signalDOMEvent(cm, e)) return;\n        var pos = posFromMouse(cm, e);\n        if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) return;\n        e_preventDefault(e);\n        var word = cm.findWordAt(pos);\n        extendSelection(cm.doc, word.anchor, word.head);\n      }));\n    else\n      on(d.scroller, \"dblclick\", function(e) { signalDOMEvent(cm, e) || e_preventDefault(e); });\n    // Prevent normal selection in the editor (we handle our own)\n    on(d.lineSpace, \"selectstart\", function(e) {\n      if (!eventInWidget(d, e)) e_preventDefault(e);\n    });\n    // Some browsers fire contextmenu *after* opening the menu, at\n    // which point we can't mess with it anymore. Context menu is\n    // handled in onMouseDown for these browsers.\n    if (!captureRightClick) on(d.scroller, \"contextmenu\", function(e) {onContextMenu(cm, e);});\n\n    // Sync scrolling between fake scrollbars and real scrollable\n    // area, ensure viewport is updated when scrolling.\n    on(d.scroller, \"scroll\", function() {\n      if (d.scroller.clientHeight) {\n        setScrollTop(cm, d.scroller.scrollTop);\n        setScrollLeft(cm, d.scroller.scrollLeft, true);\n        signal(cm, \"scroll\", cm);\n      }\n    });\n    on(d.scrollbarV, \"scroll\", function() {\n      if (d.scroller.clientHeight) setScrollTop(cm, d.scrollbarV.scrollTop);\n    });\n    on(d.scrollbarH, \"scroll\", function() {\n      if (d.scroller.clientHeight) setScrollLeft(cm, d.scrollbarH.scrollLeft);\n    });\n\n    // Listen to wheel events in order to try and update the viewport on time.\n    on(d.scroller, \"mousewheel\", function(e){onScrollWheel(cm, e);});\n    on(d.scroller, \"DOMMouseScroll\", function(e){onScrollWheel(cm, e);});\n\n    // Prevent clicks in the scrollbars from killing focus\n    function reFocus() { if (cm.state.focused) setTimeout(bind(focusInput, cm), 0); }\n    on(d.scrollbarH, \"mousedown\", reFocus);\n    on(d.scrollbarV, \"mousedown\", reFocus);\n    // Prevent wrapper from ever scrolling\n    on(d.wrapper, \"scroll\", function() { d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; });\n\n    on(d.input, \"keyup\", function(e) { onKeyUp.call(cm, e); });\n    on(d.input, \"input\", function() {\n      if (ie && ie_version >= 9 && cm.display.inputHasSelection) cm.display.inputHasSelection = null;\n      fastPoll(cm);\n    });\n    on(d.input, \"keydown\", operation(cm, onKeyDown));\n    on(d.input, \"keypress\", operation(cm, onKeyPress));\n    on(d.input, \"focus\", bind(onFocus, cm));\n    on(d.input, \"blur\", bind(onBlur, cm));\n\n    function drag_(e) {\n      if (!signalDOMEvent(cm, e)) e_stop(e);\n    }\n    if (cm.options.dragDrop) {\n      on(d.scroller, \"dragstart\", function(e){onDragStart(cm, e);});\n      on(d.scroller, \"dragenter\", drag_);\n      on(d.scroller, \"dragover\", drag_);\n      on(d.scroller, \"drop\", operation(cm, onDrop));\n    }\n    on(d.scroller, \"paste\", function(e) {\n      if (eventInWidget(d, e)) return;\n      cm.state.pasteIncoming = true;\n      focusInput(cm);\n      fastPoll(cm);\n    });\n    on(d.input, \"paste\", function() {\n      // Workaround for webkit bug https://bugs.webkit.org/show_bug.cgi?id=90206\n      // Add a char to the end of textarea before paste occur so that\n      // selection doesn't span to the end of textarea.\n      if (webkit && !cm.state.fakedLastChar && !(new Date - cm.state.lastMiddleDown < 200)) {\n        var start = d.input.selectionStart, end = d.input.selectionEnd;\n        d.input.value += \"$\";\n        // The selection end needs to be set before the start, otherwise there\n        // can be an intermediate non-empty selection between the two, which\n        // can override the middle-click paste buffer on linux and cause the\n        // wrong thing to get pasted.\n        d.input.selectionEnd = end;\n        d.input.selectionStart = start;\n        cm.state.fakedLastChar = true;\n      }\n      cm.state.pasteIncoming = true;\n      fastPoll(cm);\n    });\n\n    function prepareCopyCut(e) {\n      if (cm.somethingSelected()) {\n        lastCopied = cm.getSelections();\n        if (d.inaccurateSelection) {\n          d.prevInput = \"\";\n          d.inaccurateSelection = false;\n          d.input.value = lastCopied.join(\"\\n\");\n          selectInput(d.input);\n        }\n      } else {\n        var text = [], ranges = [];\n        for (var i = 0; i < cm.doc.sel.ranges.length; i++) {\n          var line = cm.doc.sel.ranges[i].head.line;\n          var lineRange = {anchor: Pos(line, 0), head: Pos(line + 1, 0)};\n          ranges.push(lineRange);\n          text.push(cm.getRange(lineRange.anchor, lineRange.head));\n        }\n        if (e.type == \"cut\") {\n          cm.setSelections(ranges, null, sel_dontScroll);\n        } else {\n          d.prevInput = \"\";\n          d.input.value = text.join(\"\\n\");\n          selectInput(d.input);\n        }\n        lastCopied = text;\n      }\n      if (e.type == \"cut\") cm.state.cutIncoming = true;\n    }\n    on(d.input, \"cut\", prepareCopyCut);\n    on(d.input, \"copy\", prepareCopyCut);\n\n    // Needed to handle Tab key in KHTML\n    if (khtml) on(d.sizer, \"mouseup\", function() {\n      if (activeElt() == d.input) d.input.blur();\n      focusInput(cm);\n    });\n  }\n\n  // Called when the window resizes\n  function onResize(cm) {\n    // Might be a text scaling operation, clear size caches.\n    var d = cm.display;\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n    cm.setSize();\n  }\n\n  // MOUSE EVENTS\n\n  // Return true when the given mouse event happened in a widget\n  function eventInWidget(display, e) {\n    for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\n      if (!n || n.ignoreEvents || n.parentNode == display.sizer && n != display.mover) return true;\n    }\n  }\n\n  // Given a mouse event, find the corresponding position. If liberal\n  // is false, it checks whether a gutter or scrollbar was clicked,\n  // and returns null if it was. forRect is used by rectangular\n  // selections, and tries to estimate a character position even for\n  // coordinates beyond the right of the text.\n  function posFromMouse(cm, e, liberal, forRect) {\n    var display = cm.display;\n    if (!liberal) {\n      var target = e_target(e);\n      if (target == display.scrollbarH || target == display.scrollbarV ||\n          target == display.scrollbarFiller || target == display.gutterFiller) return null;\n    }\n    var x, y, space = display.lineSpace.getBoundingClientRect();\n    // Fails unpredictably on IE[67] when mouse is dragged around quickly.\n    try { x = e.clientX - space.left; y = e.clientY - space.top; }\n    catch (e) { return null; }\n    var coords = coordsChar(cm, x, y), line;\n    if (forRect && coords.xRel == 1 && (line = getLine(cm.doc, coords.line).text).length == coords.ch) {\n      var colDiff = countColumn(line, line.length, cm.options.tabSize) - line.length;\n      coords = Pos(coords.line, Math.max(0, Math.round((x - paddingH(cm.display).left) / charWidth(cm.display)) - colDiff));\n    }\n    return coords;\n  }\n\n  // A mouse down can be a single click, double click, triple click,\n  // start of selection drag, start of text drag, new cursor\n  // (ctrl-click), rectangle drag (alt-drag), or xwin\n  // middle-click-paste. Or it might be a click on something we should\n  // not interfere with, such as a scrollbar or widget.\n  function onMouseDown(e) {\n    if (signalDOMEvent(this, e)) return;\n    var cm = this, display = cm.display;\n    display.shift = e.shiftKey;\n\n    if (eventInWidget(display, e)) {\n      if (!webkit) {\n        // Briefly turn off draggability, to allow widgets to do\n        // normal dragging things.\n        display.scroller.draggable = false;\n        setTimeout(function(){display.scroller.draggable = true;}, 100);\n      }\n      return;\n    }\n    if (clickInGutter(cm, e)) return;\n    var start = posFromMouse(cm, e);\n    window.focus();\n\n    switch (e_button(e)) {\n    case 1:\n      if (start)\n        leftButtonDown(cm, e, start);\n      else if (e_target(e) == display.scroller)\n        e_preventDefault(e);\n      break;\n    case 2:\n      if (webkit) cm.state.lastMiddleDown = +new Date;\n      if (start) extendSelection(cm.doc, start);\n      setTimeout(bind(focusInput, cm), 20);\n      e_preventDefault(e);\n      break;\n    case 3:\n      if (captureRightClick) onContextMenu(cm, e);\n      break;\n    }\n  }\n\n  var lastClick, lastDoubleClick;\n  function leftButtonDown(cm, e, start) {\n    setTimeout(bind(ensureFocus, cm), 0);\n\n    var now = +new Date, type;\n    if (lastDoubleClick && lastDoubleClick.time > now - 400 && cmp(lastDoubleClick.pos, start) == 0) {\n      type = \"triple\";\n    } else if (lastClick && lastClick.time > now - 400 && cmp(lastClick.pos, start) == 0) {\n      type = \"double\";\n      lastDoubleClick = {time: now, pos: start};\n    } else {\n      type = \"single\";\n      lastClick = {time: now, pos: start};\n    }\n\n    var sel = cm.doc.sel, modifier = mac ? e.metaKey : e.ctrlKey;\n    if (cm.options.dragDrop && dragAndDrop && !isReadOnly(cm) &&\n        type == \"single\" && sel.contains(start) > -1 && sel.somethingSelected())\n      leftButtonStartDrag(cm, e, start, modifier);\n    else\n      leftButtonSelect(cm, e, start, type, modifier);\n  }\n\n  // Start a text drag. When it ends, see if any dragging actually\n  // happen, and treat as a click if it didn't.\n  function leftButtonStartDrag(cm, e, start, modifier) {\n    var display = cm.display;\n    var dragEnd = operation(cm, function(e2) {\n      if (webkit) display.scroller.draggable = false;\n      cm.state.draggingText = false;\n      off(document, \"mouseup\", dragEnd);\n      off(display.scroller, \"drop\", dragEnd);\n      if (Math.abs(e.clientX - e2.clientX) + Math.abs(e.clientY - e2.clientY) < 10) {\n        e_preventDefault(e2);\n        if (!modifier)\n          extendSelection(cm.doc, start);\n        focusInput(cm);\n        // Work around unexplainable focus problem in IE9 (#2127)\n        if (ie && ie_version == 9)\n          setTimeout(function() {document.body.focus(); focusInput(cm);}, 20);\n      }\n    });\n    // Let the drag handler handle this.\n    if (webkit) display.scroller.draggable = true;\n    cm.state.draggingText = dragEnd;\n    // IE's approach to draggable\n    if (display.scroller.dragDrop) display.scroller.dragDrop();\n    on(document, \"mouseup\", dragEnd);\n    on(display.scroller, \"drop\", dragEnd);\n  }\n\n  // Normal selection, as opposed to text dragging.\n  function leftButtonSelect(cm, e, start, type, addNew) {\n    var display = cm.display, doc = cm.doc;\n    e_preventDefault(e);\n\n    var ourRange, ourIndex, startSel = doc.sel;\n    if (addNew && !e.shiftKey) {\n      ourIndex = doc.sel.contains(start);\n      if (ourIndex > -1)\n        ourRange = doc.sel.ranges[ourIndex];\n      else\n        ourRange = new Range(start, start);\n    } else {\n      ourRange = doc.sel.primary();\n    }\n\n    if (e.altKey) {\n      type = \"rect\";\n      if (!addNew) ourRange = new Range(start, start);\n      start = posFromMouse(cm, e, true, true);\n      ourIndex = -1;\n    } else if (type == \"double\") {\n      var word = cm.findWordAt(start);\n      if (cm.display.shift || doc.extend)\n        ourRange = extendRange(doc, ourRange, word.anchor, word.head);\n      else\n        ourRange = word;\n    } else if (type == \"triple\") {\n      var line = new Range(Pos(start.line, 0), clipPos(doc, Pos(start.line + 1, 0)));\n      if (cm.display.shift || doc.extend)\n        ourRange = extendRange(doc, ourRange, line.anchor, line.head);\n      else\n        ourRange = line;\n    } else {\n      ourRange = extendRange(doc, ourRange, start);\n    }\n\n    if (!addNew) {\n      ourIndex = 0;\n      setSelection(doc, new Selection([ourRange], 0), sel_mouse);\n      startSel = doc.sel;\n    } else if (ourIndex > -1) {\n      replaceOneSelection(doc, ourIndex, ourRange, sel_mouse);\n    } else {\n      ourIndex = doc.sel.ranges.length;\n      setSelection(doc, normalizeSelection(doc.sel.ranges.concat([ourRange]), ourIndex),\n                   {scroll: false, origin: \"*mouse\"});\n    }\n\n    var lastPos = start;\n    function extendTo(pos) {\n      if (cmp(lastPos, pos) == 0) return;\n      lastPos = pos;\n\n      if (type == \"rect\") {\n        var ranges = [], tabSize = cm.options.tabSize;\n        var startCol = countColumn(getLine(doc, start.line).text, start.ch, tabSize);\n        var posCol = countColumn(getLine(doc, pos.line).text, pos.ch, tabSize);\n        var left = Math.min(startCol, posCol), right = Math.max(startCol, posCol);\n        for (var line = Math.min(start.line, pos.line), end = Math.min(cm.lastLine(), Math.max(start.line, pos.line));\n             line <= end; line++) {\n          var text = getLine(doc, line).text, leftPos = findColumn(text, left, tabSize);\n          if (left == right)\n            ranges.push(new Range(Pos(line, leftPos), Pos(line, leftPos)));\n          else if (text.length > leftPos)\n            ranges.push(new Range(Pos(line, leftPos), Pos(line, findColumn(text, right, tabSize))));\n        }\n        if (!ranges.length) ranges.push(new Range(start, start));\n        setSelection(doc, normalizeSelection(startSel.ranges.slice(0, ourIndex).concat(ranges), ourIndex),\n                     {origin: \"*mouse\", scroll: false});\n        cm.scrollIntoView(pos);\n      } else {\n        var oldRange = ourRange;\n        var anchor = oldRange.anchor, head = pos;\n        if (type != \"single\") {\n          if (type == \"double\")\n            var range = cm.findWordAt(pos);\n          else\n            var range = new Range(Pos(pos.line, 0), clipPos(doc, Pos(pos.line + 1, 0)));\n          if (cmp(range.anchor, anchor) > 0) {\n            head = range.head;\n            anchor = minPos(oldRange.from(), range.anchor);\n          } else {\n            head = range.anchor;\n            anchor = maxPos(oldRange.to(), range.head);\n          }\n        }\n        var ranges = startSel.ranges.slice(0);\n        ranges[ourIndex] = new Range(clipPos(doc, anchor), head);\n        setSelection(doc, normalizeSelection(ranges, ourIndex), sel_mouse);\n      }\n    }\n\n    var editorSize = display.wrapper.getBoundingClientRect();\n    // Used to ensure timeout re-tries don't fire when another extend\n    // happened in the meantime (clearTimeout isn't reliable -- at\n    // least on Chrome, the timeouts still happen even when cleared,\n    // if the clear happens after their scheduled firing time).\n    var counter = 0;\n\n    function extend(e) {\n      var curCount = ++counter;\n      var cur = posFromMouse(cm, e, true, type == \"rect\");\n      if (!cur) return;\n      if (cmp(cur, lastPos) != 0) {\n        ensureFocus(cm);\n        extendTo(cur);\n        var visible = visibleLines(display, doc);\n        if (cur.line >= visible.to || cur.line < visible.from)\n          setTimeout(operation(cm, function(){if (counter == curCount) extend(e);}), 150);\n      } else {\n        var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;\n        if (outside) setTimeout(operation(cm, function() {\n          if (counter != curCount) return;\n          display.scroller.scrollTop += outside;\n          extend(e);\n        }), 50);\n      }\n    }\n\n    function done(e) {\n      counter = Infinity;\n      e_preventDefault(e);\n      focusInput(cm);\n      off(document, \"mousemove\", move);\n      off(document, \"mouseup\", up);\n      doc.history.lastSelOrigin = null;\n    }\n\n    var move = operation(cm, function(e) {\n      if (!e_button(e)) done(e);\n      else extend(e);\n    });\n    var up = operation(cm, done);\n    on(document, \"mousemove\", move);\n    on(document, \"mouseup\", up);\n  }\n\n  // Determines whether an event happened in the gutter, and fires the\n  // handlers for the corresponding event.\n  function gutterEvent(cm, e, type, prevent, signalfn) {\n    try { var mX = e.clientX, mY = e.clientY; }\n    catch(e) { return false; }\n    if (mX >= Math.floor(cm.display.gutters.getBoundingClientRect().right)) return false;\n    if (prevent) e_preventDefault(e);\n\n    var display = cm.display;\n    var lineBox = display.lineDiv.getBoundingClientRect();\n\n    if (mY > lineBox.bottom || !hasHandler(cm, type)) return e_defaultPrevented(e);\n    mY -= lineBox.top - display.viewOffset;\n\n    for (var i = 0; i < cm.options.gutters.length; ++i) {\n      var g = display.gutters.childNodes[i];\n      if (g && g.getBoundingClientRect().right >= mX) {\n        var line = lineAtHeight(cm.doc, mY);\n        var gutter = cm.options.gutters[i];\n        signalfn(cm, type, cm, line, gutter, e);\n        return e_defaultPrevented(e);\n      }\n    }\n  }\n\n  function clickInGutter(cm, e) {\n    return gutterEvent(cm, e, \"gutterClick\", true, signalLater);\n  }\n\n  // Kludge to work around strange IE behavior where it'll sometimes\n  // re-fire a series of drag-related events right after the drop (#1551)\n  var lastDrop = 0;\n\n  function onDrop(e) {\n    var cm = this;\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e))\n      return;\n    e_preventDefault(e);\n    if (ie) lastDrop = +new Date;\n    var pos = posFromMouse(cm, e, true), files = e.dataTransfer.files;\n    if (!pos || isReadOnly(cm)) return;\n    // Might be a file drop, in which case we simply extract the text\n    // and insert it.\n    if (files && files.length && window.FileReader && window.File) {\n      var n = files.length, text = Array(n), read = 0;\n      var loadFile = function(file, i) {\n        var reader = new FileReader;\n        reader.onload = operation(cm, function() {\n          text[i] = reader.result;\n          if (++read == n) {\n            pos = clipPos(cm.doc, pos);\n            var change = {from: pos, to: pos, text: splitLines(text.join(\"\\n\")), origin: \"paste\"};\n            makeChange(cm.doc, change);\n            setSelectionReplaceHistory(cm.doc, simpleSelection(pos, changeEnd(change)));\n          }\n        });\n        reader.readAsText(file);\n      };\n      for (var i = 0; i < n; ++i) loadFile(files[i], i);\n    } else { // Normal drop\n      // Don't do a replace if the drop happened inside of the selected text.\n      if (cm.state.draggingText && cm.doc.sel.contains(pos) > -1) {\n        cm.state.draggingText(e);\n        // Ensure the editor is re-focused\n        setTimeout(bind(focusInput, cm), 20);\n        return;\n      }\n      try {\n        var text = e.dataTransfer.getData(\"Text\");\n        if (text) {\n          if (cm.state.draggingText && !(mac ? e.metaKey : e.ctrlKey))\n            var selected = cm.listSelections();\n          setSelectionNoUndo(cm.doc, simpleSelection(pos, pos));\n          if (selected) for (var i = 0; i < selected.length; ++i)\n            replaceRange(cm.doc, \"\", selected[i].anchor, selected[i].head, \"drag\");\n          cm.replaceSelection(text, \"around\", \"paste\");\n          focusInput(cm);\n        }\n      }\n      catch(e){}\n    }\n  }\n\n  function onDragStart(cm, e) {\n    if (ie && (!cm.state.draggingText || +new Date - lastDrop < 100)) { e_stop(e); return; }\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) return;\n\n    e.dataTransfer.setData(\"Text\", cm.getSelection());\n\n    // Use dummy image instead of default browsers image.\n    // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don't do it there.\n    if (e.dataTransfer.setDragImage && !safari) {\n      var img = elt(\"img\", null, null, \"position: fixed; left: 0; top: 0;\");\n      img.src = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n      if (presto) {\n        img.width = img.height = 1;\n        cm.display.wrapper.appendChild(img);\n        // Force a relayout, or Opera won't use our image for some obscure reason\n        img._top = img.offsetTop;\n      }\n      e.dataTransfer.setDragImage(img, 0, 0);\n      if (presto) img.parentNode.removeChild(img);\n    }\n  }\n\n  // SCROLL EVENTS\n\n  // Sync the scrollable area and scrollbars, ensure the viewport\n  // covers the visible area.\n  function setScrollTop(cm, val) {\n    if (Math.abs(cm.doc.scrollTop - val) < 2) return;\n    cm.doc.scrollTop = val;\n    if (!gecko) updateDisplaySimple(cm, {top: val});\n    if (cm.display.scroller.scrollTop != val) cm.display.scroller.scrollTop = val;\n    if (cm.display.scrollbarV.scrollTop != val) cm.display.scrollbarV.scrollTop = val;\n    if (gecko) updateDisplaySimple(cm);\n    startWorker(cm, 100);\n  }\n  // Sync scroller and scrollbar, ensure the gutter elements are\n  // aligned.\n  function setScrollLeft(cm, val, isScroller) {\n    if (isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) return;\n    val = Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth);\n    cm.doc.scrollLeft = val;\n    alignHorizontally(cm);\n    if (cm.display.scroller.scrollLeft != val) cm.display.scroller.scrollLeft = val;\n    if (cm.display.scrollbarH.scrollLeft != val) cm.display.scrollbarH.scrollLeft = val;\n  }\n\n  // Since the delta values reported on mouse wheel events are\n  // unstandardized between browsers and even browser versions, and\n  // generally horribly unpredictable, this code starts by measuring\n  // the scroll effect that the first few mouse wheel events have,\n  // and, from that, detects the way it can convert deltas to pixel\n  // offsets afterwards.\n  //\n  // The reason we want to know the amount a wheel event will scroll\n  // is that it gives us a chance to update the display before the\n  // actual scrolling happens, reducing flickering.\n\n  var wheelSamples = 0, wheelPixelsPerUnit = null;\n  // Fill in a browser-detected starting value on browsers where we\n  // know one. These don't have to be accurate -- the result of them\n  // being wrong would just be a slight flicker on the first wheel\n  // scroll (if it is large enough).\n  if (ie) wheelPixelsPerUnit = -.53;\n  else if (gecko) wheelPixelsPerUnit = 15;\n  else if (chrome) wheelPixelsPerUnit = -.7;\n  else if (safari) wheelPixelsPerUnit = -1/3;\n\n  function onScrollWheel(cm, e) {\n    var dx = e.wheelDeltaX, dy = e.wheelDeltaY;\n    if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) dx = e.detail;\n    if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) dy = e.detail;\n    else if (dy == null) dy = e.wheelDelta;\n\n    var display = cm.display, scroll = display.scroller;\n    // Quit if there's nothing to scroll here\n    if (!(dx && scroll.scrollWidth > scroll.clientWidth ||\n          dy && scroll.scrollHeight > scroll.clientHeight)) return;\n\n    // Webkit browsers on OS X abort momentum scrolls when the target\n    // of the scroll event is removed from the scrollable element.\n    // This hack (see related code in patchDisplay) makes sure the\n    // element is kept around.\n    if (dy && mac && webkit) {\n      outer: for (var cur = e.target, view = display.view; cur != scroll; cur = cur.parentNode) {\n        for (var i = 0; i < view.length; i++) {\n          if (view[i].node == cur) {\n            cm.display.currentWheelTarget = cur;\n            break outer;\n          }\n        }\n      }\n    }\n\n    // On some browsers, horizontal scrolling will cause redraws to\n    // happen before the gutter has been realigned, causing it to\n    // wriggle around in a most unseemly way. When we have an\n    // estimated pixels/delta value, we just handle horizontal\n    // scrolling entirely here. It'll be slightly off from native, but\n    // better than glitching out.\n    if (dx && !gecko && !presto && wheelPixelsPerUnit != null) {\n      if (dy)\n        setScrollTop(cm, Math.max(0, Math.min(scroll.scrollTop + dy * wheelPixelsPerUnit, scroll.scrollHeight - scroll.clientHeight)));\n      setScrollLeft(cm, Math.max(0, Math.min(scroll.scrollLeft + dx * wheelPixelsPerUnit, scroll.scrollWidth - scroll.clientWidth)));\n      e_preventDefault(e);\n      display.wheelStartX = null; // Abort measurement, if in progress\n      return;\n    }\n\n    // 'Project' the visible viewport to cover the area that is being\n    // scrolled into view (if we know enough to estimate it).\n    if (dy && wheelPixelsPerUnit != null) {\n      var pixels = dy * wheelPixelsPerUnit;\n      var top = cm.doc.scrollTop, bot = top + display.wrapper.clientHeight;\n      if (pixels < 0) top = Math.max(0, top + pixels - 50);\n      else bot = Math.min(cm.doc.height, bot + pixels + 50);\n      updateDisplaySimple(cm, {top: top, bottom: bot});\n    }\n\n    if (wheelSamples < 20) {\n      if (display.wheelStartX == null) {\n        display.wheelStartX = scroll.scrollLeft; display.wheelStartY = scroll.scrollTop;\n        display.wheelDX = dx; display.wheelDY = dy;\n        setTimeout(function() {\n          if (display.wheelStartX == null) return;\n          var movedX = scroll.scrollLeft - display.wheelStartX;\n          var movedY = scroll.scrollTop - display.wheelStartY;\n          var sample = (movedY && display.wheelDY && movedY / display.wheelDY) ||\n            (movedX && display.wheelDX && movedX / display.wheelDX);\n          display.wheelStartX = display.wheelStartY = null;\n          if (!sample) return;\n          wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);\n          ++wheelSamples;\n        }, 200);\n      } else {\n        display.wheelDX += dx; display.wheelDY += dy;\n      }\n    }\n  }\n\n  // KEY EVENTS\n\n  // Run a handler that was bound to a key.\n  function doHandleBinding(cm, bound, dropShift) {\n    if (typeof bound == \"string\") {\n      bound = commands[bound];\n      if (!bound) return false;\n    }\n    // Ensure previous input has been read, so that the handler sees a\n    // consistent view of the document\n    if (cm.display.pollingFast && readInput(cm)) cm.display.pollingFast = false;\n    var prevShift = cm.display.shift, done = false;\n    try {\n      if (isReadOnly(cm)) cm.state.suppressEdits = true;\n      if (dropShift) cm.display.shift = false;\n      done = bound(cm) != Pass;\n    } finally {\n      cm.display.shift = prevShift;\n      cm.state.suppressEdits = false;\n    }\n    return done;\n  }\n\n  // Collect the currently active keymaps.\n  function allKeyMaps(cm) {\n    var maps = cm.state.keyMaps.slice(0);\n    if (cm.options.extraKeys) maps.push(cm.options.extraKeys);\n    maps.push(cm.options.keyMap);\n    return maps;\n  }\n\n  var maybeTransition;\n  // Handle a key from the keydown event.\n  function handleKeyBinding(cm, e) {\n    // Handle automatic keymap transitions\n    var startMap = getKeyMap(cm.options.keyMap), next = startMap.auto;\n    clearTimeout(maybeTransition);\n    if (next && !isModifierKey(e)) maybeTransition = setTimeout(function() {\n      if (getKeyMap(cm.options.keyMap) == startMap) {\n        cm.options.keyMap = (next.call ? next.call(null, cm) : next);\n        keyMapChanged(cm);\n      }\n    }, 50);\n\n    var name = keyName(e, true), handled = false;\n    if (!name) return false;\n    var keymaps = allKeyMaps(cm);\n\n    if (e.shiftKey) {\n      // First try to resolve full name (including 'Shift-'). Failing\n      // that, see if there is a cursor-motion command (starting with\n      // 'go') bound to the keyname without 'Shift-'.\n      handled = lookupKey(\"Shift-\" + name, keymaps, function(b) {return doHandleBinding(cm, b, true);})\n             || lookupKey(name, keymaps, function(b) {\n                  if (typeof b == \"string\" ? /^go[A-Z]/.test(b) : b.motion)\n                    return doHandleBinding(cm, b);\n                });\n    } else {\n      handled = lookupKey(name, keymaps, function(b) { return doHandleBinding(cm, b); });\n    }\n\n    if (handled) {\n      e_preventDefault(e);\n      restartBlink(cm);\n      signalLater(cm, \"keyHandled\", cm, name, e);\n    }\n    return handled;\n  }\n\n  // Handle a key from the keypress event\n  function handleCharBinding(cm, e, ch) {\n    var handled = lookupKey(\"'\" + ch + \"'\", allKeyMaps(cm),\n                            function(b) { return doHandleBinding(cm, b, true); });\n    if (handled) {\n      e_preventDefault(e);\n      restartBlink(cm);\n      signalLater(cm, \"keyHandled\", cm, \"'\" + ch + \"'\", e);\n    }\n    return handled;\n  }\n\n  var lastStoppedKey = null;\n  function onKeyDown(e) {\n    var cm = this;\n    ensureFocus(cm);\n    if (signalDOMEvent(cm, e)) return;\n    // IE does strange things with escape.\n    if (ie && ie_version < 11 && e.keyCode == 27) e.returnValue = false;\n    var code = e.keyCode;\n    cm.display.shift = code == 16 || e.shiftKey;\n    var handled = handleKeyBinding(cm, e);\n    if (presto) {\n      lastStoppedKey = handled ? code : null;\n      // Opera has no cut event... we try to at least catch the key combo\n      if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey))\n        cm.replaceSelection(\"\", null, \"cut\");\n    }\n\n    // Turn mouse into crosshair when Alt is held on Mac.\n    if (code == 18 && !/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className))\n      showCrossHair(cm);\n  }\n\n  function showCrossHair(cm) {\n    var lineDiv = cm.display.lineDiv;\n    addClass(lineDiv, \"CodeMirror-crosshair\");\n\n    function up(e) {\n      if (e.keyCode == 18 || !e.altKey) {\n        rmClass(lineDiv, \"CodeMirror-crosshair\");\n        off(document, \"keyup\", up);\n        off(document, \"mouseover\", up);\n      }\n    }\n    on(document, \"keyup\", up);\n    on(document, \"mouseover\", up);\n  }\n\n  function onKeyUp(e) {\n    if (e.keyCode == 16) this.doc.sel.shift = false;\n    signalDOMEvent(this, e);\n  }\n\n  function onKeyPress(e) {\n    var cm = this;\n    if (signalDOMEvent(cm, e) || e.ctrlKey && !e.altKey || mac && e.metaKey) return;\n    var keyCode = e.keyCode, charCode = e.charCode;\n    if (presto && keyCode == lastStoppedKey) {lastStoppedKey = null; e_preventDefault(e); return;}\n    if (((presto && (!e.which || e.which < 10)) || khtml) && handleKeyBinding(cm, e)) return;\n    var ch = String.fromCharCode(charCode == null ? keyCode : charCode);\n    if (handleCharBinding(cm, e, ch)) return;\n    if (ie && ie_version >= 9) cm.display.inputHasSelection = null;\n    fastPoll(cm);\n  }\n\n  // FOCUS/BLUR EVENTS\n\n  function onFocus(cm) {\n    if (cm.options.readOnly == \"nocursor\") return;\n    if (!cm.state.focused) {\n      signal(cm, \"focus\", cm);\n      cm.state.focused = true;\n      addClass(cm.display.wrapper, \"CodeMirror-focused\");\n      // The prevInput test prevents this from firing when a context\n      // menu is closed (since the resetInput would kill the\n      // select-all detection hack)\n      if (!cm.curOp && cm.display.selForContextMenu != cm.doc.sel) {\n        resetInput(cm);\n        if (webkit) setTimeout(bind(resetInput, cm, true), 0); // Issue #1730\n      }\n    }\n    slowPoll(cm);\n    restartBlink(cm);\n  }\n  function onBlur(cm) {\n    if (cm.state.focused) {\n      signal(cm, \"blur\", cm);\n      cm.state.focused = false;\n      rmClass(cm.display.wrapper, \"CodeMirror-focused\");\n    }\n    clearInterval(cm.display.blinker);\n    setTimeout(function() {if (!cm.state.focused) cm.display.shift = false;}, 150);\n  }\n\n  // CONTEXT MENU HANDLING\n\n  // To make the context menu work, we need to briefly unhide the\n  // textarea (making it as unobtrusive as possible) to let the\n  // right-click take effect on it.\n  function onContextMenu(cm, e) {\n    if (signalDOMEvent(cm, e, \"contextmenu\")) return;\n    var display = cm.display;\n    if (eventInWidget(display, e) || contextMenuInGutter(cm, e)) return;\n\n    var pos = posFromMouse(cm, e), scrollPos = display.scroller.scrollTop;\n    if (!pos || presto) return; // Opera is difficult.\n\n    // Reset the current text selection only if the click is done outside of the selection\n    // and 'resetSelectionOnContextMenu' option is true.\n    var reset = cm.options.resetSelectionOnContextMenu;\n    if (reset && cm.doc.sel.contains(pos) == -1)\n      operation(cm, setSelection)(cm.doc, simpleSelection(pos), sel_dontScroll);\n\n    var oldCSS = display.input.style.cssText;\n    display.inputDiv.style.position = \"absolute\";\n    display.input.style.cssText = \"position: fixed; width: 30px; height: 30px; top: \" + (e.clientY - 5) +\n      \"px; left: \" + (e.clientX - 5) + \"px; z-index: 1000; background: \" +\n      (ie ? \"rgba(255, 255, 255, .05)\" : \"transparent\") +\n      \"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);\";\n    if (webkit) var oldScrollY = window.scrollY; // Work around Chrome issue (#2712)\n    focusInput(cm);\n    if (webkit) window.scrollTo(null, oldScrollY);\n    resetInput(cm);\n    // Adds \"Select all\" to context menu in FF\n    if (!cm.somethingSelected()) display.input.value = display.prevInput = \" \";\n    display.selForContextMenu = cm.doc.sel;\n    clearTimeout(display.detectingSelectAll);\n\n    // Select-all will be greyed out if there's nothing to select, so\n    // this adds a zero-width space so that we can later check whether\n    // it got selected.\n    function prepareSelectAllHack() {\n      if (display.input.selectionStart != null) {\n        var selected = cm.somethingSelected();\n        var extval = display.input.value = \"\\u200b\" + (selected ? display.input.value : \"\");\n        display.prevInput = selected ? \"\" : \"\\u200b\";\n        display.input.selectionStart = 1; display.input.selectionEnd = extval.length;\n        // Re-set this, in case some other handler touched the\n        // selection in the meantime.\n        display.selForContextMenu = cm.doc.sel;\n      }\n    }\n    function rehide() {\n      display.inputDiv.style.position = \"relative\";\n      display.input.style.cssText = oldCSS;\n      if (ie && ie_version < 9) display.scrollbarV.scrollTop = display.scroller.scrollTop = scrollPos;\n      slowPoll(cm);\n\n      // Try to detect the user choosing select-all\n      if (display.input.selectionStart != null) {\n        if (!ie || (ie && ie_version < 9)) prepareSelectAllHack();\n        var i = 0, poll = function() {\n          if (display.selForContextMenu == cm.doc.sel && display.input.selectionStart == 0)\n            operation(cm, commands.selectAll)(cm);\n          else if (i++ < 10) display.detectingSelectAll = setTimeout(poll, 500);\n          else resetInput(cm);\n        };\n        display.detectingSelectAll = setTimeout(poll, 200);\n      }\n    }\n\n    if (ie && ie_version >= 9) prepareSelectAllHack();\n    if (captureRightClick) {\n      e_stop(e);\n      var mouseup = function() {\n        off(window, \"mouseup\", mouseup);\n        setTimeout(rehide, 20);\n      };\n      on(window, \"mouseup\", mouseup);\n    } else {\n      setTimeout(rehide, 50);\n    }\n  }\n\n  function contextMenuInGutter(cm, e) {\n    if (!hasHandler(cm, \"gutterContextMenu\")) return false;\n    return gutterEvent(cm, e, \"gutterContextMenu\", false, signal);\n  }\n\n  // UPDATING\n\n  // Compute the position of the end of a change (its 'to' property\n  // refers to the pre-change end).\n  var changeEnd = CodeMirror.changeEnd = function(change) {\n    if (!change.text) return change.to;\n    return Pos(change.from.line + change.text.length - 1,\n               lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0));\n  };\n\n  // Adjust a position to refer to the post-change position of the\n  // same text, or the end of the change if the change covers it.\n  function adjustForChange(pos, change) {\n    if (cmp(pos, change.from) < 0) return pos;\n    if (cmp(pos, change.to) <= 0) return changeEnd(change);\n\n    var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1, ch = pos.ch;\n    if (pos.line == change.to.line) ch += changeEnd(change).ch - change.to.ch;\n    return Pos(line, ch);\n  }\n\n  function computeSelAfterChange(doc, change) {\n    var out = [];\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      var range = doc.sel.ranges[i];\n      out.push(new Range(adjustForChange(range.anchor, change),\n                         adjustForChange(range.head, change)));\n    }\n    return normalizeSelection(out, doc.sel.primIndex);\n  }\n\n  function offsetPos(pos, old, nw) {\n    if (pos.line == old.line)\n      return Pos(nw.line, pos.ch - old.ch + nw.ch);\n    else\n      return Pos(nw.line + (pos.line - old.line), pos.ch);\n  }\n\n  // Used by replaceSelections to allow moving the selection to the\n  // start or around the replaced test. Hint may be \"start\" or \"around\".\n  function computeReplacedSel(doc, changes, hint) {\n    var out = [];\n    var oldPrev = Pos(doc.first, 0), newPrev = oldPrev;\n    for (var i = 0; i < changes.length; i++) {\n      var change = changes[i];\n      var from = offsetPos(change.from, oldPrev, newPrev);\n      var to = offsetPos(changeEnd(change), oldPrev, newPrev);\n      oldPrev = change.to;\n      newPrev = to;\n      if (hint == \"around\") {\n        var range = doc.sel.ranges[i], inv = cmp(range.head, range.anchor) < 0;\n        out[i] = new Range(inv ? to : from, inv ? from : to);\n      } else {\n        out[i] = new Range(from, from);\n      }\n    }\n    return new Selection(out, doc.sel.primIndex);\n  }\n\n  // Allow \"beforeChange\" event handlers to influence a change\n  function filterChange(doc, change, update) {\n    var obj = {\n      canceled: false,\n      from: change.from,\n      to: change.to,\n      text: change.text,\n      origin: change.origin,\n      cancel: function() { this.canceled = true; }\n    };\n    if (update) obj.update = function(from, to, text, origin) {\n      if (from) this.from = clipPos(doc, from);\n      if (to) this.to = clipPos(doc, to);\n      if (text) this.text = text;\n      if (origin !== undefined) this.origin = origin;\n    };\n    signal(doc, \"beforeChange\", doc, obj);\n    if (doc.cm) signal(doc.cm, \"beforeChange\", doc.cm, obj);\n\n    if (obj.canceled) return null;\n    return {from: obj.from, to: obj.to, text: obj.text, origin: obj.origin};\n  }\n\n  // Apply a change to a document, and add it to the document's\n  // history, and propagating it to all linked documents.\n  function makeChange(doc, change, ignoreReadOnly) {\n    if (doc.cm) {\n      if (!doc.cm.curOp) return operation(doc.cm, makeChange)(doc, change, ignoreReadOnly);\n      if (doc.cm.state.suppressEdits) return;\n    }\n\n    if (hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")) {\n      change = filterChange(doc, change, true);\n      if (!change) return;\n    }\n\n    // Possibly split or suppress the update based on the presence\n    // of read-only spans in its range.\n    var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);\n    if (split) {\n      for (var i = split.length - 1; i >= 0; --i)\n        makeChangeInner(doc, {from: split[i].from, to: split[i].to, text: i ? [\"\"] : change.text});\n    } else {\n      makeChangeInner(doc, change);\n    }\n  }\n\n  function makeChangeInner(doc, change) {\n    if (change.text.length == 1 && change.text[0] == \"\" && cmp(change.from, change.to) == 0) return;\n    var selAfter = computeSelAfterChange(doc, change);\n    addChangeToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);\n\n    makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));\n    var rebased = [];\n\n    linkedDocs(doc, function(doc, sharedHist) {\n      if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n        rebaseHist(doc.history, change);\n        rebased.push(doc.history);\n      }\n      makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));\n    });\n  }\n\n  // Revert a change stored in a document's history.\n  function makeChangeFromHistory(doc, type, allowSelectionOnly) {\n    if (doc.cm && doc.cm.state.suppressEdits) return;\n\n    var hist = doc.history, event, selAfter = doc.sel;\n    var source = type == \"undo\" ? hist.done : hist.undone, dest = type == \"undo\" ? hist.undone : hist.done;\n\n    // Verify that there is a useable event (so that ctrl-z won't\n    // needlessly clear selection events)\n    for (var i = 0; i < source.length; i++) {\n      event = source[i];\n      if (allowSelectionOnly ? event.ranges && !event.equals(doc.sel) : !event.ranges)\n        break;\n    }\n    if (i == source.length) return;\n    hist.lastOrigin = hist.lastSelOrigin = null;\n\n    for (;;) {\n      event = source.pop();\n      if (event.ranges) {\n        pushSelectionToHistory(event, dest);\n        if (allowSelectionOnly && !event.equals(doc.sel)) {\n          setSelection(doc, event, {clearRedo: false});\n          return;\n        }\n        selAfter = event;\n      }\n      else break;\n    }\n\n    // Build up a reverse change object to add to the opposite history\n    // stack (redo when undoing, and vice versa).\n    var antiChanges = [];\n    pushSelectionToHistory(selAfter, dest);\n    dest.push({changes: antiChanges, generation: hist.generation});\n    hist.generation = event.generation || ++hist.maxGeneration;\n\n    var filter = hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\");\n\n    for (var i = event.changes.length - 1; i >= 0; --i) {\n      var change = event.changes[i];\n      change.origin = type;\n      if (filter && !filterChange(doc, change, false)) {\n        source.length = 0;\n        return;\n      }\n\n      antiChanges.push(historyChangeFromChange(doc, change));\n\n      var after = i ? computeSelAfterChange(doc, change) : lst(source);\n      makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));\n      if (!i && doc.cm) doc.cm.scrollIntoView({from: change.from, to: changeEnd(change)});\n      var rebased = [];\n\n      // Propagate to the linked documents\n      linkedDocs(doc, function(doc, sharedHist) {\n        if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n          rebaseHist(doc.history, change);\n          rebased.push(doc.history);\n        }\n        makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));\n      });\n    }\n  }\n\n  // Sub-views need their line numbers shifted when text is added\n  // above or below them in the parent document.\n  function shiftDoc(doc, distance) {\n    if (distance == 0) return;\n    doc.first += distance;\n    doc.sel = new Selection(map(doc.sel.ranges, function(range) {\n      return new Range(Pos(range.anchor.line + distance, range.anchor.ch),\n                       Pos(range.head.line + distance, range.head.ch));\n    }), doc.sel.primIndex);\n    if (doc.cm) {\n      regChange(doc.cm, doc.first, doc.first - distance, distance);\n      for (var d = doc.cm.display, l = d.viewFrom; l < d.viewTo; l++)\n        regLineChange(doc.cm, l, \"gutter\");\n    }\n  }\n\n  // More lower-level change function, handling only a single document\n  // (not linked ones).\n  function makeChangeSingleDoc(doc, change, selAfter, spans) {\n    if (doc.cm && !doc.cm.curOp)\n      return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans);\n\n    if (change.to.line < doc.first) {\n      shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));\n      return;\n    }\n    if (change.from.line > doc.lastLine()) return;\n\n    // Clip the change to the size of this doc\n    if (change.from.line < doc.first) {\n      var shift = change.text.length - 1 - (doc.first - change.from.line);\n      shiftDoc(doc, shift);\n      change = {from: Pos(doc.first, 0), to: Pos(change.to.line + shift, change.to.ch),\n                text: [lst(change.text)], origin: change.origin};\n    }\n    var last = doc.lastLine();\n    if (change.to.line > last) {\n      change = {from: change.from, to: Pos(last, getLine(doc, last).text.length),\n                text: [change.text[0]], origin: change.origin};\n    }\n\n    change.removed = getBetween(doc, change.from, change.to);\n\n    if (!selAfter) selAfter = computeSelAfterChange(doc, change);\n    if (doc.cm) makeChangeSingleDocInEditor(doc.cm, change, spans);\n    else updateDoc(doc, change, spans);\n    setSelectionNoUndo(doc, selAfter, sel_dontScroll);\n  }\n\n  // Handle the interaction of a change to a document with the editor\n  // that this document is part of.\n  function makeChangeSingleDocInEditor(cm, change, spans) {\n    var doc = cm.doc, display = cm.display, from = change.from, to = change.to;\n\n    var recomputeMaxLength = false, checkWidthStart = from.line;\n    if (!cm.options.lineWrapping) {\n      checkWidthStart = lineNo(visualLine(getLine(doc, from.line)));\n      doc.iter(checkWidthStart, to.line + 1, function(line) {\n        if (line == display.maxLine) {\n          recomputeMaxLength = true;\n          return true;\n        }\n      });\n    }\n\n    if (doc.sel.contains(change.from, change.to) > -1)\n      signalCursorActivity(cm);\n\n    updateDoc(doc, change, spans, estimateHeight(cm));\n\n    if (!cm.options.lineWrapping) {\n      doc.iter(checkWidthStart, from.line + change.text.length, function(line) {\n        var len = lineLength(line);\n        if (len > display.maxLineLength) {\n          display.maxLine = line;\n          display.maxLineLength = len;\n          display.maxLineChanged = true;\n          recomputeMaxLength = false;\n        }\n      });\n      if (recomputeMaxLength) cm.curOp.updateMaxLine = true;\n    }\n\n    // Adjust frontier, schedule worker\n    doc.frontier = Math.min(doc.frontier, from.line);\n    startWorker(cm, 400);\n\n    var lendiff = change.text.length - (to.line - from.line) - 1;\n    // Remember that these lines changed, for updating the display\n    if (from.line == to.line && change.text.length == 1 && !isWholeLineUpdate(cm.doc, change))\n      regLineChange(cm, from.line, \"text\");\n    else\n      regChange(cm, from.line, to.line + 1, lendiff);\n\n    var changesHandler = hasHandler(cm, \"changes\"), changeHandler = hasHandler(cm, \"change\");\n    if (changeHandler || changesHandler) {\n      var obj = {\n        from: from, to: to,\n        text: change.text,\n        removed: change.removed,\n        origin: change.origin\n      };\n      if (changeHandler) signalLater(cm, \"change\", cm, obj);\n      if (changesHandler) (cm.curOp.changeObjs || (cm.curOp.changeObjs = [])).push(obj);\n    }\n    cm.display.selForContextMenu = null;\n  }\n\n  function replaceRange(doc, code, from, to, origin) {\n    if (!to) to = from;\n    if (cmp(to, from) < 0) { var tmp = to; to = from; from = tmp; }\n    if (typeof code == \"string\") code = splitLines(code);\n    makeChange(doc, {from: from, to: to, text: code, origin: origin});\n  }\n\n  // SCROLLING THINGS INTO VIEW\n\n  // If an editor sits on the top or bottom of the window, partially\n  // scrolled out of view, this ensures that the cursor is visible.\n  function maybeScrollWindow(cm, coords) {\n    var display = cm.display, box = display.sizer.getBoundingClientRect(), doScroll = null;\n    if (coords.top + box.top < 0) doScroll = true;\n    else if (coords.bottom + box.top > (window.innerHeight || document.documentElement.clientHeight)) doScroll = false;\n    if (doScroll != null && !phantom) {\n      var scrollNode = elt(\"div\", \"\\u200b\", null, \"position: absolute; top: \" +\n                           (coords.top - display.viewOffset - paddingTop(cm.display)) + \"px; height: \" +\n                           (coords.bottom - coords.top + scrollerCutOff) + \"px; left: \" +\n                           coords.left + \"px; width: 2px;\");\n      cm.display.lineSpace.appendChild(scrollNode);\n      scrollNode.scrollIntoView(doScroll);\n      cm.display.lineSpace.removeChild(scrollNode);\n    }\n  }\n\n  // Scroll a given position into view (immediately), verifying that\n  // it actually became visible (as line heights are accurately\n  // measured, the position of something may 'drift' during drawing).\n  function scrollPosIntoView(cm, pos, end, margin) {\n    if (margin == null) margin = 0;\n    for (var limit = 0; limit < 5; limit++) {\n      var changed = false, coords = cursorCoords(cm, pos);\n      var endCoords = !end || end == pos ? coords : cursorCoords(cm, end);\n      var scrollPos = calculateScrollPos(cm, Math.min(coords.left, endCoords.left),\n                                         Math.min(coords.top, endCoords.top) - margin,\n                                         Math.max(coords.left, endCoords.left),\n                                         Math.max(coords.bottom, endCoords.bottom) + margin);\n      var startTop = cm.doc.scrollTop, startLeft = cm.doc.scrollLeft;\n      if (scrollPos.scrollTop != null) {\n        setScrollTop(cm, scrollPos.scrollTop);\n        if (Math.abs(cm.doc.scrollTop - startTop) > 1) changed = true;\n      }\n      if (scrollPos.scrollLeft != null) {\n        setScrollLeft(cm, scrollPos.scrollLeft);\n        if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) changed = true;\n      }\n      if (!changed) return coords;\n    }\n  }\n\n  // Scroll a given set of coordinates into view (immediately).\n  function scrollIntoView(cm, x1, y1, x2, y2) {\n    var scrollPos = calculateScrollPos(cm, x1, y1, x2, y2);\n    if (scrollPos.scrollTop != null) setScrollTop(cm, scrollPos.scrollTop);\n    if (scrollPos.scrollLeft != null) setScrollLeft(cm, scrollPos.scrollLeft);\n  }\n\n  // Calculate a new scroll position needed to scroll the given\n  // rectangle into view. Returns an object with scrollTop and\n  // scrollLeft properties. When these are undefined, the\n  // vertical/horizontal position does not need to be adjusted.\n  function calculateScrollPos(cm, x1, y1, x2, y2) {\n    var display = cm.display, snapMargin = textHeight(cm.display);\n    if (y1 < 0) y1 = 0;\n    var screentop = cm.curOp && cm.curOp.scrollTop != null ? cm.curOp.scrollTop : display.scroller.scrollTop;\n    var screen = display.scroller.clientHeight - scrollerCutOff, result = {};\n    if (y2 - y1 > screen) y2 = y1 + screen;\n    var docBottom = cm.doc.height + paddingVert(display);\n    var atTop = y1 < snapMargin, atBottom = y2 > docBottom - snapMargin;\n    if (y1 < screentop) {\n      result.scrollTop = atTop ? 0 : y1;\n    } else if (y2 > screentop + screen) {\n      var newTop = Math.min(y1, (atBottom ? docBottom : y2) - screen);\n      if (newTop != screentop) result.scrollTop = newTop;\n    }\n\n    var screenleft = cm.curOp && cm.curOp.scrollLeft != null ? cm.curOp.scrollLeft : display.scroller.scrollLeft;\n    var screenw = display.scroller.clientWidth - scrollerCutOff - display.gutters.offsetWidth;\n    var tooWide = x2 - x1 > screenw;\n    if (tooWide) x2 = x1 + screenw;\n    if (x1 < 10)\n      result.scrollLeft = 0;\n    else if (x1 < screenleft)\n      result.scrollLeft = Math.max(0, x1 - (tooWide ? 0 : 10));\n    else if (x2 > screenw + screenleft - 3)\n      result.scrollLeft = x2 + (tooWide ? 0 : 10) - screenw;\n\n    return result;\n  }\n\n  // Store a relative adjustment to the scroll position in the current\n  // operation (to be applied when the operation finishes).\n  function addToScrollPos(cm, left, top) {\n    if (left != null || top != null) resolveScrollToPos(cm);\n    if (left != null)\n      cm.curOp.scrollLeft = (cm.curOp.scrollLeft == null ? cm.doc.scrollLeft : cm.curOp.scrollLeft) + left;\n    if (top != null)\n      cm.curOp.scrollTop = (cm.curOp.scrollTop == null ? cm.doc.scrollTop : cm.curOp.scrollTop) + top;\n  }\n\n  // Make sure that at the end of the operation the current cursor is\n  // shown.\n  function ensureCursorVisible(cm) {\n    resolveScrollToPos(cm);\n    var cur = cm.getCursor(), from = cur, to = cur;\n    if (!cm.options.lineWrapping) {\n      from = cur.ch ? Pos(cur.line, cur.ch - 1) : cur;\n      to = Pos(cur.line, cur.ch + 1);\n    }\n    cm.curOp.scrollToPos = {from: from, to: to, margin: cm.options.cursorScrollMargin, isCursor: true};\n  }\n\n  // When an operation has its scrollToPos property set, and another\n  // scroll action is applied before the end of the operation, this\n  // 'simulates' scrolling that position into view in a cheap way, so\n  // that the effect of intermediate scroll commands is not ignored.\n  function resolveScrollToPos(cm) {\n    var range = cm.curOp.scrollToPos;\n    if (range) {\n      cm.curOp.scrollToPos = null;\n      var from = estimateCoords(cm, range.from), to = estimateCoords(cm, range.to);\n      var sPos = calculateScrollPos(cm, Math.min(from.left, to.left),\n                                    Math.min(from.top, to.top) - range.margin,\n                                    Math.max(from.right, to.right),\n                                    Math.max(from.bottom, to.bottom) + range.margin);\n      cm.scrollTo(sPos.scrollLeft, sPos.scrollTop);\n    }\n  }\n\n  // API UTILITIES\n\n  // Indent the given line. The how parameter can be \"smart\",\n  // \"add\"/null, \"subtract\", or \"prev\". When aggressive is false\n  // (typically set to true for forced single-line indents), empty\n  // lines are not indented, and places where the mode returns Pass\n  // are left alone.\n  function indentLine(cm, n, how, aggressive) {\n    var doc = cm.doc, state;\n    if (how == null) how = \"add\";\n    if (how == \"smart\") {\n      // Fall back to \"prev\" when the mode doesn't have an indentation\n      // method.\n      if (!doc.mode.indent) how = \"prev\";\n      else state = getStateBefore(cm, n);\n    }\n\n    var tabSize = cm.options.tabSize;\n    var line = getLine(doc, n), curSpace = countColumn(line.text, null, tabSize);\n    if (line.stateAfter) line.stateAfter = null;\n    var curSpaceString = line.text.match(/^\\s*/)[0], indentation;\n    if (!aggressive && !/\\S/.test(line.text)) {\n      indentation = 0;\n      how = \"not\";\n    } else if (how == \"smart\") {\n      indentation = doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);\n      if (indentation == Pass || indentation > 150) {\n        if (!aggressive) return;\n        how = \"prev\";\n      }\n    }\n    if (how == \"prev\") {\n      if (n > doc.first) indentation = countColumn(getLine(doc, n-1).text, null, tabSize);\n      else indentation = 0;\n    } else if (how == \"add\") {\n      indentation = curSpace + cm.options.indentUnit;\n    } else if (how == \"subtract\") {\n      indentation = curSpace - cm.options.indentUnit;\n    } else if (typeof how == \"number\") {\n      indentation = curSpace + how;\n    }\n    indentation = Math.max(0, indentation);\n\n    var indentString = \"\", pos = 0;\n    if (cm.options.indentWithTabs)\n      for (var i = Math.floor(indentation / tabSize); i; --i) {pos += tabSize; indentString += \"\\t\";}\n    if (pos < indentation) indentString += spaceStr(indentation - pos);\n\n    if (indentString != curSpaceString) {\n      replaceRange(doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), \"+input\");\n    } else {\n      // Ensure that, if the cursor was in the whitespace at the start\n      // of the line, it is moved to the end of that space.\n      for (var i = 0; i < doc.sel.ranges.length; i++) {\n        var range = doc.sel.ranges[i];\n        if (range.head.line == n && range.head.ch < curSpaceString.length) {\n          var pos = Pos(n, curSpaceString.length);\n          replaceOneSelection(doc, i, new Range(pos, pos));\n          break;\n        }\n      }\n    }\n    line.stateAfter = null;\n  }\n\n  // Utility for applying a change to a line by handle or number,\n  // returning the number and optionally registering the line as\n  // changed.\n  function changeLine(doc, handle, changeType, op) {\n    var no = handle, line = handle;\n    if (typeof handle == \"number\") line = getLine(doc, clipLine(doc, handle));\n    else no = lineNo(handle);\n    if (no == null) return null;\n    if (op(line, no) && doc.cm) regLineChange(doc.cm, no, changeType);\n    return line;\n  }\n\n  // Helper for deleting text near the selection(s), used to implement\n  // backspace, delete, and similar functionality.\n  function deleteNearSelection(cm, compute) {\n    var ranges = cm.doc.sel.ranges, kill = [];\n    // Build up a set of ranges to kill first, merging overlapping\n    // ranges.\n    for (var i = 0; i < ranges.length; i++) {\n      var toKill = compute(ranges[i]);\n      while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\n        var replaced = kill.pop();\n        if (cmp(replaced.from, toKill.from) < 0) {\n          toKill.from = replaced.from;\n          break;\n        }\n      }\n      kill.push(toKill);\n    }\n    // Next, remove those actual ranges.\n    runInOp(cm, function() {\n      for (var i = kill.length - 1; i >= 0; i--)\n        replaceRange(cm.doc, \"\", kill[i].from, kill[i].to, \"+delete\");\n      ensureCursorVisible(cm);\n    });\n  }\n\n  // Used for horizontal relative motion. Dir is -1 or 1 (left or\n  // right), unit can be \"char\", \"column\" (like char, but doesn't\n  // cross line boundaries), \"word\" (across next word), or \"group\" (to\n  // the start of next group of word or non-word-non-whitespace\n  // chars). The visually param controls whether, in right-to-left\n  // text, direction 1 means to move towards the next index in the\n  // string, or towards the character to the right of the current\n  // position. The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosH(doc, pos, dir, unit, visually) {\n    var line = pos.line, ch = pos.ch, origDir = dir;\n    var lineObj = getLine(doc, line);\n    var possible = true;\n    function findNextLine() {\n      var l = line + dir;\n      if (l < doc.first || l >= doc.first + doc.size) return (possible = false);\n      line = l;\n      return lineObj = getLine(doc, l);\n    }\n    function moveOnce(boundToLine) {\n      var next = (visually ? moveVisually : moveLogically)(lineObj, ch, dir, true);\n      if (next == null) {\n        if (!boundToLine && findNextLine()) {\n          if (visually) ch = (dir < 0 ? lineRight : lineLeft)(lineObj);\n          else ch = dir < 0 ? lineObj.text.length : 0;\n        } else return (possible = false);\n      } else ch = next;\n      return true;\n    }\n\n    if (unit == \"char\") moveOnce();\n    else if (unit == \"column\") moveOnce(true);\n    else if (unit == \"word\" || unit == \"group\") {\n      var sawType = null, group = unit == \"group\";\n      var helper = doc.cm && doc.cm.getHelper(pos, \"wordChars\");\n      for (var first = true;; first = false) {\n        if (dir < 0 && !moveOnce(!first)) break;\n        var cur = lineObj.text.charAt(ch) || \"\\n\";\n        var type = isWordChar(cur, helper) ? \"w\"\n          : group && cur == \"\\n\" ? \"n\"\n          : !group || /\\s/.test(cur) ? null\n          : \"p\";\n        if (group && !first && !type) type = \"s\";\n        if (sawType && sawType != type) {\n          if (dir < 0) {dir = 1; moveOnce();}\n          break;\n        }\n\n        if (type) sawType = type;\n        if (dir > 0 && !moveOnce(!first)) break;\n      }\n    }\n    var result = skipAtomic(doc, Pos(line, ch), origDir, true);\n    if (!possible) result.hitSide = true;\n    return result;\n  }\n\n  // For relative vertical movement. Dir may be -1 or 1. Unit can be\n  // \"page\" or \"line\". The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosV(cm, pos, dir, unit) {\n    var doc = cm.doc, x = pos.left, y;\n    if (unit == \"page\") {\n      var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);\n      y = pos.top + dir * (pageSize - (dir < 0 ? 1.5 : .5) * textHeight(cm.display));\n    } else if (unit == \"line\") {\n      y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\n    }\n    for (;;) {\n      var target = coordsChar(cm, x, y);\n      if (!target.outside) break;\n      if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break; }\n      y += dir * 5;\n    }\n    return target;\n  }\n\n  // EDITOR METHODS\n\n  // The publicly visible API. Note that methodOp(f) means\n  // 'wrap f in an operation, performed on its `this` parameter'.\n\n  // This is not the complete set of editor methods. Most of the\n  // methods defined on the Doc type are also injected into\n  // CodeMirror.prototype, for backwards compatibility and\n  // convenience.\n\n  CodeMirror.prototype = {\n    constructor: CodeMirror,\n    focus: function(){window.focus(); focusInput(this); fastPoll(this);},\n\n    setOption: function(option, value) {\n      var options = this.options, old = options[option];\n      if (options[option] == value && option != \"mode\") return;\n      options[option] = value;\n      if (optionHandlers.hasOwnProperty(option))\n        operation(this, optionHandlers[option])(this, value, old);\n    },\n\n    getOption: function(option) {return this.options[option];},\n    getDoc: function() {return this.doc;},\n\n    addKeyMap: function(map, bottom) {\n      this.state.keyMaps[bottom ? \"push\" : \"unshift\"](map);\n    },\n    removeKeyMap: function(map) {\n      var maps = this.state.keyMaps;\n      for (var i = 0; i < maps.length; ++i)\n        if (maps[i] == map || (typeof maps[i] != \"string\" && maps[i].name == map)) {\n          maps.splice(i, 1);\n          return true;\n        }\n    },\n\n    addOverlay: methodOp(function(spec, options) {\n      var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\n      if (mode.startState) throw new Error(\"Overlays may not be stateful.\");\n      this.state.overlays.push({mode: mode, modeSpec: spec, opaque: options && options.opaque});\n      this.state.modeGen++;\n      regChange(this);\n    }),\n    removeOverlay: methodOp(function(spec) {\n      var overlays = this.state.overlays;\n      for (var i = 0; i < overlays.length; ++i) {\n        var cur = overlays[i].modeSpec;\n        if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\n          overlays.splice(i, 1);\n          this.state.modeGen++;\n          regChange(this);\n          return;\n        }\n      }\n    }),\n\n    indentLine: methodOp(function(n, dir, aggressive) {\n      if (typeof dir != \"string\" && typeof dir != \"number\") {\n        if (dir == null) dir = this.options.smartIndent ? \"smart\" : \"prev\";\n        else dir = dir ? \"add\" : \"subtract\";\n      }\n      if (isLine(this.doc, n)) indentLine(this, n, dir, aggressive);\n    }),\n    indentSelection: methodOp(function(how) {\n      var ranges = this.doc.sel.ranges, end = -1;\n      for (var i = 0; i < ranges.length; i++) {\n        var range = ranges[i];\n        if (!range.empty()) {\n          var from = range.from(), to = range.to();\n          var start = Math.max(end, from.line);\n          end = Math.min(this.lastLine(), to.line - (to.ch ? 0 : 1)) + 1;\n          for (var j = start; j < end; ++j)\n            indentLine(this, j, how);\n          var newRanges = this.doc.sel.ranges;\n          if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0)\n            replaceOneSelection(this.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll);\n        } else if (range.head.line > end) {\n          indentLine(this, range.head.line, how, true);\n          end = range.head.line;\n          if (i == this.doc.sel.primIndex) ensureCursorVisible(this);\n        }\n      }\n    }),\n\n    // Fetch the parser token for a given character. Useful for hacks\n    // that want to inspect the mode state (say, for completion).\n    getTokenAt: function(pos, precise) {\n      var doc = this.doc;\n      pos = clipPos(doc, pos);\n      var state = getStateBefore(this, pos.line, precise), mode = this.doc.mode;\n      var line = getLine(doc, pos.line);\n      var stream = new StringStream(line.text, this.options.tabSize);\n      while (stream.pos < pos.ch && !stream.eol()) {\n        stream.start = stream.pos;\n        var style = readToken(mode, stream, state);\n      }\n      return {start: stream.start,\n              end: stream.pos,\n              string: stream.current(),\n              type: style || null,\n              state: state};\n    },\n\n    getTokenTypeAt: function(pos) {\n      pos = clipPos(this.doc, pos);\n      var styles = getLineStyles(this, getLine(this.doc, pos.line));\n      var before = 0, after = (styles.length - 1) / 2, ch = pos.ch;\n      var type;\n      if (ch == 0) type = styles[2];\n      else for (;;) {\n        var mid = (before + after) >> 1;\n        if ((mid ? styles[mid * 2 - 1] : 0) >= ch) after = mid;\n        else if (styles[mid * 2 + 1] < ch) before = mid + 1;\n        else { type = styles[mid * 2 + 2]; break; }\n      }\n      var cut = type ? type.indexOf(\"cm-overlay \") : -1;\n      return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1);\n    },\n\n    getModeAt: function(pos) {\n      var mode = this.doc.mode;\n      if (!mode.innerMode) return mode;\n      return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode;\n    },\n\n    getHelper: function(pos, type) {\n      return this.getHelpers(pos, type)[0];\n    },\n\n    getHelpers: function(pos, type) {\n      var found = [];\n      if (!helpers.hasOwnProperty(type)) return helpers;\n      var help = helpers[type], mode = this.getModeAt(pos);\n      if (typeof mode[type] == \"string\") {\n        if (help[mode[type]]) found.push(help[mode[type]]);\n      } else if (mode[type]) {\n        for (var i = 0; i < mode[type].length; i++) {\n          var val = help[mode[type][i]];\n          if (val) found.push(val);\n        }\n      } else if (mode.helperType && help[mode.helperType]) {\n        found.push(help[mode.helperType]);\n      } else if (help[mode.name]) {\n        found.push(help[mode.name]);\n      }\n      for (var i = 0; i < help._global.length; i++) {\n        var cur = help._global[i];\n        if (cur.pred(mode, this) && indexOf(found, cur.val) == -1)\n          found.push(cur.val);\n      }\n      return found;\n    },\n\n    getStateAfter: function(line, precise) {\n      var doc = this.doc;\n      line = clipLine(doc, line == null ? doc.first + doc.size - 1: line);\n      return getStateBefore(this, line + 1, precise);\n    },\n\n    cursorCoords: function(start, mode) {\n      var pos, range = this.doc.sel.primary();\n      if (start == null) pos = range.head;\n      else if (typeof start == \"object\") pos = clipPos(this.doc, start);\n      else pos = start ? range.from() : range.to();\n      return cursorCoords(this, pos, mode || \"page\");\n    },\n\n    charCoords: function(pos, mode) {\n      return charCoords(this, clipPos(this.doc, pos), mode || \"page\");\n    },\n\n    coordsChar: function(coords, mode) {\n      coords = fromCoordSystem(this, coords, mode || \"page\");\n      return coordsChar(this, coords.left, coords.top);\n    },\n\n    lineAtHeight: function(height, mode) {\n      height = fromCoordSystem(this, {top: height, left: 0}, mode || \"page\").top;\n      return lineAtHeight(this.doc, height + this.display.viewOffset);\n    },\n    heightAtLine: function(line, mode) {\n      var end = false, last = this.doc.first + this.doc.size - 1;\n      if (line < this.doc.first) line = this.doc.first;\n      else if (line > last) { line = last; end = true; }\n      var lineObj = getLine(this.doc, line);\n      return intoCoordSystem(this, lineObj, {top: 0, left: 0}, mode || \"page\").top +\n        (end ? this.doc.height - heightAtLine(lineObj) : 0);\n    },\n\n    defaultTextHeight: function() { return textHeight(this.display); },\n    defaultCharWidth: function() { return charWidth(this.display); },\n\n    setGutterMarker: methodOp(function(line, gutterID, value) {\n      return changeLine(this.doc, line, \"gutter\", function(line) {\n        var markers = line.gutterMarkers || (line.gutterMarkers = {});\n        markers[gutterID] = value;\n        if (!value && isEmpty(markers)) line.gutterMarkers = null;\n        return true;\n      });\n    }),\n\n    clearGutter: methodOp(function(gutterID) {\n      var cm = this, doc = cm.doc, i = doc.first;\n      doc.iter(function(line) {\n        if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\n          line.gutterMarkers[gutterID] = null;\n          regLineChange(cm, i, \"gutter\");\n          if (isEmpty(line.gutterMarkers)) line.gutterMarkers = null;\n        }\n        ++i;\n      });\n    }),\n\n    addLineWidget: methodOp(function(handle, node, options) {\n      return addLineWidget(this, handle, node, options);\n    }),\n\n    removeLineWidget: function(widget) { widget.clear(); },\n\n    lineInfo: function(line) {\n      if (typeof line == \"number\") {\n        if (!isLine(this.doc, line)) return null;\n        var n = line;\n        line = getLine(this.doc, line);\n        if (!line) return null;\n      } else {\n        var n = lineNo(line);\n        if (n == null) return null;\n      }\n      return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,\n              textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,\n              widgets: line.widgets};\n    },\n\n    getViewport: function() { return {from: this.display.viewFrom, to: this.display.viewTo};},\n\n    addWidget: function(pos, node, scroll, vert, horiz) {\n      var display = this.display;\n      pos = cursorCoords(this, clipPos(this.doc, pos));\n      var top = pos.bottom, left = pos.left;\n      node.style.position = \"absolute\";\n      display.sizer.appendChild(node);\n      if (vert == \"over\") {\n        top = pos.top;\n      } else if (vert == \"above\" || vert == \"near\") {\n        var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\n        hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth);\n        // Default to positioning above (if specified and possible); otherwise default to positioning below\n        if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)\n          top = pos.top - node.offsetHeight;\n        else if (pos.bottom + node.offsetHeight <= vspace)\n          top = pos.bottom;\n        if (left + node.offsetWidth > hspace)\n          left = hspace - node.offsetWidth;\n      }\n      node.style.top = top + \"px\";\n      node.style.left = node.style.right = \"\";\n      if (horiz == \"right\") {\n        left = display.sizer.clientWidth - node.offsetWidth;\n        node.style.right = \"0px\";\n      } else {\n        if (horiz == \"left\") left = 0;\n        else if (horiz == \"middle\") left = (display.sizer.clientWidth - node.offsetWidth) / 2;\n        node.style.left = left + \"px\";\n      }\n      if (scroll)\n        scrollIntoView(this, left, top, left + node.offsetWidth, top + node.offsetHeight);\n    },\n\n    triggerOnKeyDown: methodOp(onKeyDown),\n    triggerOnKeyPress: methodOp(onKeyPress),\n    triggerOnKeyUp: onKeyUp,\n\n    execCommand: function(cmd) {\n      if (commands.hasOwnProperty(cmd))\n        return commands[cmd](this);\n    },\n\n    findPosH: function(from, amount, unit, visually) {\n      var dir = 1;\n      if (amount < 0) { dir = -1; amount = -amount; }\n      for (var i = 0, cur = clipPos(this.doc, from); i < amount; ++i) {\n        cur = findPosH(this.doc, cur, dir, unit, visually);\n        if (cur.hitSide) break;\n      }\n      return cur;\n    },\n\n    moveH: methodOp(function(dir, unit) {\n      var cm = this;\n      cm.extendSelectionsBy(function(range) {\n        if (cm.display.shift || cm.doc.extend || range.empty())\n          return findPosH(cm.doc, range.head, dir, unit, cm.options.rtlMoveVisually);\n        else\n          return dir < 0 ? range.from() : range.to();\n      }, sel_move);\n    }),\n\n    deleteH: methodOp(function(dir, unit) {\n      var sel = this.doc.sel, doc = this.doc;\n      if (sel.somethingSelected())\n        doc.replaceSelection(\"\", null, \"+delete\");\n      else\n        deleteNearSelection(this, function(range) {\n          var other = findPosH(doc, range.head, dir, unit, false);\n          return dir < 0 ? {from: other, to: range.head} : {from: range.head, to: other};\n        });\n    }),\n\n    findPosV: function(from, amount, unit, goalColumn) {\n      var dir = 1, x = goalColumn;\n      if (amount < 0) { dir = -1; amount = -amount; }\n      for (var i = 0, cur = clipPos(this.doc, from); i < amount; ++i) {\n        var coords = cursorCoords(this, cur, \"div\");\n        if (x == null) x = coords.left;\n        else coords.left = x;\n        cur = findPosV(this, coords, dir, unit);\n        if (cur.hitSide) break;\n      }\n      return cur;\n    },\n\n    moveV: methodOp(function(dir, unit) {\n      var cm = this, doc = this.doc, goals = [];\n      var collapse = !cm.display.shift && !doc.extend && doc.sel.somethingSelected();\n      doc.extendSelectionsBy(function(range) {\n        if (collapse)\n          return dir < 0 ? range.from() : range.to();\n        var headPos = cursorCoords(cm, range.head, \"div\");\n        if (range.goalColumn != null) headPos.left = range.goalColumn;\n        goals.push(headPos.left);\n        var pos = findPosV(cm, headPos, dir, unit);\n        if (unit == \"page\" && range == doc.sel.primary())\n          addToScrollPos(cm, null, charCoords(cm, pos, \"div\").top - headPos.top);\n        return pos;\n      }, sel_move);\n      if (goals.length) for (var i = 0; i < doc.sel.ranges.length; i++)\n        doc.sel.ranges[i].goalColumn = goals[i];\n    }),\n\n    // Find the word at the given position (as returned by coordsChar).\n    findWordAt: function(pos) {\n      var doc = this.doc, line = getLine(doc, pos.line).text;\n      var start = pos.ch, end = pos.ch;\n      if (line) {\n        var helper = this.getHelper(pos, \"wordChars\");\n        if ((pos.xRel < 0 || end == line.length) && start) --start; else ++end;\n        var startChar = line.charAt(start);\n        var check = isWordChar(startChar, helper)\n          ? function(ch) { return isWordChar(ch, helper); }\n          : /\\s/.test(startChar) ? function(ch) {return /\\s/.test(ch);}\n          : function(ch) {return !/\\s/.test(ch) && !isWordChar(ch);};\n        while (start > 0 && check(line.charAt(start - 1))) --start;\n        while (end < line.length && check(line.charAt(end))) ++end;\n      }\n      return new Range(Pos(pos.line, start), Pos(pos.line, end));\n    },\n\n    toggleOverwrite: function(value) {\n      if (value != null && value == this.state.overwrite) return;\n      if (this.state.overwrite = !this.state.overwrite)\n        addClass(this.display.cursorDiv, \"CodeMirror-overwrite\");\n      else\n        rmClass(this.display.cursorDiv, \"CodeMirror-overwrite\");\n\n      signal(this, \"overwriteToggle\", this, this.state.overwrite);\n    },\n    hasFocus: function() { return activeElt() == this.display.input; },\n\n    scrollTo: methodOp(function(x, y) {\n      if (x != null || y != null) resolveScrollToPos(this);\n      if (x != null) this.curOp.scrollLeft = x;\n      if (y != null) this.curOp.scrollTop = y;\n    }),\n    getScrollInfo: function() {\n      var scroller = this.display.scroller, co = scrollerCutOff;\n      return {left: scroller.scrollLeft, top: scroller.scrollTop,\n              height: scroller.scrollHeight - co, width: scroller.scrollWidth - co,\n              clientHeight: scroller.clientHeight - co, clientWidth: scroller.clientWidth - co};\n    },\n\n    scrollIntoView: methodOp(function(range, margin) {\n      if (range == null) {\n        range = {from: this.doc.sel.primary().head, to: null};\n        if (margin == null) margin = this.options.cursorScrollMargin;\n      } else if (typeof range == \"number\") {\n        range = {from: Pos(range, 0), to: null};\n      } else if (range.from == null) {\n        range = {from: range, to: null};\n      }\n      if (!range.to) range.to = range.from;\n      range.margin = margin || 0;\n\n      if (range.from.line != null) {\n        resolveScrollToPos(this);\n        this.curOp.scrollToPos = range;\n      } else {\n        var sPos = calculateScrollPos(this, Math.min(range.from.left, range.to.left),\n                                      Math.min(range.from.top, range.to.top) - range.margin,\n                                      Math.max(range.from.right, range.to.right),\n                                      Math.max(range.from.bottom, range.to.bottom) + range.margin);\n        this.scrollTo(sPos.scrollLeft, sPos.scrollTop);\n      }\n    }),\n\n    setSize: methodOp(function(width, height) {\n      var cm = this;\n      function interpret(val) {\n        return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val;\n      }\n      if (width != null) cm.display.wrapper.style.width = interpret(width);\n      if (height != null) cm.display.wrapper.style.height = interpret(height);\n      if (cm.options.lineWrapping) clearLineMeasurementCache(this);\n      var lineNo = cm.display.viewFrom;\n      cm.doc.iter(lineNo, cm.display.viewTo, function(line) {\n        if (line.widgets) for (var i = 0; i < line.widgets.length; i++)\n          if (line.widgets[i].noHScroll) { regLineChange(cm, lineNo, \"widget\"); break; }\n        ++lineNo;\n      });\n      cm.curOp.forceUpdate = true;\n      signal(cm, \"refresh\", this);\n    }),\n\n    operation: function(f){return runInOp(this, f);},\n\n    refresh: methodOp(function() {\n      var oldHeight = this.display.cachedTextHeight;\n      regChange(this);\n      this.curOp.forceUpdate = true;\n      clearCaches(this);\n      this.scrollTo(this.doc.scrollLeft, this.doc.scrollTop);\n      updateGutterSpace(this);\n      if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5)\n        estimateLineHeights(this);\n      signal(this, \"refresh\", this);\n    }),\n\n    swapDoc: methodOp(function(doc) {\n      var old = this.doc;\n      old.cm = null;\n      attachDoc(this, doc);\n      clearCaches(this);\n      resetInput(this);\n      this.scrollTo(doc.scrollLeft, doc.scrollTop);\n      this.curOp.forceScroll = true;\n      signalLater(this, \"swapDoc\", this, old);\n      return old;\n    }),\n\n    getInputField: function(){return this.display.input;},\n    getWrapperElement: function(){return this.display.wrapper;},\n    getScrollerElement: function(){return this.display.scroller;},\n    getGutterElement: function(){return this.display.gutters;}\n  };\n  eventMixin(CodeMirror);\n\n  // OPTION DEFAULTS\n\n  // The default configuration options.\n  var defaults = CodeMirror.defaults = {};\n  // Functions to run when options are changed.\n  var optionHandlers = CodeMirror.optionHandlers = {};\n\n  function option(name, deflt, handle, notOnInit) {\n    CodeMirror.defaults[name] = deflt;\n    if (handle) optionHandlers[name] =\n      notOnInit ? function(cm, val, old) {if (old != Init) handle(cm, val, old);} : handle;\n  }\n\n  // Passed to option handlers when there is no old value.\n  var Init = CodeMirror.Init = {toString: function(){return \"CodeMirror.Init\";}};\n\n  // These two are, on init, called from the constructor because they\n  // have to be initialized before the editor can start at all.\n  option(\"value\", \"\", function(cm, val) {\n    cm.setValue(val);\n  }, true);\n  option(\"mode\", null, function(cm, val) {\n    cm.doc.modeOption = val;\n    loadMode(cm);\n  }, true);\n\n  option(\"indentUnit\", 2, loadMode, true);\n  option(\"indentWithTabs\", false);\n  option(\"smartIndent\", true);\n  option(\"tabSize\", 4, function(cm) {\n    resetModeState(cm);\n    clearCaches(cm);\n    regChange(cm);\n  }, true);\n  option(\"specialChars\", /[\\t\\u0000-\\u0019\\u00ad\\u200b-\\u200f\\u2028\\u2029\\ufeff]/g, function(cm, val) {\n    cm.options.specialChars = new RegExp(val.source + (val.test(\"\\t\") ? \"\" : \"|\\t\"), \"g\");\n    cm.refresh();\n  }, true);\n  option(\"specialCharPlaceholder\", defaultSpecialCharPlaceholder, function(cm) {cm.refresh();}, true);\n  option(\"electricChars\", true);\n  option(\"rtlMoveVisually\", !windows);\n  option(\"wholeLineUpdateBefore\", true);\n\n  option(\"theme\", \"default\", function(cm) {\n    themeChanged(cm);\n    guttersChanged(cm);\n  }, true);\n  option(\"keyMap\", \"default\", keyMapChanged);\n  option(\"extraKeys\", null);\n\n  option(\"lineWrapping\", false, wrappingChanged, true);\n  option(\"gutters\", [], function(cm) {\n    setGuttersForLineNumbers(cm.options);\n    guttersChanged(cm);\n  }, true);\n  option(\"fixedGutter\", true, function(cm, val) {\n    cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + \"px\" : \"0\";\n    cm.refresh();\n  }, true);\n  option(\"coverGutterNextToScrollbar\", false, updateScrollbars, true);\n  option(\"lineNumbers\", false, function(cm) {\n    setGuttersForLineNumbers(cm.options);\n    guttersChanged(cm);\n  }, true);\n  option(\"firstLineNumber\", 1, guttersChanged, true);\n  option(\"lineNumberFormatter\", function(integer) {return integer;}, guttersChanged, true);\n  option(\"showCursorWhenSelecting\", false, updateSelection, true);\n\n  option(\"resetSelectionOnContextMenu\", true);\n\n  option(\"readOnly\", false, function(cm, val) {\n    if (val == \"nocursor\") {\n      onBlur(cm);\n      cm.display.input.blur();\n      cm.display.disabled = true;\n    } else {\n      cm.display.disabled = false;\n      if (!val) resetInput(cm);\n    }\n  });\n  option(\"disableInput\", false, function(cm, val) {if (!val) resetInput(cm);}, true);\n  option(\"dragDrop\", true);\n\n  option(\"cursorBlinkRate\", 530);\n  option(\"cursorScrollMargin\", 0);\n  option(\"cursorHeight\", 1, updateSelection, true);\n  option(\"singleCursorHeightPerLine\", true, updateSelection, true);\n  option(\"workTime\", 100);\n  option(\"workDelay\", 100);\n  option(\"flattenSpans\", true, resetModeState, true);\n  option(\"addModeClass\", false, resetModeState, true);\n  option(\"pollInterval\", 100);\n  option(\"undoDepth\", 200, function(cm, val){cm.doc.history.undoDepth = val;});\n  option(\"historyEventDelay\", 1250);\n  option(\"viewportMargin\", 10, function(cm){cm.refresh();}, true);\n  option(\"maxHighlightLength\", 10000, resetModeState, true);\n  option(\"moveInputWithCursor\", true, function(cm, val) {\n    if (!val) cm.display.inputDiv.style.top = cm.display.inputDiv.style.left = 0;\n  });\n\n  option(\"tabindex\", null, function(cm, val) {\n    cm.display.input.tabIndex = val || \"\";\n  });\n  option(\"autofocus\", null);\n\n  // MODE DEFINITION AND QUERYING\n\n  // Known modes, by name and by MIME\n  var modes = CodeMirror.modes = {}, mimeModes = CodeMirror.mimeModes = {};\n\n  // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n  CodeMirror.defineMode = function(name, mode) {\n    if (!CodeMirror.defaults.mode && name != \"null\") CodeMirror.defaults.mode = name;\n    if (arguments.length > 2)\n      mode.dependencies = Array.prototype.slice.call(arguments, 2);\n    modes[name] = mode;\n  };\n\n  CodeMirror.defineMIME = function(mime, spec) {\n    mimeModes[mime] = spec;\n  };\n\n  // Given a MIME type, a {name, ...options} config object, or a name\n  // string, return a mode config object.\n  CodeMirror.resolveMode = function(spec) {\n    if (typeof spec == \"string\" && mimeModes.hasOwnProperty(spec)) {\n      spec = mimeModes[spec];\n    } else if (spec && typeof spec.name == \"string\" && mimeModes.hasOwnProperty(spec.name)) {\n      var found = mimeModes[spec.name];\n      if (typeof found == \"string\") found = {name: found};\n      spec = createObj(found, spec);\n      spec.name = found.name;\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\n      return CodeMirror.resolveMode(\"application/xml\");\n    }\n    if (typeof spec == \"string\") return {name: spec};\n    else return spec || {name: \"null\"};\n  };\n\n  // Given a mode spec (anything that resolveMode accepts), find and\n  // initialize an actual mode object.\n  CodeMirror.getMode = function(options, spec) {\n    var spec = CodeMirror.resolveMode(spec);\n    var mfactory = modes[spec.name];\n    if (!mfactory) return CodeMirror.getMode(options, \"text/plain\");\n    var modeObj = mfactory(options, spec);\n    if (modeExtensions.hasOwnProperty(spec.name)) {\n      var exts = modeExtensions[spec.name];\n      for (var prop in exts) {\n        if (!exts.hasOwnProperty(prop)) continue;\n        if (modeObj.hasOwnProperty(prop)) modeObj[\"_\" + prop] = modeObj[prop];\n        modeObj[prop] = exts[prop];\n      }\n    }\n    modeObj.name = spec.name;\n    if (spec.helperType) modeObj.helperType = spec.helperType;\n    if (spec.modeProps) for (var prop in spec.modeProps)\n      modeObj[prop] = spec.modeProps[prop];\n\n    return modeObj;\n  };\n\n  // Minimal default mode.\n  CodeMirror.defineMode(\"null\", function() {\n    return {token: function(stream) {stream.skipToEnd();}};\n  });\n  CodeMirror.defineMIME(\"text/plain\", \"null\");\n\n  // This can be used to attach properties to mode objects from\n  // outside the actual mode definition.\n  var modeExtensions = CodeMirror.modeExtensions = {};\n  CodeMirror.extendMode = function(mode, properties) {\n    var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : (modeExtensions[mode] = {});\n    copyObj(properties, exts);\n  };\n\n  // EXTENSIONS\n\n  CodeMirror.defineExtension = function(name, func) {\n    CodeMirror.prototype[name] = func;\n  };\n  CodeMirror.defineDocExtension = function(name, func) {\n    Doc.prototype[name] = func;\n  };\n  CodeMirror.defineOption = option;\n\n  var initHooks = [];\n  CodeMirror.defineInitHook = function(f) {initHooks.push(f);};\n\n  var helpers = CodeMirror.helpers = {};\n  CodeMirror.registerHelper = function(type, name, value) {\n    if (!helpers.hasOwnProperty(type)) helpers[type] = CodeMirror[type] = {_global: []};\n    helpers[type][name] = value;\n  };\n  CodeMirror.registerGlobalHelper = function(type, name, predicate, value) {\n    CodeMirror.registerHelper(type, name, value);\n    helpers[type]._global.push({pred: predicate, val: value});\n  };\n\n  // MODE STATE HANDLING\n\n  // Utility functions for working with state. Exported because nested\n  // modes need to do this for their inner modes.\n\n  var copyState = CodeMirror.copyState = function(mode, state) {\n    if (state === true) return state;\n    if (mode.copyState) return mode.copyState(state);\n    var nstate = {};\n    for (var n in state) {\n      var val = state[n];\n      if (val instanceof Array) val = val.concat([]);\n      nstate[n] = val;\n    }\n    return nstate;\n  };\n\n  var startState = CodeMirror.startState = function(mode, a1, a2) {\n    return mode.startState ? mode.startState(a1, a2) : true;\n  };\n\n  // Given a mode and a state (for that mode), find the inner mode and\n  // state at the position that the state refers to.\n  CodeMirror.innerMode = function(mode, state) {\n    while (mode.innerMode) {\n      var info = mode.innerMode(state);\n      if (!info || info.mode == mode) break;\n      state = info.state;\n      mode = info.mode;\n    }\n    return info || {mode: mode, state: state};\n  };\n\n  // STANDARD COMMANDS\n\n  // Commands are parameter-less actions that can be performed on an\n  // editor, mostly used for keybindings.\n  var commands = CodeMirror.commands = {\n    selectAll: function(cm) {cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()), sel_dontScroll);},\n    singleSelection: function(cm) {\n      cm.setSelection(cm.getCursor(\"anchor\"), cm.getCursor(\"head\"), sel_dontScroll);\n    },\n    killLine: function(cm) {\n      deleteNearSelection(cm, function(range) {\n        if (range.empty()) {\n          var len = getLine(cm.doc, range.head.line).text.length;\n          if (range.head.ch == len && range.head.line < cm.lastLine())\n            return {from: range.head, to: Pos(range.head.line + 1, 0)};\n          else\n            return {from: range.head, to: Pos(range.head.line, len)};\n        } else {\n          return {from: range.from(), to: range.to()};\n        }\n      });\n    },\n    deleteLine: function(cm) {\n      deleteNearSelection(cm, function(range) {\n        return {from: Pos(range.from().line, 0),\n                to: clipPos(cm.doc, Pos(range.to().line + 1, 0))};\n      });\n    },\n    delLineLeft: function(cm) {\n      deleteNearSelection(cm, function(range) {\n        return {from: Pos(range.from().line, 0), to: range.from()};\n      });\n    },\n    delWrappedLineLeft: function(cm) {\n      deleteNearSelection(cm, function(range) {\n        var top = cm.charCoords(range.head, \"div\").top + 5;\n        var leftPos = cm.coordsChar({left: 0, top: top}, \"div\");\n        return {from: leftPos, to: range.from()};\n      });\n    },\n    delWrappedLineRight: function(cm) {\n      deleteNearSelection(cm, function(range) {\n        var top = cm.charCoords(range.head, \"div\").top + 5;\n        var rightPos = cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\");\n        return {from: range.from(), to: rightPos };\n      });\n    },\n    undo: function(cm) {cm.undo();},\n    redo: function(cm) {cm.redo();},\n    undoSelection: function(cm) {cm.undoSelection();},\n    redoSelection: function(cm) {cm.redoSelection();},\n    goDocStart: function(cm) {cm.extendSelection(Pos(cm.firstLine(), 0));},\n    goDocEnd: function(cm) {cm.extendSelection(Pos(cm.lastLine()));},\n    goLineStart: function(cm) {\n      cm.extendSelectionsBy(function(range) { return lineStart(cm, range.head.line); },\n                            {origin: \"+move\", bias: 1});\n    },\n    goLineStartSmart: function(cm) {\n      cm.extendSelectionsBy(function(range) {\n        return lineStartSmart(cm, range.head);\n      }, {origin: \"+move\", bias: 1});\n    },\n    goLineEnd: function(cm) {\n      cm.extendSelectionsBy(function(range) { return lineEnd(cm, range.head.line); },\n                            {origin: \"+move\", bias: -1});\n    },\n    goLineRight: function(cm) {\n      cm.extendSelectionsBy(function(range) {\n        var top = cm.charCoords(range.head, \"div\").top + 5;\n        return cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\");\n      }, sel_move);\n    },\n    goLineLeft: function(cm) {\n      cm.extendSelectionsBy(function(range) {\n        var top = cm.charCoords(range.head, \"div\").top + 5;\n        return cm.coordsChar({left: 0, top: top}, \"div\");\n      }, sel_move);\n    },\n    goLineLeftSmart: function(cm) {\n      cm.extendSelectionsBy(function(range) {\n        var top = cm.charCoords(range.head, \"div\").top + 5;\n        var pos = cm.coordsChar({left: 0, top: top}, \"div\");\n        if (pos.ch < cm.getLine(pos.line).search(/\\S/)) return lineStartSmart(cm, range.head);\n        return pos;\n      }, sel_move);\n    },\n    goLineUp: function(cm) {cm.moveV(-1, \"line\");},\n    goLineDown: function(cm) {cm.moveV(1, \"line\");},\n    goPageUp: function(cm) {cm.moveV(-1, \"page\");},\n    goPageDown: function(cm) {cm.moveV(1, \"page\");},\n    goCharLeft: function(cm) {cm.moveH(-1, \"char\");},\n    goCharRight: function(cm) {cm.moveH(1, \"char\");},\n    goColumnLeft: function(cm) {cm.moveH(-1, \"column\");},\n    goColumnRight: function(cm) {cm.moveH(1, \"column\");},\n    goWordLeft: function(cm) {cm.moveH(-1, \"word\");},\n    goGroupRight: function(cm) {cm.moveH(1, \"group\");},\n    goGroupLeft: function(cm) {cm.moveH(-1, \"group\");},\n    goWordRight: function(cm) {cm.moveH(1, \"word\");},\n    delCharBefore: function(cm) {cm.deleteH(-1, \"char\");},\n    delCharAfter: function(cm) {cm.deleteH(1, \"char\");},\n    delWordBefore: function(cm) {cm.deleteH(-1, \"word\");},\n    delWordAfter: function(cm) {cm.deleteH(1, \"word\");},\n    delGroupBefore: function(cm) {cm.deleteH(-1, \"group\");},\n    delGroupAfter: function(cm) {cm.deleteH(1, \"group\");},\n    indentAuto: function(cm) {cm.indentSelection(\"smart\");},\n    indentMore: function(cm) {cm.indentSelection(\"add\");},\n    indentLess: function(cm) {cm.indentSelection(\"subtract\");},\n    insertTab: function(cm) {cm.replaceSelection(\"\\t\");},\n    insertSoftTab: function(cm) {\n      var spaces = [], ranges = cm.listSelections(), tabSize = cm.options.tabSize;\n      for (var i = 0; i < ranges.length; i++) {\n        var pos = ranges[i].from();\n        var col = countColumn(cm.getLine(pos.line), pos.ch, tabSize);\n        spaces.push(new Array(tabSize - col % tabSize + 1).join(\" \"));\n      }\n      cm.replaceSelections(spaces);\n    },\n    defaultTab: function(cm) {\n      if (cm.somethingSelected()) cm.indentSelection(\"add\");\n      else cm.execCommand(\"insertTab\");\n    },\n    transposeChars: function(cm) {\n      runInOp(cm, function() {\n        var ranges = cm.listSelections(), newSel = [];\n        for (var i = 0; i < ranges.length; i++) {\n          var cur = ranges[i].head, line = getLine(cm.doc, cur.line).text;\n          if (line) {\n            if (cur.ch == line.length) cur = new Pos(cur.line, cur.ch - 1);\n            if (cur.ch > 0) {\n              cur = new Pos(cur.line, cur.ch + 1);\n              cm.replaceRange(line.charAt(cur.ch - 1) + line.charAt(cur.ch - 2),\n                              Pos(cur.line, cur.ch - 2), cur, \"+transpose\");\n            } else if (cur.line > cm.doc.first) {\n              var prev = getLine(cm.doc, cur.line - 1).text;\n              if (prev)\n                cm.replaceRange(line.charAt(0) + \"\\n\" + prev.charAt(prev.length - 1),\n                                Pos(cur.line - 1, prev.length - 1), Pos(cur.line, 1), \"+transpose\");\n            }\n          }\n          newSel.push(new Range(cur, cur));\n        }\n        cm.setSelections(newSel);\n      });\n    },\n    newlineAndIndent: function(cm) {\n      runInOp(cm, function() {\n        var len = cm.listSelections().length;\n        for (var i = 0; i < len; i++) {\n          var range = cm.listSelections()[i];\n          cm.replaceRange(\"\\n\", range.anchor, range.head, \"+input\");\n          cm.indentLine(range.from().line + 1, null, true);\n          ensureCursorVisible(cm);\n        }\n      });\n    },\n    toggleOverwrite: function(cm) {cm.toggleOverwrite();}\n  };\n\n  // STANDARD KEYMAPS\n\n  var keyMap = CodeMirror.keyMap = {};\n  keyMap.basic = {\n    \"Left\": \"goCharLeft\", \"Right\": \"goCharRight\", \"Up\": \"goLineUp\", \"Down\": \"goLineDown\",\n    \"End\": \"goLineEnd\", \"Home\": \"goLineStartSmart\", \"PageUp\": \"goPageUp\", \"PageDown\": \"goPageDown\",\n    \"Delete\": \"delCharAfter\", \"Backspace\": \"delCharBefore\", \"Shift-Backspace\": \"delCharBefore\",\n    \"Tab\": \"defaultTab\", \"Shift-Tab\": \"indentAuto\",\n    \"Enter\": \"newlineAndIndent\", \"Insert\": \"toggleOverwrite\",\n    \"Esc\": \"singleSelection\"\n  };\n  // Note that the save and find-related commands aren't defined by\n  // default. User code or addons can define them. Unknown commands\n  // are simply ignored.\n  keyMap.pcDefault = {\n    \"Ctrl-A\": \"selectAll\", \"Ctrl-D\": \"deleteLine\", \"Ctrl-Z\": \"undo\", \"Shift-Ctrl-Z\": \"redo\", \"Ctrl-Y\": \"redo\",\n    \"Ctrl-Home\": \"goDocStart\", \"Ctrl-End\": \"goDocEnd\", \"Ctrl-Up\": \"goLineUp\", \"Ctrl-Down\": \"goLineDown\",\n    \"Ctrl-Left\": \"goGroupLeft\", \"Ctrl-Right\": \"goGroupRight\", \"Alt-Left\": \"goLineStart\", \"Alt-Right\": \"goLineEnd\",\n    \"Ctrl-Backspace\": \"delGroupBefore\", \"Ctrl-Delete\": \"delGroupAfter\", \"Ctrl-S\": \"save\", \"Ctrl-F\": \"find\",\n    \"Ctrl-G\": \"findNext\", \"Shift-Ctrl-G\": \"findPrev\", \"Shift-Ctrl-F\": \"replace\", \"Shift-Ctrl-R\": \"replaceAll\",\n    \"Ctrl-[\": \"indentLess\", \"Ctrl-]\": \"indentMore\",\n    \"Ctrl-U\": \"undoSelection\", \"Shift-Ctrl-U\": \"redoSelection\", \"Alt-U\": \"redoSelection\",\n    fallthrough: \"basic\"\n  };\n  keyMap.macDefault = {\n    \"Cmd-A\": \"selectAll\", \"Cmd-D\": \"deleteLine\", \"Cmd-Z\": \"undo\", \"Shift-Cmd-Z\": \"redo\", \"Cmd-Y\": \"redo\",\n    \"Cmd-Home\": \"goDocStart\", \"Cmd-Up\": \"goDocStart\", \"Cmd-End\": \"goDocEnd\", \"Cmd-Down\": \"goDocEnd\", \"Alt-Left\": \"goGroupLeft\",\n    \"Alt-Right\": \"goGroupRight\", \"Cmd-Left\": \"goLineLeft\", \"Cmd-Right\": \"goLineRight\", \"Alt-Backspace\": \"delGroupBefore\",\n    \"Ctrl-Alt-Backspace\": \"delGroupAfter\", \"Alt-Delete\": \"delGroupAfter\", \"Cmd-S\": \"save\", \"Cmd-F\": \"find\",\n    \"Cmd-G\": \"findNext\", \"Shift-Cmd-G\": \"findPrev\", \"Cmd-Alt-F\": \"replace\", \"Shift-Cmd-Alt-F\": \"replaceAll\",\n    \"Cmd-[\": \"indentLess\", \"Cmd-]\": \"indentMore\", \"Cmd-Backspace\": \"delWrappedLineLeft\", \"Cmd-Delete\": \"delWrappedLineRight\",\n    \"Cmd-U\": \"undoSelection\", \"Shift-Cmd-U\": \"redoSelection\", \"Ctrl-Up\": \"goDocStart\", \"Ctrl-Down\": \"goDocEnd\",\n    fallthrough: [\"basic\", \"emacsy\"]\n  };\n  // Very basic readline/emacs-style bindings, which are standard on Mac.\n  keyMap.emacsy = {\n    \"Ctrl-F\": \"goCharRight\", \"Ctrl-B\": \"goCharLeft\", \"Ctrl-P\": \"goLineUp\", \"Ctrl-N\": \"goLineDown\",\n    \"Alt-F\": \"goWordRight\", \"Alt-B\": \"goWordLeft\", \"Ctrl-A\": \"goLineStart\", \"Ctrl-E\": \"goLineEnd\",\n    \"Ctrl-V\": \"goPageDown\", \"Shift-Ctrl-V\": \"goPageUp\", \"Ctrl-D\": \"delCharAfter\", \"Ctrl-H\": \"delCharBefore\",\n    \"Alt-D\": \"delWordAfter\", \"Alt-Backspace\": \"delWordBefore\", \"Ctrl-K\": \"killLine\", \"Ctrl-T\": \"transposeChars\"\n  };\n  keyMap[\"default\"] = mac ? keyMap.macDefault : keyMap.pcDefault;\n\n  // KEYMAP DISPATCH\n\n  function getKeyMap(val) {\n    if (typeof val == \"string\") return keyMap[val];\n    else return val;\n  }\n\n  // Given an array of keymaps and a key name, call handle on any\n  // bindings found, until that returns a truthy value, at which point\n  // we consider the key handled. Implements things like binding a key\n  // to false stopping further handling and keymap fallthrough.\n  var lookupKey = CodeMirror.lookupKey = function(name, maps, handle) {\n    function lookup(map) {\n      map = getKeyMap(map);\n      var found = map[name];\n      if (found === false) return \"stop\";\n      if (found != null && handle(found)) return true;\n      if (map.nofallthrough) return \"stop\";\n\n      var fallthrough = map.fallthrough;\n      if (fallthrough == null) return false;\n      if (Object.prototype.toString.call(fallthrough) != \"[object Array]\")\n        return lookup(fallthrough);\n      for (var i = 0; i < fallthrough.length; ++i) {\n        var done = lookup(fallthrough[i]);\n        if (done) return done;\n      }\n      return false;\n    }\n\n    for (var i = 0; i < maps.length; ++i) {\n      var done = lookup(maps[i]);\n      if (done) return done != \"stop\";\n    }\n  };\n\n  // Modifier key presses don't count as 'real' key presses for the\n  // purpose of keymap fallthrough.\n  var isModifierKey = CodeMirror.isModifierKey = function(event) {\n    var name = keyNames[event.keyCode];\n    return name == \"Ctrl\" || name == \"Alt\" || name == \"Shift\" || name == \"Mod\";\n  };\n\n  // Look up the name of a key as indicated by an event object.\n  var keyName = CodeMirror.keyName = function(event, noShift) {\n    if (presto && event.keyCode == 34 && event[\"char\"]) return false;\n    var name = keyNames[event.keyCode];\n    if (name == null || event.altGraphKey) return false;\n    if (event.altKey) name = \"Alt-\" + name;\n    if (flipCtrlCmd ? event.metaKey : event.ctrlKey) name = \"Ctrl-\" + name;\n    if (flipCtrlCmd ? event.ctrlKey : event.metaKey) name = \"Cmd-\" + name;\n    if (!noShift && event.shiftKey) name = \"Shift-\" + name;\n    return name;\n  };\n\n  // FROMTEXTAREA\n\n  CodeMirror.fromTextArea = function(textarea, options) {\n    if (!options) options = {};\n    options.value = textarea.value;\n    if (!options.tabindex && textarea.tabindex)\n      options.tabindex = textarea.tabindex;\n    if (!options.placeholder && textarea.placeholder)\n      options.placeholder = textarea.placeholder;\n    // Set autofocus to true if this textarea is focused, or if it has\n    // autofocus and no other element is focused.\n    if (options.autofocus == null) {\n      var hasFocus = activeElt();\n      options.autofocus = hasFocus == textarea ||\n        textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body;\n    }\n\n    function save() {textarea.value = cm.getValue();}\n    if (textarea.form) {\n      on(textarea.form, \"submit\", save);\n      // Deplorable hack to make the submit method do the right thing.\n      if (!options.leaveSubmitMethodAlone) {\n        var form = textarea.form, realSubmit = form.submit;\n        try {\n          var wrappedSubmit = form.submit = function() {\n            save();\n            form.submit = realSubmit;\n            form.submit();\n            form.submit = wrappedSubmit;\n          };\n        } catch(e) {}\n      }\n    }\n\n    textarea.style.display = \"none\";\n    var cm = CodeMirror(function(node) {\n      textarea.parentNode.insertBefore(node, textarea.nextSibling);\n    }, options);\n    cm.save = save;\n    cm.getTextArea = function() { return textarea; };\n    cm.toTextArea = function() {\n      cm.toTextArea = isNaN; // Prevent this from being ran twice\n      save();\n      textarea.parentNode.removeChild(cm.getWrapperElement());\n      textarea.style.display = \"\";\n      if (textarea.form) {\n        off(textarea.form, \"submit\", save);\n        if (typeof textarea.form.submit == \"function\")\n          textarea.form.submit = realSubmit;\n      }\n    };\n    return cm;\n  };\n\n  // STRING STREAM\n\n  // Fed to the mode parsers, provides helper functions to make\n  // parsers more succinct.\n\n  var StringStream = CodeMirror.StringStream = function(string, tabSize) {\n    this.pos = this.start = 0;\n    this.string = string;\n    this.tabSize = tabSize || 8;\n    this.lastColumnPos = this.lastColumnValue = 0;\n    this.lineStart = 0;\n  };\n\n  StringStream.prototype = {\n    eol: function() {return this.pos >= this.string.length;},\n    sol: function() {return this.pos == this.lineStart;},\n    peek: function() {return this.string.charAt(this.pos) || undefined;},\n    next: function() {\n      if (this.pos < this.string.length)\n        return this.string.charAt(this.pos++);\n    },\n    eat: function(match) {\n      var ch = this.string.charAt(this.pos);\n      if (typeof match == \"string\") var ok = ch == match;\n      else var ok = ch && (match.test ? match.test(ch) : match(ch));\n      if (ok) {++this.pos; return ch;}\n    },\n    eatWhile: function(match) {\n      var start = this.pos;\n      while (this.eat(match)){}\n      return this.pos > start;\n    },\n    eatSpace: function() {\n      var start = this.pos;\n      while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) ++this.pos;\n      return this.pos > start;\n    },\n    skipToEnd: function() {this.pos = this.string.length;},\n    skipTo: function(ch) {\n      var found = this.string.indexOf(ch, this.pos);\n      if (found > -1) {this.pos = found; return true;}\n    },\n    backUp: function(n) {this.pos -= n;},\n    column: function() {\n      if (this.lastColumnPos < this.start) {\n        this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\n        this.lastColumnPos = this.start;\n      }\n      return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0);\n    },\n    indentation: function() {\n      return countColumn(this.string, null, this.tabSize) -\n        (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0);\n    },\n    match: function(pattern, consume, caseInsensitive) {\n      if (typeof pattern == \"string\") {\n        var cased = function(str) {return caseInsensitive ? str.toLowerCase() : str;};\n        var substr = this.string.substr(this.pos, pattern.length);\n        if (cased(substr) == cased(pattern)) {\n          if (consume !== false) this.pos += pattern.length;\n          return true;\n        }\n      } else {\n        var match = this.string.slice(this.pos).match(pattern);\n        if (match && match.index > 0) return null;\n        if (match && consume !== false) this.pos += match[0].length;\n        return match;\n      }\n    },\n    current: function(){return this.string.slice(this.start, this.pos);},\n    hideFirstChars: function(n, inner) {\n      this.lineStart += n;\n      try { return inner(); }\n      finally { this.lineStart -= n; }\n    }\n  };\n\n  // TEXTMARKERS\n\n  // Created with markText and setBookmark methods. A TextMarker is a\n  // handle that can be used to clear or find a marked position in the\n  // document. Line objects hold arrays (markedSpans) containing\n  // {from, to, marker} object pointing to such marker objects, and\n  // indicating that such a marker is present on that line. Multiple\n  // lines may point to the same marker when it spans across lines.\n  // The spans will have null for their from/to properties when the\n  // marker continues beyond the start/end of the line. Markers have\n  // links back to the lines they currently touch.\n\n  var TextMarker = CodeMirror.TextMarker = function(doc, type) {\n    this.lines = [];\n    this.type = type;\n    this.doc = doc;\n  };\n  eventMixin(TextMarker);\n\n  // Clear the marker.\n  TextMarker.prototype.clear = function() {\n    if (this.explicitlyCleared) return;\n    var cm = this.doc.cm, withOp = cm && !cm.curOp;\n    if (withOp) startOperation(cm);\n    if (hasHandler(this, \"clear\")) {\n      var found = this.find();\n      if (found) signalLater(this, \"clear\", found.from, found.to);\n    }\n    var min = null, max = null;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this);\n      if (cm && !this.collapsed) regLineChange(cm, lineNo(line), \"text\");\n      else if (cm) {\n        if (span.to != null) max = lineNo(line);\n        if (span.from != null) min = lineNo(line);\n      }\n      line.markedSpans = removeMarkedSpan(line.markedSpans, span);\n      if (span.from == null && this.collapsed && !lineIsHidden(this.doc, line) && cm)\n        updateLineHeight(line, textHeight(cm.display));\n    }\n    if (cm && this.collapsed && !cm.options.lineWrapping) for (var i = 0; i < this.lines.length; ++i) {\n      var visual = visualLine(this.lines[i]), len = lineLength(visual);\n      if (len > cm.display.maxLineLength) {\n        cm.display.maxLine = visual;\n        cm.display.maxLineLength = len;\n        cm.display.maxLineChanged = true;\n      }\n    }\n\n    if (min != null && cm && this.collapsed) regChange(cm, min, max + 1);\n    this.lines.length = 0;\n    this.explicitlyCleared = true;\n    if (this.atomic && this.doc.cantEdit) {\n      this.doc.cantEdit = false;\n      if (cm) reCheckSelection(cm.doc);\n    }\n    if (cm) signalLater(cm, \"markerCleared\", cm, this);\n    if (withOp) endOperation(cm);\n    if (this.parent) this.parent.clear();\n  };\n\n  // Find the position of the marker in the document. Returns a {from,\n  // to} object by default. Side can be passed to get a specific side\n  // -- 0 (both), -1 (left), or 1 (right). When lineObj is true, the\n  // Pos objects returned contain a line object, rather than a line\n  // number (used to prevent looking up the same line twice).\n  TextMarker.prototype.find = function(side, lineObj) {\n    if (side == null && this.type == \"bookmark\") side = 1;\n    var from, to;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this);\n      if (span.from != null) {\n        from = Pos(lineObj ? line : lineNo(line), span.from);\n        if (side == -1) return from;\n      }\n      if (span.to != null) {\n        to = Pos(lineObj ? line : lineNo(line), span.to);\n        if (side == 1) return to;\n      }\n    }\n    return from && {from: from, to: to};\n  };\n\n  // Signals that the marker's widget changed, and surrounding layout\n  // should be recomputed.\n  TextMarker.prototype.changed = function() {\n    var pos = this.find(-1, true), widget = this, cm = this.doc.cm;\n    if (!pos || !cm) return;\n    runInOp(cm, function() {\n      var line = pos.line, lineN = lineNo(pos.line);\n      var view = findViewForLine(cm, lineN);\n      if (view) {\n        clearLineMeasurementCacheFor(view);\n        cm.curOp.selectionChanged = cm.curOp.forceUpdate = true;\n      }\n      cm.curOp.updateMaxLine = true;\n      if (!lineIsHidden(widget.doc, line) && widget.height != null) {\n        var oldHeight = widget.height;\n        widget.height = null;\n        var dHeight = widgetHeight(widget) - oldHeight;\n        if (dHeight)\n          updateLineHeight(line, line.height + dHeight);\n      }\n    });\n  };\n\n  TextMarker.prototype.attachLine = function(line) {\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp;\n      if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1)\n        (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this);\n    }\n    this.lines.push(line);\n  };\n  TextMarker.prototype.detachLine = function(line) {\n    this.lines.splice(indexOf(this.lines, line), 1);\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp;\n      (op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this);\n    }\n  };\n\n  // Collapsed markers have unique ids, in order to be able to order\n  // them, which is needed for uniquely determining an outer marker\n  // when they overlap (they may nest, but not partially overlap).\n  var nextMarkerId = 0;\n\n  // Create a marker, wire it up to the right lines, and\n  function markText(doc, from, to, options, type) {\n    // Shared markers (across linked documents) are handled separately\n    // (markTextShared will call out to this again, once per\n    // document).\n    if (options && options.shared) return markTextShared(doc, from, to, options, type);\n    // Ensure we are in an operation.\n    if (doc.cm && !doc.cm.curOp) return operation(doc.cm, markText)(doc, from, to, options, type);\n\n    var marker = new TextMarker(doc, type), diff = cmp(from, to);\n    if (options) copyObj(options, marker, false);\n    // Don't connect empty markers unless clearWhenEmpty is false\n    if (diff > 0 || diff == 0 && marker.clearWhenEmpty !== false)\n      return marker;\n    if (marker.replacedWith) {\n      // Showing up as a widget implies collapsed (widget replaces text)\n      marker.collapsed = true;\n      marker.widgetNode = elt(\"span\", [marker.replacedWith], \"CodeMirror-widget\");\n      if (!options.handleMouseEvents) marker.widgetNode.ignoreEvents = true;\n      if (options.insertLeft) marker.widgetNode.insertLeft = true;\n    }\n    if (marker.collapsed) {\n      if (conflictingCollapsedRange(doc, from.line, from, to, marker) ||\n          from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker))\n        throw new Error(\"Inserting collapsed marker partially overlapping an existing one\");\n      sawCollapsedSpans = true;\n    }\n\n    if (marker.addToHistory)\n      addChangeToHistory(doc, {from: from, to: to, origin: \"markText\"}, doc.sel, NaN);\n\n    var curLine = from.line, cm = doc.cm, updateMaxLine;\n    doc.iter(curLine, to.line + 1, function(line) {\n      if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(line) == cm.display.maxLine)\n        updateMaxLine = true;\n      if (marker.collapsed && curLine != from.line) updateLineHeight(line, 0);\n      addMarkedSpan(line, new MarkedSpan(marker,\n                                         curLine == from.line ? from.ch : null,\n                                         curLine == to.line ? to.ch : null));\n      ++curLine;\n    });\n    // lineIsHidden depends on the presence of the spans, so needs a second pass\n    if (marker.collapsed) doc.iter(from.line, to.line + 1, function(line) {\n      if (lineIsHidden(doc, line)) updateLineHeight(line, 0);\n    });\n\n    if (marker.clearOnEnter) on(marker, \"beforeCursorEnter\", function() { marker.clear(); });\n\n    if (marker.readOnly) {\n      sawReadOnlySpans = true;\n      if (doc.history.done.length || doc.history.undone.length)\n        doc.clearHistory();\n    }\n    if (marker.collapsed) {\n      marker.id = ++nextMarkerId;\n      marker.atomic = true;\n    }\n    if (cm) {\n      // Sync editor state\n      if (updateMaxLine) cm.curOp.updateMaxLine = true;\n      if (marker.collapsed)\n        regChange(cm, from.line, to.line + 1);\n      else if (marker.className || marker.title || marker.startStyle || marker.endStyle)\n        for (var i = from.line; i <= to.line; i++) regLineChange(cm, i, \"text\");\n      if (marker.atomic) reCheckSelection(cm.doc);\n      signalLater(cm, \"markerAdded\", cm, marker);\n    }\n    return marker;\n  }\n\n  // SHARED TEXTMARKERS\n\n  // A shared marker spans multiple linked documents. It is\n  // implemented as a meta-marker-object controlling multiple normal\n  // markers.\n  var SharedTextMarker = CodeMirror.SharedTextMarker = function(markers, primary) {\n    this.markers = markers;\n    this.primary = primary;\n    for (var i = 0; i < markers.length; ++i)\n      markers[i].parent = this;\n  };\n  eventMixin(SharedTextMarker);\n\n  SharedTextMarker.prototype.clear = function() {\n    if (this.explicitlyCleared) return;\n    this.explicitlyCleared = true;\n    for (var i = 0; i < this.markers.length; ++i)\n      this.markers[i].clear();\n    signalLater(this, \"clear\");\n  };\n  SharedTextMarker.prototype.find = function(side, lineObj) {\n    return this.primary.find(side, lineObj);\n  };\n\n  function markTextShared(doc, from, to, options, type) {\n    options = copyObj(options);\n    options.shared = false;\n    var markers = [markText(doc, from, to, options, type)], primary = markers[0];\n    var widget = options.widgetNode;\n    linkedDocs(doc, function(doc) {\n      if (widget) options.widgetNode = widget.cloneNode(true);\n      markers.push(markText(doc, clipPos(doc, from), clipPos(doc, to), options, type));\n      for (var i = 0; i < doc.linked.length; ++i)\n        if (doc.linked[i].isParent) return;\n      primary = lst(markers);\n    });\n    return new SharedTextMarker(markers, primary);\n  }\n\n  function findSharedMarkers(doc) {\n    return doc.findMarks(Pos(doc.first, 0), doc.clipPos(Pos(doc.lastLine())),\n                         function(m) { return m.parent; });\n  }\n\n  function copySharedMarkers(doc, markers) {\n    for (var i = 0; i < markers.length; i++) {\n      var marker = markers[i], pos = marker.find();\n      var mFrom = doc.clipPos(pos.from), mTo = doc.clipPos(pos.to);\n      if (cmp(mFrom, mTo)) {\n        var subMark = markText(doc, mFrom, mTo, marker.primary, marker.primary.type);\n        marker.markers.push(subMark);\n        subMark.parent = marker;\n      }\n    }\n  }\n\n  function detachSharedMarkers(markers) {\n    for (var i = 0; i < markers.length; i++) {\n      var marker = markers[i], linked = [marker.primary.doc];;\n      linkedDocs(marker.primary.doc, function(d) { linked.push(d); });\n      for (var j = 0; j < marker.markers.length; j++) {\n        var subMarker = marker.markers[j];\n        if (indexOf(linked, subMarker.doc) == -1) {\n          subMarker.parent = null;\n          marker.markers.splice(j--, 1);\n        }\n      }\n    }\n  }\n\n  // TEXTMARKER SPANS\n\n  function MarkedSpan(marker, from, to) {\n    this.marker = marker;\n    this.from = from; this.to = to;\n  }\n\n  // Search an array of spans for a span matching the given marker.\n  function getMarkedSpanFor(spans, marker) {\n    if (spans) for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.marker == marker) return span;\n    }\n  }\n  // Remove a span from an array, returning undefined if no spans are\n  // left (we don't store arrays for lines without spans).\n  function removeMarkedSpan(spans, span) {\n    for (var r, i = 0; i < spans.length; ++i)\n      if (spans[i] != span) (r || (r = [])).push(spans[i]);\n    return r;\n  }\n  // Add a span to a line.\n  function addMarkedSpan(line, span) {\n    line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span];\n    span.marker.attachLine(line);\n  }\n\n  // Used for the algorithm that adjusts markers for a change in the\n  // document. These functions cut an array of spans at a given\n  // character position, returning an array of remaining chunks (or\n  // undefined if nothing remains).\n  function markedSpansBefore(old, startCh, isInsert) {\n    if (old) for (var i = 0, nw; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh);\n      if (startsBefore || span.from == startCh && marker.type == \"bookmark\" && (!isInsert || !span.marker.insertLeft)) {\n        var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh);\n        (nw || (nw = [])).push(new MarkedSpan(marker, span.from, endsAfter ? null : span.to));\n      }\n    }\n    return nw;\n  }\n  function markedSpansAfter(old, endCh, isInsert) {\n    if (old) for (var i = 0, nw; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh);\n      if (endsAfter || span.from == endCh && marker.type == \"bookmark\" && (!isInsert || span.marker.insertLeft)) {\n        var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh);\n        (nw || (nw = [])).push(new MarkedSpan(marker, startsBefore ? null : span.from - endCh,\n                                              span.to == null ? null : span.to - endCh));\n      }\n    }\n    return nw;\n  }\n\n  // Given a change object, compute the new set of marker spans that\n  // cover the line in which the change took place. Removes spans\n  // entirely within the change, reconnects spans belonging to the\n  // same marker that appear on both sides of the change, and cuts off\n  // spans partially within the change. Returns an array of span\n  // arrays with one element for each line in (after) the change.\n  function stretchSpansOverChange(doc, change) {\n    var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans;\n    var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans;\n    if (!oldFirst && !oldLast) return null;\n\n    var startCh = change.from.ch, endCh = change.to.ch, isInsert = cmp(change.from, change.to) == 0;\n    // Get the spans that 'stick out' on both sides\n    var first = markedSpansBefore(oldFirst, startCh, isInsert);\n    var last = markedSpansAfter(oldLast, endCh, isInsert);\n\n    // Next, merge those two ends\n    var sameLine = change.text.length == 1, offset = lst(change.text).length + (sameLine ? startCh : 0);\n    if (first) {\n      // Fix up .to properties of first\n      for (var i = 0; i < first.length; ++i) {\n        var span = first[i];\n        if (span.to == null) {\n          var found = getMarkedSpanFor(last, span.marker);\n          if (!found) span.to = startCh;\n          else if (sameLine) span.to = found.to == null ? null : found.to + offset;\n        }\n      }\n    }\n    if (last) {\n      // Fix up .from in last (or move them into first in case of sameLine)\n      for (var i = 0; i < last.length; ++i) {\n        var span = last[i];\n        if (span.to != null) span.to += offset;\n        if (span.from == null) {\n          var found = getMarkedSpanFor(first, span.marker);\n          if (!found) {\n            span.from = offset;\n            if (sameLine) (first || (first = [])).push(span);\n          }\n        } else {\n          span.from += offset;\n          if (sameLine) (first || (first = [])).push(span);\n        }\n      }\n    }\n    // Make sure we didn't create any zero-length spans\n    if (first) first = clearEmptySpans(first);\n    if (last && last != first) last = clearEmptySpans(last);\n\n    var newMarkers = [first];\n    if (!sameLine) {\n      // Fill gap with whole-line-spans\n      var gap = change.text.length - 2, gapMarkers;\n      if (gap > 0 && first)\n        for (var i = 0; i < first.length; ++i)\n          if (first[i].to == null)\n            (gapMarkers || (gapMarkers = [])).push(new MarkedSpan(first[i].marker, null, null));\n      for (var i = 0; i < gap; ++i)\n        newMarkers.push(gapMarkers);\n      newMarkers.push(last);\n    }\n    return newMarkers;\n  }\n\n  // Remove spans that are empty and don't have a clearWhenEmpty\n  // option of false.\n  function clearEmptySpans(spans) {\n    for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false)\n        spans.splice(i--, 1);\n    }\n    if (!spans.length) return null;\n    return spans;\n  }\n\n  // Used for un/re-doing changes from the history. Combines the\n  // result of computing the existing spans with the set of spans that\n  // existed in the history (so that deleting around a span and then\n  // undoing brings back the span).\n  function mergeOldSpans(doc, change) {\n    var old = getOldSpans(doc, change);\n    var stretched = stretchSpansOverChange(doc, change);\n    if (!old) return stretched;\n    if (!stretched) return old;\n\n    for (var i = 0; i < old.length; ++i) {\n      var oldCur = old[i], stretchCur = stretched[i];\n      if (oldCur && stretchCur) {\n        spans: for (var j = 0; j < stretchCur.length; ++j) {\n          var span = stretchCur[j];\n          for (var k = 0; k < oldCur.length; ++k)\n            if (oldCur[k].marker == span.marker) continue spans;\n          oldCur.push(span);\n        }\n      } else if (stretchCur) {\n        old[i] = stretchCur;\n      }\n    }\n    return old;\n  }\n\n  // Used to 'clip' out readOnly ranges when making a change.\n  function removeReadOnlyRanges(doc, from, to) {\n    var markers = null;\n    doc.iter(from.line, to.line + 1, function(line) {\n      if (line.markedSpans) for (var i = 0; i < line.markedSpans.length; ++i) {\n        var mark = line.markedSpans[i].marker;\n        if (mark.readOnly && (!markers || indexOf(markers, mark) == -1))\n          (markers || (markers = [])).push(mark);\n      }\n    });\n    if (!markers) return null;\n    var parts = [{from: from, to: to}];\n    for (var i = 0; i < markers.length; ++i) {\n      var mk = markers[i], m = mk.find(0);\n      for (var j = 0; j < parts.length; ++j) {\n        var p = parts[j];\n        if (cmp(p.to, m.from) < 0 || cmp(p.from, m.to) > 0) continue;\n        var newParts = [j, 1], dfrom = cmp(p.from, m.from), dto = cmp(p.to, m.to);\n        if (dfrom < 0 || !mk.inclusiveLeft && !dfrom)\n          newParts.push({from: p.from, to: m.from});\n        if (dto > 0 || !mk.inclusiveRight && !dto)\n          newParts.push({from: m.to, to: p.to});\n        parts.splice.apply(parts, newParts);\n        j += newParts.length - 1;\n      }\n    }\n    return parts;\n  }\n\n  // Connect or disconnect spans from a line.\n  function detachMarkedSpans(line) {\n    var spans = line.markedSpans;\n    if (!spans) return;\n    for (var i = 0; i < spans.length; ++i)\n      spans[i].marker.detachLine(line);\n    line.markedSpans = null;\n  }\n  function attachMarkedSpans(line, spans) {\n    if (!spans) return;\n    for (var i = 0; i < spans.length; ++i)\n      spans[i].marker.attachLine(line);\n    line.markedSpans = spans;\n  }\n\n  // Helpers used when computing which overlapping collapsed span\n  // counts as the larger one.\n  function extraLeft(marker) { return marker.inclusiveLeft ? -1 : 0; }\n  function extraRight(marker) { return marker.inclusiveRight ? 1 : 0; }\n\n  // Returns a number indicating which of two overlapping collapsed\n  // spans is larger (and thus includes the other). Falls back to\n  // comparing ids when the spans cover exactly the same range.\n  function compareCollapsedMarkers(a, b) {\n    var lenDiff = a.lines.length - b.lines.length;\n    if (lenDiff != 0) return lenDiff;\n    var aPos = a.find(), bPos = b.find();\n    var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b);\n    if (fromCmp) return -fromCmp;\n    var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b);\n    if (toCmp) return toCmp;\n    return b.id - a.id;\n  }\n\n  // Find out whether a line ends or starts in a collapsed span. If\n  // so, return the marker for that span.\n  function collapsedSpanAtSide(line, start) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) for (var sp, i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (sp.marker.collapsed && (start ? sp.from : sp.to) == null &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0))\n        found = sp.marker;\n    }\n    return found;\n  }\n  function collapsedSpanAtStart(line) { return collapsedSpanAtSide(line, true); }\n  function collapsedSpanAtEnd(line) { return collapsedSpanAtSide(line, false); }\n\n  // Test whether there exists a collapsed span that partially\n  // overlaps (covers the start or end, but not both) of a new span.\n  // Such overlap is not allowed.\n  function conflictingCollapsedRange(doc, lineNo, from, to, marker) {\n    var line = getLine(doc, lineNo);\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (!sp.marker.collapsed) continue;\n      var found = sp.marker.find(0);\n      var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker);\n      var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker);\n      if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) continue;\n      if (fromCmp <= 0 && (cmp(found.to, from) > 0 || (sp.marker.inclusiveRight && marker.inclusiveLeft)) ||\n          fromCmp >= 0 && (cmp(found.from, to) < 0 || (sp.marker.inclusiveLeft && marker.inclusiveRight)))\n        return true;\n    }\n  }\n\n  // A visual line is a line as drawn on the screen. Folding, for\n  // example, can cause multiple logical lines to appear on the same\n  // visual line. This finds the start of the visual line that the\n  // given line is part of (usually that is the line itself).\n  function visualLine(line) {\n    var merged;\n    while (merged = collapsedSpanAtStart(line))\n      line = merged.find(-1, true).line;\n    return line;\n  }\n\n  // Returns an array of logical lines that continue the visual line\n  // started by the argument, or undefined if there are no such lines.\n  function visualLineContinued(line) {\n    var merged, lines;\n    while (merged = collapsedSpanAtEnd(line)) {\n      line = merged.find(1, true).line;\n      (lines || (lines = [])).push(line);\n    }\n    return lines;\n  }\n\n  // Get the line number of the start of the visual line that the\n  // given line number is part of.\n  function visualLineNo(doc, lineN) {\n    var line = getLine(doc, lineN), vis = visualLine(line);\n    if (line == vis) return lineN;\n    return lineNo(vis);\n  }\n  // Get the line number of the start of the next visual line after\n  // the given line.\n  function visualLineEndNo(doc, lineN) {\n    if (lineN > doc.lastLine()) return lineN;\n    var line = getLine(doc, lineN), merged;\n    if (!lineIsHidden(doc, line)) return lineN;\n    while (merged = collapsedSpanAtEnd(line))\n      line = merged.find(1, true).line;\n    return lineNo(line) + 1;\n  }\n\n  // Compute whether a line is hidden. Lines count as hidden when they\n  // are part of a visual line that starts with another line, or when\n  // they are entirely covered by collapsed, non-widget span.\n  function lineIsHidden(doc, line) {\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) for (var sp, i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (!sp.marker.collapsed) continue;\n      if (sp.from == null) return true;\n      if (sp.marker.widgetNode) continue;\n      if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp))\n        return true;\n    }\n  }\n  function lineIsHiddenInner(doc, line, span) {\n    if (span.to == null) {\n      var end = span.marker.find(1, true);\n      return lineIsHiddenInner(doc, end.line, getMarkedSpanFor(end.line.markedSpans, span.marker));\n    }\n    if (span.marker.inclusiveRight && span.to == line.text.length)\n      return true;\n    for (var sp, i = 0; i < line.markedSpans.length; ++i) {\n      sp = line.markedSpans[i];\n      if (sp.marker.collapsed && !sp.marker.widgetNode && sp.from == span.to &&\n          (sp.to == null || sp.to != span.from) &&\n          (sp.marker.inclusiveLeft || span.marker.inclusiveRight) &&\n          lineIsHiddenInner(doc, line, sp)) return true;\n    }\n  }\n\n  // LINE WIDGETS\n\n  // Line widgets are block elements displayed above or below a line.\n\n  var LineWidget = CodeMirror.LineWidget = function(cm, node, options) {\n    if (options) for (var opt in options) if (options.hasOwnProperty(opt))\n      this[opt] = options[opt];\n    this.cm = cm;\n    this.node = node;\n  };\n  eventMixin(LineWidget);\n\n  function adjustScrollWhenAboveVisible(cm, line, diff) {\n    if (heightAtLine(line) < ((cm.curOp && cm.curOp.scrollTop) || cm.doc.scrollTop))\n      addToScrollPos(cm, null, diff);\n  }\n\n  LineWidget.prototype.clear = function() {\n    var cm = this.cm, ws = this.line.widgets, line = this.line, no = lineNo(line);\n    if (no == null || !ws) return;\n    for (var i = 0; i < ws.length; ++i) if (ws[i] == this) ws.splice(i--, 1);\n    if (!ws.length) line.widgets = null;\n    var height = widgetHeight(this);\n    runInOp(cm, function() {\n      adjustScrollWhenAboveVisible(cm, line, -height);\n      regLineChange(cm, no, \"widget\");\n      updateLineHeight(line, Math.max(0, line.height - height));\n    });\n  };\n  LineWidget.prototype.changed = function() {\n    var oldH = this.height, cm = this.cm, line = this.line;\n    this.height = null;\n    var diff = widgetHeight(this) - oldH;\n    if (!diff) return;\n    runInOp(cm, function() {\n      cm.curOp.forceUpdate = true;\n      adjustScrollWhenAboveVisible(cm, line, diff);\n      updateLineHeight(line, line.height + diff);\n    });\n  };\n\n  function widgetHeight(widget) {\n    if (widget.height != null) return widget.height;\n    if (!contains(document.body, widget.node)) {\n      var parentStyle = \"position: relative;\";\n      if (widget.coverGutter)\n        parentStyle += \"margin-left: -\" + widget.cm.getGutterElement().offsetWidth + \"px;\";\n      removeChildrenAndAdd(widget.cm.display.measure, elt(\"div\", [widget.node], null, parentStyle));\n    }\n    return widget.height = widget.node.offsetHeight;\n  }\n\n  function addLineWidget(cm, handle, node, options) {\n    var widget = new LineWidget(cm, node, options);\n    if (widget.noHScroll) cm.display.alignWidgets = true;\n    changeLine(cm.doc, handle, \"widget\", function(line) {\n      var widgets = line.widgets || (line.widgets = []);\n      if (widget.insertAt == null) widgets.push(widget);\n      else widgets.splice(Math.min(widgets.length - 1, Math.max(0, widget.insertAt)), 0, widget);\n      widget.line = line;\n      if (!lineIsHidden(cm.doc, line)) {\n        var aboveVisible = heightAtLine(line) < cm.doc.scrollTop;\n        updateLineHeight(line, line.height + widgetHeight(widget));\n        if (aboveVisible) addToScrollPos(cm, null, widget.height);\n        cm.curOp.forceUpdate = true;\n      }\n      return true;\n    });\n    return widget;\n  }\n\n  // LINE DATA STRUCTURE\n\n  // Line objects. These hold state related to a line, including\n  // highlighting info (the styles array).\n  var Line = CodeMirror.Line = function(text, markedSpans, estimateHeight) {\n    this.text = text;\n    attachMarkedSpans(this, markedSpans);\n    this.height = estimateHeight ? estimateHeight(this) : 1;\n  };\n  eventMixin(Line);\n  Line.prototype.lineNo = function() { return lineNo(this); };\n\n  // Change the content (text, markers) of a line. Automatically\n  // invalidates cached information and tries to re-estimate the\n  // line's height.\n  function updateLine(line, text, markedSpans, estimateHeight) {\n    line.text = text;\n    if (line.stateAfter) line.stateAfter = null;\n    if (line.styles) line.styles = null;\n    if (line.order != null) line.order = null;\n    detachMarkedSpans(line);\n    attachMarkedSpans(line, markedSpans);\n    var estHeight = estimateHeight ? estimateHeight(line) : 1;\n    if (estHeight != line.height) updateLineHeight(line, estHeight);\n  }\n\n  // Detach a line from the document tree and its markers.\n  function cleanUpLine(line) {\n    line.parent = null;\n    detachMarkedSpans(line);\n  }\n\n  function extractLineClasses(type, output) {\n    if (type) for (;;) {\n      var lineClass = type.match(/(?:^|\\s+)line-(background-)?(\\S+)/);\n      if (!lineClass) break;\n      type = type.slice(0, lineClass.index) + type.slice(lineClass.index + lineClass[0].length);\n      var prop = lineClass[1] ? \"bgClass\" : \"textClass\";\n      if (output[prop] == null)\n        output[prop] = lineClass[2];\n      else if (!(new RegExp(\"(?:^|\\s)\" + lineClass[2] + \"(?:$|\\s)\")).test(output[prop]))\n        output[prop] += \" \" + lineClass[2];\n    }\n    return type;\n  }\n\n  function callBlankLine(mode, state) {\n    if (mode.blankLine) return mode.blankLine(state);\n    if (!mode.innerMode) return;\n    var inner = CodeMirror.innerMode(mode, state);\n    if (inner.mode.blankLine) return inner.mode.blankLine(inner.state);\n  }\n\n  function readToken(mode, stream, state) {\n    for (var i = 0; i < 10; i++) {\n      var style = mode.token(stream, state);\n      if (stream.pos > stream.start) return style;\n    }\n    throw new Error(\"Mode \" + mode.name + \" failed to advance stream.\");\n  }\n\n  // Run the given mode's parser over a line, calling f for each token.\n  function runMode(cm, text, mode, state, f, lineClasses, forceToEnd) {\n    var flattenSpans = mode.flattenSpans;\n    if (flattenSpans == null) flattenSpans = cm.options.flattenSpans;\n    var curStart = 0, curStyle = null;\n    var stream = new StringStream(text, cm.options.tabSize), style;\n    if (text == \"\") extractLineClasses(callBlankLine(mode, state), lineClasses);\n    while (!stream.eol()) {\n      if (stream.pos > cm.options.maxHighlightLength) {\n        flattenSpans = false;\n        if (forceToEnd) processLine(cm, text, state, stream.pos);\n        stream.pos = text.length;\n        style = null;\n      } else {\n        style = extractLineClasses(readToken(mode, stream, state), lineClasses);\n      }\n      if (cm.options.addModeClass) {\n        var mName = CodeMirror.innerMode(mode, state).mode.name;\n        if (mName) style = \"m-\" + (style ? mName + \" \" + style : mName);\n      }\n      if (!flattenSpans || curStyle != style) {\n        if (curStart < stream.start) f(stream.start, curStyle);\n        curStart = stream.start; curStyle = style;\n      }\n      stream.start = stream.pos;\n    }\n    while (curStart < stream.pos) {\n      // Webkit seems to refuse to render text nodes longer than 57444 characters\n      var pos = Math.min(stream.pos, curStart + 50000);\n      f(pos, curStyle);\n      curStart = pos;\n    }\n  }\n\n  // Compute a style array (an array starting with a mode generation\n  // -- for invalidation -- followed by pairs of end positions and\n  // style strings), which is used to highlight the tokens on the\n  // line.\n  function highlightLine(cm, line, state, forceToEnd) {\n    // A styles array always starts with a number identifying the\n    // mode/overlays that it is based on (for easy invalidation).\n    var st = [cm.state.modeGen], lineClasses = {};\n    // Compute the base array of styles\n    runMode(cm, line.text, cm.doc.mode, state, function(end, style) {\n      st.push(end, style);\n    }, lineClasses, forceToEnd);\n\n    // Run overlays, adjust style array.\n    for (var o = 0; o < cm.state.overlays.length; ++o) {\n      var overlay = cm.state.overlays[o], i = 1, at = 0;\n      runMode(cm, line.text, overlay.mode, true, function(end, style) {\n        var start = i;\n        // Ensure there's a token end at the current position, and that i points at it\n        while (at < end) {\n          var i_end = st[i];\n          if (i_end > end)\n            st.splice(i, 1, end, st[i+1], i_end);\n          i += 2;\n          at = Math.min(end, i_end);\n        }\n        if (!style) return;\n        if (overlay.opaque) {\n          st.splice(start, i - start, end, \"cm-overlay \" + style);\n          i = start + 2;\n        } else {\n          for (; start < i; start += 2) {\n            var cur = st[start+1];\n            st[start+1] = (cur ? cur + \" \" : \"\") + \"cm-overlay \" + style;\n          }\n        }\n      }, lineClasses);\n    }\n\n    return {styles: st, classes: lineClasses.bgClass || lineClasses.textClass ? lineClasses : null};\n  }\n\n  function getLineStyles(cm, line) {\n    if (!line.styles || line.styles[0] != cm.state.modeGen) {\n      var result = highlightLine(cm, line, line.stateAfter = getStateBefore(cm, lineNo(line)));\n      line.styles = result.styles;\n      if (result.classes) line.styleClasses = result.classes;\n      else if (line.styleClasses) line.styleClasses = null;\n    }\n    return line.styles;\n  }\n\n  // Lightweight form of highlight -- proceed over this line and\n  // update state, but don't save a style array. Used for lines that\n  // aren't currently visible.\n  function processLine(cm, text, state, startAt) {\n    var mode = cm.doc.mode;\n    var stream = new StringStream(text, cm.options.tabSize);\n    stream.start = stream.pos = startAt || 0;\n    if (text == \"\") callBlankLine(mode, state);\n    while (!stream.eol() && stream.pos <= cm.options.maxHighlightLength) {\n      readToken(mode, stream, state);\n      stream.start = stream.pos;\n    }\n  }\n\n  // Convert a style as returned by a mode (either null, or a string\n  // containing one or more styles) to a CSS style. This is cached,\n  // and also looks for line-wide styles.\n  var styleToClassCache = {}, styleToClassCacheWithMode = {};\n  function interpretTokenStyle(style, options) {\n    if (!style || /^\\s*$/.test(style)) return null;\n    var cache = options.addModeClass ? styleToClassCacheWithMode : styleToClassCache;\n    return cache[style] ||\n      (cache[style] = style.replace(/\\S+/g, \"cm-$&\"));\n  }\n\n  // Render the DOM representation of the text of a line. Also builds\n  // up a 'line map', which points at the DOM nodes that represent\n  // specific stretches of text, and is used by the measuring code.\n  // The returned object contains the DOM node, this map, and\n  // information about line-wide styles that were set by the mode.\n  function buildLineContent(cm, lineView) {\n    // The padding-right forces the element to have a 'border', which\n    // is needed on Webkit to be able to get line-level bounding\n    // rectangles for it (in measureChar).\n    var content = elt(\"span\", null, null, webkit ? \"padding-right: .1px\" : null);\n    var builder = {pre: elt(\"pre\", [content]), content: content, col: 0, pos: 0, cm: cm};\n    lineView.measure = {};\n\n    // Iterate over the logical lines that make up this visual line.\n    for (var i = 0; i <= (lineView.rest ? lineView.rest.length : 0); i++) {\n      var line = i ? lineView.rest[i - 1] : lineView.line, order;\n      builder.pos = 0;\n      builder.addToken = buildToken;\n      // Optionally wire in some hacks into the token-rendering\n      // algorithm, to deal with browser quirks.\n      if ((ie || webkit) && cm.getOption(\"lineWrapping\"))\n        builder.addToken = buildTokenSplitSpaces(builder.addToken);\n      if (hasBadBidiRects(cm.display.measure) && (order = getOrder(line)))\n        builder.addToken = buildTokenBadBidi(builder.addToken, order);\n      builder.map = [];\n      insertLineContent(line, builder, getLineStyles(cm, line));\n      if (line.styleClasses) {\n        if (line.styleClasses.bgClass)\n          builder.bgClass = joinClasses(line.styleClasses.bgClass, builder.bgClass || \"\");\n        if (line.styleClasses.textClass)\n          builder.textClass = joinClasses(line.styleClasses.textClass, builder.textClass || \"\");\n      }\n\n      // Ensure at least a single node is present, for measuring.\n      if (builder.map.length == 0)\n        builder.map.push(0, 0, builder.content.appendChild(zeroWidthElement(cm.display.measure)));\n\n      // Store the map and a cache object for the current logical line\n      if (i == 0) {\n        lineView.measure.map = builder.map;\n        lineView.measure.cache = {};\n      } else {\n        (lineView.measure.maps || (lineView.measure.maps = [])).push(builder.map);\n        (lineView.measure.caches || (lineView.measure.caches = [])).push({});\n      }\n    }\n\n    signal(cm, \"renderLine\", cm, lineView.line, builder.pre);\n    if (builder.pre.className)\n      builder.textClass = joinClasses(builder.pre.className, builder.textClass || \"\");\n    return builder;\n  }\n\n  function defaultSpecialCharPlaceholder(ch) {\n    var token = elt(\"span\", \"\\u2022\", \"cm-invalidchar\");\n    token.title = \"\\\\u\" + ch.charCodeAt(0).toString(16);\n    return token;\n  }\n\n  // Build up the DOM representation for a single token, and add it to\n  // the line map. Takes care to render special characters separately.\n  function buildToken(builder, text, style, startStyle, endStyle, title) {\n    if (!text) return;\n    var special = builder.cm.options.specialChars, mustWrap = false;\n    if (!special.test(text)) {\n      builder.col += text.length;\n      var content = document.createTextNode(text);\n      builder.map.push(builder.pos, builder.pos + text.length, content);\n      if (ie && ie_version < 9) mustWrap = true;\n      builder.pos += text.length;\n    } else {\n      var content = document.createDocumentFragment(), pos = 0;\n      while (true) {\n        special.lastIndex = pos;\n        var m = special.exec(text);\n        var skipped = m ? m.index - pos : text.length - pos;\n        if (skipped) {\n          var txt = document.createTextNode(text.slice(pos, pos + skipped));\n          if (ie && ie_version < 9) content.appendChild(elt(\"span\", [txt]));\n          else content.appendChild(txt);\n          builder.map.push(builder.pos, builder.pos + skipped, txt);\n          builder.col += skipped;\n          builder.pos += skipped;\n        }\n        if (!m) break;\n        pos += skipped + 1;\n        if (m[0] == \"\\t\") {\n          var tabSize = builder.cm.options.tabSize, tabWidth = tabSize - builder.col % tabSize;\n          var txt = content.appendChild(elt(\"span\", spaceStr(tabWidth), \"cm-tab\"));\n          builder.col += tabWidth;\n        } else {\n          var txt = builder.cm.options.specialCharPlaceholder(m[0]);\n          if (ie && ie_version < 9) content.appendChild(elt(\"span\", [txt]));\n          else content.appendChild(txt);\n          builder.col += 1;\n        }\n        builder.map.push(builder.pos, builder.pos + 1, txt);\n        builder.pos++;\n      }\n    }\n    if (style || startStyle || endStyle || mustWrap) {\n      var fullStyle = style || \"\";\n      if (startStyle) fullStyle += startStyle;\n      if (endStyle) fullStyle += endStyle;\n      var token = elt(\"span\", [content], fullStyle);\n      if (title) token.title = title;\n      return builder.content.appendChild(token);\n    }\n    builder.content.appendChild(content);\n  }\n\n  function buildTokenSplitSpaces(inner) {\n    function split(old) {\n      var out = \" \";\n      for (var i = 0; i < old.length - 2; ++i) out += i % 2 ? \" \" : \"\\u00a0\";\n      out += \" \";\n      return out;\n    }\n    return function(builder, text, style, startStyle, endStyle, title) {\n      inner(builder, text.replace(/ {3,}/g, split), style, startStyle, endStyle, title);\n    };\n  }\n\n  // Work around nonsense dimensions being reported for stretches of\n  // right-to-left text.\n  function buildTokenBadBidi(inner, order) {\n    return function(builder, text, style, startStyle, endStyle, title) {\n      style = style ? style + \" cm-force-border\" : \"cm-force-border\";\n      var start = builder.pos, end = start + text.length;\n      for (;;) {\n        // Find the part that overlaps with the start of this text\n        for (var i = 0; i < order.length; i++) {\n          var part = order[i];\n          if (part.to > start && part.from <= start) break;\n        }\n        if (part.to >= end) return inner(builder, text, style, startStyle, endStyle, title);\n        inner(builder, text.slice(0, part.to - start), style, startStyle, null, title);\n        startStyle = null;\n        text = text.slice(part.to - start);\n        start = part.to;\n      }\n    };\n  }\n\n  function buildCollapsedSpan(builder, size, marker, ignoreWidget) {\n    var widget = !ignoreWidget && marker.widgetNode;\n    if (widget) {\n      builder.map.push(builder.pos, builder.pos + size, widget);\n      builder.content.appendChild(widget);\n    }\n    builder.pos += size;\n  }\n\n  // Outputs a number of spans to make up a line, taking highlighting\n  // and marked text into account.\n  function insertLineContent(line, builder, styles) {\n    var spans = line.markedSpans, allText = line.text, at = 0;\n    if (!spans) {\n      for (var i = 1; i < styles.length; i+=2)\n        builder.addToken(builder, allText.slice(at, at = styles[i]), interpretTokenStyle(styles[i+1], builder.cm.options));\n      return;\n    }\n\n    var len = allText.length, pos = 0, i = 1, text = \"\", style;\n    var nextChange = 0, spanStyle, spanEndStyle, spanStartStyle, title, collapsed;\n    for (;;) {\n      if (nextChange == pos) { // Update current marker set\n        spanStyle = spanEndStyle = spanStartStyle = title = \"\";\n        collapsed = null; nextChange = Infinity;\n        var foundBookmarks = [];\n        for (var j = 0; j < spans.length; ++j) {\n          var sp = spans[j], m = sp.marker;\n          if (sp.from <= pos && (sp.to == null || sp.to > pos)) {\n            if (sp.to != null && nextChange > sp.to) { nextChange = sp.to; spanEndStyle = \"\"; }\n            if (m.className) spanStyle += \" \" + m.className;\n            if (m.startStyle && sp.from == pos) spanStartStyle += \" \" + m.startStyle;\n            if (m.endStyle && sp.to == nextChange) spanEndStyle += \" \" + m.endStyle;\n            if (m.title && !title) title = m.title;\n            if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0))\n              collapsed = sp;\n          } else if (sp.from > pos && nextChange > sp.from) {\n            nextChange = sp.from;\n          }\n          if (m.type == \"bookmark\" && sp.from == pos && m.widgetNode) foundBookmarks.push(m);\n        }\n        if (collapsed && (collapsed.from || 0) == pos) {\n          buildCollapsedSpan(builder, (collapsed.to == null ? len + 1 : collapsed.to) - pos,\n                             collapsed.marker, collapsed.from == null);\n          if (collapsed.to == null) return;\n        }\n        if (!collapsed && foundBookmarks.length) for (var j = 0; j < foundBookmarks.length; ++j)\n          buildCollapsedSpan(builder, 0, foundBookmarks[j]);\n      }\n      if (pos >= len) break;\n\n      var upto = Math.min(len, nextChange);\n      while (true) {\n        if (text) {\n          var end = pos + text.length;\n          if (!collapsed) {\n            var tokenText = end > upto ? text.slice(0, upto - pos) : text;\n            builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle,\n                             spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : \"\", title);\n          }\n          if (end >= upto) {text = text.slice(upto - pos); pos = upto; break;}\n          pos = end;\n          spanStartStyle = \"\";\n        }\n        text = allText.slice(at, at = styles[i++]);\n        style = interpretTokenStyle(styles[i++], builder.cm.options);\n      }\n    }\n  }\n\n  // DOCUMENT DATA STRUCTURE\n\n  // By default, updates that start and end at the beginning of a line\n  // are treated specially, in order to make the association of line\n  // widgets and marker elements with the text behave more intuitive.\n  function isWholeLineUpdate(doc, change) {\n    return change.from.ch == 0 && change.to.ch == 0 && lst(change.text) == \"\" &&\n      (!doc.cm || doc.cm.options.wholeLineUpdateBefore);\n  }\n\n  // Perform a change on the document data structure.\n  function updateDoc(doc, change, markedSpans, estimateHeight) {\n    function spansFor(n) {return markedSpans ? markedSpans[n] : null;}\n    function update(line, text, spans) {\n      updateLine(line, text, spans, estimateHeight);\n      signalLater(line, \"change\", line, change);\n    }\n\n    var from = change.from, to = change.to, text = change.text;\n    var firstLine = getLine(doc, from.line), lastLine = getLine(doc, to.line);\n    var lastText = lst(text), lastSpans = spansFor(text.length - 1), nlines = to.line - from.line;\n\n    // Adjust the line structure\n    if (isWholeLineUpdate(doc, change)) {\n      // This is a whole-line replace. Treated specially to make\n      // sure line objects move the way they are supposed to.\n      for (var i = 0, added = []; i < text.length - 1; ++i)\n        added.push(new Line(text[i], spansFor(i), estimateHeight));\n      update(lastLine, lastLine.text, lastSpans);\n      if (nlines) doc.remove(from.line, nlines);\n      if (added.length) doc.insert(from.line, added);\n    } else if (firstLine == lastLine) {\n      if (text.length == 1) {\n        update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans);\n      } else {\n        for (var added = [], i = 1; i < text.length - 1; ++i)\n          added.push(new Line(text[i], spansFor(i), estimateHeight));\n        added.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight));\n        update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n        doc.insert(from.line + 1, added);\n      }\n    } else if (text.length == 1) {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0));\n      doc.remove(from.line + 1, nlines);\n    } else {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n      update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans);\n      for (var i = 1, added = []; i < text.length - 1; ++i)\n        added.push(new Line(text[i], spansFor(i), estimateHeight));\n      if (nlines > 1) doc.remove(from.line + 1, nlines - 1);\n      doc.insert(from.line + 1, added);\n    }\n\n    signalLater(doc, \"change\", doc, change);\n  }\n\n  // The document is represented as a BTree consisting of leaves, with\n  // chunk of lines in them, and branches, with up to ten leaves or\n  // other branch nodes below them. The top node is always a branch\n  // node, and is the document object itself (meaning it has\n  // additional methods and properties).\n  //\n  // All nodes have parent links. The tree is used both to go from\n  // line numbers to line objects, and to go from objects to numbers.\n  // It also indexes by height, and is used to convert between height\n  // and line object, and to find the total height of the document.\n  //\n  // See also http://marijnhaverbeke.nl/blog/codemirror-line-tree.html\n\n  function LeafChunk(lines) {\n    this.lines = lines;\n    this.parent = null;\n    for (var i = 0, height = 0; i < lines.length; ++i) {\n      lines[i].parent = this;\n      height += lines[i].height;\n    }\n    this.height = height;\n  }\n\n  LeafChunk.prototype = {\n    chunkSize: function() { return this.lines.length; },\n    // Remove the n lines at offset 'at'.\n    removeInner: function(at, n) {\n      for (var i = at, e = at + n; i < e; ++i) {\n        var line = this.lines[i];\n        this.height -= line.height;\n        cleanUpLine(line);\n        signalLater(line, \"delete\");\n      }\n      this.lines.splice(at, n);\n    },\n    // Helper used to collapse a small branch into a single leaf.\n    collapse: function(lines) {\n      lines.push.apply(lines, this.lines);\n    },\n    // Insert the given array of lines at offset 'at', count them as\n    // having the given height.\n    insertInner: function(at, lines, height) {\n      this.height += height;\n      this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at));\n      for (var i = 0; i < lines.length; ++i) lines[i].parent = this;\n    },\n    // Used to iterate over a part of the tree.\n    iterN: function(at, n, op) {\n      for (var e = at + n; at < e; ++at)\n        if (op(this.lines[at])) return true;\n    }\n  };\n\n  function BranchChunk(children) {\n    this.children = children;\n    var size = 0, height = 0;\n    for (var i = 0; i < children.length; ++i) {\n      var ch = children[i];\n      size += ch.chunkSize(); height += ch.height;\n      ch.parent = this;\n    }\n    this.size = size;\n    this.height = height;\n    this.parent = null;\n  }\n\n  BranchChunk.prototype = {\n    chunkSize: function() { return this.size; },\n    removeInner: function(at, n) {\n      this.size -= n;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var rm = Math.min(n, sz - at), oldHeight = child.height;\n          child.removeInner(at, rm);\n          this.height -= oldHeight - child.height;\n          if (sz == rm) { this.children.splice(i--, 1); child.parent = null; }\n          if ((n -= rm) == 0) break;\n          at = 0;\n        } else at -= sz;\n      }\n      // If the result is smaller than 25 lines, ensure that it is a\n      // single leaf node.\n      if (this.size - n < 25 &&\n          (this.children.length > 1 || !(this.children[0] instanceof LeafChunk))) {\n        var lines = [];\n        this.collapse(lines);\n        this.children = [new LeafChunk(lines)];\n        this.children[0].parent = this;\n      }\n    },\n    collapse: function(lines) {\n      for (var i = 0; i < this.children.length; ++i) this.children[i].collapse(lines);\n    },\n    insertInner: function(at, lines, height) {\n      this.size += lines.length;\n      this.height += height;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at <= sz) {\n          child.insertInner(at, lines, height);\n          if (child.lines && child.lines.length > 50) {\n            while (child.lines.length > 50) {\n              var spilled = child.lines.splice(child.lines.length - 25, 25);\n              var newleaf = new LeafChunk(spilled);\n              child.height -= newleaf.height;\n              this.children.splice(i + 1, 0, newleaf);\n              newleaf.parent = this;\n            }\n            this.maybeSpill();\n          }\n          break;\n        }\n        at -= sz;\n      }\n    },\n    // When a node has grown, check whether it should be split.\n    maybeSpill: function() {\n      if (this.children.length <= 10) return;\n      var me = this;\n      do {\n        var spilled = me.children.splice(me.children.length - 5, 5);\n        var sibling = new BranchChunk(spilled);\n        if (!me.parent) { // Become the parent node\n          var copy = new BranchChunk(me.children);\n          copy.parent = me;\n          me.children = [copy, sibling];\n          me = copy;\n        } else {\n          me.size -= sibling.size;\n          me.height -= sibling.height;\n          var myIndex = indexOf(me.parent.children, me);\n          me.parent.children.splice(myIndex + 1, 0, sibling);\n        }\n        sibling.parent = me.parent;\n      } while (me.children.length > 10);\n      me.parent.maybeSpill();\n    },\n    iterN: function(at, n, op) {\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var used = Math.min(n, sz - at);\n          if (child.iterN(at, used, op)) return true;\n          if ((n -= used) == 0) break;\n          at = 0;\n        } else at -= sz;\n      }\n    }\n  };\n\n  var nextDocId = 0;\n  var Doc = CodeMirror.Doc = function(text, mode, firstLine) {\n    if (!(this instanceof Doc)) return new Doc(text, mode, firstLine);\n    if (firstLine == null) firstLine = 0;\n\n    BranchChunk.call(this, [new LeafChunk([new Line(\"\", null)])]);\n    this.first = firstLine;\n    this.scrollTop = this.scrollLeft = 0;\n    this.cantEdit = false;\n    this.cleanGeneration = 1;\n    this.frontier = firstLine;\n    var start = Pos(firstLine, 0);\n    this.sel = simpleSelection(start);\n    this.history = new History(null);\n    this.id = ++nextDocId;\n    this.modeOption = mode;\n\n    if (typeof text == \"string\") text = splitLines(text);\n    updateDoc(this, {from: start, to: start, text: text});\n    setSelection(this, simpleSelection(start), sel_dontScroll);\n  };\n\n  Doc.prototype = createObj(BranchChunk.prototype, {\n    constructor: Doc,\n    // Iterate over the document. Supports two forms -- with only one\n    // argument, it calls that for each line in the document. With\n    // three, it iterates over the range given by the first two (with\n    // the second being non-inclusive).\n    iter: function(from, to, op) {\n      if (op) this.iterN(from - this.first, to - from, op);\n      else this.iterN(this.first, this.first + this.size, from);\n    },\n\n    // Non-public interface for adding and removing lines.\n    insert: function(at, lines) {\n      var height = 0;\n      for (var i = 0; i < lines.length; ++i) height += lines[i].height;\n      this.insertInner(at - this.first, lines, height);\n    },\n    remove: function(at, n) { this.removeInner(at - this.first, n); },\n\n    // From here, the methods are part of the public interface. Most\n    // are also available from CodeMirror (editor) instances.\n\n    getValue: function(lineSep) {\n      var lines = getLines(this, this.first, this.first + this.size);\n      if (lineSep === false) return lines;\n      return lines.join(lineSep || \"\\n\");\n    },\n    setValue: docMethodOp(function(code) {\n      var top = Pos(this.first, 0), last = this.first + this.size - 1;\n      makeChange(this, {from: top, to: Pos(last, getLine(this, last).text.length),\n                        text: splitLines(code), origin: \"setValue\"}, true);\n      setSelection(this, simpleSelection(top));\n    }),\n    replaceRange: function(code, from, to, origin) {\n      from = clipPos(this, from);\n      to = to ? clipPos(this, to) : from;\n      replaceRange(this, code, from, to, origin);\n    },\n    getRange: function(from, to, lineSep) {\n      var lines = getBetween(this, clipPos(this, from), clipPos(this, to));\n      if (lineSep === false) return lines;\n      return lines.join(lineSep || \"\\n\");\n    },\n\n    getLine: function(line) {var l = this.getLineHandle(line); return l && l.text;},\n\n    getLineHandle: function(line) {if (isLine(this, line)) return getLine(this, line);},\n    getLineNumber: function(line) {return lineNo(line);},\n\n    getLineHandleVisualStart: function(line) {\n      if (typeof line == \"number\") line = getLine(this, line);\n      return visualLine(line);\n    },\n\n    lineCount: function() {return this.size;},\n    firstLine: function() {return this.first;},\n    lastLine: function() {return this.first + this.size - 1;},\n\n    clipPos: function(pos) {return clipPos(this, pos);},\n\n    getCursor: function(start) {\n      var range = this.sel.primary(), pos;\n      if (start == null || start == \"head\") pos = range.head;\n      else if (start == \"anchor\") pos = range.anchor;\n      else if (start == \"end\" || start == \"to\" || start === false) pos = range.to();\n      else pos = range.from();\n      return pos;\n    },\n    listSelections: function() { return this.sel.ranges; },\n    somethingSelected: function() {return this.sel.somethingSelected();},\n\n    setCursor: docMethodOp(function(line, ch, options) {\n      setSimpleSelection(this, clipPos(this, typeof line == \"number\" ? Pos(line, ch || 0) : line), null, options);\n    }),\n    setSelection: docMethodOp(function(anchor, head, options) {\n      setSimpleSelection(this, clipPos(this, anchor), clipPos(this, head || anchor), options);\n    }),\n    extendSelection: docMethodOp(function(head, other, options) {\n      extendSelection(this, clipPos(this, head), other && clipPos(this, other), options);\n    }),\n    extendSelections: docMethodOp(function(heads, options) {\n      extendSelections(this, clipPosArray(this, heads, options));\n    }),\n    extendSelectionsBy: docMethodOp(function(f, options) {\n      extendSelections(this, map(this.sel.ranges, f), options);\n    }),\n    setSelections: docMethodOp(function(ranges, primary, options) {\n      if (!ranges.length) return;\n      for (var i = 0, out = []; i < ranges.length; i++)\n        out[i] = new Range(clipPos(this, ranges[i].anchor),\n                           clipPos(this, ranges[i].head));\n      if (primary == null) primary = Math.min(ranges.length - 1, this.sel.primIndex);\n      setSelection(this, normalizeSelection(out, primary), options);\n    }),\n    addSelection: docMethodOp(function(anchor, head, options) {\n      var ranges = this.sel.ranges.slice(0);\n      ranges.push(new Range(clipPos(this, anchor), clipPos(this, head || anchor)));\n      setSelection(this, normalizeSelection(ranges, ranges.length - 1), options);\n    }),\n\n    getSelection: function(lineSep) {\n      var ranges = this.sel.ranges, lines;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this, ranges[i].from(), ranges[i].to());\n        lines = lines ? lines.concat(sel) : sel;\n      }\n      if (lineSep === false) return lines;\n      else return lines.join(lineSep || \"\\n\");\n    },\n    getSelections: function(lineSep) {\n      var parts = [], ranges = this.sel.ranges;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this, ranges[i].from(), ranges[i].to());\n        if (lineSep !== false) sel = sel.join(lineSep || \"\\n\");\n        parts[i] = sel;\n      }\n      return parts;\n    },\n    replaceSelection: function(code, collapse, origin) {\n      var dup = [];\n      for (var i = 0; i < this.sel.ranges.length; i++)\n        dup[i] = code;\n      this.replaceSelections(dup, collapse, origin || \"+input\");\n    },\n    replaceSelections: docMethodOp(function(code, collapse, origin) {\n      var changes = [], sel = this.sel;\n      for (var i = 0; i < sel.ranges.length; i++) {\n        var range = sel.ranges[i];\n        changes[i] = {from: range.from(), to: range.to(), text: splitLines(code[i]), origin: origin};\n      }\n      var newSel = collapse && collapse != \"end\" && computeReplacedSel(this, changes, collapse);\n      for (var i = changes.length - 1; i >= 0; i--)\n        makeChange(this, changes[i]);\n      if (newSel) setSelectionReplaceHistory(this, newSel);\n      else if (this.cm) ensureCursorVisible(this.cm);\n    }),\n    undo: docMethodOp(function() {makeChangeFromHistory(this, \"undo\");}),\n    redo: docMethodOp(function() {makeChangeFromHistory(this, \"redo\");}),\n    undoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"undo\", true);}),\n    redoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"redo\", true);}),\n\n    setExtending: function(val) {this.extend = val;},\n    getExtending: function() {return this.extend;},\n\n    historySize: function() {\n      var hist = this.history, done = 0, undone = 0;\n      for (var i = 0; i < hist.done.length; i++) if (!hist.done[i].ranges) ++done;\n      for (var i = 0; i < hist.undone.length; i++) if (!hist.undone[i].ranges) ++undone;\n      return {undo: done, redo: undone};\n    },\n    clearHistory: function() {this.history = new History(this.history.maxGeneration);},\n\n    markClean: function() {\n      this.cleanGeneration = this.changeGeneration(true);\n    },\n    changeGeneration: function(forceSplit) {\n      if (forceSplit)\n        this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null;\n      return this.history.generation;\n    },\n    isClean: function (gen) {\n      return this.history.generation == (gen || this.cleanGeneration);\n    },\n\n    getHistory: function() {\n      return {done: copyHistoryArray(this.history.done),\n              undone: copyHistoryArray(this.history.undone)};\n    },\n    setHistory: function(histData) {\n      var hist = this.history = new History(this.history.maxGeneration);\n      hist.done = copyHistoryArray(histData.done.slice(0), null, true);\n      hist.undone = copyHistoryArray(histData.undone.slice(0), null, true);\n    },\n\n    addLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, \"class\", function(line) {\n        var prop = where == \"text\" ? \"textClass\" : where == \"background\" ? \"bgClass\" : \"wrapClass\";\n        if (!line[prop]) line[prop] = cls;\n        else if (new RegExp(\"(?:^|\\\\s)\" + cls + \"(?:$|\\\\s)\").test(line[prop])) return false;\n        else line[prop] += \" \" + cls;\n        return true;\n      });\n    }),\n    removeLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, \"class\", function(line) {\n        var prop = where == \"text\" ? \"textClass\" : where == \"background\" ? \"bgClass\" : \"wrapClass\";\n        var cur = line[prop];\n        if (!cur) return false;\n        else if (cls == null) line[prop] = null;\n        else {\n          var found = cur.match(new RegExp(\"(?:^|\\\\s+)\" + cls + \"(?:$|\\\\s+)\"));\n          if (!found) return false;\n          var end = found.index + found[0].length;\n          line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? \"\" : \" \") + cur.slice(end) || null;\n        }\n        return true;\n      });\n    }),\n\n    markText: function(from, to, options) {\n      return markText(this, clipPos(this, from), clipPos(this, to), options, \"range\");\n    },\n    setBookmark: function(pos, options) {\n      var realOpts = {replacedWith: options && (options.nodeType == null ? options.widget : options),\n                      insertLeft: options && options.insertLeft,\n                      clearWhenEmpty: false, shared: options && options.shared};\n      pos = clipPos(this, pos);\n      return markText(this, pos, pos, realOpts, \"bookmark\");\n    },\n    findMarksAt: function(pos) {\n      pos = clipPos(this, pos);\n      var markers = [], spans = getLine(this, pos.line).markedSpans;\n      if (spans) for (var i = 0; i < spans.length; ++i) {\n        var span = spans[i];\n        if ((span.from == null || span.from <= pos.ch) &&\n            (span.to == null || span.to >= pos.ch))\n          markers.push(span.marker.parent || span.marker);\n      }\n      return markers;\n    },\n    findMarks: function(from, to, filter) {\n      from = clipPos(this, from); to = clipPos(this, to);\n      var found = [], lineNo = from.line;\n      this.iter(from.line, to.line + 1, function(line) {\n        var spans = line.markedSpans;\n        if (spans) for (var i = 0; i < spans.length; i++) {\n          var span = spans[i];\n          if (!(lineNo == from.line && from.ch > span.to ||\n                span.from == null && lineNo != from.line||\n                lineNo == to.line && span.from > to.ch) &&\n              (!filter || filter(span.marker)))\n            found.push(span.marker.parent || span.marker);\n        }\n        ++lineNo;\n      });\n      return found;\n    },\n    getAllMarks: function() {\n      var markers = [];\n      this.iter(function(line) {\n        var sps = line.markedSpans;\n        if (sps) for (var i = 0; i < sps.length; ++i)\n          if (sps[i].from != null) markers.push(sps[i].marker);\n      });\n      return markers;\n    },\n\n    posFromIndex: function(off) {\n      var ch, lineNo = this.first;\n      this.iter(function(line) {\n        var sz = line.text.length + 1;\n        if (sz > off) { ch = off; return true; }\n        off -= sz;\n        ++lineNo;\n      });\n      return clipPos(this, Pos(lineNo, ch));\n    },\n    indexFromPos: function (coords) {\n      coords = clipPos(this, coords);\n      var index = coords.ch;\n      if (coords.line < this.first || coords.ch < 0) return 0;\n      this.iter(this.first, coords.line, function (line) {\n        index += line.text.length + 1;\n      });\n      return index;\n    },\n\n    copy: function(copyHistory) {\n      var doc = new Doc(getLines(this, this.first, this.first + this.size), this.modeOption, this.first);\n      doc.scrollTop = this.scrollTop; doc.scrollLeft = this.scrollLeft;\n      doc.sel = this.sel;\n      doc.extend = false;\n      if (copyHistory) {\n        doc.history.undoDepth = this.history.undoDepth;\n        doc.setHistory(this.getHistory());\n      }\n      return doc;\n    },\n\n    linkedDoc: function(options) {\n      if (!options) options = {};\n      var from = this.first, to = this.first + this.size;\n      if (options.from != null && options.from > from) from = options.from;\n      if (options.to != null && options.to < to) to = options.to;\n      var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from);\n      if (options.sharedHist) copy.history = this.history;\n      (this.linked || (this.linked = [])).push({doc: copy, sharedHist: options.sharedHist});\n      copy.linked = [{doc: this, isParent: true, sharedHist: options.sharedHist}];\n      copySharedMarkers(copy, findSharedMarkers(this));\n      return copy;\n    },\n    unlinkDoc: function(other) {\n      if (other instanceof CodeMirror) other = other.doc;\n      if (this.linked) for (var i = 0; i < this.linked.length; ++i) {\n        var link = this.linked[i];\n        if (link.doc != other) continue;\n        this.linked.splice(i, 1);\n        other.unlinkDoc(this);\n        detachSharedMarkers(findSharedMarkers(this));\n        break;\n      }\n      // If the histories were shared, split them again\n      if (other.history == this.history) {\n        var splitIds = [other.id];\n        linkedDocs(other, function(doc) {splitIds.push(doc.id);}, true);\n        other.history = new History(null);\n        other.history.done = copyHistoryArray(this.history.done, splitIds);\n        other.history.undone = copyHistoryArray(this.history.undone, splitIds);\n      }\n    },\n    iterLinkedDocs: function(f) {linkedDocs(this, f);},\n\n    getMode: function() {return this.mode;},\n    getEditor: function() {return this.cm;}\n  });\n\n  // Public alias.\n  Doc.prototype.eachLine = Doc.prototype.iter;\n\n  // Set up methods on CodeMirror's prototype to redirect to the editor's document.\n  var dontDelegate = \"iter insert remove copy getEditor\".split(\" \");\n  for (var prop in Doc.prototype) if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0)\n    CodeMirror.prototype[prop] = (function(method) {\n      return function() {return method.apply(this.doc, arguments);};\n    })(Doc.prototype[prop]);\n\n  eventMixin(Doc);\n\n  // Call f for all linked documents.\n  function linkedDocs(doc, f, sharedHistOnly) {\n    function propagate(doc, skip, sharedHist) {\n      if (doc.linked) for (var i = 0; i < doc.linked.length; ++i) {\n        var rel = doc.linked[i];\n        if (rel.doc == skip) continue;\n        var shared = sharedHist && rel.sharedHist;\n        if (sharedHistOnly && !shared) continue;\n        f(rel.doc, shared);\n        propagate(rel.doc, doc, shared);\n      }\n    }\n    propagate(doc, null, true);\n  }\n\n  // Attach a document to an editor.\n  function attachDoc(cm, doc) {\n    if (doc.cm) throw new Error(\"This document is already in use.\");\n    cm.doc = doc;\n    doc.cm = cm;\n    estimateLineHeights(cm);\n    loadMode(cm);\n    if (!cm.options.lineWrapping) findMaxLine(cm);\n    cm.options.mode = doc.modeOption;\n    regChange(cm);\n  }\n\n  // LINE UTILITIES\n\n  // Find the line object corresponding to the given line number.\n  function getLine(doc, n) {\n    n -= doc.first;\n    if (n < 0 || n >= doc.size) throw new Error(\"There is no line \" + (n + doc.first) + \" in the document.\");\n    for (var chunk = doc; !chunk.lines;) {\n      for (var i = 0;; ++i) {\n        var child = chunk.children[i], sz = child.chunkSize();\n        if (n < sz) { chunk = child; break; }\n        n -= sz;\n      }\n    }\n    return chunk.lines[n];\n  }\n\n  // Get the part of a document between two positions, as an array of\n  // strings.\n  function getBetween(doc, start, end) {\n    var out = [], n = start.line;\n    doc.iter(start.line, end.line + 1, function(line) {\n      var text = line.text;\n      if (n == end.line) text = text.slice(0, end.ch);\n      if (n == start.line) text = text.slice(start.ch);\n      out.push(text);\n      ++n;\n    });\n    return out;\n  }\n  // Get the lines between from and to, as array of strings.\n  function getLines(doc, from, to) {\n    var out = [];\n    doc.iter(from, to, function(line) { out.push(line.text); });\n    return out;\n  }\n\n  // Update the height of a line, propagating the height change\n  // upwards to parent nodes.\n  function updateLineHeight(line, height) {\n    var diff = height - line.height;\n    if (diff) for (var n = line; n; n = n.parent) n.height += diff;\n  }\n\n  // Given a line object, find its line number by walking up through\n  // its parent links.\n  function lineNo(line) {\n    if (line.parent == null) return null;\n    var cur = line.parent, no = indexOf(cur.lines, line);\n    for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\n      for (var i = 0;; ++i) {\n        if (chunk.children[i] == cur) break;\n        no += chunk.children[i].chunkSize();\n      }\n    }\n    return no + cur.first;\n  }\n\n  // Find the line at the given vertical position, using the height\n  // information in the document tree.\n  function lineAtHeight(chunk, h) {\n    var n = chunk.first;\n    outer: do {\n      for (var i = 0; i < chunk.children.length; ++i) {\n        var child = chunk.children[i], ch = child.height;\n        if (h < ch) { chunk = child; continue outer; }\n        h -= ch;\n        n += child.chunkSize();\n      }\n      return n;\n    } while (!chunk.lines);\n    for (var i = 0; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i], lh = line.height;\n      if (h < lh) break;\n      h -= lh;\n    }\n    return n + i;\n  }\n\n\n  // Find the height above the given line.\n  function heightAtLine(lineObj) {\n    lineObj = visualLine(lineObj);\n\n    var h = 0, chunk = lineObj.parent;\n    for (var i = 0; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i];\n      if (line == lineObj) break;\n      else h += line.height;\n    }\n    for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\n      for (var i = 0; i < p.children.length; ++i) {\n        var cur = p.children[i];\n        if (cur == chunk) break;\n        else h += cur.height;\n      }\n    }\n    return h;\n  }\n\n  // Get the bidi ordering for the given line (and cache it). Returns\n  // false for lines that are fully left-to-right, and an array of\n  // BidiSpan objects otherwise.\n  function getOrder(line) {\n    var order = line.order;\n    if (order == null) order = line.order = bidiOrdering(line.text);\n    return order;\n  }\n\n  // HISTORY\n\n  function History(startGen) {\n    // Arrays of change events and selections. Doing something adds an\n    // event to done and clears undo. Undoing moves events from done\n    // to undone, redoing moves them in the other direction.\n    this.done = []; this.undone = [];\n    this.undoDepth = Infinity;\n    // Used to track when changes can be merged into a single undo\n    // event\n    this.lastModTime = this.lastSelTime = 0;\n    this.lastOp = this.lastSelOp = null;\n    this.lastOrigin = this.lastSelOrigin = null;\n    // Used by the isClean() method\n    this.generation = this.maxGeneration = startGen || 1;\n  }\n\n  // Create a history change event from an updateDoc-style change\n  // object.\n  function historyChangeFromChange(doc, change) {\n    var histChange = {from: copyPos(change.from), to: changeEnd(change), text: getBetween(doc, change.from, change.to)};\n    attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n    linkedDocs(doc, function(doc) {attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);}, true);\n    return histChange;\n  }\n\n  // Pop all selection events off the end of a history array. Stop at\n  // a change event.\n  function clearSelectionEvents(array) {\n    while (array.length) {\n      var last = lst(array);\n      if (last.ranges) array.pop();\n      else break;\n    }\n  }\n\n  // Find the top change event in the history. Pop off selection\n  // events that are in the way.\n  function lastChangeEvent(hist, force) {\n    if (force) {\n      clearSelectionEvents(hist.done);\n      return lst(hist.done);\n    } else if (hist.done.length && !lst(hist.done).ranges) {\n      return lst(hist.done);\n    } else if (hist.done.length > 1 && !hist.done[hist.done.length - 2].ranges) {\n      hist.done.pop();\n      return lst(hist.done);\n    }\n  }\n\n  // Register a change in the history. Merges changes that are within\n  // a single operation, ore are close together with an origin that\n  // allows merging (starting with \"+\") into a single event.\n  function addChangeToHistory(doc, change, selAfter, opId) {\n    var hist = doc.history;\n    hist.undone.length = 0;\n    var time = +new Date, cur;\n\n    if ((hist.lastOp == opId ||\n         hist.lastOrigin == change.origin && change.origin &&\n         ((change.origin.charAt(0) == \"+\" && doc.cm && hist.lastModTime > time - doc.cm.options.historyEventDelay) ||\n          change.origin.charAt(0) == \"*\")) &&\n        (cur = lastChangeEvent(hist, hist.lastOp == opId))) {\n      // Merge this change into the last event\n      var last = lst(cur.changes);\n      if (cmp(change.from, change.to) == 0 && cmp(change.from, last.to) == 0) {\n        // Optimized case for simple insertion -- don't want to add\n        // new changesets for every character typed\n        last.to = changeEnd(change);\n      } else {\n        // Add new sub-event\n        cur.changes.push(historyChangeFromChange(doc, change));\n      }\n    } else {\n      // Can not be merged, start a new event.\n      var before = lst(hist.done);\n      if (!before || !before.ranges)\n        pushSelectionToHistory(doc.sel, hist.done);\n      cur = {changes: [historyChangeFromChange(doc, change)],\n             generation: hist.generation};\n      hist.done.push(cur);\n      while (hist.done.length > hist.undoDepth) {\n        hist.done.shift();\n        if (!hist.done[0].ranges) hist.done.shift();\n      }\n    }\n    hist.done.push(selAfter);\n    hist.generation = ++hist.maxGeneration;\n    hist.lastModTime = hist.lastSelTime = time;\n    hist.lastOp = hist.lastSelOp = opId;\n    hist.lastOrigin = hist.lastSelOrigin = change.origin;\n\n    if (!last) signal(doc, \"historyAdded\");\n  }\n\n  function selectionEventCanBeMerged(doc, origin, prev, sel) {\n    var ch = origin.charAt(0);\n    return ch == \"*\" ||\n      ch == \"+\" &&\n      prev.ranges.length == sel.ranges.length &&\n      prev.somethingSelected() == sel.somethingSelected() &&\n      new Date - doc.history.lastSelTime <= (doc.cm ? doc.cm.options.historyEventDelay : 500);\n  }\n\n  // Called whenever the selection changes, sets the new selection as\n  // the pending selection in the history, and pushes the old pending\n  // selection into the 'done' array when it was significantly\n  // different (in number of selected ranges, emptiness, or time).\n  function addSelectionToHistory(doc, sel, opId, options) {\n    var hist = doc.history, origin = options && options.origin;\n\n    // A new event is started when the previous origin does not match\n    // the current, or the origins don't allow matching. Origins\n    // starting with * are always merged, those starting with + are\n    // merged when similar and close together in time.\n    if (opId == hist.lastSelOp ||\n        (origin && hist.lastSelOrigin == origin &&\n         (hist.lastModTime == hist.lastSelTime && hist.lastOrigin == origin ||\n          selectionEventCanBeMerged(doc, origin, lst(hist.done), sel))))\n      hist.done[hist.done.length - 1] = sel;\n    else\n      pushSelectionToHistory(sel, hist.done);\n\n    hist.lastSelTime = +new Date;\n    hist.lastSelOrigin = origin;\n    hist.lastSelOp = opId;\n    if (options && options.clearRedo !== false)\n      clearSelectionEvents(hist.undone);\n  }\n\n  function pushSelectionToHistory(sel, dest) {\n    var top = lst(dest);\n    if (!(top && top.ranges && top.equals(sel)))\n      dest.push(sel);\n  }\n\n  // Used to store marked span information in the history.\n  function attachLocalSpans(doc, change, from, to) {\n    var existing = change[\"spans_\" + doc.id], n = 0;\n    doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function(line) {\n      if (line.markedSpans)\n        (existing || (existing = change[\"spans_\" + doc.id] = {}))[n] = line.markedSpans;\n      ++n;\n    });\n  }\n\n  // When un/re-doing restores text containing marked spans, those\n  // that have been explicitly cleared should not be restored.\n  function removeClearedSpans(spans) {\n    if (!spans) return null;\n    for (var i = 0, out; i < spans.length; ++i) {\n      if (spans[i].marker.explicitlyCleared) { if (!out) out = spans.slice(0, i); }\n      else if (out) out.push(spans[i]);\n    }\n    return !out ? spans : out.length ? out : null;\n  }\n\n  // Retrieve and filter the old marked spans stored in a change event.\n  function getOldSpans(doc, change) {\n    var found = change[\"spans_\" + doc.id];\n    if (!found) return null;\n    for (var i = 0, nw = []; i < change.text.length; ++i)\n      nw.push(removeClearedSpans(found[i]));\n    return nw;\n  }\n\n  // Used both to provide a JSON-safe object in .getHistory, and, when\n  // detaching a document, to split the history in two\n  function copyHistoryArray(events, newGroup, instantiateSel) {\n    for (var i = 0, copy = []; i < events.length; ++i) {\n      var event = events[i];\n      if (event.ranges) {\n        copy.push(instantiateSel ? Selection.prototype.deepCopy.call(event) : event);\n        continue;\n      }\n      var changes = event.changes, newChanges = [];\n      copy.push({changes: newChanges});\n      for (var j = 0; j < changes.length; ++j) {\n        var change = changes[j], m;\n        newChanges.push({from: change.from, to: change.to, text: change.text});\n        if (newGroup) for (var prop in change) if (m = prop.match(/^spans_(\\d+)$/)) {\n          if (indexOf(newGroup, Number(m[1])) > -1) {\n            lst(newChanges)[prop] = change[prop];\n            delete change[prop];\n          }\n        }\n      }\n    }\n    return copy;\n  }\n\n  // Rebasing/resetting history to deal with externally-sourced changes\n\n  function rebaseHistSelSingle(pos, from, to, diff) {\n    if (to < pos.line) {\n      pos.line += diff;\n    } else if (from < pos.line) {\n      pos.line = from;\n      pos.ch = 0;\n    }\n  }\n\n  // Tries to rebase an array of history events given a change in the\n  // document. If the change touches the same lines as the event, the\n  // event, and everything 'behind' it, is discarded. If the change is\n  // before the event, the event's positions are updated. Uses a\n  // copy-on-write scheme for the positions, to avoid having to\n  // reallocate them all on every rebase, but also avoid problems with\n  // shared position objects being unsafely updated.\n  function rebaseHistArray(array, from, to, diff) {\n    for (var i = 0; i < array.length; ++i) {\n      var sub = array[i], ok = true;\n      if (sub.ranges) {\n        if (!sub.copied) { sub = array[i] = sub.deepCopy(); sub.copied = true; }\n        for (var j = 0; j < sub.ranges.length; j++) {\n          rebaseHistSelSingle(sub.ranges[j].anchor, from, to, diff);\n          rebaseHistSelSingle(sub.ranges[j].head, from, to, diff);\n        }\n        continue;\n      }\n      for (var j = 0; j < sub.changes.length; ++j) {\n        var cur = sub.changes[j];\n        if (to < cur.from.line) {\n          cur.from = Pos(cur.from.line + diff, cur.from.ch);\n          cur.to = Pos(cur.to.line + diff, cur.to.ch);\n        } else if (from <= cur.to.line) {\n          ok = false;\n          break;\n        }\n      }\n      if (!ok) {\n        array.splice(0, i + 1);\n        i = 0;\n      }\n    }\n  }\n\n  function rebaseHist(hist, change) {\n    var from = change.from.line, to = change.to.line, diff = change.text.length - (to - from) - 1;\n    rebaseHistArray(hist.done, from, to, diff);\n    rebaseHistArray(hist.undone, from, to, diff);\n  }\n\n  // EVENT UTILITIES\n\n  // Due to the fact that we still support jurassic IE versions, some\n  // compatibility wrappers are needed.\n\n  var e_preventDefault = CodeMirror.e_preventDefault = function(e) {\n    if (e.preventDefault) e.preventDefault();\n    else e.returnValue = false;\n  };\n  var e_stopPropagation = CodeMirror.e_stopPropagation = function(e) {\n    if (e.stopPropagation) e.stopPropagation();\n    else e.cancelBubble = true;\n  };\n  function e_defaultPrevented(e) {\n    return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false;\n  }\n  var e_stop = CodeMirror.e_stop = function(e) {e_preventDefault(e); e_stopPropagation(e);};\n\n  function e_target(e) {return e.target || e.srcElement;}\n  function e_button(e) {\n    var b = e.which;\n    if (b == null) {\n      if (e.button & 1) b = 1;\n      else if (e.button & 2) b = 3;\n      else if (e.button & 4) b = 2;\n    }\n    if (mac && e.ctrlKey && b == 1) b = 3;\n    return b;\n  }\n\n  // EVENT HANDLING\n\n  // Lightweight event framework. on/off also work on DOM nodes,\n  // registering native DOM handlers.\n\n  var on = CodeMirror.on = function(emitter, type, f) {\n    if (emitter.addEventListener)\n      emitter.addEventListener(type, f, false);\n    else if (emitter.attachEvent)\n      emitter.attachEvent(\"on\" + type, f);\n    else {\n      var map = emitter._handlers || (emitter._handlers = {});\n      var arr = map[type] || (map[type] = []);\n      arr.push(f);\n    }\n  };\n\n  var off = CodeMirror.off = function(emitter, type, f) {\n    if (emitter.removeEventListener)\n      emitter.removeEventListener(type, f, false);\n    else if (emitter.detachEvent)\n      emitter.detachEvent(\"on\" + type, f);\n    else {\n      var arr = emitter._handlers && emitter._handlers[type];\n      if (!arr) return;\n      for (var i = 0; i < arr.length; ++i)\n        if (arr[i] == f) { arr.splice(i, 1); break; }\n    }\n  };\n\n  var signal = CodeMirror.signal = function(emitter, type /*, values...*/) {\n    var arr = emitter._handlers && emitter._handlers[type];\n    if (!arr) return;\n    var args = Array.prototype.slice.call(arguments, 2);\n    for (var i = 0; i < arr.length; ++i) arr[i].apply(null, args);\n  };\n\n  var orphanDelayedCallbacks = null;\n\n  // Often, we want to signal events at a point where we are in the\n  // middle of some work, but don't want the handler to start calling\n  // other methods on the editor, which might be in an inconsistent\n  // state or simply not expect any other events to happen.\n  // signalLater looks whether there are any handlers, and schedules\n  // them to be executed when the last operation ends, or, if no\n  // operation is active, when a timeout fires.\n  function signalLater(emitter, type /*, values...*/) {\n    var arr = emitter._handlers && emitter._handlers[type];\n    if (!arr) return;\n    var args = Array.prototype.slice.call(arguments, 2), list;\n    if (operationGroup) {\n      list = operationGroup.delayedCallbacks;\n    } else if (orphanDelayedCallbacks) {\n      list = orphanDelayedCallbacks;\n    } else {\n      list = orphanDelayedCallbacks = [];\n      setTimeout(fireOrphanDelayed, 0);\n    }\n    function bnd(f) {return function(){f.apply(null, args);};};\n    for (var i = 0; i < arr.length; ++i)\n      list.push(bnd(arr[i]));\n  }\n\n  function fireOrphanDelayed() {\n    var delayed = orphanDelayedCallbacks;\n    orphanDelayedCallbacks = null;\n    for (var i = 0; i < delayed.length; ++i) delayed[i]();\n  }\n\n  // The DOM events that CodeMirror handles can be overridden by\n  // registering a (non-DOM) handler on the editor for the event name,\n  // and preventDefault-ing the event in that handler.\n  function signalDOMEvent(cm, e, override) {\n    signal(cm, override || e.type, cm, e);\n    return e_defaultPrevented(e) || e.codemirrorIgnore;\n  }\n\n  function signalCursorActivity(cm) {\n    var arr = cm._handlers && cm._handlers.cursorActivity;\n    if (!arr) return;\n    var set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = []);\n    for (var i = 0; i < arr.length; ++i) if (indexOf(set, arr[i]) == -1)\n      set.push(arr[i]);\n  }\n\n  function hasHandler(emitter, type) {\n    var arr = emitter._handlers && emitter._handlers[type];\n    return arr && arr.length > 0;\n  }\n\n  // Add on and off methods to a constructor's prototype, to make\n  // registering events on such objects more convenient.\n  function eventMixin(ctor) {\n    ctor.prototype.on = function(type, f) {on(this, type, f);};\n    ctor.prototype.off = function(type, f) {off(this, type, f);};\n  }\n\n  // MISC UTILITIES\n\n  // Number of pixels added to scroller and sizer to hide scrollbar\n  var scrollerCutOff = 30;\n\n  // Returned or thrown by various protocols to signal 'I'm not\n  // handling this'.\n  var Pass = CodeMirror.Pass = {toString: function(){return \"CodeMirror.Pass\";}};\n\n  // Reused option objects for setSelection & friends\n  var sel_dontScroll = {scroll: false}, sel_mouse = {origin: \"*mouse\"}, sel_move = {origin: \"+move\"};\n\n  function Delayed() {this.id = null;}\n  Delayed.prototype.set = function(ms, f) {\n    clearTimeout(this.id);\n    this.id = setTimeout(f, ms);\n  };\n\n  // Counts the column offset in a string, taking tabs into account.\n  // Used mostly to find indentation.\n  var countColumn = CodeMirror.countColumn = function(string, end, tabSize, startIndex, startValue) {\n    if (end == null) {\n      end = string.search(/[^\\s\\u00a0]/);\n      if (end == -1) end = string.length;\n    }\n    for (var i = startIndex || 0, n = startValue || 0;;) {\n      var nextTab = string.indexOf(\"\\t\", i);\n      if (nextTab < 0 || nextTab >= end)\n        return n + (end - i);\n      n += nextTab - i;\n      n += tabSize - (n % tabSize);\n      i = nextTab + 1;\n    }\n  };\n\n  // The inverse of countColumn -- find the offset that corresponds to\n  // a particular column.\n  function findColumn(string, goal, tabSize) {\n    for (var pos = 0, col = 0;;) {\n      var nextTab = string.indexOf(\"\\t\", pos);\n      if (nextTab == -1) nextTab = string.length;\n      var skipped = nextTab - pos;\n      if (nextTab == string.length || col + skipped >= goal)\n        return pos + Math.min(skipped, goal - col);\n      col += nextTab - pos;\n      col += tabSize - (col % tabSize);\n      pos = nextTab + 1;\n      if (col >= goal) return pos;\n    }\n  }\n\n  var spaceStrs = [\"\"];\n  function spaceStr(n) {\n    while (spaceStrs.length <= n)\n      spaceStrs.push(lst(spaceStrs) + \" \");\n    return spaceStrs[n];\n  }\n\n  function lst(arr) { return arr[arr.length-1]; }\n\n  var selectInput = function(node) { node.select(); };\n  if (ios) // Mobile Safari apparently has a bug where select() is broken.\n    selectInput = function(node) { node.selectionStart = 0; node.selectionEnd = node.value.length; };\n  else if (ie) // Suppress mysterious IE10 errors\n    selectInput = function(node) { try { node.select(); } catch(_e) {} };\n\n  function indexOf(array, elt) {\n    for (var i = 0; i < array.length; ++i)\n      if (array[i] == elt) return i;\n    return -1;\n  }\n  if ([].indexOf) indexOf = function(array, elt) { return array.indexOf(elt); };\n  function map(array, f) {\n    var out = [];\n    for (var i = 0; i < array.length; i++) out[i] = f(array[i], i);\n    return out;\n  }\n  if ([].map) map = function(array, f) { return array.map(f); };\n\n  function createObj(base, props) {\n    var inst;\n    if (Object.create) {\n      inst = Object.create(base);\n    } else {\n      var ctor = function() {};\n      ctor.prototype = base;\n      inst = new ctor();\n    }\n    if (props) copyObj(props, inst);\n    return inst;\n  };\n\n  function copyObj(obj, target, overwrite) {\n    if (!target) target = {};\n    for (var prop in obj)\n      if (obj.hasOwnProperty(prop) && (overwrite !== false || !target.hasOwnProperty(prop)))\n        target[prop] = obj[prop];\n    return target;\n  }\n\n  function bind(f) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    return function(){return f.apply(null, args);};\n  }\n\n  var nonASCIISingleCaseWordChar = /[\\u00df\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\n  var isWordCharBasic = CodeMirror.isWordChar = function(ch) {\n    return /\\w/.test(ch) || ch > \"\\x80\" &&\n      (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch));\n  };\n  function isWordChar(ch, helper) {\n    if (!helper) return isWordCharBasic(ch);\n    if (helper.source.indexOf(\"\\\\w\") > -1 && isWordCharBasic(ch)) return true;\n    return helper.test(ch);\n  }\n\n  function isEmpty(obj) {\n    for (var n in obj) if (obj.hasOwnProperty(n) && obj[n]) return false;\n    return true;\n  }\n\n  // Extending unicode characters. A series of a non-extending char +\n  // any number of extending chars is treated as a single unit as far\n  // as editing and measuring is concerned. This is not fully correct,\n  // since some scripts/fonts/browsers also treat other configurations\n  // of code points as a group.\n  var extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;\n  function isExtendingChar(ch) { return ch.charCodeAt(0) >= 768 && extendingChars.test(ch); }\n\n  // DOM UTILITIES\n\n  function elt(tag, content, className, style) {\n    var e = document.createElement(tag);\n    if (className) e.className = className;\n    if (style) e.style.cssText = style;\n    if (typeof content == \"string\") e.appendChild(document.createTextNode(content));\n    else if (content) for (var i = 0; i < content.length; ++i) e.appendChild(content[i]);\n    return e;\n  }\n\n  var range;\n  if (document.createRange) range = function(node, start, end) {\n    var r = document.createRange();\n    r.setEnd(node, end);\n    r.setStart(node, start);\n    return r;\n  };\n  else range = function(node, start, end) {\n    var r = document.body.createTextRange();\n    r.moveToElementText(node.parentNode);\n    r.collapse(true);\n    r.moveEnd(\"character\", end);\n    r.moveStart(\"character\", start);\n    return r;\n  };\n\n  function removeChildren(e) {\n    for (var count = e.childNodes.length; count > 0; --count)\n      e.removeChild(e.firstChild);\n    return e;\n  }\n\n  function removeChildrenAndAdd(parent, e) {\n    return removeChildren(parent).appendChild(e);\n  }\n\n  function contains(parent, child) {\n    if (parent.contains)\n      return parent.contains(child);\n    while (child = child.parentNode)\n      if (child == parent) return true;\n  }\n\n  function activeElt() { return document.activeElement; }\n  // Older versions of IE throws unspecified error when touching\n  // document.activeElement in some cases (during loading, in iframe)\n  if (ie && ie_version < 11) activeElt = function() {\n    try { return document.activeElement; }\n    catch(e) { return document.body; }\n  };\n\n  function classTest(cls) { return new RegExp(\"\\\\b\" + cls + \"\\\\b\\\\s*\"); }\n  function rmClass(node, cls) {\n    var test = classTest(cls);\n    if (test.test(node.className)) node.className = node.className.replace(test, \"\");\n  }\n  function addClass(node, cls) {\n    if (!classTest(cls).test(node.className)) node.className += \" \" + cls;\n  }\n  function joinClasses(a, b) {\n    var as = a.split(\" \");\n    for (var i = 0; i < as.length; i++)\n      if (as[i] && !classTest(as[i]).test(b)) b += \" \" + as[i];\n    return b;\n  }\n\n  // WINDOW-WIDE EVENTS\n\n  // These must be handled carefully, because naively registering a\n  // handler for each editor will cause the editors to never be\n  // garbage collected.\n\n  function forEachCodeMirror(f) {\n    if (!document.body.getElementsByClassName) return;\n    var byClass = document.body.getElementsByClassName(\"CodeMirror\");\n    for (var i = 0; i < byClass.length; i++) {\n      var cm = byClass[i].CodeMirror;\n      if (cm) f(cm);\n    }\n  }\n\n  var globalsRegistered = false;\n  function ensureGlobalHandlers() {\n    if (globalsRegistered) return;\n    registerGlobalHandlers();\n    globalsRegistered = true;\n  }\n  function registerGlobalHandlers() {\n    // When the window resizes, we need to refresh active editors.\n    var resizeTimer;\n    on(window, \"resize\", function() {\n      if (resizeTimer == null) resizeTimer = setTimeout(function() {\n        resizeTimer = null;\n        knownScrollbarWidth = null;\n        forEachCodeMirror(onResize);\n      }, 100);\n    });\n    // When the window loses focus, we want to show the editor as blurred\n    on(window, \"blur\", function() {\n      forEachCodeMirror(onBlur);\n    });\n  }\n\n  // FEATURE DETECTION\n\n  // Detect drag-and-drop\n  var dragAndDrop = function() {\n    // There is *some* kind of drag-and-drop support in IE6-8, but I\n    // couldn't get it to work yet.\n    if (ie && ie_version < 9) return false;\n    var div = elt('div');\n    return \"draggable\" in div || \"dragDrop\" in div;\n  }();\n\n  var knownScrollbarWidth;\n  function scrollbarWidth(measure) {\n    if (knownScrollbarWidth != null) return knownScrollbarWidth;\n    var test = elt(\"div\", null, null, \"width: 50px; height: 50px; overflow-x: scroll\");\n    removeChildrenAndAdd(measure, test);\n    if (test.offsetWidth)\n      knownScrollbarWidth = test.offsetHeight - test.clientHeight;\n    return knownScrollbarWidth || 0;\n  }\n\n  var zwspSupported;\n  function zeroWidthElement(measure) {\n    if (zwspSupported == null) {\n      var test = elt(\"span\", \"\\u200b\");\n      removeChildrenAndAdd(measure, elt(\"span\", [test, document.createTextNode(\"x\")]));\n      if (measure.firstChild.offsetHeight != 0)\n        zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !(ie && ie_version < 8);\n    }\n    if (zwspSupported) return elt(\"span\", \"\\u200b\");\n    else return elt(\"span\", \"\\u00a0\", null, \"display: inline-block; width: 1px; margin-right: -1px\");\n  }\n\n  // Feature-detect IE's crummy client rect reporting for bidi text\n  var badBidiRects;\n  function hasBadBidiRects(measure) {\n    if (badBidiRects != null) return badBidiRects;\n    var txt = removeChildrenAndAdd(measure, document.createTextNode(\"A\\u062eA\"));\n    var r0 = range(txt, 0, 1).getBoundingClientRect();\n    if (!r0 || r0.left == r0.right) return false; // Safari returns null in some cases (#2780)\n    var r1 = range(txt, 1, 2).getBoundingClientRect();\n    return badBidiRects = (r1.right - r0.right < 3);\n  }\n\n  // See if \"\".split is the broken IE version, if so, provide an\n  // alternative way to split lines.\n  var splitLines = CodeMirror.splitLines = \"\\n\\nb\".split(/\\n/).length != 3 ? function(string) {\n    var pos = 0, result = [], l = string.length;\n    while (pos <= l) {\n      var nl = string.indexOf(\"\\n\", pos);\n      if (nl == -1) nl = string.length;\n      var line = string.slice(pos, string.charAt(nl - 1) == \"\\r\" ? nl - 1 : nl);\n      var rt = line.indexOf(\"\\r\");\n      if (rt != -1) {\n        result.push(line.slice(0, rt));\n        pos += rt + 1;\n      } else {\n        result.push(line);\n        pos = nl + 1;\n      }\n    }\n    return result;\n  } : function(string){return string.split(/\\r\\n?|\\n/);};\n\n  var hasSelection = window.getSelection ? function(te) {\n    try { return te.selectionStart != te.selectionEnd; }\n    catch(e) { return false; }\n  } : function(te) {\n    try {var range = te.ownerDocument.selection.createRange();}\n    catch(e) {}\n    if (!range || range.parentElement() != te) return false;\n    return range.compareEndPoints(\"StartToEnd\", range) != 0;\n  };\n\n  var hasCopyEvent = (function() {\n    var e = elt(\"div\");\n    if (\"oncopy\" in e) return true;\n    e.setAttribute(\"oncopy\", \"return;\");\n    return typeof e.oncopy == \"function\";\n  })();\n\n  var badZoomedRects = null;\n  function hasBadZoomedRects(measure) {\n    if (badZoomedRects != null) return badZoomedRects;\n    var node = removeChildrenAndAdd(measure, elt(\"span\", \"x\"));\n    var normal = node.getBoundingClientRect();\n    var fromRange = range(node, 0, 1).getBoundingClientRect();\n    return badZoomedRects = Math.abs(normal.left - fromRange.left) > 1;\n  }\n\n  // KEY NAMES\n\n  var keyNames = {3: \"Enter\", 8: \"Backspace\", 9: \"Tab\", 13: \"Enter\", 16: \"Shift\", 17: \"Ctrl\", 18: \"Alt\",\n                  19: \"Pause\", 20: \"CapsLock\", 27: \"Esc\", 32: \"Space\", 33: \"PageUp\", 34: \"PageDown\", 35: \"End\",\n                  36: \"Home\", 37: \"Left\", 38: \"Up\", 39: \"Right\", 40: \"Down\", 44: \"PrintScrn\", 45: \"Insert\",\n                  46: \"Delete\", 59: \";\", 61: \"=\", 91: \"Mod\", 92: \"Mod\", 93: \"Mod\", 107: \"=\", 109: \"-\", 127: \"Delete\",\n                  173: \"-\", 186: \";\", 187: \"=\", 188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\",\n                  221: \"]\", 222: \"'\", 63232: \"Up\", 63233: \"Down\", 63234: \"Left\", 63235: \"Right\", 63272: \"Delete\",\n                  63273: \"Home\", 63275: \"End\", 63276: \"PageUp\", 63277: \"PageDown\", 63302: \"Insert\"};\n  CodeMirror.keyNames = keyNames;\n  (function() {\n    // Number keys\n    for (var i = 0; i < 10; i++) keyNames[i + 48] = keyNames[i + 96] = String(i);\n    // Alphabetic keys\n    for (var i = 65; i <= 90; i++) keyNames[i] = String.fromCharCode(i);\n    // Function keys\n    for (var i = 1; i <= 12; i++) keyNames[i + 111] = keyNames[i + 63235] = \"F\" + i;\n  })();\n\n  // BIDI HELPERS\n\n  function iterateBidiSections(order, from, to, f) {\n    if (!order) return f(from, to, \"ltr\");\n    var found = false;\n    for (var i = 0; i < order.length; ++i) {\n      var part = order[i];\n      if (part.from < to && part.to > from || from == to && part.to == from) {\n        f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? \"rtl\" : \"ltr\");\n        found = true;\n      }\n    }\n    if (!found) f(from, to, \"ltr\");\n  }\n\n  function bidiLeft(part) { return part.level % 2 ? part.to : part.from; }\n  function bidiRight(part) { return part.level % 2 ? part.from : part.to; }\n\n  function lineLeft(line) { var order = getOrder(line); return order ? bidiLeft(order[0]) : 0; }\n  function lineRight(line) {\n    var order = getOrder(line);\n    if (!order) return line.text.length;\n    return bidiRight(lst(order));\n  }\n\n  function lineStart(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLine(line);\n    if (visual != line) lineN = lineNo(visual);\n    var order = getOrder(visual);\n    var ch = !order ? 0 : order[0].level % 2 ? lineRight(visual) : lineLeft(visual);\n    return Pos(lineN, ch);\n  }\n  function lineEnd(cm, lineN) {\n    var merged, line = getLine(cm.doc, lineN);\n    while (merged = collapsedSpanAtEnd(line)) {\n      line = merged.find(1, true).line;\n      lineN = null;\n    }\n    var order = getOrder(line);\n    var ch = !order ? line.text.length : order[0].level % 2 ? lineLeft(line) : lineRight(line);\n    return Pos(lineN == null ? lineNo(line) : lineN, ch);\n  }\n  function lineStartSmart(cm, pos) {\n    var start = lineStart(cm, pos.line);\n    var line = getLine(cm.doc, start.line);\n    var order = getOrder(line);\n    if (!order || order[0].level == 0) {\n      var firstNonWS = Math.max(0, line.text.search(/\\S/));\n      var inWS = pos.line == start.line && pos.ch <= firstNonWS && pos.ch;\n      return Pos(start.line, inWS ? 0 : firstNonWS);\n    }\n    return start;\n  }\n\n  function compareBidiLevel(order, a, b) {\n    var linedir = order[0].level;\n    if (a == linedir) return true;\n    if (b == linedir) return false;\n    return a < b;\n  }\n  var bidiOther;\n  function getBidiPartAt(order, pos) {\n    bidiOther = null;\n    for (var i = 0, found; i < order.length; ++i) {\n      var cur = order[i];\n      if (cur.from < pos && cur.to > pos) return i;\n      if ((cur.from == pos || cur.to == pos)) {\n        if (found == null) {\n          found = i;\n        } else if (compareBidiLevel(order, cur.level, order[found].level)) {\n          if (cur.from != cur.to) bidiOther = found;\n          return i;\n        } else {\n          if (cur.from != cur.to) bidiOther = i;\n          return found;\n        }\n      }\n    }\n    return found;\n  }\n\n  function moveInLine(line, pos, dir, byUnit) {\n    if (!byUnit) return pos + dir;\n    do pos += dir;\n    while (pos > 0 && isExtendingChar(line.text.charAt(pos)));\n    return pos;\n  }\n\n  // This is needed in order to move 'visually' through bi-directional\n  // text -- i.e., pressing left should make the cursor go left, even\n  // when in RTL text. The tricky part is the 'jumps', where RTL and\n  // LTR text touch each other. This often requires the cursor offset\n  // to move more than one unit, in order to visually move one unit.\n  function moveVisually(line, start, dir, byUnit) {\n    var bidi = getOrder(line);\n    if (!bidi) return moveLogically(line, start, dir, byUnit);\n    var pos = getBidiPartAt(bidi, start), part = bidi[pos];\n    var target = moveInLine(line, start, part.level % 2 ? -dir : dir, byUnit);\n\n    for (;;) {\n      if (target > part.from && target < part.to) return target;\n      if (target == part.from || target == part.to) {\n        if (getBidiPartAt(bidi, target) == pos) return target;\n        part = bidi[pos += dir];\n        return (dir > 0) == part.level % 2 ? part.to : part.from;\n      } else {\n        part = bidi[pos += dir];\n        if (!part) return null;\n        if ((dir > 0) == part.level % 2)\n          target = moveInLine(line, part.to, -1, byUnit);\n        else\n          target = moveInLine(line, part.from, 1, byUnit);\n      }\n    }\n  }\n\n  function moveLogically(line, start, dir, byUnit) {\n    var target = start + dir;\n    if (byUnit) while (target > 0 && isExtendingChar(line.text.charAt(target))) target += dir;\n    return target < 0 || target > line.text.length ? null : target;\n  }\n\n  // Bidirectional ordering algorithm\n  // See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\n  // that this (partially) implements.\n\n  // One-char codes used for character types:\n  // L (L):   Left-to-Right\n  // R (R):   Right-to-Left\n  // r (AL):  Right-to-Left Arabic\n  // 1 (EN):  European Number\n  // + (ES):  European Number Separator\n  // % (ET):  European Number Terminator\n  // n (AN):  Arabic Number\n  // , (CS):  Common Number Separator\n  // m (NSM): Non-Spacing Mark\n  // b (BN):  Boundary Neutral\n  // s (B):   Paragraph Separator\n  // t (S):   Segment Separator\n  // w (WS):  Whitespace\n  // N (ON):  Other Neutrals\n\n  // Returns null if characters are ordered as they appear\n  // (left-to-right), or an array of sections ({from, to, level}\n  // objects) in the order in which they occur visually.\n  var bidiOrdering = (function() {\n    // Character types for codepoints 0 to 0xff\n    var lowTypes = \"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN\";\n    // Character types for codepoints 0x600 to 0x6ff\n    var arabicTypes = \"rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm\";\n    function charType(code) {\n      if (code <= 0xf7) return lowTypes.charAt(code);\n      else if (0x590 <= code && code <= 0x5f4) return \"R\";\n      else if (0x600 <= code && code <= 0x6ed) return arabicTypes.charAt(code - 0x600);\n      else if (0x6ee <= code && code <= 0x8ac) return \"r\";\n      else if (0x2000 <= code && code <= 0x200b) return \"w\";\n      else if (code == 0x200c) return \"b\";\n      else return \"L\";\n    }\n\n    var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n    var isNeutral = /[stwN]/, isStrong = /[LRr]/, countsAsLeft = /[Lb1n]/, countsAsNum = /[1n]/;\n    // Browsers seem to always treat the boundaries of block elements as being L.\n    var outerType = \"L\";\n\n    function BidiSpan(level, from, to) {\n      this.level = level;\n      this.from = from; this.to = to;\n    }\n\n    return function(str) {\n      if (!bidiRE.test(str)) return false;\n      var len = str.length, types = [];\n      for (var i = 0, type; i < len; ++i)\n        types.push(type = charType(str.charCodeAt(i)));\n\n      // W1. Examine each non-spacing mark (NSM) in the level run, and\n      // change the type of the NSM to the type of the previous\n      // character. If the NSM is at the start of the level run, it will\n      // get the type of sor.\n      for (var i = 0, prev = outerType; i < len; ++i) {\n        var type = types[i];\n        if (type == \"m\") types[i] = prev;\n        else prev = type;\n      }\n\n      // W2. Search backwards from each instance of a European number\n      // until the first strong type (R, L, AL, or sor) is found. If an\n      // AL is found, change the type of the European number to Arabic\n      // number.\n      // W3. Change all ALs to R.\n      for (var i = 0, cur = outerType; i < len; ++i) {\n        var type = types[i];\n        if (type == \"1\" && cur == \"r\") types[i] = \"n\";\n        else if (isStrong.test(type)) { cur = type; if (type == \"r\") types[i] = \"R\"; }\n      }\n\n      // W4. A single European separator between two European numbers\n      // changes to a European number. A single common separator between\n      // two numbers of the same type changes to that type.\n      for (var i = 1, prev = types[0]; i < len - 1; ++i) {\n        var type = types[i];\n        if (type == \"+\" && prev == \"1\" && types[i+1] == \"1\") types[i] = \"1\";\n        else if (type == \",\" && prev == types[i+1] &&\n                 (prev == \"1\" || prev == \"n\")) types[i] = prev;\n        prev = type;\n      }\n\n      // W5. A sequence of European terminators adjacent to European\n      // numbers changes to all European numbers.\n      // W6. Otherwise, separators and terminators change to Other\n      // Neutral.\n      for (var i = 0; i < len; ++i) {\n        var type = types[i];\n        if (type == \",\") types[i] = \"N\";\n        else if (type == \"%\") {\n          for (var end = i + 1; end < len && types[end] == \"%\"; ++end) {}\n          var replace = (i && types[i-1] == \"!\") || (end < len && types[end] == \"1\") ? \"1\" : \"N\";\n          for (var j = i; j < end; ++j) types[j] = replace;\n          i = end - 1;\n        }\n      }\n\n      // W7. Search backwards from each instance of a European number\n      // until the first strong type (R, L, or sor) is found. If an L is\n      // found, then change the type of the European number to L.\n      for (var i = 0, cur = outerType; i < len; ++i) {\n        var type = types[i];\n        if (cur == \"L\" && type == \"1\") types[i] = \"L\";\n        else if (isStrong.test(type)) cur = type;\n      }\n\n      // N1. A sequence of neutrals takes the direction of the\n      // surrounding strong text if the text on both sides has the same\n      // direction. European and Arabic numbers act as if they were R in\n      // terms of their influence on neutrals. Start-of-level-run (sor)\n      // and end-of-level-run (eor) are used at level run boundaries.\n      // N2. Any remaining neutrals take the embedding direction.\n      for (var i = 0; i < len; ++i) {\n        if (isNeutral.test(types[i])) {\n          for (var end = i + 1; end < len && isNeutral.test(types[end]); ++end) {}\n          var before = (i ? types[i-1] : outerType) == \"L\";\n          var after = (end < len ? types[end] : outerType) == \"L\";\n          var replace = before || after ? \"L\" : \"R\";\n          for (var j = i; j < end; ++j) types[j] = replace;\n          i = end - 1;\n        }\n      }\n\n      // Here we depart from the documented algorithm, in order to avoid\n      // building up an actual levels array. Since there are only three\n      // levels (0, 1, 2) in an implementation that doesn't take\n      // explicit embedding into account, we can build up the order on\n      // the fly, without following the level-based algorithm.\n      var order = [], m;\n      for (var i = 0; i < len;) {\n        if (countsAsLeft.test(types[i])) {\n          var start = i;\n          for (++i; i < len && countsAsLeft.test(types[i]); ++i) {}\n          order.push(new BidiSpan(0, start, i));\n        } else {\n          var pos = i, at = order.length;\n          for (++i; i < len && types[i] != \"L\"; ++i) {}\n          for (var j = pos; j < i;) {\n            if (countsAsNum.test(types[j])) {\n              if (pos < j) order.splice(at, 0, new BidiSpan(1, pos, j));\n              var nstart = j;\n              for (++j; j < i && countsAsNum.test(types[j]); ++j) {}\n              order.splice(at, 0, new BidiSpan(2, nstart, j));\n              pos = j;\n            } else ++j;\n          }\n          if (pos < i) order.splice(at, 0, new BidiSpan(1, pos, i));\n        }\n      }\n      if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\n        order[0].from = m[0].length;\n        order.unshift(new BidiSpan(0, 0, m[0].length));\n      }\n      if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\n        lst(order).to -= m[0].length;\n        order.push(new BidiSpan(0, len - m[0].length, len));\n      }\n      if (order[0].level != lst(order).level)\n        order.push(new BidiSpan(order[0].level, len, len));\n\n      return order;\n    };\n  })();\n\n  // THE END\n\n  CodeMirror.version = \"4.7.0\";\n\n  return CodeMirror;\n});\n","/* eslint-env node, browser */\n\"use strict\";\n\nmodule.exports = function (element) {\n    var self = this,\n        Combokeys = self.constructor;\n\n    /**\n     * a list of all the callbacks setup via Combokeys.bind()\n     *\n     * @type {Object}\n     */\n    self.callbacks = {};\n\n    /**\n     * direct map of string combinations to callbacks used for trigger()\n     *\n     * @type {Object}\n     */\n    self.directMap = {};\n\n    /**\n     * keeps track of what level each sequence is at since multiple\n     * sequences can start out with the same sequence\n     *\n     * @type {Object}\n     */\n    self.sequenceLevels = {};\n\n    /**\n     * variable to store the setTimeout call\n     *\n     * @type {null|number}\n     */\n    self.resetTimer;\n\n    /**\n     * temporary state where we will ignore the next keyup\n     *\n     * @type {boolean|string}\n     */\n    self.ignoreNextKeyup = false;\n\n    /**\n     * temporary state where we will ignore the next keypress\n     *\n     * @type {boolean}\n     */\n    self.ignoreNextKeypress = false;\n\n    /**\n     * are we currently inside of a sequence?\n     * type of action (\"keyup\" or \"keydown\" or \"keypress\") or false\n     *\n     * @type {boolean|string}\n     */\n    self.nextExpectedAction = false;\n\n    self.element = element;\n\n    self.addEvents();\n\n    Combokeys.instances.push(self);\n    return self;\n};\n\nmodule.exports.prototype.bind = require(\"./prototype/bind\");\nmodule.exports.prototype.bindMultiple = require(\"./prototype/bindMultiple\");\nmodule.exports.prototype.unbind = require(\"./prototype/unbind\");\nmodule.exports.prototype.trigger = require(\"./prototype/trigger\");\nmodule.exports.prototype.reset = require(\"./prototype/reset.js\");\nmodule.exports.prototype.stopCallback = require(\"./prototype/stopCallback\");\nmodule.exports.prototype.handleKey = require(\"./prototype/handleKey\");\nmodule.exports.prototype.addEvents = require(\"./prototype/addEvents\");\nmodule.exports.prototype.bindSingle = require(\"./prototype/bindSingle\");\nmodule.exports.prototype.getKeyInfo = require(\"./prototype/getKeyInfo\");\nmodule.exports.prototype.pickBestAction = require(\"./prototype/pickBestAction\");\nmodule.exports.prototype.getReverseMap = require(\"./prototype/getReverseMap\");\nmodule.exports.prototype.getMatches = require(\"./prototype/getMatches\");\nmodule.exports.prototype.resetSequences = require(\"./prototype/resetSequences\");\nmodule.exports.prototype.fireCallback = require(\"./prototype/fireCallback\");\nmodule.exports.prototype.bindSequence = require(\"./prototype/bindSequence\");\nmodule.exports.prototype.resetSequenceTimer = require(\"./prototype/resetSequenceTimer\");\n\nmodule.exports.instances = [];\nmodule.exports.reset = require(\"./reset\");\n\n/**\n * variable to store the flipped version of MAP from above\n * needed to check if we should use keypress or not when no action\n * is specified\n *\n * @type {Object|undefined}\n */\nmodule.exports.REVERSE_MAP = null;\n","/* eslint-env node, browser */\n\"use strict\";\nmodule.exports = function () {\n    var self = this,\n        addEvent,\n        element = self.element,\n        handleKeyEvent,\n        boundHandler;\n\n    handleKeyEvent = require(\"./handleKeyEvent\");\n\n    addEvent = require(\"../../helpers/addEvent\");\n    boundHandler = handleKeyEvent.bind(self);\n    addEvent(element, \"keypress\", boundHandler);\n    addEvent(element, \"keydown\", boundHandler);\n    addEvent(element, \"keyup\", boundHandler);\n};\n","/* eslint-env node, browser */\n\"use strict\";\n/**\n * binds an event to Combokeys\n *\n * can be a single key, a combination of keys separated with +,\n * an array of keys, or a sequence of keys separated by spaces\n *\n * be sure to list the modifier keys first to make sure that the\n * correct key ends up getting bound (the last key in the pattern)\n *\n * @param {string|Array} keys\n * @param {Function} callback\n * @param {string=} action - \"keypress\", \"keydown\", or \"keyup\"\n * @returns void\n */\nmodule.exports = function(keys, callback, action) {\n    var self = this;\n\n    keys = keys instanceof Array ? keys : [keys];\n    self.bindMultiple(keys, callback, action);\n    return self;\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * binds multiple combinations to the same callback\n *\n * @param {Array} combinations\n * @param {Function} callback\n * @param {string|undefined} action\n * @returns void\n */\nmodule.exports = function (combinations, callback, action) {\n    var self = this;\n\n    for (var j = 0; j < combinations.length; ++j) {\n        self.bindSingle(combinations[j], callback, action);\n    }\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * binds a key sequence to an event\n *\n * @param {string} combo - combo specified in bind call\n * @param {Array} keys\n * @param {Function} callback\n * @param {string=} action\n * @returns void\n */\nmodule.exports = function (combo, keys, callback, action) {\n    var self = this;\n\n    // start off by adding a sequence level record for this combination\n    // and setting the level to 0\n    self.sequenceLevels[combo] = 0;\n\n    /**\n     * callback to increase the sequence level for this sequence and reset\n     * all other sequences that were active\n     *\n     * @param {string} nextAction\n     * @returns {Function}\n     */\n    function increaseSequence(nextAction) {\n        return function() {\n            self.nextExpectedAction = nextAction;\n            ++self.sequenceLevels[combo];\n            self.resetSequenceTimer();\n        };\n    }\n\n    /**\n     * wraps the specified callback inside of another function in order\n     * to reset all sequence counters as soon as this sequence is done\n     *\n     * @param {Event} e\n     * @returns void\n     */\n    function callbackAndReset(e) {\n        var characterFromEvent;\n        self.fireCallback(callback, e, combo);\n\n        // we should ignore the next key up if the action is key down\n        // or keypress.  this is so if you finish a sequence and\n        // release the key the final key will not trigger a keyup\n        if (action !== \"keyup\") {\n            characterFromEvent = require(\"../../helpers/characterFromEvent\");\n            self.ignoreNextKeyup = characterFromEvent(e);\n        }\n\n        // weird race condition if a sequence ends with the key\n        // another sequence begins with\n        setTimeout(\n            function() {\n                self.resetSequences();\n            },\n            10\n        );\n    }\n\n    // loop through keys one at a time and bind the appropriate callback\n    // function.  for any key leading up to the final one it should\n    // increase the sequence. after the final, it should reset all sequences\n    //\n    // if an action is specified in the original bind call then that will\n    // be used throughout.  otherwise we will pass the action that the\n    // next key in the sequence should match.  this allows a sequence\n    // to mix and match keypress and keydown events depending on which\n    // ones are better suited to the key provided\n    for (var j = 0; j < keys.length; ++j) {\n        var isFinal = j + 1 === keys.length;\n        var wrappedCallback = isFinal ? callbackAndReset : increaseSequence(action || self.getKeyInfo(keys[j + 1]).action);\n        self.bindSingle(keys[j], wrappedCallback, action, combo, j);\n    }\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * binds a single keyboard combination\n *\n * @param {string} combination\n * @param {Function} callback\n * @param {string=} action\n * @param {string=} sequenceName - name of sequence if part of sequence\n * @param {number=} level - what part of the sequence the command is\n * @returns void\n */\nmodule.exports = function (combination, callback, action, sequenceName, level) {\n    var self = this;\n\n    // store a direct mapped reference for use with Combokeys.trigger\n    self.directMap[combination + \":\" + action] = callback;\n\n    // make sure multiple spaces in a row become a single space\n    combination = combination.replace(/\\s+/g, \" \");\n\n    var sequence = combination.split(\" \"),\n        info;\n\n    // if this pattern is a sequence of keys then run through this method\n    // to reprocess each pattern one key at a time\n    if (sequence.length > 1) {\n        self.bindSequence(combination, sequence, callback, action);\n        return;\n    }\n\n    info = self.getKeyInfo(combination, action);\n\n    // make sure to initialize array if this is the first time\n    // a callback is added for this key\n    self.callbacks[info.key] = self.callbacks[info.key] || [];\n\n    // remove an existing match if there is one\n    self.getMatches(info.key, info.modifiers, {type: info.action}, sequenceName, combination, level);\n\n    // add this call back to the array\n    // if it is a sequence put it at the beginning\n    // if not put it at the end\n    //\n    // this is important because the way these are processed expects\n    // the sequence ones to come first\n    self.callbacks[info.key][sequenceName ? \"unshift\" : \"push\"]({\n        callback: callback,\n        modifiers: info.modifiers,\n        action: info.action,\n        seq: sequenceName,\n        level: level,\n        combo: combination\n    });\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * actually calls the callback function\n *\n * if your callback function returns false this will use the jquery\n * convention - prevent default and stop propogation on the event\n *\n * @param {Function} callback\n * @param {Event} e\n * @returns void\n */\nmodule.exports = function (callback, e, combo, sequence) {\n    var self = this,\n        preventDefault,\n        stopPropagation;\n\n    // if this event should not happen stop here\n    if (self.stopCallback(e, e.target || e.srcElement, combo, sequence)) {\n        return;\n    }\n\n    if (callback(e, combo) === false) {\n        preventDefault = require(\"../../helpers/preventDefault\");\n        preventDefault(e);\n        stopPropagation = require(\"../../helpers/stopPropagation\");\n        stopPropagation(e);\n    }\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * Gets info for a specific key combination\n *\n * @param  {string} combination key combination (\"command+s\" or \"a\" or \"*\")\n * @param  {string=} action\n * @returns {Object}\n */\nmodule.exports = function (combination, action) {\n    var self = this,\n        keysFromString,\n        keys,\n        key,\n        j,\n        modifiers = [],\n        SPECIAL_ALIASES,\n        SHIFT_MAP,\n        isModifier;\n\n    keysFromString = require(\"../../helpers/keysFromString\");\n    // take the keys from this pattern and figure out what the actual\n    // pattern is all about\n    keys = keysFromString(combination);\n\n    SPECIAL_ALIASES = require(\"../../helpers/special-aliases\");\n    SHIFT_MAP = require(\"../../helpers/shift-map\");\n    isModifier = require(\"../../helpers/isModifier\");\n    for (j = 0; j < keys.length; ++j) {\n        key = keys[j];\n\n        // normalize key names\n        if (SPECIAL_ALIASES[key]) {\n            key = SPECIAL_ALIASES[key];\n        }\n\n        // if this is not a keypress event then we should\n        // be smart about using shift keys\n        // this will only work for US keyboards however\n        if (action && action !== \"keypress\" && SHIFT_MAP[key]) {\n            key = SHIFT_MAP[key];\n            modifiers.push(\"shift\");\n        }\n\n        // if this key is a modifier then add it to the list of modifiers\n        if (isModifier(key)) {\n            modifiers.push(key);\n        }\n    }\n\n    // depending on what the key combination is\n    // we will try to pick the best event for it\n    action = self.pickBestAction(key, modifiers, action);\n\n    return {\n        key: key,\n        modifiers: modifiers,\n        action: action\n    };\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * finds all callbacks that match based on the keycode, modifiers,\n * and action\n *\n * @param {string} character\n * @param {Array} modifiers\n * @param {Event|Object} e\n * @param {string=} sequenceName - name of the sequence we are looking for\n * @param {string=} combination\n * @param {number=} level\n * @returns {Array}\n */\nmodule.exports = function (character, modifiers, e, sequenceName, combination, level) {\n    var self = this,\n        j,\n        callback,\n        matches = [],\n        action = e.type,\n        isModifier,\n        modifiersMatch;\n\n    // if there are no events related to this keycode\n    if (!self.callbacks[character]) {\n        return [];\n    }\n\n    isModifier = require(\"../../helpers/isModifier\");\n    // if a modifier key is coming up on its own we should allow it\n    if (action === \"keyup\" && isModifier(character)) {\n        modifiers = [character];\n    }\n\n    // loop through all callbacks for the key that was pressed\n    // and see if any of them match\n    for (j = 0; j < self.callbacks[character].length; ++j) {\n        callback = self.callbacks[character][j];\n\n        // if a sequence name is not specified, but this is a sequence at\n        // the wrong level then move onto the next match\n        if (!sequenceName && callback.seq && self.sequenceLevels[callback.seq] !== callback.level) {\n            continue;\n        }\n\n        // if the action we are looking for doesn't match the action we got\n        // then we should keep going\n        if (action !== callback.action) {\n            continue;\n        }\n\n        // if this is a keypress event and the meta key and control key\n        // are not pressed that means that we need to only look at the\n        // character, otherwise check the modifiers as well\n        //\n        // chrome will not fire a keypress if meta or control is down\n        // safari will fire a keypress if meta or meta+shift is down\n        // firefox will fire a keypress if meta or control is down\n        modifiersMatch = require(\"./modifiersMatch\");\n        if ((action === \"keypress\" && !e.metaKey && !e.ctrlKey) || modifiersMatch(modifiers, callback.modifiers)) {\n\n            // when you bind a combination or sequence a second time it\n            // should overwrite the first one.  if a sequenceName or\n            // combination is specified in this call it does just that\n            //\n            // @todo make deleting its own method?\n            var deleteCombo = !sequenceName && callback.combo === combination;\n            var deleteSequence = sequenceName && callback.seq === sequenceName && callback.level === level;\n            if (deleteCombo || deleteSequence) {\n                self.callbacks[character].splice(j, 1);\n            }\n\n            matches.push(callback);\n        }\n    }\n\n    return matches;\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * reverses the map lookup so that we can look for specific keys\n * to see what can and can't use keypress\n *\n * @return {Object}\n */\nmodule.exports = function () {\n    var self = this,\n        constructor = self.constructor,\n        SPECIAL_KEYS_MAP;\n\n    if (!constructor.REVERSE_MAP) {\n        constructor.REVERSE_MAP = {};\n        SPECIAL_KEYS_MAP = require(\"../../helpers/special-keys-map\");\n        for (var key in SPECIAL_KEYS_MAP) {\n\n            // pull out the numeric keypad from here cause keypress should\n            // be able to detect the keys from the character\n            if (key > 95 && key < 112) {\n                continue;\n            }\n\n            if (SPECIAL_KEYS_MAP.hasOwnProperty(key)) {\n                constructor.REVERSE_MAP[SPECIAL_KEYS_MAP[key]] = key;\n            }\n        }\n    }\n    return constructor.REVERSE_MAP;\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * handles a character key event\n *\n * @param {string} character\n * @param {Array} modifiers\n * @param {Event} e\n * @returns void\n */\nmodule.exports = function (character, modifiers, e) {\n    var self = this,\n        callbacks,\n        j,\n        doNotReset = {},\n        maxLevel = 0,\n        processedSequenceCallback = false,\n        isModifier,\n        ignoreThisKeypress;\n\n    callbacks = self.getMatches(character, modifiers, e);\n    // Calculate the maxLevel for sequences so we can only execute the longest callback sequence\n    for (j = 0; j < callbacks.length; ++j) {\n        if (callbacks[j].seq) {\n            maxLevel = Math.max(maxLevel, callbacks[j].level);\n        }\n    }\n\n    // loop through matching callbacks for this key event\n    for (j = 0; j < callbacks.length; ++j) {\n\n        // fire for all sequence callbacks\n        // this is because if for example you have multiple sequences\n        // bound such as \"g i\" and \"g t\" they both need to fire the\n        // callback for matching g cause otherwise you can only ever\n        // match the first one\n        if (callbacks[j].seq) {\n\n            // only fire callbacks for the maxLevel to prevent\n            // subsequences from also firing\n            //\n            // for example 'a option b' should not cause 'option b' to fire\n            // even though 'option b' is part of the other sequence\n            //\n            // any sequences that do not match here will be discarded\n            // below by the resetSequences call\n            if (callbacks[j].level !== maxLevel) {\n                continue;\n            }\n\n            processedSequenceCallback = true;\n\n            // keep a list of which sequences were matches for later\n            doNotReset[callbacks[j].seq] = 1;\n            self.fireCallback(callbacks[j].callback, e, callbacks[j].combo, callbacks[j].seq);\n            continue;\n        }\n\n        // if there were no sequence matches but we are still here\n        // that means this is a regular match so we should fire that\n        if (!processedSequenceCallback) {\n            self.fireCallback(callbacks[j].callback, e, callbacks[j].combo);\n        }\n    }\n\n    // if the key you pressed matches the type of sequence without\n    // being a modifier (ie \"keyup\" or \"keypress\") then we should\n    // reset all sequences that were not matched by this event\n    //\n    // this is so, for example, if you have the sequence \"h a t\" and you\n    // type \"h e a r t\" it does not match.  in this case the \"e\" will\n    // cause the sequence to reset\n    //\n    // modifier keys are ignored because you can have a sequence\n    // that contains modifiers such as \"enter ctrl+space\" and in most\n    // cases the modifier key will be pressed before the next key\n    //\n    // also if you have a sequence such as \"ctrl+b a\" then pressing the\n    // \"b\" key will trigger a \"keypress\" and a \"keydown\"\n    //\n    // the \"keydown\" is expected when there is a modifier, but the\n    // \"keypress\" ends up matching the nextExpectedAction since it occurs\n    // after and that causes the sequence to reset\n    //\n    // we ignore keypresses in a sequence that directly follow a keydown\n    // for the same character\n    ignoreThisKeypress = e.type === \"keypress\" && self.ignoreNextKeypress;\n    isModifier = require(\"../../helpers/isModifier\");\n    if (e.type === self.nextExpectedAction && !isModifier(character) && !ignoreThisKeypress) {\n        self.resetSequences(doNotReset);\n    }\n\n    self.ignoreNextKeypress = processedSequenceCallback && e.type === \"keydown\";\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * handles a keydown event\n *\n * @param {Event} e\n * @returns void\n */\nmodule.exports = function (e) {\n    var self = this,\n        characterFromEvent,\n        eventModifiers;\n\n    // normalize e.which for key events\n    // @see http://stackoverflow.com/questions/4285627/javascript-keycode-vs-charcode-utter-confusion\n    if (typeof e.which !== \"number\") {\n        e.which = e.keyCode;\n    }\n    characterFromEvent = require(\"../../helpers/characterFromEvent\");\n    var character = characterFromEvent(e);\n\n    // no character found then stop\n    if (!character) {\n        return;\n    }\n\n    // need to use === for the character check because the character can be 0\n    if (e.type === \"keyup\" && self.ignoreNextKeyup === character) {\n        self.ignoreNextKeyup = false;\n        return;\n    }\n\n    eventModifiers = require(\"../../helpers/eventModifiers\");\n    self.handleKey(character, eventModifiers(e), e);\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * checks if two arrays are equal\n *\n * @param {Array} modifiers1\n * @param {Array} modifiers2\n * @returns {boolean}\n */\nmodule.exports = function (modifiers1, modifiers2) {\n    return modifiers1.sort().join(\",\") === modifiers2.sort().join(\",\");\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * picks the best action based on the key combination\n *\n * @param {string} key - character for key\n * @param {Array} modifiers\n * @param {string=} action passed in\n */\nmodule.exports = function (key, modifiers, action) {\n    var self = this;\n\n    // if no action was picked in we should try to pick the one\n    // that we think would work best for this key\n    if (!action) {\n        action = self.getReverseMap()[key] ? \"keydown\" : \"keypress\";\n    }\n\n    // modifier keys don't work as expected with keypress,\n    // switch to keydown\n    if (action === \"keypress\" && modifiers.length) {\n        action = \"keydown\";\n    }\n\n    return action;\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * resets the library back to its initial state. This is useful\n * if you want to clear out the current keyboard shortcuts and bind\n * new ones - for example if you switch to another page\n *\n * @returns void\n */\nmodule.exports = function() {\n    var self = this;\n    self.callbacks = {};\n    self.directMap = {};\n    return this;\n};\n","/* eslint-env node, browser */\n\"use strict\";\n/**\n * called to set a 1 second timeout on the specified sequence\n *\n * this is so after each key press in the sequence you have 1 second\n * to press the next key before you have to start over\n *\n * @returns void\n */\nmodule.exports = function () {\n    var self = this;\n\n    clearTimeout(self.resetTimer);\n    self.resetTimer = setTimeout(\n        function() {\n        self.resetSequences();\n        },\n        1000\n    );\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * resets all sequence counters except for the ones passed in\n *\n * @param {Object} doNotReset\n * @returns void\n */\nmodule.exports = function (doNotReset) {\n    var self = this;\n\n    doNotReset = doNotReset || {};\n\n    var activeSequences = false,\n        key;\n\n    for (key in self.sequenceLevels) {\n        if (doNotReset[key]) {\n            activeSequences = true;\n            continue;\n        }\n        self.sequenceLevels[key] = 0;\n    }\n\n    if (!activeSequences) {\n        self.nextExpectedAction = false;\n    }\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n* should we stop this event before firing off callbacks\n*\n* @param {Event} e\n* @param {Element} element\n* @return {boolean}\n*/\nmodule.exports = function(e, element) {\n\n    // if the element has the class \"combokeys\" then no need to stop\n    if ((\" \" + element.className + \" \").indexOf(\" combokeys \") > -1) {\n        return false;\n    }\n\n    // stop for input, select, and textarea\n    return element.tagName === \"INPUT\" || element.tagName === \"SELECT\" || element.tagName === \"TEXTAREA\" || element.isContentEditable;\n};\n","/* eslint-env node, browser */\n\"use strict\";\n/**\n * triggers an event that has already been bound\n *\n * @param {string} keys\n * @param {string=} action\n * @returns void\n */\nmodule.exports = function(keys, action) {\n    if (directMap[keys + \":\" + action]) {\n        directMap[keys + \":\" + action]({}, keys);\n    }\n    return this;\n};\n","/* eslint-env node, browser */\n\"use strict\";\n/**\n * unbinds an event to Combokeys\n *\n * the unbinding sets the callback function of the specified key combo\n * to an empty function and deletes the corresponding key in the\n * directMap dict.\n *\n * TODO: actually remove this from the callbacks dictionary instead\n * of binding an empty function\n *\n * the keycombo+action has to be exactly the same as\n * it was defined in the bind method\n *\n * @param {string|Array} keys\n * @param {string} action\n * @returns void\n */\nmodule.exports = function(keys, action) {\n    var self = this;\n\n    return self.bind(keys, function() {}, action);\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\nmodule.exports = function () {\n    var self = this;\n\n    self.instances.forEach(function(combokeys) {\n        combokeys.reset();\n    });\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * cross browser add event method\n *\n * @param {Element|HTMLDocument} object\n * @param {string} type\n * @param {Function} callback\n * @returns void\n */\nmodule.exports = function (object, type, callback) {\n    if (object.addEventListener) {\n        object.addEventListener(type, callback, false);\n        return;\n    }\n\n    object.attachEvent(\"on\" + type, callback);\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * takes the event and returns the key character\n *\n * @param {Event} e\n * @return {string}\n */\nmodule.exports = function (e) {\n    var SPECIAL_KEYS_MAP,\n        SPECIAL_CHARACTERS_MAP;\n    SPECIAL_KEYS_MAP = require(\"./special-keys-map\");\n    SPECIAL_CHARACTERS_MAP = require(\"./special-characters-map\");\n\n\n    // for keypress events we should return the character as is\n    if (e.type === \"keypress\") {\n        var character = String.fromCharCode(e.which);\n\n        // if the shift key is not pressed then it is safe to assume\n        // that we want the character to be lowercase.  this means if\n        // you accidentally have caps lock on then your key bindings\n        // will continue to work\n        //\n        // the only side effect that might not be desired is if you\n        // bind something like 'A' cause you want to trigger an\n        // event when capital A is pressed caps lock will no longer\n        // trigger the event.  shift+a will though.\n        if (!e.shiftKey) {\n            character = character.toLowerCase();\n        }\n\n        return character;\n    }\n\n    // for non keypress events the special maps are needed\n    if (SPECIAL_KEYS_MAP[e.which]) {\n        return SPECIAL_KEYS_MAP[e.which];\n    }\n\n    if (SPECIAL_CHARACTERS_MAP[e.which]) {\n        return SPECIAL_CHARACTERS_MAP[e.which];\n    }\n\n    // if it is not in the special map\n\n    // with keydown and keyup events the character seems to always\n    // come in as an uppercase character whether you are pressing shift\n    // or not.  we should make sure it is always lowercase for comparisons\n    return String.fromCharCode(e.which).toLowerCase();\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * takes a key event and figures out what the modifiers are\n *\n * @param {Event} e\n * @returns {Array}\n */\nmodule.exports = function (e) {\n    var modifiers = [];\n\n    if (e.shiftKey) {\n        modifiers.push(\"shift\");\n    }\n\n    if (e.altKey) {\n        modifiers.push(\"alt\");\n    }\n\n    if (e.ctrlKey) {\n        modifiers.push(\"ctrl\");\n    }\n\n    if (e.metaKey) {\n        modifiers.push(\"meta\");\n    }\n\n    return modifiers;\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * determines if the keycode specified is a modifier key or not\n *\n * @param {string} key\n * @returns {boolean}\n */\nmodule.exports = function (key) {\n    return key === \"shift\" || key === \"ctrl\" || key === \"alt\" || key === \"meta\";\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * Converts from a string key combination to an array\n *\n * @param  {string} combination like \"command+shift+l\"\n * @return {Array}\n */\nmodule.exports = function (combination) {\n    if (combination === \"+\") {\n        return [\"+\"];\n    }\n\n    return combination.split(\"+\");\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * prevents default for this event\n *\n * @param {Event} e\n * @returns void\n */\nmodule.exports = function (e) {\n    if (e.preventDefault) {\n        e.preventDefault();\n        return;\n    }\n\n    e.returnValue = false;\n};\n","/* eslint-env node, browser */\n\"use strict\";\n/**\n * this is a mapping of keys that require shift on a US keypad\n * back to the non shift equivelents\n *\n * this is so you can use keyup events with these keys\n *\n * note that this will only work reliably on US keyboards\n *\n * @type {Object}\n */\nmodule.exports = {\n    \"~\": \"`\",\n    \"!\": \"1\",\n    \"@\": \"2\",\n    \"#\": \"3\",\n    \"$\": \"4\",\n    \"%\": \"5\",\n    \"^\": \"6\",\n    \"&\": \"7\",\n    \"*\": \"8\",\n    \"(\": \"9\",\n    \")\": \"0\",\n    \"_\": \"-\",\n    \"+\": \"=\",\n    \":\": \";\",\n    \"\\\"\": \"'\",\n    \"<\": \",\",\n    \">\": \".\",\n    \"?\": \"/\",\n    \"|\": \"\\\\\"\n};\n","/* eslint-env node, browser */\n\"use strict\";\n/**\n * this is a list of special strings you can use to map\n * to modifier keys when you specify your keyboard shortcuts\n *\n * @type {Object}\n */\nmodule.exports = {\n    \"option\": \"alt\",\n    \"command\": \"meta\",\n    \"return\": \"enter\",\n    \"escape\": \"esc\",\n    \"mod\": /Mac|iPod|iPhone|iPad/.test(navigator.platform) ? \"meta\" : \"ctrl\"\n};\n","/* eslint-env node, browser */\n\"use strict\";\n/**\n * mapping for special characters so they can support\n *\n * this dictionary is only used incase you want to bind a\n * keyup or keydown event to one of these keys\n *\n * @type {Object}\n */\nmodule.exports = {\n    106: \"*\",\n    107: \"+\",\n    109: \"-\",\n    110: \".\",\n    111: \"/\",\n    186: \";\",\n    187: \"=\",\n    188: \",\",\n    189: \"-\",\n    190: \".\",\n    191: \"/\",\n    192: \"`\",\n    219: \"[\",\n    220: \"\\\\\",\n    221: \"]\",\n    222: \"'\"\n};\n","/* eslint-env node, browser */\n\"use strict\";\n/**\n * mapping of special keycodes to their corresponding keys\n *\n * everything in this dictionary cannot use keypress events\n * so it has to be here to map to the correct keycodes for\n * keyup/keydown events\n *\n * @type {Object}\n */\nmodule.exports = {\n    8: \"backspace\",\n    9: \"tab\",\n    13: \"enter\",\n    16: \"shift\",\n    17: \"ctrl\",\n    18: \"alt\",\n    20: \"capslock\",\n    27: \"esc\",\n    32: \"space\",\n    33: \"pageup\",\n    34: \"pagedown\",\n    35: \"end\",\n    36: \"home\",\n    37: \"left\",\n    38: \"up\",\n    39: \"right\",\n    40: \"down\",\n    45: \"ins\",\n    46: \"del\",\n    91: \"meta\",\n    93: \"meta\",\n    224: \"meta\"\n};\n\n/**\n * loop through the f keys, f1 to f19 and add them to the map\n * programatically\n */\nfor (var i = 1; i < 20; ++i) {\n    module.exports[111 + i] = \"f\" + i;\n}\n\n/**\n * loop through to map numbers on the numeric keypad\n */\nfor (i = 0; i <= 9; ++i) {\n    module.exports[i + 96] = i;\n}\n","/* eslint-env node, browser */\n\"use strict\";\n\n/**\n * stops propogation for this event\n *\n * @param {Event} e\n * @returns void\n */\nmodule.exports = function (e) {\n    if (e.stopPropagation) {\n        e.stopPropagation();\n        return;\n    }\n\n    e.cancelBubble = true;\n};\n","/* eslint-env node, browser */\n\"use strict\";\n\nmodule.exports = require(\"./Combokeys\");\n","module.exports = createHash\n\nfunction createHash(elem) {\n    var attributes = elem.attributes\n    var hash = {}\n\n    if (attributes === null || attributes === undefined) {\n        return hash\n    }\n\n    for (var i = 0; i < attributes.length; i++) {\n        var attr = attributes[i]\n\n        if (attr.name.substr(0,5) !== \"data-\") {\n            continue\n        }\n\n        hash[attr.name.substr(5)] = attr.value\n    }\n\n    return hash\n}\n","var createStore = require(\"weakmap-shim/create-store\")\nvar Individual = require(\"individual\")\n\nvar createHash = require(\"./create-hash.js\")\n\nvar hashStore = Individual(\"__DATA_SET_WEAKMAP@3\", createStore())\n\nmodule.exports = DataSet\n\nfunction DataSet(elem) {\n    var store = hashStore(elem)\n\n    if (!store.hash) {\n        store.hash = createHash(elem)\n    }\n\n    return store.hash\n}\n","/* See LICENSE file for terms of use */\n\n/*\n * Text diff implementation.\n *\n * This library supports the following APIS:\n * JsDiff.diffChars: Character by character diff\n * JsDiff.diffWords: Word (as defined by \\b regex) diff which ignores whitespace\n * JsDiff.diffLines: Line based diff\n *\n * JsDiff.diffCss: Diff targeted at CSS content\n *\n * These methods are based on the implementation proposed in\n * \"An O(ND) Difference Algorithm and its Variations\" (Myers, 1986).\n * http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.4.6927\n */\nvar JsDiff = (function() {\n  /*jshint maxparams: 5*/\n  function clonePath(path) {\n    return { newPos: path.newPos, components: path.components.slice(0) };\n  }\n  function removeEmpty(array) {\n    var ret = [];\n    for (var i = 0; i < array.length; i++) {\n      if (array[i]) {\n        ret.push(array[i]);\n      }\n    }\n    return ret;\n  }\n  function escapeHTML(s) {\n    var n = s;\n    n = n.replace(/&/g, '&amp;');\n    n = n.replace(/</g, '&lt;');\n    n = n.replace(/>/g, '&gt;');\n    n = n.replace(/\"/g, '&quot;');\n\n    return n;\n  }\n\n  var Diff = function(ignoreWhitespace) {\n    this.ignoreWhitespace = ignoreWhitespace;\n  };\n  Diff.prototype = {\n      diff: function(oldString, newString) {\n        // Handle the identity case (this is due to unrolling editLength == 0\n        if (newString === oldString) {\n          return [{ value: newString }];\n        }\n        if (!newString) {\n          return [{ value: oldString, removed: true }];\n        }\n        if (!oldString) {\n          return [{ value: newString, added: true }];\n        }\n\n        newString = this.tokenize(newString);\n        oldString = this.tokenize(oldString);\n\n        var newLen = newString.length, oldLen = oldString.length;\n        var maxEditLength = newLen + oldLen;\n        var bestPath = [{ newPos: -1, components: [] }];\n\n        // Seed editLength = 0\n        var oldPos = this.extractCommon(bestPath[0], newString, oldString, 0);\n        if (bestPath[0].newPos+1 >= newLen && oldPos+1 >= oldLen) {\n          return bestPath[0].components;\n        }\n\n        for (var editLength = 1; editLength <= maxEditLength; editLength++) {\n          for (var diagonalPath = -1*editLength; diagonalPath <= editLength; diagonalPath+=2) {\n            var basePath;\n            var addPath = bestPath[diagonalPath-1],\n                removePath = bestPath[diagonalPath+1];\n            oldPos = (removePath ? removePath.newPos : 0) - diagonalPath;\n            if (addPath) {\n              // No one else is going to attempt to use this value, clear it\n              bestPath[diagonalPath-1] = undefined;\n            }\n\n            var canAdd = addPath && addPath.newPos+1 < newLen;\n            var canRemove = removePath && 0 <= oldPos && oldPos < oldLen;\n            if (!canAdd && !canRemove) {\n              bestPath[diagonalPath] = undefined;\n              continue;\n            }\n\n            // Select the diagonal that we want to branch from. We select the prior\n            // path whose position in the new string is the farthest from the origin\n            // and does not pass the bounds of the diff graph\n            if (!canAdd || (canRemove && addPath.newPos < removePath.newPos)) {\n              basePath = clonePath(removePath);\n              this.pushComponent(basePath.components, oldString[oldPos], undefined, true);\n            } else {\n              basePath = clonePath(addPath);\n              basePath.newPos++;\n              this.pushComponent(basePath.components, newString[basePath.newPos], true, undefined);\n            }\n\n            var oldPos = this.extractCommon(basePath, newString, oldString, diagonalPath);\n\n            if (basePath.newPos+1 >= newLen && oldPos+1 >= oldLen) {\n              return basePath.components;\n            } else {\n              bestPath[diagonalPath] = basePath;\n            }\n          }\n        }\n      },\n\n      pushComponent: function(components, value, added, removed) {\n        var last = components[components.length-1];\n        if (last && last.added === added && last.removed === removed) {\n          // We need to clone here as the component clone operation is just\n          // as shallow array clone\n          components[components.length-1] =\n            {value: this.join(last.value, value), added: added, removed: removed };\n        } else {\n          components.push({value: value, added: added, removed: removed });\n        }\n      },\n      extractCommon: function(basePath, newString, oldString, diagonalPath) {\n        var newLen = newString.length,\n            oldLen = oldString.length,\n            newPos = basePath.newPos,\n            oldPos = newPos - diagonalPath;\n        while (newPos+1 < newLen && oldPos+1 < oldLen && this.equals(newString[newPos+1], oldString[oldPos+1])) {\n          newPos++;\n          oldPos++;\n\n          this.pushComponent(basePath.components, newString[newPos], undefined, undefined);\n        }\n        basePath.newPos = newPos;\n        return oldPos;\n      },\n\n      equals: function(left, right) {\n        var reWhitespace = /\\S/;\n        if (this.ignoreWhitespace && !reWhitespace.test(left) && !reWhitespace.test(right)) {\n          return true;\n        } else {\n          return left === right;\n        }\n      },\n      join: function(left, right) {\n        return left + right;\n      },\n      tokenize: function(value) {\n        return value;\n      }\n  };\n\n  var CharDiff = new Diff();\n\n  var WordDiff = new Diff(true);\n  var WordWithSpaceDiff = new Diff();\n  WordDiff.tokenize = WordWithSpaceDiff.tokenize = function(value) {\n    return removeEmpty(value.split(/(\\s+|\\b)/));\n  };\n\n  var CssDiff = new Diff(true);\n  CssDiff.tokenize = function(value) {\n    return removeEmpty(value.split(/([{}:;,]|\\s+)/));\n  };\n\n  var LineDiff = new Diff();\n  LineDiff.tokenize = function(value) {\n    var retLines = [],\n        lines = value.split(/^/m);\n\n    for(var i = 0; i < lines.length; i++) {\n      var line = lines[i],\n          lastLine = lines[i - 1];\n\n      // Merge lines that may contain windows new lines\n      if (line == '\\n' && lastLine && lastLine[lastLine.length - 1] === '\\r') {\n        retLines[retLines.length - 1] += '\\n';\n      } else if (line) {\n        retLines.push(line);\n      }\n    }\n\n    return retLines;\n  };\n\n  return {\n    Diff: Diff,\n\n    diffChars: function(oldStr, newStr) { return CharDiff.diff(oldStr, newStr); },\n    diffWords: function(oldStr, newStr) { return WordDiff.diff(oldStr, newStr); },\n    diffWordsWithSpace: function(oldStr, newStr) { return WordWithSpaceDiff.diff(oldStr, newStr); },\n    diffLines: function(oldStr, newStr) { return LineDiff.diff(oldStr, newStr); },\n\n    diffCss: function(oldStr, newStr) { return CssDiff.diff(oldStr, newStr); },\n\n    createPatch: function(fileName, oldStr, newStr, oldHeader, newHeader) {\n      var ret = [];\n\n      ret.push('Index: ' + fileName);\n      ret.push('===================================================================');\n      ret.push('--- ' + fileName + (typeof oldHeader === 'undefined' ? '' : '\\t' + oldHeader));\n      ret.push('+++ ' + fileName + (typeof newHeader === 'undefined' ? '' : '\\t' + newHeader));\n\n      var diff = LineDiff.diff(oldStr, newStr);\n      if (!diff[diff.length-1].value) {\n        diff.pop();   // Remove trailing newline add\n      }\n      diff.push({value: '', lines: []});   // Append an empty value to make cleanup easier\n\n      function contextLines(lines) {\n        return lines.map(function(entry) { return ' ' + entry; });\n      }\n      function eofNL(curRange, i, current) {\n        var last = diff[diff.length-2],\n            isLast = i === diff.length-2,\n            isLastOfType = i === diff.length-3 && (current.added !== last.added || current.removed !== last.removed);\n\n        // Figure out if this is the last line for the given file and missing NL\n        if (!/\\n$/.test(current.value) && (isLast || isLastOfType)) {\n          curRange.push('\\\\ No newline at end of file');\n        }\n      }\n\n      var oldRangeStart = 0, newRangeStart = 0, curRange = [],\n          oldLine = 1, newLine = 1;\n      for (var i = 0; i < diff.length; i++) {\n        var current = diff[i],\n            lines = current.lines || current.value.replace(/\\n$/, '').split('\\n');\n        current.lines = lines;\n\n        if (current.added || current.removed) {\n          if (!oldRangeStart) {\n            var prev = diff[i-1];\n            oldRangeStart = oldLine;\n            newRangeStart = newLine;\n\n            if (prev) {\n              curRange = contextLines(prev.lines.slice(-4));\n              oldRangeStart -= curRange.length;\n              newRangeStart -= curRange.length;\n            }\n          }\n          curRange.push.apply(curRange, lines.map(function(entry) { return (current.added?'+':'-') + entry; }));\n          eofNL(curRange, i, current);\n\n          if (current.added) {\n            newLine += lines.length;\n          } else {\n            oldLine += lines.length;\n          }\n        } else {\n          if (oldRangeStart) {\n            // Close out any changes that have been output (or join overlapping)\n            if (lines.length <= 8 && i < diff.length-2) {\n              // Overlapping\n              curRange.push.apply(curRange, contextLines(lines));\n            } else {\n              // end the range and output\n              var contextSize = Math.min(lines.length, 4);\n              ret.push(\n                  '@@ -' + oldRangeStart + ',' + (oldLine-oldRangeStart+contextSize)\n                  + ' +' + newRangeStart + ',' + (newLine-newRangeStart+contextSize)\n                  + ' @@');\n              ret.push.apply(ret, curRange);\n              ret.push.apply(ret, contextLines(lines.slice(0, contextSize)));\n              if (lines.length <= 4) {\n                eofNL(ret, i, current);\n              }\n\n              oldRangeStart = 0;  newRangeStart = 0; curRange = [];\n            }\n          }\n          oldLine += lines.length;\n          newLine += lines.length;\n        }\n      }\n\n      return ret.join('\\n') + '\\n';\n    },\n\n    applyPatch: function(oldStr, uniDiff) {\n      var diffstr = uniDiff.split('\\n');\n      var diff = [];\n      var remEOFNL = false,\n          addEOFNL = false;\n\n      for (var i = (diffstr[0][0]==='I'?4:0); i < diffstr.length; i++) {\n        if(diffstr[i][0] === '@') {\n          var meh = diffstr[i].split(/@@ -(\\d+),(\\d+) \\+(\\d+),(\\d+) @@/);\n          diff.unshift({\n            start:meh[3],\n            oldlength:meh[2],\n            oldlines:[],\n            newlength:meh[4],\n            newlines:[]\n          });\n        } else if(diffstr[i][0] === '+') {\n          diff[0].newlines.push(diffstr[i].substr(1));\n        } else if(diffstr[i][0] === '-') {\n          diff[0].oldlines.push(diffstr[i].substr(1));\n        } else if(diffstr[i][0] === ' ') {\n          diff[0].newlines.push(diffstr[i].substr(1));\n          diff[0].oldlines.push(diffstr[i].substr(1));\n        } else if(diffstr[i][0] === '\\\\') {\n          if (diffstr[i-1][0] === '+') {\n            remEOFNL = true;\n          } else if(diffstr[i-1][0] === '-') {\n            addEOFNL = true;\n          }\n        }\n      }\n\n      var str = oldStr.split('\\n');\n      for (var i = diff.length - 1; i >= 0; i--) {\n        var d = diff[i];\n        for (var j = 0; j < d.oldlength; j++) {\n          if(str[d.start-1+j] !== d.oldlines[j]) {\n            return false;\n          }\n        }\n        Array.prototype.splice.apply(str,[d.start-1,+d.oldlength].concat(d.newlines));\n      }\n\n      if (remEOFNL) {\n        while (!str[str.length-1]) {\n          str.pop();\n        }\n      } else if (addEOFNL) {\n        str.push('');\n      }\n      return str.join('\\n');\n    },\n\n    convertChangesToXML: function(changes){\n      var ret = [];\n      for ( var i = 0; i < changes.length; i++) {\n        var change = changes[i];\n        if (change.added) {\n          ret.push('<ins>');\n        } else if (change.removed) {\n          ret.push('<del>');\n        }\n\n        ret.push(escapeHTML(change.value));\n\n        if (change.added) {\n          ret.push('</ins>');\n        } else if (change.removed) {\n          ret.push('</del>');\n        }\n      }\n      return ret.join('');\n    },\n\n    // See: http://code.google.com/p/google-diff-match-patch/wiki/API\n    convertChangesToDMP: function(changes){\n      var ret = [], change;\n      for ( var i = 0; i < changes.length; i++) {\n        change = changes[i];\n        ret.push([(change.added ? 1 : change.removed ? -1 : 0), change.value]);\n      }\n      return ret;\n    }\n  };\n})();\n\nif (typeof module !== 'undefined') {\n    module.exports = JsDiff;\n}\n","/*!\n  * domready (c) Dustin Diaz 2014 - License MIT\n  */\n!function (name, definition) {\n\n  if (typeof module != 'undefined') module.exports = definition()\n  else if (typeof define == 'function' && typeof define.amd == 'object') define(definition)\n  else this[name] = definition()\n\n}('domready', function () {\n\n  var fns = [], listener\n    , doc = document\n    , hack = doc.documentElement.doScroll\n    , domContentLoaded = 'DOMContentLoaded'\n    , loaded = (hack ? /^loaded|^c/ : /^loaded|^i|^c/).test(doc.readyState)\n\n\n  if (!loaded)\n  doc.addEventListener(domContentLoaded, listener = function () {\n    doc.removeEventListener(domContentLoaded, listener)\n    loaded = 1\n    while (listener = fns.shift()) listener()\n  })\n\n  return function (fn) {\n    loaded ? fn() : fns.push(fn)\n  }\n\n});\n","module.exports = function(obj) {\n    if (typeof obj === 'string') return camelCase(obj);\n    return walk(obj);\n};\n\nfunction walk (obj) {\n    if (!obj || typeof obj !== 'object') return obj;\n    if (isDate(obj) || isRegex(obj)) return obj;\n    if (isArray(obj)) return map(obj, walk);\n    return reduce(objectKeys(obj), function (acc, key) {\n        var camel = camelCase(key);\n        acc[camel] = walk(obj[key]);\n        return acc;\n    }, {});\n}\n\nfunction camelCase(str) {\n    return str.replace(/[_.-](\\w|$)/g, function (_,x) {\n        return x.toUpperCase();\n    });\n}\n\nvar isArray = Array.isArray || function (obj) {\n    return Object.prototype.toString.call(obj) === '[object Array]';\n};\n\nvar isDate = function (obj) {\n    return Object.prototype.toString.call(obj) === '[object Date]';\n};\n\nvar isRegex = function (obj) {\n    return Object.prototype.toString.call(obj) === '[object RegExp]';\n};\n\nvar has = Object.prototype.hasOwnProperty;\nvar objectKeys = Object.keys || function (obj) {\n    var keys = [];\n    for (var key in obj) {\n        if (has.call(obj, key)) keys.push(key);\n    }\n    return keys;\n};\n\nfunction map (xs, f) {\n    if (xs.map) return xs.map(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        res.push(f(xs[i], i));\n    }\n    return res;\n}\n\nfunction reduce (xs, f, acc) {\n    if (xs.reduce) return xs.reduce(f, acc);\n    for (var i = 0; i < xs.length; i++) {\n        acc = f(acc, xs[i], i);\n    }\n    return acc;\n}\n","var nargs = /\\{([0-9a-zA-Z]+)\\}/g\nvar slice = Array.prototype.slice\n\nmodule.exports = template\n\nfunction template(string) {\n    var args\n\n    if (arguments.length === 2 && typeof arguments[1] === \"object\") {\n        args = arguments[1]\n    } else {\n        args = slice.call(arguments, 1)\n    }\n\n    if (!args || !args.hasOwnProperty) {\n        args = {}\n    }\n\n    return string.replace(nargs, function replaceArg(match, i, index) {\n        var result\n\n        if (string[index - 1] === \"{\" &&\n            string[index + match.length] === \"}\") {\n            return i\n        } else {\n            result = args.hasOwnProperty(i) ? args[i] : null\n            if (result === null || result === undefined) {\n                return \"\"\n            }\n\n            return result\n        }\n    })\n}\n","module.exports = extend\n\nfunction extend(target) {\n    for (var i = 1; i < arguments.length; i++) {\n        var source = arguments[i]\n\n        for (var key in source) {\n            if (source.hasOwnProperty(key)) {\n                target[key] = source[key]\n            }\n        }\n    }\n\n    return target\n}\n","var camelize = require(\"camelize\")\nvar template = require(\"string-template\")\nvar extend = require(\"xtend/mutable\")\n\nmodule.exports = TypedError\n\nfunction TypedError(args) {\n    if (!args) {\n        throw new Error(\"args is required\");\n    }\n    if (!args.type) {\n        throw new Error(\"args.type is required\");\n    }\n    if (!args.message) {\n        throw new Error(\"args.message is required\");\n    }\n\n    var message = args.message\n\n    if (args.type && !args.name) {\n        var errorName = camelize(args.type) + \"Error\"\n        args.name = errorName[0].toUpperCase() + errorName.substr(1)\n    }\n\n    extend(createError, args);\n    createError._name = args.name;\n\n    return createError;\n\n    function createError(opts) {\n        var result = new Error()\n\n        Object.defineProperty(result, \"type\", {\n            value: result.type,\n            enumerable: true,\n            writable: true,\n            configurable: true\n        })\n\n        var options = extend({}, args, opts)\n\n        extend(result, options)\n        result.message = template(message, options)\n\n        return result\n    }\n}\n\n","var root = typeof window !== 'undefined' ?\n    window : typeof global !== 'undefined' ?\n    global : {};\n\nmodule.exports = Individual\n\nfunction Individual(key, value) {\n    if (root[key]) {\n        return root[key]\n    }\n\n    Object.defineProperty(root, key, {\n        value: value\n        , configurable: true\n    })\n\n    return value\n}\n","module.exports = isObject\n\nfunction isObject(x) {\n    return typeof x === \"object\" && x !== null\n}\n","(function() {\r\n  'use strict';\r\n\r\n  if (self.fetch) {\r\n    return\r\n  }\r\n\r\n  function Headers(headers) {\r\n    this.map = {}\r\n\r\n    var self = this\r\n    if (headers instanceof Headers) {\r\n      headers.forEach(function(name, values) {\r\n        values.forEach(function(value) {\r\n          self.append(name, value)\r\n        })\r\n      })\r\n\r\n    } else if (headers) {\r\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\r\n        self.append(name, headers[name])\r\n      })\r\n    }\r\n  }\r\n\r\n  Headers.prototype.append = function(name, value) {\r\n    name = name.toLowerCase()\r\n    var list = this.map[name]\r\n    if (!list) {\r\n      list = []\r\n      this.map[name] = list\r\n    }\r\n    list.push(value)\r\n  }\r\n\r\n  Headers.prototype['delete'] = function(name) {\r\n    delete this.map[name.toLowerCase()]\r\n  }\r\n\r\n  Headers.prototype.get = function(name) {\r\n    var values = this.map[name.toLowerCase()]\r\n    return values ? values[0] : null\r\n  }\r\n\r\n  Headers.prototype.getAll = function(name) {\r\n    return this.map[name.toLowerCase()] || []\r\n  }\r\n\r\n  Headers.prototype.has = function(name) {\r\n    return this.map.hasOwnProperty(name.toLowerCase())\r\n  }\r\n\r\n  Headers.prototype.set = function(name, value) {\r\n    this.map[name.toLowerCase()] = [value]\r\n  }\r\n\r\n  // Instead of iterable for now.\r\n  Headers.prototype.forEach = function(callback) {\r\n    var self = this\r\n    Object.getOwnPropertyNames(this.map).forEach(function(name) {\r\n      callback(name, self.map[name])\r\n    })\r\n  }\r\n\r\n  function consumed(body) {\r\n    if (body.bodyUsed) {\r\n      return Promise.reject(new TypeError('Already read'))\r\n    }\r\n    body.bodyUsed = true\r\n  }\r\n\r\n  function fileReaderReady(reader) {\r\n    return new Promise(function(resolve, reject) {\r\n      reader.onload = function() {\r\n        resolve(reader.result)\r\n      }\r\n      reader.onerror = function() {\r\n        reject(reader.error)\r\n      }\r\n    })\r\n  }\r\n\r\n  function readBlobAsArrayBuffer(blob) {\r\n    var reader = new FileReader()\r\n    reader.readAsArrayBuffer(blob)\r\n    return fileReaderReady(reader)\r\n  }\r\n\r\n  function readBlobAsText(blob) {\r\n    var reader = new FileReader()\r\n    reader.readAsText(blob)\r\n    return fileReaderReady(reader)\r\n  }\r\n\r\n  var support = {\r\n    blob: 'FileReader' in self && 'Blob' in self && (function() {\r\n      try {\r\n        new Blob();\r\n        return true\r\n      } catch(e) {\r\n        return false\r\n      }\r\n    })(),\r\n    formData: 'FormData' in self,\r\n    XDomainRequest: 'XDomainRequest' in self\r\n  }\r\n\r\n  function Body() {\r\n    this.bodyUsed = false\r\n\r\n    if (support.blob) {\r\n      this._initBody = function(body) {\r\n        this._bodyInit = body\r\n        if (typeof body === 'string') {\r\n          this._bodyText = body\r\n        } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\r\n          this._bodyBlob = body\r\n        } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\r\n          this._bodyFormData = body\r\n        } else if (!body) {\r\n          this._bodyText = ''\r\n        } else {\r\n          throw new Error('unsupported BodyInit type')\r\n        }\r\n      }\r\n\r\n      this.blob = function() {\r\n        var rejected = consumed(this)\r\n        if (rejected) {\r\n          return rejected\r\n        }\r\n\r\n        if (this._bodyBlob) {\r\n          return Promise.resolve(this._bodyBlob)\r\n        } else if (this._bodyFormData) {\r\n          throw new Error('could not read FormData body as blob')\r\n        } else {\r\n          return Promise.resolve(new Blob([this._bodyText]))\r\n        }\r\n      }\r\n\r\n      this.arrayBuffer = function() {\r\n        return this.blob().then(readBlobAsArrayBuffer)\r\n      }\r\n\r\n      this.text = function() {\r\n        var rejected = consumed(this)\r\n        if (rejected) {\r\n          return rejected\r\n        }\r\n\r\n        if (this._bodyBlob) {\r\n          return readBlobAsText(this._bodyBlob)\r\n        } else if (this._bodyFormData) {\r\n          throw new Error('could not read FormData body as text')\r\n        } else {\r\n          return Promise.resolve(this._bodyText)\r\n        }\r\n      }\r\n    } else {\r\n      this._initBody = function(body) {\r\n        this._bodyInit = body\r\n        if (typeof body === 'string') {\r\n          this._bodyText = body\r\n        } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\r\n          this._bodyFormData = body\r\n        } else if (!body) {\r\n          this._bodyText = ''\r\n        } else {\r\n          throw new Error('unsupported BodyInit type')\r\n        }\r\n      }\r\n\r\n      this.text = function() {\r\n        var rejected = consumed(this)\r\n        return rejected ? rejected : Promise.resolve(this._bodyText)\r\n      }\r\n    }\r\n\r\n    if (support.formData) {\r\n      this.formData = function() {\r\n        return this.text().then(decode)\r\n      }\r\n    }\r\n\r\n    this.json = function() {\r\n      return this.text().then(JSON.parse)\r\n    }\r\n\r\n    return this\r\n  }\r\n\r\n  // HTTP methods whose capitalization should be normalized\r\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\r\n\r\n  function normalizeMethod(method) {\r\n    var upcased = method.toUpperCase()\r\n    return (methods.indexOf(upcased) > -1) ? upcased : method\r\n  }\r\n\r\n  function Request(url, options) {\r\n    options = options || {}\r\n    this.url = url\r\n\r\n    this.credentials = options.credentials || 'omit'\r\n    this.headers = new Headers(options.headers)\r\n    this.method = normalizeMethod(options.method || 'GET')\r\n    this.mode = options.mode || null\r\n    this.referrer = null\r\n\r\n    if ((this.method === 'GET' || this.method === 'HEAD') && options.body) {\r\n      throw new TypeError('Body not allowed for GET or HEAD requests')\r\n    }\r\n    this._initBody(options.body)\r\n  }\r\n\r\n  function decode(body) {\r\n    var form = new FormData()\r\n    body.trim().split('&').forEach(function(bytes) {\r\n      if (bytes) {\r\n        var split = bytes.split('=')\r\n        var name = split.shift().replace(/\\+/g, ' ')\r\n        var value = split.join('=').replace(/\\+/g, ' ')\r\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\r\n      }\r\n    })\r\n    return form\r\n  }\r\n\r\n  function headers(xhr) {\r\n    var head = new Headers()\r\n    var pairs = xhr.getAllResponseHeaders().trim().split('\\n')\r\n    pairs.forEach(function(header) {\r\n      var split = header.trim().split(':')\r\n      var key = split.shift().trim()\r\n      var value = split.join(':').trim()\r\n      head.append(key, value)\r\n    })\r\n    return head\r\n  }\r\n\r\n  Request.prototype.fetch = function() {\r\n    var self = this\r\n\r\n    return new Promise(function(resolve, reject) {\r\n      var legacyCors = false;\r\n      if (support.XDomainRequest) {\r\n        var origin = location.protocol + '//' + location.host;\r\n        legacyCors = (/^\\/\\//.test(self.url) ? location.protocol + self.url : self.url).substring(0, origin.length) !== origin;\r\n      }\r\n      var xhr = legacyCors ? new XDomainRequest() : new XMLHttpRequest()\r\n\r\n      if (legacyCors) {\r\n        xhr.getAllResponseHeaders = function() {\r\n          return 'Content-Type: '+xhr.contentType;\r\n        };\r\n      } else if (self.credentials === 'cors') {\r\n        xhr.withCredentials = true;\r\n      }\r\n\r\n      function responseURL() {\r\n        if ('responseURL' in xhr) {\r\n          return xhr.responseURL\r\n        }\r\n\r\n        // Avoid security warnings on getResponseHeader when not allowed by CORS\r\n        if (/^X-Request-URL:/m.test(xhr.getAllResponseHeaders())) {\r\n          return xhr.getResponseHeader('X-Request-URL')\r\n        }\r\n\r\n        return;\r\n      }\r\n\r\n      xhr.onload = function() {\r\n        var status = (xhr.status === 1223) ? 204 : xhr.status\r\n\r\n        // If XDomainRequest there is no status code so just hope for the best...\r\n        if (legacyCors) {\r\n          status = 200;\r\n        }\r\n        if (status < 100 || status > 599) {\r\n          reject(new TypeError('Network request failed'))\r\n          return\r\n        }\r\n        var options = {\r\n          status: status,\r\n          statusText: xhr.statusText,\r\n          headers: headers(xhr),\r\n          url: responseURL()\r\n        }\r\n        var body = 'response' in xhr ? xhr.response : xhr.responseText;\r\n        resolve(new Response(body, options))\r\n      }\r\n\r\n      xhr.onerror = function() {\r\n        reject(new TypeError('Network request failed'))\r\n      }\r\n\r\n      xhr.open(self.method, self.url, true)\r\n      if ('responseType' in xhr && support.blob) {\r\n        xhr.responseType = 'blob'\r\n      }\r\n\r\n      self.headers.forEach(function(name, values) {\r\n        values.forEach(function(value) {\r\n          xhr.setRequestHeader(name, value)\r\n        })\r\n      })\r\n\r\n      xhr.send(typeof self._bodyInit === 'undefined' ? null : self._bodyInit)\r\n    })\r\n  }\r\n\r\n  Body.call(Request.prototype)\r\n\r\n  function Response(bodyInit, options) {\r\n    if (!options) {\r\n      options = {}\r\n    }\r\n\r\n    this._initBody(bodyInit)\r\n    this.type = 'default'\r\n    this.url = null\r\n    this.status = options.status\r\n    this.statusText = options.statusText\r\n    this.headers = options.headers\r\n    this.url = options.url || ''\r\n  }\r\n\r\n  Body.call(Response.prototype)\r\n\r\n  self.Headers = Headers;\r\n  self.Request = Request;\r\n  self.Response = Response;\r\n\r\n  self.fetch = function (url, options) {\r\n    return new Request(url, options).fetch()\r\n  }\r\n  self.fetch.polyfill = true\r\n})();\r\n","module.exports = require('whatwg-fetch');\n","if (typeof module === \"object\" && typeof module.exports === \"object\") module.exports = Lexer;\n\nLexer.defunct = function (char) {\n    throw new Error(\"Unexpected character at index \" + (this.index - 1) + \": \" + char);\n};\n\nfunction Lexer(defunct) {\n    if (typeof defunct !== \"function\") defunct = Lexer.defunct;\n\n    var tokens = [];\n    var rules = [];\n    var remove = 0;\n    this.state = 0;\n    this.index = 0;\n    this.input = \"\";\n\n    this.addRule = function (pattern, action, start) {\n        var global = pattern.global;\n\n        if (!global) {\n            var flags = \"g\";\n            if (pattern.multiline) flags += \"m\";\n            if (pattern.ignoreCase) flags += \"i\";\n            pattern = new RegExp(pattern.source, flags);\n        }\n\n        if (Object.prototype.toString.call(start) !== \"[object Array]\") start = [0];\n\n        rules.push({\n            pattern: pattern,\n            global: global,\n            action: action,\n            start: start\n        });\n\n        return this;\n    };\n\n    this.setInput = function (input) {\n        remove = 0;\n        this.state = 0;\n        this.index = 0;\n        this.input = input;\n        return this;\n    };\n\n    this.lex = function () {\n        if (tokens.length) return tokens.shift();\n\n        this.reject = true;\n\n        while (this.index <= this.input.length) {\n            var matches = scan.call(this).splice(remove);\n            var index = this.index;\n\n            while (matches.length) {\n                if (this.reject) {\n                    var match = matches.shift();\n                    var result = match.result;\n                    var length = match.length;\n                    this.index += length;\n                    this.reject = false;\n                    remove++;\n\n                    var token = match.action.apply(this, result);\n                    if (this.reject) this.index = result.index;\n                    else if (typeof token !== \"undefined\") {\n                        switch (Object.prototype.toString.call(token)) {\n                        case \"[object Array]\":\n                            tokens = token.slice(1);\n                            token = token[0];\n                        default:\n                            if (length) remove = 0;\n                            return token;\n                        }\n                    }\n                } else break;\n            }\n\n            var input = this.input;\n\n            if (index < input.length) {\n                if (this.reject) {\n                    remove = 0;\n                    var token = defunct.call(this, input.charAt(this.index++));\n                    if (typeof token !== \"undefined\") {\n                        if (Object.prototype.toString.call(token) === \"[object Array]\") {\n                            tokens = token.slice(1);\n                            return token[0];\n                        } else return token;\n                    }\n                } else {\n                    if (this.index !== index) remove = 0;\n                    this.reject = true;\n                }\n            } else if (matches.length)\n                this.reject = true;\n            else break;\n        }\n    };\n\n    function scan() {\n        var matches = [];\n        var index = 0;\n\n        var state = this.state;\n        var lastIndex = this.index;\n        var input = this.input;\n\n        for (var i = 0, length = rules.length; i < length; i++) {\n            var rule = rules[i];\n            var start = rule.start;\n            var states = start.length;\n\n            if ((!states || start.indexOf(state) >= 0) ||\n                (state % 2 && states === 1 && !start[0])) {\n                var pattern = rule.pattern;\n                pattern.lastIndex = lastIndex;\n                var result = pattern.exec(input);\n\n                if (result && result.index === lastIndex) {\n                    var j = matches.push({\n                        result: result,\n                        action: rule.action,\n                        length: result[0].length\n                    });\n\n                    if (rule.global) index = j;\n\n                    while (--j > index) {\n                        var k = j - 1;\n\n                        if (matches[j].length > matches[k].length) {\n                            var temple = matches[j];\n                            matches[j] = matches[k];\n                            matches[k] = temple;\n                        }\n                    }\n                }\n            }\n        }\n\n        return matches;\n    }\n}\n","/**\n * @license\n * Lo-Dash 2.4.1 (Custom Build) <http://lodash.com/>\n * Build: `lodash modern -o ./dist/lodash.js`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\n;(function() {\n\n  /** Used as a safe reference for `undefined` in pre ES5 environments */\n  var undefined;\n\n  /** Used to pool arrays and objects used internally */\n  var arrayPool = [],\n      objectPool = [];\n\n  /** Used to generate unique IDs */\n  var idCounter = 0;\n\n  /** Used to prefix keys to avoid issues with `__proto__` and properties on `Object.prototype` */\n  var keyPrefix = +new Date + '';\n\n  /** Used as the size when optimizations are enabled for large arrays */\n  var largeArraySize = 75;\n\n  /** Used as the max size of the `arrayPool` and `objectPool` */\n  var maxPoolSize = 40;\n\n  /** Used to detect and test whitespace */\n  var whitespace = (\n    // whitespace\n    ' \\t\\x0B\\f\\xA0\\ufeff' +\n\n    // line terminators\n    '\\n\\r\\u2028\\u2029' +\n\n    // unicode category \"Zs\" space separators\n    '\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000'\n  );\n\n  /** Used to match empty string literals in compiled template source */\n  var reEmptyStringLeading = /\\b__p \\+= '';/g,\n      reEmptyStringMiddle = /\\b(__p \\+=) '' \\+/g,\n      reEmptyStringTrailing = /(__e\\(.*?\\)|\\b__t\\)) \\+\\n'';/g;\n\n  /**\n   * Used to match ES6 template delimiters\n   * http://people.mozilla.org/~jorendorff/es6-draft.html#sec-literals-string-literals\n   */\n  var reEsTemplate = /\\$\\{([^\\\\}]*(?:\\\\.[^\\\\}]*)*)\\}/g;\n\n  /** Used to match regexp flags from their coerced string values */\n  var reFlags = /\\w*$/;\n\n  /** Used to detected named functions */\n  var reFuncName = /^\\s*function[ \\n\\r\\t]+\\w/;\n\n  /** Used to match \"interpolate\" template delimiters */\n  var reInterpolate = /<%=([\\s\\S]+?)%>/g;\n\n  /** Used to match leading whitespace and zeros to be removed */\n  var reLeadingSpacesAndZeros = RegExp('^[' + whitespace + ']*0+(?=.$)');\n\n  /** Used to ensure capturing order of template delimiters */\n  var reNoMatch = /($^)/;\n\n  /** Used to detect functions containing a `this` reference */\n  var reThis = /\\bthis\\b/;\n\n  /** Used to match unescaped characters in compiled string literals */\n  var reUnescapedString = /['\\n\\r\\t\\u2028\\u2029\\\\]/g;\n\n  /** Used to assign default `context` object properties */\n  var contextProps = [\n    'Array', 'Boolean', 'Date', 'Function', 'Math', 'Number', 'Object',\n    'RegExp', 'String', '_', 'attachEvent', 'clearTimeout', 'isFinite', 'isNaN',\n    'parseInt', 'setTimeout'\n  ];\n\n  /** Used to make template sourceURLs easier to identify */\n  var templateCounter = 0;\n\n  /** `Object#toString` result shortcuts */\n  var argsClass = '[object Arguments]',\n      arrayClass = '[object Array]',\n      boolClass = '[object Boolean]',\n      dateClass = '[object Date]',\n      funcClass = '[object Function]',\n      numberClass = '[object Number]',\n      objectClass = '[object Object]',\n      regexpClass = '[object RegExp]',\n      stringClass = '[object String]';\n\n  /** Used to identify object classifications that `_.clone` supports */\n  var cloneableClasses = {};\n  cloneableClasses[funcClass] = false;\n  cloneableClasses[argsClass] = cloneableClasses[arrayClass] =\n  cloneableClasses[boolClass] = cloneableClasses[dateClass] =\n  cloneableClasses[numberClass] = cloneableClasses[objectClass] =\n  cloneableClasses[regexpClass] = cloneableClasses[stringClass] = true;\n\n  /** Used as an internal `_.debounce` options object */\n  var debounceOptions = {\n    'leading': false,\n    'maxWait': 0,\n    'trailing': false\n  };\n\n  /** Used as the property descriptor for `__bindData__` */\n  var descriptor = {\n    'configurable': false,\n    'enumerable': false,\n    'value': null,\n    'writable': false\n  };\n\n  /** Used to determine if values are of the language type Object */\n  var objectTypes = {\n    'boolean': false,\n    'function': true,\n    'object': true,\n    'number': false,\n    'string': false,\n    'undefined': false\n  };\n\n  /** Used to escape characters for inclusion in compiled string literals */\n  var stringEscapes = {\n    '\\\\': '\\\\',\n    \"'\": \"'\",\n    '\\n': 'n',\n    '\\r': 'r',\n    '\\t': 't',\n    '\\u2028': 'u2028',\n    '\\u2029': 'u2029'\n  };\n\n  /** Used as a reference to the global object */\n  var root = (objectTypes[typeof window] && window) || this;\n\n  /** Detect free variable `exports` */\n  var freeExports = objectTypes[typeof exports] && exports && !exports.nodeType && exports;\n\n  /** Detect free variable `module` */\n  var freeModule = objectTypes[typeof module] && module && !module.nodeType && module;\n\n  /** Detect the popular CommonJS extension `module.exports` */\n  var moduleExports = freeModule && freeModule.exports === freeExports && freeExports;\n\n  /** Detect free variable `global` from Node.js or Browserified code and use it as `root` */\n  var freeGlobal = objectTypes[typeof global] && global;\n  if (freeGlobal && (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal)) {\n    root = freeGlobal;\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * The base implementation of `_.indexOf` without support for binary searches\n   * or `fromIndex` constraints.\n   *\n   * @private\n   * @param {Array} array The array to search.\n   * @param {*} value The value to search for.\n   * @param {number} [fromIndex=0] The index to search from.\n   * @returns {number} Returns the index of the matched value or `-1`.\n   */\n  function baseIndexOf(array, value, fromIndex) {\n    var index = (fromIndex || 0) - 1,\n        length = array ? array.length : 0;\n\n    while (++index < length) {\n      if (array[index] === value) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * An implementation of `_.contains` for cache objects that mimics the return\n   * signature of `_.indexOf` by returning `0` if the value is found, else `-1`.\n   *\n   * @private\n   * @param {Object} cache The cache object to inspect.\n   * @param {*} value The value to search for.\n   * @returns {number} Returns `0` if `value` is found, else `-1`.\n   */\n  function cacheIndexOf(cache, value) {\n    var type = typeof value;\n    cache = cache.cache;\n\n    if (type == 'boolean' || value == null) {\n      return cache[value] ? 0 : -1;\n    }\n    if (type != 'number' && type != 'string') {\n      type = 'object';\n    }\n    var key = type == 'number' ? value : keyPrefix + value;\n    cache = (cache = cache[type]) && cache[key];\n\n    return type == 'object'\n      ? (cache && baseIndexOf(cache, value) > -1 ? 0 : -1)\n      : (cache ? 0 : -1);\n  }\n\n  /**\n   * Adds a given value to the corresponding cache object.\n   *\n   * @private\n   * @param {*} value The value to add to the cache.\n   */\n  function cachePush(value) {\n    var cache = this.cache,\n        type = typeof value;\n\n    if (type == 'boolean' || value == null) {\n      cache[value] = true;\n    } else {\n      if (type != 'number' && type != 'string') {\n        type = 'object';\n      }\n      var key = type == 'number' ? value : keyPrefix + value,\n          typeCache = cache[type] || (cache[type] = {});\n\n      if (type == 'object') {\n        (typeCache[key] || (typeCache[key] = [])).push(value);\n      } else {\n        typeCache[key] = true;\n      }\n    }\n  }\n\n  /**\n   * Used by `_.max` and `_.min` as the default callback when a given\n   * collection is a string value.\n   *\n   * @private\n   * @param {string} value The character to inspect.\n   * @returns {number} Returns the code unit of given character.\n   */\n  function charAtCallback(value) {\n    return value.charCodeAt(0);\n  }\n\n  /**\n   * Used by `sortBy` to compare transformed `collection` elements, stable sorting\n   * them in ascending order.\n   *\n   * @private\n   * @param {Object} a The object to compare to `b`.\n   * @param {Object} b The object to compare to `a`.\n   * @returns {number} Returns the sort order indicator of `1` or `-1`.\n   */\n  function compareAscending(a, b) {\n    var ac = a.criteria,\n        bc = b.criteria,\n        index = -1,\n        length = ac.length;\n\n    while (++index < length) {\n      var value = ac[index],\n          other = bc[index];\n\n      if (value !== other) {\n        if (value > other || typeof value == 'undefined') {\n          return 1;\n        }\n        if (value < other || typeof other == 'undefined') {\n          return -1;\n        }\n      }\n    }\n    // Fixes an `Array#sort` bug in the JS engine embedded in Adobe applications\n    // that causes it, under certain circumstances, to return the same value for\n    // `a` and `b`. See https://github.com/jashkenas/underscore/pull/1247\n    //\n    // This also ensures a stable sort in V8 and other engines.\n    // See http://code.google.com/p/v8/issues/detail?id=90\n    return a.index - b.index;\n  }\n\n  /**\n   * Creates a cache object to optimize linear searches of large arrays.\n   *\n   * @private\n   * @param {Array} [array=[]] The array to search.\n   * @returns {null|Object} Returns the cache object or `null` if caching should not be used.\n   */\n  function createCache(array) {\n    var index = -1,\n        length = array.length,\n        first = array[0],\n        mid = array[(length / 2) | 0],\n        last = array[length - 1];\n\n    if (first && typeof first == 'object' &&\n        mid && typeof mid == 'object' && last && typeof last == 'object') {\n      return false;\n    }\n    var cache = getObject();\n    cache['false'] = cache['null'] = cache['true'] = cache['undefined'] = false;\n\n    var result = getObject();\n    result.array = array;\n    result.cache = cache;\n    result.push = cachePush;\n\n    while (++index < length) {\n      result.push(array[index]);\n    }\n    return result;\n  }\n\n  /**\n   * Used by `template` to escape characters for inclusion in compiled\n   * string literals.\n   *\n   * @private\n   * @param {string} match The matched character to escape.\n   * @returns {string} Returns the escaped character.\n   */\n  function escapeStringChar(match) {\n    return '\\\\' + stringEscapes[match];\n  }\n\n  /**\n   * Gets an array from the array pool or creates a new one if the pool is empty.\n   *\n   * @private\n   * @returns {Array} The array from the pool.\n   */\n  function getArray() {\n    return arrayPool.pop() || [];\n  }\n\n  /**\n   * Gets an object from the object pool or creates a new one if the pool is empty.\n   *\n   * @private\n   * @returns {Object} The object from the pool.\n   */\n  function getObject() {\n    return objectPool.pop() || {\n      'array': null,\n      'cache': null,\n      'criteria': null,\n      'false': false,\n      'index': 0,\n      'null': false,\n      'number': null,\n      'object': null,\n      'push': null,\n      'string': null,\n      'true': false,\n      'undefined': false,\n      'value': null\n    };\n  }\n\n  /**\n   * Releases the given array back to the array pool.\n   *\n   * @private\n   * @param {Array} [array] The array to release.\n   */\n  function releaseArray(array) {\n    array.length = 0;\n    if (arrayPool.length < maxPoolSize) {\n      arrayPool.push(array);\n    }\n  }\n\n  /**\n   * Releases the given object back to the object pool.\n   *\n   * @private\n   * @param {Object} [object] The object to release.\n   */\n  function releaseObject(object) {\n    var cache = object.cache;\n    if (cache) {\n      releaseObject(cache);\n    }\n    object.array = object.cache = object.criteria = object.object = object.number = object.string = object.value = null;\n    if (objectPool.length < maxPoolSize) {\n      objectPool.push(object);\n    }\n  }\n\n  /**\n   * Slices the `collection` from the `start` index up to, but not including,\n   * the `end` index.\n   *\n   * Note: This function is used instead of `Array#slice` to support node lists\n   * in IE < 9 and to ensure dense arrays are returned.\n   *\n   * @private\n   * @param {Array|Object|string} collection The collection to slice.\n   * @param {number} start The start index.\n   * @param {number} end The end index.\n   * @returns {Array} Returns the new array.\n   */\n  function slice(array, start, end) {\n    start || (start = 0);\n    if (typeof end == 'undefined') {\n      end = array ? array.length : 0;\n    }\n    var index = -1,\n        length = end - start || 0,\n        result = Array(length < 0 ? 0 : length);\n\n    while (++index < length) {\n      result[index] = array[start + index];\n    }\n    return result;\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Create a new `lodash` function using the given context object.\n   *\n   * @static\n   * @memberOf _\n   * @category Utilities\n   * @param {Object} [context=root] The context object.\n   * @returns {Function} Returns the `lodash` function.\n   */\n  function runInContext(context) {\n    // Avoid issues with some ES3 environments that attempt to use values, named\n    // after built-in constructors like `Object`, for the creation of literals.\n    // ES5 clears this up by stating that literals must use built-in constructors.\n    // See http://es5.github.io/#x11.1.5.\n    context = context ? _.defaults(root.Object(), context, _.pick(root, contextProps)) : root;\n\n    /** Native constructor references */\n    var Array = context.Array,\n        Boolean = context.Boolean,\n        Date = context.Date,\n        Function = context.Function,\n        Math = context.Math,\n        Number = context.Number,\n        Object = context.Object,\n        RegExp = context.RegExp,\n        String = context.String,\n        TypeError = context.TypeError;\n\n    /**\n     * Used for `Array` method references.\n     *\n     * Normally `Array.prototype` would suffice, however, using an array literal\n     * avoids issues in Narwhal.\n     */\n    var arrayRef = [];\n\n    /** Used for native method references */\n    var objectProto = Object.prototype;\n\n    /** Used to restore the original `_` reference in `noConflict` */\n    var oldDash = context._;\n\n    /** Used to resolve the internal [[Class]] of values */\n    var toString = objectProto.toString;\n\n    /** Used to detect if a method is native */\n    var reNative = RegExp('^' +\n      String(toString)\n        .replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\n        .replace(/toString| for [^\\]]+/g, '.*?') + '$'\n    );\n\n    /** Native method shortcuts */\n    var ceil = Math.ceil,\n        clearTimeout = context.clearTimeout,\n        floor = Math.floor,\n        fnToString = Function.prototype.toString,\n        getPrototypeOf = isNative(getPrototypeOf = Object.getPrototypeOf) && getPrototypeOf,\n        hasOwnProperty = objectProto.hasOwnProperty,\n        push = arrayRef.push,\n        setTimeout = context.setTimeout,\n        splice = arrayRef.splice,\n        unshift = arrayRef.unshift;\n\n    /** Used to set meta data on functions */\n    var defineProperty = (function() {\n      // IE 8 only accepts DOM elements\n      try {\n        var o = {},\n            func = isNative(func = Object.defineProperty) && func,\n            result = func(o, o, o) && func;\n      } catch(e) { }\n      return result;\n    }());\n\n    /* Native method shortcuts for methods with the same name as other `lodash` methods */\n    var nativeCreate = isNative(nativeCreate = Object.create) && nativeCreate,\n        nativeIsArray = isNative(nativeIsArray = Array.isArray) && nativeIsArray,\n        nativeIsFinite = context.isFinite,\n        nativeIsNaN = context.isNaN,\n        nativeKeys = isNative(nativeKeys = Object.keys) && nativeKeys,\n        nativeMax = Math.max,\n        nativeMin = Math.min,\n        nativeParseInt = context.parseInt,\n        nativeRandom = Math.random;\n\n    /** Used to lookup a built-in constructor by [[Class]] */\n    var ctorByClass = {};\n    ctorByClass[arrayClass] = Array;\n    ctorByClass[boolClass] = Boolean;\n    ctorByClass[dateClass] = Date;\n    ctorByClass[funcClass] = Function;\n    ctorByClass[objectClass] = Object;\n    ctorByClass[numberClass] = Number;\n    ctorByClass[regexpClass] = RegExp;\n    ctorByClass[stringClass] = String;\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * Creates a `lodash` object which wraps the given value to enable intuitive\n     * method chaining.\n     *\n     * In addition to Lo-Dash methods, wrappers also have the following `Array` methods:\n     * `concat`, `join`, `pop`, `push`, `reverse`, `shift`, `slice`, `sort`, `splice`,\n     * and `unshift`\n     *\n     * Chaining is supported in custom builds as long as the `value` method is\n     * implicitly or explicitly included in the build.\n     *\n     * The chainable wrapper functions are:\n     * `after`, `assign`, `bind`, `bindAll`, `bindKey`, `chain`, `compact`,\n     * `compose`, `concat`, `countBy`, `create`, `createCallback`, `curry`,\n     * `debounce`, `defaults`, `defer`, `delay`, `difference`, `filter`, `flatten`,\n     * `forEach`, `forEachRight`, `forIn`, `forInRight`, `forOwn`, `forOwnRight`,\n     * `functions`, `groupBy`, `indexBy`, `initial`, `intersection`, `invert`,\n     * `invoke`, `keys`, `map`, `max`, `memoize`, `merge`, `min`, `object`, `omit`,\n     * `once`, `pairs`, `partial`, `partialRight`, `pick`, `pluck`, `pull`, `push`,\n     * `range`, `reject`, `remove`, `rest`, `reverse`, `shuffle`, `slice`, `sort`,\n     * `sortBy`, `splice`, `tap`, `throttle`, `times`, `toArray`, `transform`,\n     * `union`, `uniq`, `unshift`, `unzip`, `values`, `where`, `without`, `wrap`,\n     * and `zip`\n     *\n     * The non-chainable wrapper functions are:\n     * `clone`, `cloneDeep`, `contains`, `escape`, `every`, `find`, `findIndex`,\n     * `findKey`, `findLast`, `findLastIndex`, `findLastKey`, `has`, `identity`,\n     * `indexOf`, `isArguments`, `isArray`, `isBoolean`, `isDate`, `isElement`,\n     * `isEmpty`, `isEqual`, `isFinite`, `isFunction`, `isNaN`, `isNull`, `isNumber`,\n     * `isObject`, `isPlainObject`, `isRegExp`, `isString`, `isUndefined`, `join`,\n     * `lastIndexOf`, `mixin`, `noConflict`, `parseInt`, `pop`, `random`, `reduce`,\n     * `reduceRight`, `result`, `shift`, `size`, `some`, `sortedIndex`, `runInContext`,\n     * `template`, `unescape`, `uniqueId`, and `value`\n     *\n     * The wrapper functions `first` and `last` return wrapped values when `n` is\n     * provided, otherwise they return unwrapped values.\n     *\n     * Explicit chaining can be enabled by using the `_.chain` method.\n     *\n     * @name _\n     * @constructor\n     * @category Chaining\n     * @param {*} value The value to wrap in a `lodash` instance.\n     * @returns {Object} Returns a `lodash` instance.\n     * @example\n     *\n     * var wrapped = _([1, 2, 3]);\n     *\n     * // returns an unwrapped value\n     * wrapped.reduce(function(sum, num) {\n     *   return sum + num;\n     * });\n     * // => 6\n     *\n     * // returns a wrapped value\n     * var squares = wrapped.map(function(num) {\n     *   return num * num;\n     * });\n     *\n     * _.isArray(squares);\n     * // => false\n     *\n     * _.isArray(squares.value());\n     * // => true\n     */\n    function lodash(value) {\n      // don't wrap if already wrapped, even if wrapped by a different `lodash` constructor\n      return (value && typeof value == 'object' && !isArray(value) && hasOwnProperty.call(value, '__wrapped__'))\n       ? value\n       : new lodashWrapper(value);\n    }\n\n    /**\n     * A fast path for creating `lodash` wrapper objects.\n     *\n     * @private\n     * @param {*} value The value to wrap in a `lodash` instance.\n     * @param {boolean} chainAll A flag to enable chaining for all methods\n     * @returns {Object} Returns a `lodash` instance.\n     */\n    function lodashWrapper(value, chainAll) {\n      this.__chain__ = !!chainAll;\n      this.__wrapped__ = value;\n    }\n    // ensure `new lodashWrapper` is an instance of `lodash`\n    lodashWrapper.prototype = lodash.prototype;\n\n    /**\n     * An object used to flag environments features.\n     *\n     * @static\n     * @memberOf _\n     * @type Object\n     */\n    var support = lodash.support = {};\n\n    /**\n     * Detect if functions can be decompiled by `Function#toString`\n     * (all but PS3 and older Opera mobile browsers & avoided in Windows 8 apps).\n     *\n     * @memberOf _.support\n     * @type boolean\n     */\n    support.funcDecomp = !isNative(context.WinRTError) && reThis.test(runInContext);\n\n    /**\n     * Detect if `Function#name` is supported (all but IE).\n     *\n     * @memberOf _.support\n     * @type boolean\n     */\n    support.funcNames = typeof Function.name == 'string';\n\n    /**\n     * By default, the template delimiters used by Lo-Dash are similar to those in\n     * embedded Ruby (ERB). Change the following template settings to use alternative\n     * delimiters.\n     *\n     * @static\n     * @memberOf _\n     * @type Object\n     */\n    lodash.templateSettings = {\n\n      /**\n       * Used to detect `data` property values to be HTML-escaped.\n       *\n       * @memberOf _.templateSettings\n       * @type RegExp\n       */\n      'escape': /<%-([\\s\\S]+?)%>/g,\n\n      /**\n       * Used to detect code to be evaluated.\n       *\n       * @memberOf _.templateSettings\n       * @type RegExp\n       */\n      'evaluate': /<%([\\s\\S]+?)%>/g,\n\n      /**\n       * Used to detect `data` property values to inject.\n       *\n       * @memberOf _.templateSettings\n       * @type RegExp\n       */\n      'interpolate': reInterpolate,\n\n      /**\n       * Used to reference the data object in the template text.\n       *\n       * @memberOf _.templateSettings\n       * @type string\n       */\n      'variable': '',\n\n      /**\n       * Used to import variables into the compiled template.\n       *\n       * @memberOf _.templateSettings\n       * @type Object\n       */\n      'imports': {\n\n        /**\n         * A reference to the `lodash` function.\n         *\n         * @memberOf _.templateSettings.imports\n         * @type Function\n         */\n        '_': lodash\n      }\n    };\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * The base implementation of `_.bind` that creates the bound function and\n     * sets its meta data.\n     *\n     * @private\n     * @param {Array} bindData The bind data array.\n     * @returns {Function} Returns the new bound function.\n     */\n    function baseBind(bindData) {\n      var func = bindData[0],\n          partialArgs = bindData[2],\n          thisArg = bindData[4];\n\n      function bound() {\n        // `Function#bind` spec\n        // http://es5.github.io/#x15.3.4.5\n        if (partialArgs) {\n          // avoid `arguments` object deoptimizations by using `slice` instead\n          // of `Array.prototype.slice.call` and not assigning `arguments` to a\n          // variable as a ternary expression\n          var args = slice(partialArgs);\n          push.apply(args, arguments);\n        }\n        // mimic the constructor's `return` behavior\n        // http://es5.github.io/#x13.2.2\n        if (this instanceof bound) {\n          // ensure `new bound` is an instance of `func`\n          var thisBinding = baseCreate(func.prototype),\n              result = func.apply(thisBinding, args || arguments);\n          return isObject(result) ? result : thisBinding;\n        }\n        return func.apply(thisArg, args || arguments);\n      }\n      setBindData(bound, bindData);\n      return bound;\n    }\n\n    /**\n     * The base implementation of `_.clone` without argument juggling or support\n     * for `thisArg` binding.\n     *\n     * @private\n     * @param {*} value The value to clone.\n     * @param {boolean} [isDeep=false] Specify a deep clone.\n     * @param {Function} [callback] The function to customize cloning values.\n     * @param {Array} [stackA=[]] Tracks traversed source objects.\n     * @param {Array} [stackB=[]] Associates clones with source counterparts.\n     * @returns {*} Returns the cloned value.\n     */\n    function baseClone(value, isDeep, callback, stackA, stackB) {\n      if (callback) {\n        var result = callback(value);\n        if (typeof result != 'undefined') {\n          return result;\n        }\n      }\n      // inspect [[Class]]\n      var isObj = isObject(value);\n      if (isObj) {\n        var className = toString.call(value);\n        if (!cloneableClasses[className]) {\n          return value;\n        }\n        var ctor = ctorByClass[className];\n        switch (className) {\n          case boolClass:\n          case dateClass:\n            return new ctor(+value);\n\n          case numberClass:\n          case stringClass:\n            return new ctor(value);\n\n          case regexpClass:\n            result = ctor(value.source, reFlags.exec(value));\n            result.lastIndex = value.lastIndex;\n            return result;\n        }\n      } else {\n        return value;\n      }\n      var isArr = isArray(value);\n      if (isDeep) {\n        // check for circular references and return corresponding clone\n        var initedStack = !stackA;\n        stackA || (stackA = getArray());\n        stackB || (stackB = getArray());\n\n        var length = stackA.length;\n        while (length--) {\n          if (stackA[length] == value) {\n            return stackB[length];\n          }\n        }\n        result = isArr ? ctor(value.length) : {};\n      }\n      else {\n        result = isArr ? slice(value) : assign({}, value);\n      }\n      // add array properties assigned by `RegExp#exec`\n      if (isArr) {\n        if (hasOwnProperty.call(value, 'index')) {\n          result.index = value.index;\n        }\n        if (hasOwnProperty.call(value, 'input')) {\n          result.input = value.input;\n        }\n      }\n      // exit for shallow clone\n      if (!isDeep) {\n        return result;\n      }\n      // add the source value to the stack of traversed objects\n      // and associate it with its clone\n      stackA.push(value);\n      stackB.push(result);\n\n      // recursively populate clone (susceptible to call stack limits)\n      (isArr ? forEach : forOwn)(value, function(objValue, key) {\n        result[key] = baseClone(objValue, isDeep, callback, stackA, stackB);\n      });\n\n      if (initedStack) {\n        releaseArray(stackA);\n        releaseArray(stackB);\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.create` without support for assigning\n     * properties to the created object.\n     *\n     * @private\n     * @param {Object} prototype The object to inherit from.\n     * @returns {Object} Returns the new object.\n     */\n    function baseCreate(prototype, properties) {\n      return isObject(prototype) ? nativeCreate(prototype) : {};\n    }\n    // fallback for browsers without `Object.create`\n    if (!nativeCreate) {\n      baseCreate = (function() {\n        function Object() {}\n        return function(prototype) {\n          if (isObject(prototype)) {\n            Object.prototype = prototype;\n            var result = new Object;\n            Object.prototype = null;\n          }\n          return result || context.Object();\n        };\n      }());\n    }\n\n    /**\n     * The base implementation of `_.createCallback` without support for creating\n     * \"_.pluck\" or \"_.where\" style callbacks.\n     *\n     * @private\n     * @param {*} [func=identity] The value to convert to a callback.\n     * @param {*} [thisArg] The `this` binding of the created callback.\n     * @param {number} [argCount] The number of arguments the callback accepts.\n     * @returns {Function} Returns a callback function.\n     */\n    function baseCreateCallback(func, thisArg, argCount) {\n      if (typeof func != 'function') {\n        return identity;\n      }\n      // exit early for no `thisArg` or already bound by `Function#bind`\n      if (typeof thisArg == 'undefined' || !('prototype' in func)) {\n        return func;\n      }\n      var bindData = func.__bindData__;\n      if (typeof bindData == 'undefined') {\n        if (support.funcNames) {\n          bindData = !func.name;\n        }\n        bindData = bindData || !support.funcDecomp;\n        if (!bindData) {\n          var source = fnToString.call(func);\n          if (!support.funcNames) {\n            bindData = !reFuncName.test(source);\n          }\n          if (!bindData) {\n            // checks if `func` references the `this` keyword and stores the result\n            bindData = reThis.test(source);\n            setBindData(func, bindData);\n          }\n        }\n      }\n      // exit early if there are no `this` references or `func` is bound\n      if (bindData === false || (bindData !== true && bindData[1] & 1)) {\n        return func;\n      }\n      switch (argCount) {\n        case 1: return function(value) {\n          return func.call(thisArg, value);\n        };\n        case 2: return function(a, b) {\n          return func.call(thisArg, a, b);\n        };\n        case 3: return function(value, index, collection) {\n          return func.call(thisArg, value, index, collection);\n        };\n        case 4: return function(accumulator, value, index, collection) {\n          return func.call(thisArg, accumulator, value, index, collection);\n        };\n      }\n      return bind(func, thisArg);\n    }\n\n    /**\n     * The base implementation of `createWrapper` that creates the wrapper and\n     * sets its meta data.\n     *\n     * @private\n     * @param {Array} bindData The bind data array.\n     * @returns {Function} Returns the new function.\n     */\n    function baseCreateWrapper(bindData) {\n      var func = bindData[0],\n          bitmask = bindData[1],\n          partialArgs = bindData[2],\n          partialRightArgs = bindData[3],\n          thisArg = bindData[4],\n          arity = bindData[5];\n\n      var isBind = bitmask & 1,\n          isBindKey = bitmask & 2,\n          isCurry = bitmask & 4,\n          isCurryBound = bitmask & 8,\n          key = func;\n\n      function bound() {\n        var thisBinding = isBind ? thisArg : this;\n        if (partialArgs) {\n          var args = slice(partialArgs);\n          push.apply(args, arguments);\n        }\n        if (partialRightArgs || isCurry) {\n          args || (args = slice(arguments));\n          if (partialRightArgs) {\n            push.apply(args, partialRightArgs);\n          }\n          if (isCurry && args.length < arity) {\n            bitmask |= 16 & ~32;\n            return baseCreateWrapper([func, (isCurryBound ? bitmask : bitmask & ~3), args, null, thisArg, arity]);\n          }\n        }\n        args || (args = arguments);\n        if (isBindKey) {\n          func = thisBinding[key];\n        }\n        if (this instanceof bound) {\n          thisBinding = baseCreate(func.prototype);\n          var result = func.apply(thisBinding, args);\n          return isObject(result) ? result : thisBinding;\n        }\n        return func.apply(thisBinding, args);\n      }\n      setBindData(bound, bindData);\n      return bound;\n    }\n\n    /**\n     * The base implementation of `_.difference` that accepts a single array\n     * of values to exclude.\n     *\n     * @private\n     * @param {Array} array The array to process.\n     * @param {Array} [values] The array of values to exclude.\n     * @returns {Array} Returns a new array of filtered values.\n     */\n    function baseDifference(array, values) {\n      var index = -1,\n          indexOf = getIndexOf(),\n          length = array ? array.length : 0,\n          isLarge = length >= largeArraySize && indexOf === baseIndexOf,\n          result = [];\n\n      if (isLarge) {\n        var cache = createCache(values);\n        if (cache) {\n          indexOf = cacheIndexOf;\n          values = cache;\n        } else {\n          isLarge = false;\n        }\n      }\n      while (++index < length) {\n        var value = array[index];\n        if (indexOf(values, value) < 0) {\n          result.push(value);\n        }\n      }\n      if (isLarge) {\n        releaseObject(values);\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.flatten` without support for callback\n     * shorthands or `thisArg` binding.\n     *\n     * @private\n     * @param {Array} array The array to flatten.\n     * @param {boolean} [isShallow=false] A flag to restrict flattening to a single level.\n     * @param {boolean} [isStrict=false] A flag to restrict flattening to arrays and `arguments` objects.\n     * @param {number} [fromIndex=0] The index to start from.\n     * @returns {Array} Returns a new flattened array.\n     */\n    function baseFlatten(array, isShallow, isStrict, fromIndex) {\n      var index = (fromIndex || 0) - 1,\n          length = array ? array.length : 0,\n          result = [];\n\n      while (++index < length) {\n        var value = array[index];\n\n        if (value && typeof value == 'object' && typeof value.length == 'number'\n            && (isArray(value) || isArguments(value))) {\n          // recursively flatten arrays (susceptible to call stack limits)\n          if (!isShallow) {\n            value = baseFlatten(value, isShallow, isStrict);\n          }\n          var valIndex = -1,\n              valLength = value.length,\n              resIndex = result.length;\n\n          result.length += valLength;\n          while (++valIndex < valLength) {\n            result[resIndex++] = value[valIndex];\n          }\n        } else if (!isStrict) {\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.isEqual`, without support for `thisArg` binding,\n     * that allows partial \"_.where\" style comparisons.\n     *\n     * @private\n     * @param {*} a The value to compare.\n     * @param {*} b The other value to compare.\n     * @param {Function} [callback] The function to customize comparing values.\n     * @param {Function} [isWhere=false] A flag to indicate performing partial comparisons.\n     * @param {Array} [stackA=[]] Tracks traversed `a` objects.\n     * @param {Array} [stackB=[]] Tracks traversed `b` objects.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     */\n    function baseIsEqual(a, b, callback, isWhere, stackA, stackB) {\n      // used to indicate that when comparing objects, `a` has at least the properties of `b`\n      if (callback) {\n        var result = callback(a, b);\n        if (typeof result != 'undefined') {\n          return !!result;\n        }\n      }\n      // exit early for identical values\n      if (a === b) {\n        // treat `+0` vs. `-0` as not equal\n        return a !== 0 || (1 / a == 1 / b);\n      }\n      var type = typeof a,\n          otherType = typeof b;\n\n      // exit early for unlike primitive values\n      if (a === a &&\n          !(a && objectTypes[type]) &&\n          !(b && objectTypes[otherType])) {\n        return false;\n      }\n      // exit early for `null` and `undefined` avoiding ES3's Function#call behavior\n      // http://es5.github.io/#x15.3.4.4\n      if (a == null || b == null) {\n        return a === b;\n      }\n      // compare [[Class]] names\n      var className = toString.call(a),\n          otherClass = toString.call(b);\n\n      if (className == argsClass) {\n        className = objectClass;\n      }\n      if (otherClass == argsClass) {\n        otherClass = objectClass;\n      }\n      if (className != otherClass) {\n        return false;\n      }\n      switch (className) {\n        case boolClass:\n        case dateClass:\n          // coerce dates and booleans to numbers, dates to milliseconds and booleans\n          // to `1` or `0` treating invalid dates coerced to `NaN` as not equal\n          return +a == +b;\n\n        case numberClass:\n          // treat `NaN` vs. `NaN` as equal\n          return (a != +a)\n            ? b != +b\n            // but treat `+0` vs. `-0` as not equal\n            : (a == 0 ? (1 / a == 1 / b) : a == +b);\n\n        case regexpClass:\n        case stringClass:\n          // coerce regexes to strings (http://es5.github.io/#x15.10.6.4)\n          // treat string primitives and their corresponding object instances as equal\n          return a == String(b);\n      }\n      var isArr = className == arrayClass;\n      if (!isArr) {\n        // unwrap any `lodash` wrapped values\n        var aWrapped = hasOwnProperty.call(a, '__wrapped__'),\n            bWrapped = hasOwnProperty.call(b, '__wrapped__');\n\n        if (aWrapped || bWrapped) {\n          return baseIsEqual(aWrapped ? a.__wrapped__ : a, bWrapped ? b.__wrapped__ : b, callback, isWhere, stackA, stackB);\n        }\n        // exit for functions and DOM nodes\n        if (className != objectClass) {\n          return false;\n        }\n        // in older versions of Opera, `arguments` objects have `Array` constructors\n        var ctorA = a.constructor,\n            ctorB = b.constructor;\n\n        // non `Object` object instances with different constructors are not equal\n        if (ctorA != ctorB &&\n              !(isFunction(ctorA) && ctorA instanceof ctorA && isFunction(ctorB) && ctorB instanceof ctorB) &&\n              ('constructor' in a && 'constructor' in b)\n            ) {\n          return false;\n        }\n      }\n      // assume cyclic structures are equal\n      // the algorithm for detecting cyclic structures is adapted from ES 5.1\n      // section 15.12.3, abstract operation `JO` (http://es5.github.io/#x15.12.3)\n      var initedStack = !stackA;\n      stackA || (stackA = getArray());\n      stackB || (stackB = getArray());\n\n      var length = stackA.length;\n      while (length--) {\n        if (stackA[length] == a) {\n          return stackB[length] == b;\n        }\n      }\n      var size = 0;\n      result = true;\n\n      // add `a` and `b` to the stack of traversed objects\n      stackA.push(a);\n      stackB.push(b);\n\n      // recursively compare objects and arrays (susceptible to call stack limits)\n      if (isArr) {\n        // compare lengths to determine if a deep comparison is necessary\n        length = a.length;\n        size = b.length;\n        result = size == length;\n\n        if (result || isWhere) {\n          // deep compare the contents, ignoring non-numeric properties\n          while (size--) {\n            var index = length,\n                value = b[size];\n\n            if (isWhere) {\n              while (index--) {\n                if ((result = baseIsEqual(a[index], value, callback, isWhere, stackA, stackB))) {\n                  break;\n                }\n              }\n            } else if (!(result = baseIsEqual(a[size], value, callback, isWhere, stackA, stackB))) {\n              break;\n            }\n          }\n        }\n      }\n      else {\n        // deep compare objects using `forIn`, instead of `forOwn`, to avoid `Object.keys`\n        // which, in this case, is more costly\n        forIn(b, function(value, key, b) {\n          if (hasOwnProperty.call(b, key)) {\n            // count the number of properties.\n            size++;\n            // deep compare each property value.\n            return (result = hasOwnProperty.call(a, key) && baseIsEqual(a[key], value, callback, isWhere, stackA, stackB));\n          }\n        });\n\n        if (result && !isWhere) {\n          // ensure both objects have the same number of properties\n          forIn(a, function(value, key, a) {\n            if (hasOwnProperty.call(a, key)) {\n              // `size` will be `-1` if `a` has more properties than `b`\n              return (result = --size > -1);\n            }\n          });\n        }\n      }\n      stackA.pop();\n      stackB.pop();\n\n      if (initedStack) {\n        releaseArray(stackA);\n        releaseArray(stackB);\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.merge` without argument juggling or support\n     * for `thisArg` binding.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @param {Function} [callback] The function to customize merging properties.\n     * @param {Array} [stackA=[]] Tracks traversed source objects.\n     * @param {Array} [stackB=[]] Associates values with source counterparts.\n     */\n    function baseMerge(object, source, callback, stackA, stackB) {\n      (isArray(source) ? forEach : forOwn)(source, function(source, key) {\n        var found,\n            isArr,\n            result = source,\n            value = object[key];\n\n        if (source && ((isArr = isArray(source)) || isPlainObject(source))) {\n          // avoid merging previously merged cyclic sources\n          var stackLength = stackA.length;\n          while (stackLength--) {\n            if ((found = stackA[stackLength] == source)) {\n              value = stackB[stackLength];\n              break;\n            }\n          }\n          if (!found) {\n            var isShallow;\n            if (callback) {\n              result = callback(value, source);\n              if ((isShallow = typeof result != 'undefined')) {\n                value = result;\n              }\n            }\n            if (!isShallow) {\n              value = isArr\n                ? (isArray(value) ? value : [])\n                : (isPlainObject(value) ? value : {});\n            }\n            // add `source` and associated `value` to the stack of traversed objects\n            stackA.push(source);\n            stackB.push(value);\n\n            // recursively merge objects and arrays (susceptible to call stack limits)\n            if (!isShallow) {\n              baseMerge(value, source, callback, stackA, stackB);\n            }\n          }\n        }\n        else {\n          if (callback) {\n            result = callback(value, source);\n            if (typeof result == 'undefined') {\n              result = source;\n            }\n          }\n          if (typeof result != 'undefined') {\n            value = result;\n          }\n        }\n        object[key] = value;\n      });\n    }\n\n    /**\n     * The base implementation of `_.random` without argument juggling or support\n     * for returning floating-point numbers.\n     *\n     * @private\n     * @param {number} min The minimum possible value.\n     * @param {number} max The maximum possible value.\n     * @returns {number} Returns a random number.\n     */\n    function baseRandom(min, max) {\n      return min + floor(nativeRandom() * (max - min + 1));\n    }\n\n    /**\n     * The base implementation of `_.uniq` without support for callback shorthands\n     * or `thisArg` binding.\n     *\n     * @private\n     * @param {Array} array The array to process.\n     * @param {boolean} [isSorted=false] A flag to indicate that `array` is sorted.\n     * @param {Function} [callback] The function called per iteration.\n     * @returns {Array} Returns a duplicate-value-free array.\n     */\n    function baseUniq(array, isSorted, callback) {\n      var index = -1,\n          indexOf = getIndexOf(),\n          length = array ? array.length : 0,\n          result = [];\n\n      var isLarge = !isSorted && length >= largeArraySize && indexOf === baseIndexOf,\n          seen = (callback || isLarge) ? getArray() : result;\n\n      if (isLarge) {\n        var cache = createCache(seen);\n        indexOf = cacheIndexOf;\n        seen = cache;\n      }\n      while (++index < length) {\n        var value = array[index],\n            computed = callback ? callback(value, index, array) : value;\n\n        if (isSorted\n              ? !index || seen[seen.length - 1] !== computed\n              : indexOf(seen, computed) < 0\n            ) {\n          if (callback || isLarge) {\n            seen.push(computed);\n          }\n          result.push(value);\n        }\n      }\n      if (isLarge) {\n        releaseArray(seen.array);\n        releaseObject(seen);\n      } else if (callback) {\n        releaseArray(seen);\n      }\n      return result;\n    }\n\n    /**\n     * Creates a function that aggregates a collection, creating an object composed\n     * of keys generated from the results of running each element of the collection\n     * through a callback. The given `setter` function sets the keys and values\n     * of the composed object.\n     *\n     * @private\n     * @param {Function} setter The setter function.\n     * @returns {Function} Returns the new aggregator function.\n     */\n    function createAggregator(setter) {\n      return function(collection, callback, thisArg) {\n        var result = {};\n        callback = lodash.createCallback(callback, thisArg, 3);\n\n        var index = -1,\n            length = collection ? collection.length : 0;\n\n        if (typeof length == 'number') {\n          while (++index < length) {\n            var value = collection[index];\n            setter(result, value, callback(value, index, collection), collection);\n          }\n        } else {\n          forOwn(collection, function(value, key, collection) {\n            setter(result, value, callback(value, key, collection), collection);\n          });\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Creates a function that, when called, either curries or invokes `func`\n     * with an optional `this` binding and partially applied arguments.\n     *\n     * @private\n     * @param {Function|string} func The function or method name to reference.\n     * @param {number} bitmask The bitmask of method flags to compose.\n     *  The bitmask may be composed of the following flags:\n     *  1 - `_.bind`\n     *  2 - `_.bindKey`\n     *  4 - `_.curry`\n     *  8 - `_.curry` (bound)\n     *  16 - `_.partial`\n     *  32 - `_.partialRight`\n     * @param {Array} [partialArgs] An array of arguments to prepend to those\n     *  provided to the new function.\n     * @param {Array} [partialRightArgs] An array of arguments to append to those\n     *  provided to the new function.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {number} [arity] The arity of `func`.\n     * @returns {Function} Returns the new function.\n     */\n    function createWrapper(func, bitmask, partialArgs, partialRightArgs, thisArg, arity) {\n      var isBind = bitmask & 1,\n          isBindKey = bitmask & 2,\n          isCurry = bitmask & 4,\n          isCurryBound = bitmask & 8,\n          isPartial = bitmask & 16,\n          isPartialRight = bitmask & 32;\n\n      if (!isBindKey && !isFunction(func)) {\n        throw new TypeError;\n      }\n      if (isPartial && !partialArgs.length) {\n        bitmask &= ~16;\n        isPartial = partialArgs = false;\n      }\n      if (isPartialRight && !partialRightArgs.length) {\n        bitmask &= ~32;\n        isPartialRight = partialRightArgs = false;\n      }\n      var bindData = func && func.__bindData__;\n      if (bindData && bindData !== true) {\n        // clone `bindData`\n        bindData = slice(bindData);\n        if (bindData[2]) {\n          bindData[2] = slice(bindData[2]);\n        }\n        if (bindData[3]) {\n          bindData[3] = slice(bindData[3]);\n        }\n        // set `thisBinding` is not previously bound\n        if (isBind && !(bindData[1] & 1)) {\n          bindData[4] = thisArg;\n        }\n        // set if previously bound but not currently (subsequent curried functions)\n        if (!isBind && bindData[1] & 1) {\n          bitmask |= 8;\n        }\n        // set curried arity if not yet set\n        if (isCurry && !(bindData[1] & 4)) {\n          bindData[5] = arity;\n        }\n        // append partial left arguments\n        if (isPartial) {\n          push.apply(bindData[2] || (bindData[2] = []), partialArgs);\n        }\n        // append partial right arguments\n        if (isPartialRight) {\n          unshift.apply(bindData[3] || (bindData[3] = []), partialRightArgs);\n        }\n        // merge flags\n        bindData[1] |= bitmask;\n        return createWrapper.apply(null, bindData);\n      }\n      // fast path for `_.bind`\n      var creater = (bitmask == 1 || bitmask === 17) ? baseBind : baseCreateWrapper;\n      return creater([func, bitmask, partialArgs, partialRightArgs, thisArg, arity]);\n    }\n\n    /**\n     * Used by `escape` to convert characters to HTML entities.\n     *\n     * @private\n     * @param {string} match The matched character to escape.\n     * @returns {string} Returns the escaped character.\n     */\n    function escapeHtmlChar(match) {\n      return htmlEscapes[match];\n    }\n\n    /**\n     * Gets the appropriate \"indexOf\" function. If the `_.indexOf` method is\n     * customized, this method returns the custom method, otherwise it returns\n     * the `baseIndexOf` function.\n     *\n     * @private\n     * @returns {Function} Returns the \"indexOf\" function.\n     */\n    function getIndexOf() {\n      var result = (result = lodash.indexOf) === indexOf ? baseIndexOf : result;\n      return result;\n    }\n\n    /**\n     * Checks if `value` is a native function.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is a native function, else `false`.\n     */\n    function isNative(value) {\n      return typeof value == 'function' && reNative.test(value);\n    }\n\n    /**\n     * Sets `this` binding data on a given function.\n     *\n     * @private\n     * @param {Function} func The function to set data on.\n     * @param {Array} value The data array to set.\n     */\n    var setBindData = !defineProperty ? noop : function(func, value) {\n      descriptor.value = value;\n      defineProperty(func, '__bindData__', descriptor);\n    };\n\n    /**\n     * A fallback implementation of `isPlainObject` which checks if a given value\n     * is an object created by the `Object` constructor, assuming objects created\n     * by the `Object` constructor have no inherited enumerable properties and that\n     * there are no `Object.prototype` extensions.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n     */\n    function shimIsPlainObject(value) {\n      var ctor,\n          result;\n\n      // avoid non Object objects, `arguments` objects, and DOM elements\n      if (!(value && toString.call(value) == objectClass) ||\n          (ctor = value.constructor, isFunction(ctor) && !(ctor instanceof ctor))) {\n        return false;\n      }\n      // In most environments an object's own properties are iterated before\n      // its inherited properties. If the last iterated property is an object's\n      // own property then there are no inherited enumerable properties.\n      forIn(value, function(value, key) {\n        result = key;\n      });\n      return typeof result == 'undefined' || hasOwnProperty.call(value, result);\n    }\n\n    /**\n     * Used by `unescape` to convert HTML entities to characters.\n     *\n     * @private\n     * @param {string} match The matched character to unescape.\n     * @returns {string} Returns the unescaped character.\n     */\n    function unescapeHtmlChar(match) {\n      return htmlUnescapes[match];\n    }\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * Checks if `value` is an `arguments` object.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is an `arguments` object, else `false`.\n     * @example\n     *\n     * (function() { return _.isArguments(arguments); })(1, 2, 3);\n     * // => true\n     *\n     * _.isArguments([1, 2, 3]);\n     * // => false\n     */\n    function isArguments(value) {\n      return value && typeof value == 'object' && typeof value.length == 'number' &&\n        toString.call(value) == argsClass || false;\n    }\n\n    /**\n     * Checks if `value` is an array.\n     *\n     * @static\n     * @memberOf _\n     * @type Function\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is an array, else `false`.\n     * @example\n     *\n     * (function() { return _.isArray(arguments); })();\n     * // => false\n     *\n     * _.isArray([1, 2, 3]);\n     * // => true\n     */\n    var isArray = nativeIsArray || function(value) {\n      return value && typeof value == 'object' && typeof value.length == 'number' &&\n        toString.call(value) == arrayClass || false;\n    };\n\n    /**\n     * A fallback implementation of `Object.keys` which produces an array of the\n     * given object's own enumerable property names.\n     *\n     * @private\n     * @type Function\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns an array of property names.\n     */\n    var shimKeys = function(object) {\n      var index, iterable = object, result = [];\n      if (!iterable) return result;\n      if (!(objectTypes[typeof object])) return result;\n        for (index in iterable) {\n          if (hasOwnProperty.call(iterable, index)) {\n            result.push(index);\n          }\n        }\n      return result\n    };\n\n    /**\n     * Creates an array composed of the own enumerable property names of an object.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns an array of property names.\n     * @example\n     *\n     * _.keys({ 'one': 1, 'two': 2, 'three': 3 });\n     * // => ['one', 'two', 'three'] (property order is not guaranteed across environments)\n     */\n    var keys = !nativeKeys ? shimKeys : function(object) {\n      if (!isObject(object)) {\n        return [];\n      }\n      return nativeKeys(object);\n    };\n\n    /**\n     * Used to convert characters to HTML entities:\n     *\n     * Though the `>` character is escaped for symmetry, characters like `>` and `/`\n     * don't require escaping in HTML and have no special meaning unless they're part\n     * of a tag or an unquoted attribute value.\n     * http://mathiasbynens.be/notes/ambiguous-ampersands (under \"semi-related fun fact\")\n     */\n    var htmlEscapes = {\n      '&': '&amp;',\n      '<': '&lt;',\n      '>': '&gt;',\n      '\"': '&quot;',\n      \"'\": '&#39;'\n    };\n\n    /** Used to convert HTML entities to characters */\n    var htmlUnescapes = invert(htmlEscapes);\n\n    /** Used to match HTML entities and HTML characters */\n    var reEscapedHtml = RegExp('(' + keys(htmlUnescapes).join('|') + ')', 'g'),\n        reUnescapedHtml = RegExp('[' + keys(htmlEscapes).join('') + ']', 'g');\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * Assigns own enumerable properties of source object(s) to the destination\n     * object. Subsequent sources will overwrite property assignments of previous\n     * sources. If a callback is provided it will be executed to produce the\n     * assigned values. The callback is bound to `thisArg` and invoked with two\n     * arguments; (objectValue, sourceValue).\n     *\n     * @static\n     * @memberOf _\n     * @type Function\n     * @alias extend\n     * @category Objects\n     * @param {Object} object The destination object.\n     * @param {...Object} [source] The source objects.\n     * @param {Function} [callback] The function to customize assigning values.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns the destination object.\n     * @example\n     *\n     * _.assign({ 'name': 'fred' }, { 'employer': 'slate' });\n     * // => { 'name': 'fred', 'employer': 'slate' }\n     *\n     * var defaults = _.partialRight(_.assign, function(a, b) {\n     *   return typeof a == 'undefined' ? b : a;\n     * });\n     *\n     * var object = { 'name': 'barney' };\n     * defaults(object, { 'name': 'fred', 'employer': 'slate' });\n     * // => { 'name': 'barney', 'employer': 'slate' }\n     */\n    var assign = function(object, source, guard) {\n      var index, iterable = object, result = iterable;\n      if (!iterable) return result;\n      var args = arguments,\n          argsIndex = 0,\n          argsLength = typeof guard == 'number' ? 2 : args.length;\n      if (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n        var callback = baseCreateCallback(args[--argsLength - 1], args[argsLength--], 2);\n      } else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n        callback = args[--argsLength];\n      }\n      while (++argsIndex < argsLength) {\n        iterable = args[argsIndex];\n        if (iterable && objectTypes[typeof iterable]) {\n        var ownIndex = -1,\n            ownProps = objectTypes[typeof iterable] && keys(iterable),\n            length = ownProps ? ownProps.length : 0;\n\n        while (++ownIndex < length) {\n          index = ownProps[ownIndex];\n          result[index] = callback ? callback(result[index], iterable[index]) : iterable[index];\n        }\n        }\n      }\n      return result\n    };\n\n    /**\n     * Creates a clone of `value`. If `isDeep` is `true` nested objects will also\n     * be cloned, otherwise they will be assigned by reference. If a callback\n     * is provided it will be executed to produce the cloned values. If the\n     * callback returns `undefined` cloning will be handled by the method instead.\n     * The callback is bound to `thisArg` and invoked with one argument; (value).\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to clone.\n     * @param {boolean} [isDeep=false] Specify a deep clone.\n     * @param {Function} [callback] The function to customize cloning values.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the cloned value.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36 },\n     *   { 'name': 'fred',   'age': 40 }\n     * ];\n     *\n     * var shallow = _.clone(characters);\n     * shallow[0] === characters[0];\n     * // => true\n     *\n     * var deep = _.clone(characters, true);\n     * deep[0] === characters[0];\n     * // => false\n     *\n     * _.mixin({\n     *   'clone': _.partialRight(_.clone, function(value) {\n     *     return _.isElement(value) ? value.cloneNode(false) : undefined;\n     *   })\n     * });\n     *\n     * var clone = _.clone(document.body);\n     * clone.childNodes.length;\n     * // => 0\n     */\n    function clone(value, isDeep, callback, thisArg) {\n      // allows working with \"Collections\" methods without using their `index`\n      // and `collection` arguments for `isDeep` and `callback`\n      if (typeof isDeep != 'boolean' && isDeep != null) {\n        thisArg = callback;\n        callback = isDeep;\n        isDeep = false;\n      }\n      return baseClone(value, isDeep, typeof callback == 'function' && baseCreateCallback(callback, thisArg, 1));\n    }\n\n    /**\n     * Creates a deep clone of `value`. If a callback is provided it will be\n     * executed to produce the cloned values. If the callback returns `undefined`\n     * cloning will be handled by the method instead. The callback is bound to\n     * `thisArg` and invoked with one argument; (value).\n     *\n     * Note: This method is loosely based on the structured clone algorithm. Functions\n     * and DOM nodes are **not** cloned. The enumerable properties of `arguments` objects and\n     * objects created by constructors other than `Object` are cloned to plain `Object` objects.\n     * See http://www.w3.org/TR/html5/infrastructure.html#internal-structured-cloning-algorithm.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to deep clone.\n     * @param {Function} [callback] The function to customize cloning values.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the deep cloned value.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36 },\n     *   { 'name': 'fred',   'age': 40 }\n     * ];\n     *\n     * var deep = _.cloneDeep(characters);\n     * deep[0] === characters[0];\n     * // => false\n     *\n     * var view = {\n     *   'label': 'docs',\n     *   'node': element\n     * };\n     *\n     * var clone = _.cloneDeep(view, function(value) {\n     *   return _.isElement(value) ? value.cloneNode(true) : undefined;\n     * });\n     *\n     * clone.node == view.node;\n     * // => false\n     */\n    function cloneDeep(value, callback, thisArg) {\n      return baseClone(value, true, typeof callback == 'function' && baseCreateCallback(callback, thisArg, 1));\n    }\n\n    /**\n     * Creates an object that inherits from the given `prototype` object. If a\n     * `properties` object is provided its own enumerable properties are assigned\n     * to the created object.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} prototype The object to inherit from.\n     * @param {Object} [properties] The properties to assign to the object.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * function Shape() {\n     *   this.x = 0;\n     *   this.y = 0;\n     * }\n     *\n     * function Circle() {\n     *   Shape.call(this);\n     * }\n     *\n     * Circle.prototype = _.create(Shape.prototype, { 'constructor': Circle });\n     *\n     * var circle = new Circle;\n     * circle instanceof Circle;\n     * // => true\n     *\n     * circle instanceof Shape;\n     * // => true\n     */\n    function create(prototype, properties) {\n      var result = baseCreate(prototype);\n      return properties ? assign(result, properties) : result;\n    }\n\n    /**\n     * Assigns own enumerable properties of source object(s) to the destination\n     * object for all destination properties that resolve to `undefined`. Once a\n     * property is set, additional defaults of the same property will be ignored.\n     *\n     * @static\n     * @memberOf _\n     * @type Function\n     * @category Objects\n     * @param {Object} object The destination object.\n     * @param {...Object} [source] The source objects.\n     * @param- {Object} [guard] Allows working with `_.reduce` without using its\n     *  `key` and `object` arguments as sources.\n     * @returns {Object} Returns the destination object.\n     * @example\n     *\n     * var object = { 'name': 'barney' };\n     * _.defaults(object, { 'name': 'fred', 'employer': 'slate' });\n     * // => { 'name': 'barney', 'employer': 'slate' }\n     */\n    var defaults = function(object, source, guard) {\n      var index, iterable = object, result = iterable;\n      if (!iterable) return result;\n      var args = arguments,\n          argsIndex = 0,\n          argsLength = typeof guard == 'number' ? 2 : args.length;\n      while (++argsIndex < argsLength) {\n        iterable = args[argsIndex];\n        if (iterable && objectTypes[typeof iterable]) {\n        var ownIndex = -1,\n            ownProps = objectTypes[typeof iterable] && keys(iterable),\n            length = ownProps ? ownProps.length : 0;\n\n        while (++ownIndex < length) {\n          index = ownProps[ownIndex];\n          if (typeof result[index] == 'undefined') result[index] = iterable[index];\n        }\n        }\n      }\n      return result\n    };\n\n    /**\n     * This method is like `_.findIndex` except that it returns the key of the\n     * first element that passes the callback check, instead of the element itself.\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to search.\n     * @param {Function|Object|string} [callback=identity] The function called per\n     *  iteration. If a property name or object is provided it will be used to\n     *  create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {string|undefined} Returns the key of the found element, else `undefined`.\n     * @example\n     *\n     * var characters = {\n     *   'barney': {  'age': 36, 'blocked': false },\n     *   'fred': {    'age': 40, 'blocked': true },\n     *   'pebbles': { 'age': 1,  'blocked': false }\n     * };\n     *\n     * _.findKey(characters, function(chr) {\n     *   return chr.age < 40;\n     * });\n     * // => 'barney' (property order is not guaranteed across environments)\n     *\n     * // using \"_.where\" callback shorthand\n     * _.findKey(characters, { 'age': 1 });\n     * // => 'pebbles'\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.findKey(characters, 'blocked');\n     * // => 'fred'\n     */\n    function findKey(object, callback, thisArg) {\n      var result;\n      callback = lodash.createCallback(callback, thisArg, 3);\n      forOwn(object, function(value, key, object) {\n        if (callback(value, key, object)) {\n          result = key;\n          return false;\n        }\n      });\n      return result;\n    }\n\n    /**\n     * This method is like `_.findKey` except that it iterates over elements\n     * of a `collection` in the opposite order.\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to search.\n     * @param {Function|Object|string} [callback=identity] The function called per\n     *  iteration. If a property name or object is provided it will be used to\n     *  create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {string|undefined} Returns the key of the found element, else `undefined`.\n     * @example\n     *\n     * var characters = {\n     *   'barney': {  'age': 36, 'blocked': true },\n     *   'fred': {    'age': 40, 'blocked': false },\n     *   'pebbles': { 'age': 1,  'blocked': true }\n     * };\n     *\n     * _.findLastKey(characters, function(chr) {\n     *   return chr.age < 40;\n     * });\n     * // => returns `pebbles`, assuming `_.findKey` returns `barney`\n     *\n     * // using \"_.where\" callback shorthand\n     * _.findLastKey(characters, { 'age': 40 });\n     * // => 'fred'\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.findLastKey(characters, 'blocked');\n     * // => 'pebbles'\n     */\n    function findLastKey(object, callback, thisArg) {\n      var result;\n      callback = lodash.createCallback(callback, thisArg, 3);\n      forOwnRight(object, function(value, key, object) {\n        if (callback(value, key, object)) {\n          result = key;\n          return false;\n        }\n      });\n      return result;\n    }\n\n    /**\n     * Iterates over own and inherited enumerable properties of an object,\n     * executing the callback for each property. The callback is bound to `thisArg`\n     * and invoked with three arguments; (value, key, object). Callbacks may exit\n     * iteration early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @type Function\n     * @category Objects\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [callback=identity] The function called per iteration.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * function Shape() {\n     *   this.x = 0;\n     *   this.y = 0;\n     * }\n     *\n     * Shape.prototype.move = function(x, y) {\n     *   this.x += x;\n     *   this.y += y;\n     * };\n     *\n     * _.forIn(new Shape, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => logs 'x', 'y', and 'move' (property order is not guaranteed across environments)\n     */\n    var forIn = function(collection, callback, thisArg) {\n      var index, iterable = collection, result = iterable;\n      if (!iterable) return result;\n      if (!objectTypes[typeof iterable]) return result;\n      callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3);\n        for (index in iterable) {\n          if (callback(iterable[index], index, collection) === false) return result;\n        }\n      return result\n    };\n\n    /**\n     * This method is like `_.forIn` except that it iterates over elements\n     * of a `collection` in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [callback=identity] The function called per iteration.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * function Shape() {\n     *   this.x = 0;\n     *   this.y = 0;\n     * }\n     *\n     * Shape.prototype.move = function(x, y) {\n     *   this.x += x;\n     *   this.y += y;\n     * };\n     *\n     * _.forInRight(new Shape, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => logs 'move', 'y', and 'x' assuming `_.forIn ` logs 'x', 'y', and 'move'\n     */\n    function forInRight(object, callback, thisArg) {\n      var pairs = [];\n\n      forIn(object, function(value, key) {\n        pairs.push(key, value);\n      });\n\n      var length = pairs.length;\n      callback = baseCreateCallback(callback, thisArg, 3);\n      while (length--) {\n        if (callback(pairs[length--], pairs[length], object) === false) {\n          break;\n        }\n      }\n      return object;\n    }\n\n    /**\n     * Iterates over own enumerable properties of an object, executing the callback\n     * for each property. The callback is bound to `thisArg` and invoked with three\n     * arguments; (value, key, object). Callbacks may exit iteration early by\n     * explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @type Function\n     * @category Objects\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [callback=identity] The function called per iteration.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * _.forOwn({ '0': 'zero', '1': 'one', 'length': 2 }, function(num, key) {\n     *   console.log(key);\n     * });\n     * // => logs '0', '1', and 'length' (property order is not guaranteed across environments)\n     */\n    var forOwn = function(collection, callback, thisArg) {\n      var index, iterable = collection, result = iterable;\n      if (!iterable) return result;\n      if (!objectTypes[typeof iterable]) return result;\n      callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3);\n        var ownIndex = -1,\n            ownProps = objectTypes[typeof iterable] && keys(iterable),\n            length = ownProps ? ownProps.length : 0;\n\n        while (++ownIndex < length) {\n          index = ownProps[ownIndex];\n          if (callback(iterable[index], index, collection) === false) return result;\n        }\n      return result\n    };\n\n    /**\n     * This method is like `_.forOwn` except that it iterates over elements\n     * of a `collection` in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [callback=identity] The function called per iteration.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * _.forOwnRight({ '0': 'zero', '1': 'one', 'length': 2 }, function(num, key) {\n     *   console.log(key);\n     * });\n     * // => logs 'length', '1', and '0' assuming `_.forOwn` logs '0', '1', and 'length'\n     */\n    function forOwnRight(object, callback, thisArg) {\n      var props = keys(object),\n          length = props.length;\n\n      callback = baseCreateCallback(callback, thisArg, 3);\n      while (length--) {\n        var key = props[length];\n        if (callback(object[key], key, object) === false) {\n          break;\n        }\n      }\n      return object;\n    }\n\n    /**\n     * Creates a sorted array of property names of all enumerable properties,\n     * own and inherited, of `object` that have function values.\n     *\n     * @static\n     * @memberOf _\n     * @alias methods\n     * @category Objects\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns an array of property names that have function values.\n     * @example\n     *\n     * _.functions(_);\n     * // => ['all', 'any', 'bind', 'bindAll', 'clone', 'compact', 'compose', ...]\n     */\n    function functions(object) {\n      var result = [];\n      forIn(object, function(value, key) {\n        if (isFunction(value)) {\n          result.push(key);\n        }\n      });\n      return result.sort();\n    }\n\n    /**\n     * Checks if the specified property name exists as a direct property of `object`,\n     * instead of an inherited property.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to inspect.\n     * @param {string} key The name of the property to check.\n     * @returns {boolean} Returns `true` if key is a direct property, else `false`.\n     * @example\n     *\n     * _.has({ 'a': 1, 'b': 2, 'c': 3 }, 'b');\n     * // => true\n     */\n    function has(object, key) {\n      return object ? hasOwnProperty.call(object, key) : false;\n    }\n\n    /**\n     * Creates an object composed of the inverted keys and values of the given object.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to invert.\n     * @returns {Object} Returns the created inverted object.\n     * @example\n     *\n     * _.invert({ 'first': 'fred', 'second': 'barney' });\n     * // => { 'fred': 'first', 'barney': 'second' }\n     */\n    function invert(object) {\n      var index = -1,\n          props = keys(object),\n          length = props.length,\n          result = {};\n\n      while (++index < length) {\n        var key = props[index];\n        result[object[key]] = key;\n      }\n      return result;\n    }\n\n    /**\n     * Checks if `value` is a boolean value.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is a boolean value, else `false`.\n     * @example\n     *\n     * _.isBoolean(null);\n     * // => false\n     */\n    function isBoolean(value) {\n      return value === true || value === false ||\n        value && typeof value == 'object' && toString.call(value) == boolClass || false;\n    }\n\n    /**\n     * Checks if `value` is a date.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is a date, else `false`.\n     * @example\n     *\n     * _.isDate(new Date);\n     * // => true\n     */\n    function isDate(value) {\n      return value && typeof value == 'object' && toString.call(value) == dateClass || false;\n    }\n\n    /**\n     * Checks if `value` is a DOM element.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is a DOM element, else `false`.\n     * @example\n     *\n     * _.isElement(document.body);\n     * // => true\n     */\n    function isElement(value) {\n      return value && value.nodeType === 1 || false;\n    }\n\n    /**\n     * Checks if `value` is empty. Arrays, strings, or `arguments` objects with a\n     * length of `0` and objects with no own enumerable properties are considered\n     * \"empty\".\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Array|Object|string} value The value to inspect.\n     * @returns {boolean} Returns `true` if the `value` is empty, else `false`.\n     * @example\n     *\n     * _.isEmpty([1, 2, 3]);\n     * // => false\n     *\n     * _.isEmpty({});\n     * // => true\n     *\n     * _.isEmpty('');\n     * // => true\n     */\n    function isEmpty(value) {\n      var result = true;\n      if (!value) {\n        return result;\n      }\n      var className = toString.call(value),\n          length = value.length;\n\n      if ((className == arrayClass || className == stringClass || className == argsClass ) ||\n          (className == objectClass && typeof length == 'number' && isFunction(value.splice))) {\n        return !length;\n      }\n      forOwn(value, function() {\n        return (result = false);\n      });\n      return result;\n    }\n\n    /**\n     * Performs a deep comparison between two values to determine if they are\n     * equivalent to each other. If a callback is provided it will be executed\n     * to compare values. If the callback returns `undefined` comparisons will\n     * be handled by the method instead. The callback is bound to `thisArg` and\n     * invoked with two arguments; (a, b).\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} a The value to compare.\n     * @param {*} b The other value to compare.\n     * @param {Function} [callback] The function to customize comparing values.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     * @example\n     *\n     * var object = { 'name': 'fred' };\n     * var copy = { 'name': 'fred' };\n     *\n     * object == copy;\n     * // => false\n     *\n     * _.isEqual(object, copy);\n     * // => true\n     *\n     * var words = ['hello', 'goodbye'];\n     * var otherWords = ['hi', 'goodbye'];\n     *\n     * _.isEqual(words, otherWords, function(a, b) {\n     *   var reGreet = /^(?:hello|hi)$/i,\n     *       aGreet = _.isString(a) && reGreet.test(a),\n     *       bGreet = _.isString(b) && reGreet.test(b);\n     *\n     *   return (aGreet || bGreet) ? (aGreet == bGreet) : undefined;\n     * });\n     * // => true\n     */\n    function isEqual(a, b, callback, thisArg) {\n      return baseIsEqual(a, b, typeof callback == 'function' && baseCreateCallback(callback, thisArg, 2));\n    }\n\n    /**\n     * Checks if `value` is, or can be coerced to, a finite number.\n     *\n     * Note: This is not the same as native `isFinite` which will return true for\n     * booleans and empty strings. See http://es5.github.io/#x15.1.2.5.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is finite, else `false`.\n     * @example\n     *\n     * _.isFinite(-101);\n     * // => true\n     *\n     * _.isFinite('10');\n     * // => true\n     *\n     * _.isFinite(true);\n     * // => false\n     *\n     * _.isFinite('');\n     * // => false\n     *\n     * _.isFinite(Infinity);\n     * // => false\n     */\n    function isFinite(value) {\n      return nativeIsFinite(value) && !nativeIsNaN(parseFloat(value));\n    }\n\n    /**\n     * Checks if `value` is a function.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is a function, else `false`.\n     * @example\n     *\n     * _.isFunction(_);\n     * // => true\n     */\n    function isFunction(value) {\n      return typeof value == 'function';\n    }\n\n    /**\n     * Checks if `value` is the language type of Object.\n     * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is an object, else `false`.\n     * @example\n     *\n     * _.isObject({});\n     * // => true\n     *\n     * _.isObject([1, 2, 3]);\n     * // => true\n     *\n     * _.isObject(1);\n     * // => false\n     */\n    function isObject(value) {\n      // check if the value is the ECMAScript language type of Object\n      // http://es5.github.io/#x8\n      // and avoid a V8 bug\n      // http://code.google.com/p/v8/issues/detail?id=2291\n      return !!(value && objectTypes[typeof value]);\n    }\n\n    /**\n     * Checks if `value` is `NaN`.\n     *\n     * Note: This is not the same as native `isNaN` which will return `true` for\n     * `undefined` and other non-numeric values. See http://es5.github.io/#x15.1.2.4.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is `NaN`, else `false`.\n     * @example\n     *\n     * _.isNaN(NaN);\n     * // => true\n     *\n     * _.isNaN(new Number(NaN));\n     * // => true\n     *\n     * isNaN(undefined);\n     * // => true\n     *\n     * _.isNaN(undefined);\n     * // => false\n     */\n    function isNaN(value) {\n      // `NaN` as a primitive is the only value that is not equal to itself\n      // (perform the [[Class]] check first to avoid errors with some host objects in IE)\n      return isNumber(value) && value != +value;\n    }\n\n    /**\n     * Checks if `value` is `null`.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is `null`, else `false`.\n     * @example\n     *\n     * _.isNull(null);\n     * // => true\n     *\n     * _.isNull(undefined);\n     * // => false\n     */\n    function isNull(value) {\n      return value === null;\n    }\n\n    /**\n     * Checks if `value` is a number.\n     *\n     * Note: `NaN` is considered a number. See http://es5.github.io/#x8.5.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is a number, else `false`.\n     * @example\n     *\n     * _.isNumber(8.4 * 5);\n     * // => true\n     */\n    function isNumber(value) {\n      return typeof value == 'number' ||\n        value && typeof value == 'object' && toString.call(value) == numberClass || false;\n    }\n\n    /**\n     * Checks if `value` is an object created by the `Object` constructor.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n     * @example\n     *\n     * function Shape() {\n     *   this.x = 0;\n     *   this.y = 0;\n     * }\n     *\n     * _.isPlainObject(new Shape);\n     * // => false\n     *\n     * _.isPlainObject([1, 2, 3]);\n     * // => false\n     *\n     * _.isPlainObject({ 'x': 0, 'y': 0 });\n     * // => true\n     */\n    var isPlainObject = !getPrototypeOf ? shimIsPlainObject : function(value) {\n      if (!(value && toString.call(value) == objectClass)) {\n        return false;\n      }\n      var valueOf = value.valueOf,\n          objProto = isNative(valueOf) && (objProto = getPrototypeOf(valueOf)) && getPrototypeOf(objProto);\n\n      return objProto\n        ? (value == objProto || getPrototypeOf(value) == objProto)\n        : shimIsPlainObject(value);\n    };\n\n    /**\n     * Checks if `value` is a regular expression.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is a regular expression, else `false`.\n     * @example\n     *\n     * _.isRegExp(/fred/);\n     * // => true\n     */\n    function isRegExp(value) {\n      return value && typeof value == 'object' && toString.call(value) == regexpClass || false;\n    }\n\n    /**\n     * Checks if `value` is a string.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is a string, else `false`.\n     * @example\n     *\n     * _.isString('fred');\n     * // => true\n     */\n    function isString(value) {\n      return typeof value == 'string' ||\n        value && typeof value == 'object' && toString.call(value) == stringClass || false;\n    }\n\n    /**\n     * Checks if `value` is `undefined`.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if the `value` is `undefined`, else `false`.\n     * @example\n     *\n     * _.isUndefined(void 0);\n     * // => true\n     */\n    function isUndefined(value) {\n      return typeof value == 'undefined';\n    }\n\n    /**\n     * Creates an object with the same keys as `object` and values generated by\n     * running each own enumerable property of `object` through the callback.\n     * The callback is bound to `thisArg` and invoked with three arguments;\n     * (value, key, object).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a new object with values of the results of each `callback` execution.\n     * @example\n     *\n     * _.mapValues({ 'a': 1, 'b': 2, 'c': 3} , function(num) { return num * 3; });\n     * // => { 'a': 3, 'b': 6, 'c': 9 }\n     *\n     * var characters = {\n     *   'fred': { 'name': 'fred', 'age': 40 },\n     *   'pebbles': { 'name': 'pebbles', 'age': 1 }\n     * };\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.mapValues(characters, 'age');\n     * // => { 'fred': 40, 'pebbles': 1 }\n     */\n    function mapValues(object, callback, thisArg) {\n      var result = {};\n      callback = lodash.createCallback(callback, thisArg, 3);\n\n      forOwn(object, function(value, key, object) {\n        result[key] = callback(value, key, object);\n      });\n      return result;\n    }\n\n    /**\n     * Recursively merges own enumerable properties of the source object(s), that\n     * don't resolve to `undefined` into the destination object. Subsequent sources\n     * will overwrite property assignments of previous sources. If a callback is\n     * provided it will be executed to produce the merged values of the destination\n     * and source properties. If the callback returns `undefined` merging will\n     * be handled by the method instead. The callback is bound to `thisArg` and\n     * invoked with two arguments; (objectValue, sourceValue).\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The destination object.\n     * @param {...Object} [source] The source objects.\n     * @param {Function} [callback] The function to customize merging properties.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns the destination object.\n     * @example\n     *\n     * var names = {\n     *   'characters': [\n     *     { 'name': 'barney' },\n     *     { 'name': 'fred' }\n     *   ]\n     * };\n     *\n     * var ages = {\n     *   'characters': [\n     *     { 'age': 36 },\n     *     { 'age': 40 }\n     *   ]\n     * };\n     *\n     * _.merge(names, ages);\n     * // => { 'characters': [{ 'name': 'barney', 'age': 36 }, { 'name': 'fred', 'age': 40 }] }\n     *\n     * var food = {\n     *   'fruits': ['apple'],\n     *   'vegetables': ['beet']\n     * };\n     *\n     * var otherFood = {\n     *   'fruits': ['banana'],\n     *   'vegetables': ['carrot']\n     * };\n     *\n     * _.merge(food, otherFood, function(a, b) {\n     *   return _.isArray(a) ? a.concat(b) : undefined;\n     * });\n     * // => { 'fruits': ['apple', 'banana'], 'vegetables': ['beet', 'carrot] }\n     */\n    function merge(object) {\n      var args = arguments,\n          length = 2;\n\n      if (!isObject(object)) {\n        return object;\n      }\n      // allows working with `_.reduce` and `_.reduceRight` without using\n      // their `index` and `collection` arguments\n      if (typeof args[2] != 'number') {\n        length = args.length;\n      }\n      if (length > 3 && typeof args[length - 2] == 'function') {\n        var callback = baseCreateCallback(args[--length - 1], args[length--], 2);\n      } else if (length > 2 && typeof args[length - 1] == 'function') {\n        callback = args[--length];\n      }\n      var sources = slice(arguments, 1, length),\n          index = -1,\n          stackA = getArray(),\n          stackB = getArray();\n\n      while (++index < length) {\n        baseMerge(object, sources[index], callback, stackA, stackB);\n      }\n      releaseArray(stackA);\n      releaseArray(stackB);\n      return object;\n    }\n\n    /**\n     * Creates a shallow clone of `object` excluding the specified properties.\n     * Property names may be specified as individual arguments or as arrays of\n     * property names. If a callback is provided it will be executed for each\n     * property of `object` omitting the properties the callback returns truey\n     * for. The callback is bound to `thisArg` and invoked with three arguments;\n     * (value, key, object).\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The source object.\n     * @param {Function|...string|string[]} [callback] The properties to omit or the\n     *  function called per iteration.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns an object without the omitted properties.\n     * @example\n     *\n     * _.omit({ 'name': 'fred', 'age': 40 }, 'age');\n     * // => { 'name': 'fred' }\n     *\n     * _.omit({ 'name': 'fred', 'age': 40 }, function(value) {\n     *   return typeof value == 'number';\n     * });\n     * // => { 'name': 'fred' }\n     */\n    function omit(object, callback, thisArg) {\n      var result = {};\n      if (typeof callback != 'function') {\n        var props = [];\n        forIn(object, function(value, key) {\n          props.push(key);\n        });\n        props = baseDifference(props, baseFlatten(arguments, true, false, 1));\n\n        var index = -1,\n            length = props.length;\n\n        while (++index < length) {\n          var key = props[index];\n          result[key] = object[key];\n        }\n      } else {\n        callback = lodash.createCallback(callback, thisArg, 3);\n        forIn(object, function(value, key, object) {\n          if (!callback(value, key, object)) {\n            result[key] = value;\n          }\n        });\n      }\n      return result;\n    }\n\n    /**\n     * Creates a two dimensional array of an object's key-value pairs,\n     * i.e. `[[key1, value1], [key2, value2]]`.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns new array of key-value pairs.\n     * @example\n     *\n     * _.pairs({ 'barney': 36, 'fred': 40 });\n     * // => [['barney', 36], ['fred', 40]] (property order is not guaranteed across environments)\n     */\n    function pairs(object) {\n      var index = -1,\n          props = keys(object),\n          length = props.length,\n          result = Array(length);\n\n      while (++index < length) {\n        var key = props[index];\n        result[index] = [key, object[key]];\n      }\n      return result;\n    }\n\n    /**\n     * Creates a shallow clone of `object` composed of the specified properties.\n     * Property names may be specified as individual arguments or as arrays of\n     * property names. If a callback is provided it will be executed for each\n     * property of `object` picking the properties the callback returns truey\n     * for. The callback is bound to `thisArg` and invoked with three arguments;\n     * (value, key, object).\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The source object.\n     * @param {Function|...string|string[]} [callback] The function called per\n     *  iteration or property names to pick, specified as individual property\n     *  names or arrays of property names.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns an object composed of the picked properties.\n     * @example\n     *\n     * _.pick({ 'name': 'fred', '_userid': 'fred1' }, 'name');\n     * // => { 'name': 'fred' }\n     *\n     * _.pick({ 'name': 'fred', '_userid': 'fred1' }, function(value, key) {\n     *   return key.charAt(0) != '_';\n     * });\n     * // => { 'name': 'fred' }\n     */\n    function pick(object, callback, thisArg) {\n      var result = {};\n      if (typeof callback != 'function') {\n        var index = -1,\n            props = baseFlatten(arguments, true, false, 1),\n            length = isObject(object) ? props.length : 0;\n\n        while (++index < length) {\n          var key = props[index];\n          if (key in object) {\n            result[key] = object[key];\n          }\n        }\n      } else {\n        callback = lodash.createCallback(callback, thisArg, 3);\n        forIn(object, function(value, key, object) {\n          if (callback(value, key, object)) {\n            result[key] = value;\n          }\n        });\n      }\n      return result;\n    }\n\n    /**\n     * An alternative to `_.reduce` this method transforms `object` to a new\n     * `accumulator` object which is the result of running each of its own\n     * enumerable properties through a callback, with each callback execution\n     * potentially mutating the `accumulator` object. The callback is bound to\n     * `thisArg` and invoked with four arguments; (accumulator, value, key, object).\n     * Callbacks may exit iteration early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Array|Object} object The object to iterate over.\n     * @param {Function} [callback=identity] The function called per iteration.\n     * @param {*} [accumulator] The custom accumulator value.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the accumulated value.\n     * @example\n     *\n     * var squares = _.transform([1, 2, 3, 4, 5, 6, 7, 8, 9, 10], function(result, num) {\n     *   num *= num;\n     *   if (num % 2) {\n     *     return result.push(num) < 3;\n     *   }\n     * });\n     * // => [1, 9, 25]\n     *\n     * var mapped = _.transform({ 'a': 1, 'b': 2, 'c': 3 }, function(result, num, key) {\n     *   result[key] = num * 3;\n     * });\n     * // => { 'a': 3, 'b': 6, 'c': 9 }\n     */\n    function transform(object, callback, accumulator, thisArg) {\n      var isArr = isArray(object);\n      if (accumulator == null) {\n        if (isArr) {\n          accumulator = [];\n        } else {\n          var ctor = object && object.constructor,\n              proto = ctor && ctor.prototype;\n\n          accumulator = baseCreate(proto);\n        }\n      }\n      if (callback) {\n        callback = lodash.createCallback(callback, thisArg, 4);\n        (isArr ? forEach : forOwn)(object, function(value, index, object) {\n          return callback(accumulator, value, index, object);\n        });\n      }\n      return accumulator;\n    }\n\n    /**\n     * Creates an array composed of the own enumerable property values of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @category Objects\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns an array of property values.\n     * @example\n     *\n     * _.values({ 'one': 1, 'two': 2, 'three': 3 });\n     * // => [1, 2, 3] (property order is not guaranteed across environments)\n     */\n    function values(object) {\n      var index = -1,\n          props = keys(object),\n          length = props.length,\n          result = Array(length);\n\n      while (++index < length) {\n        result[index] = object[props[index]];\n      }\n      return result;\n    }\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * Creates an array of elements from the specified indexes, or keys, of the\n     * `collection`. Indexes may be specified as individual arguments or as arrays\n     * of indexes.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {...(number|number[]|string|string[])} [index] The indexes of `collection`\n     *   to retrieve, specified as individual indexes or arrays of indexes.\n     * @returns {Array} Returns a new array of elements corresponding to the\n     *  provided indexes.\n     * @example\n     *\n     * _.at(['a', 'b', 'c', 'd', 'e'], [0, 2, 4]);\n     * // => ['a', 'c', 'e']\n     *\n     * _.at(['fred', 'barney', 'pebbles'], 0, 2);\n     * // => ['fred', 'pebbles']\n     */\n    function at(collection) {\n      var args = arguments,\n          index = -1,\n          props = baseFlatten(args, true, false, 1),\n          length = (args[2] && args[2][args[1]] === collection) ? 1 : props.length,\n          result = Array(length);\n\n      while(++index < length) {\n        result[index] = collection[props[index]];\n      }\n      return result;\n    }\n\n    /**\n     * Checks if a given value is present in a collection using strict equality\n     * for comparisons, i.e. `===`. If `fromIndex` is negative, it is used as the\n     * offset from the end of the collection.\n     *\n     * @static\n     * @memberOf _\n     * @alias include\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {*} target The value to check for.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @returns {boolean} Returns `true` if the `target` element is found, else `false`.\n     * @example\n     *\n     * _.contains([1, 2, 3], 1);\n     * // => true\n     *\n     * _.contains([1, 2, 3], 1, 2);\n     * // => false\n     *\n     * _.contains({ 'name': 'fred', 'age': 40 }, 'fred');\n     * // => true\n     *\n     * _.contains('pebbles', 'eb');\n     * // => true\n     */\n    function contains(collection, target, fromIndex) {\n      var index = -1,\n          indexOf = getIndexOf(),\n          length = collection ? collection.length : 0,\n          result = false;\n\n      fromIndex = (fromIndex < 0 ? nativeMax(0, length + fromIndex) : fromIndex) || 0;\n      if (isArray(collection)) {\n        result = indexOf(collection, target, fromIndex) > -1;\n      } else if (typeof length == 'number') {\n        result = (isString(collection) ? collection.indexOf(target, fromIndex) : indexOf(collection, target, fromIndex)) > -1;\n      } else {\n        forOwn(collection, function(value) {\n          if (++index >= fromIndex) {\n            return !(result = value === target);\n          }\n        });\n      }\n      return result;\n    }\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of `collection` through the callback. The corresponding value\n     * of each key is the number of times the key was returned by the callback.\n     * The callback is bound to `thisArg` and invoked with three arguments;\n     * (value, index|key, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * _.countBy([4.3, 6.1, 6.4], function(num) { return Math.floor(num); });\n     * // => { '4': 1, '6': 2 }\n     *\n     * _.countBy([4.3, 6.1, 6.4], function(num) { return this.floor(num); }, Math);\n     * // => { '4': 1, '6': 2 }\n     *\n     * _.countBy(['one', 'two', 'three'], 'length');\n     * // => { '3': 2, '5': 1 }\n     */\n    var countBy = createAggregator(function(result, value, key) {\n      (hasOwnProperty.call(result, key) ? result[key]++ : result[key] = 1);\n    });\n\n    /**\n     * Checks if the given callback returns truey value for **all** elements of\n     * a collection. The callback is bound to `thisArg` and invoked with three\n     * arguments; (value, index|key, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @alias all\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {boolean} Returns `true` if all elements passed the callback check,\n     *  else `false`.\n     * @example\n     *\n     * _.every([true, 1, null, 'yes']);\n     * // => false\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36 },\n     *   { 'name': 'fred',   'age': 40 }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.every(characters, 'age');\n     * // => true\n     *\n     * // using \"_.where\" callback shorthand\n     * _.every(characters, { 'age': 36 });\n     * // => false\n     */\n    function every(collection, callback, thisArg) {\n      var result = true;\n      callback = lodash.createCallback(callback, thisArg, 3);\n\n      var index = -1,\n          length = collection ? collection.length : 0;\n\n      if (typeof length == 'number') {\n        while (++index < length) {\n          if (!(result = !!callback(collection[index], index, collection))) {\n            break;\n          }\n        }\n      } else {\n        forOwn(collection, function(value, index, collection) {\n          return (result = !!callback(value, index, collection));\n        });\n      }\n      return result;\n    }\n\n    /**\n     * Iterates over elements of a collection, returning an array of all elements\n     * the callback returns truey for. The callback is bound to `thisArg` and\n     * invoked with three arguments; (value, index|key, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @alias select\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a new array of elements that passed the callback check.\n     * @example\n     *\n     * var evens = _.filter([1, 2, 3, 4, 5, 6], function(num) { return num % 2 == 0; });\n     * // => [2, 4, 6]\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36, 'blocked': false },\n     *   { 'name': 'fred',   'age': 40, 'blocked': true }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.filter(characters, 'blocked');\n     * // => [{ 'name': 'fred', 'age': 40, 'blocked': true }]\n     *\n     * // using \"_.where\" callback shorthand\n     * _.filter(characters, { 'age': 36 });\n     * // => [{ 'name': 'barney', 'age': 36, 'blocked': false }]\n     */\n    function filter(collection, callback, thisArg) {\n      var result = [];\n      callback = lodash.createCallback(callback, thisArg, 3);\n\n      var index = -1,\n          length = collection ? collection.length : 0;\n\n      if (typeof length == 'number') {\n        while (++index < length) {\n          var value = collection[index];\n          if (callback(value, index, collection)) {\n            result.push(value);\n          }\n        }\n      } else {\n        forOwn(collection, function(value, index, collection) {\n          if (callback(value, index, collection)) {\n            result.push(value);\n          }\n        });\n      }\n      return result;\n    }\n\n    /**\n     * Iterates over elements of a collection, returning the first element that\n     * the callback returns truey for. The callback is bound to `thisArg` and\n     * invoked with three arguments; (value, index|key, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @alias detect, findWhere\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the found element, else `undefined`.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney',  'age': 36, 'blocked': false },\n     *   { 'name': 'fred',    'age': 40, 'blocked': true },\n     *   { 'name': 'pebbles', 'age': 1,  'blocked': false }\n     * ];\n     *\n     * _.find(characters, function(chr) {\n     *   return chr.age < 40;\n     * });\n     * // => { 'name': 'barney', 'age': 36, 'blocked': false }\n     *\n     * // using \"_.where\" callback shorthand\n     * _.find(characters, { 'age': 1 });\n     * // =>  { 'name': 'pebbles', 'age': 1, 'blocked': false }\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.find(characters, 'blocked');\n     * // => { 'name': 'fred', 'age': 40, 'blocked': true }\n     */\n    function find(collection, callback, thisArg) {\n      callback = lodash.createCallback(callback, thisArg, 3);\n\n      var index = -1,\n          length = collection ? collection.length : 0;\n\n      if (typeof length == 'number') {\n        while (++index < length) {\n          var value = collection[index];\n          if (callback(value, index, collection)) {\n            return value;\n          }\n        }\n      } else {\n        var result;\n        forOwn(collection, function(value, index, collection) {\n          if (callback(value, index, collection)) {\n            result = value;\n            return false;\n          }\n        });\n        return result;\n      }\n    }\n\n    /**\n     * This method is like `_.find` except that it iterates over elements\n     * of a `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the found element, else `undefined`.\n     * @example\n     *\n     * _.findLast([1, 2, 3, 4], function(num) {\n     *   return num % 2 == 1;\n     * });\n     * // => 3\n     */\n    function findLast(collection, callback, thisArg) {\n      var result;\n      callback = lodash.createCallback(callback, thisArg, 3);\n      forEachRight(collection, function(value, index, collection) {\n        if (callback(value, index, collection)) {\n          result = value;\n          return false;\n        }\n      });\n      return result;\n    }\n\n    /**\n     * Iterates over elements of a collection, executing the callback for each\n     * element. The callback is bound to `thisArg` and invoked with three arguments;\n     * (value, index|key, collection). Callbacks may exit iteration early by\n     * explicitly returning `false`.\n     *\n     * Note: As with other \"Collections\" methods, objects with a `length` property\n     * are iterated like arrays. To avoid this behavior `_.forIn` or `_.forOwn`\n     * may be used for object iteration.\n     *\n     * @static\n     * @memberOf _\n     * @alias each\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function} [callback=identity] The function called per iteration.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array|Object|string} Returns `collection`.\n     * @example\n     *\n     * _([1, 2, 3]).forEach(function(num) { console.log(num); }).join(',');\n     * // => logs each number and returns '1,2,3'\n     *\n     * _.forEach({ 'one': 1, 'two': 2, 'three': 3 }, function(num) { console.log(num); });\n     * // => logs each number and returns the object (property order is not guaranteed across environments)\n     */\n    function forEach(collection, callback, thisArg) {\n      var index = -1,\n          length = collection ? collection.length : 0;\n\n      callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3);\n      if (typeof length == 'number') {\n        while (++index < length) {\n          if (callback(collection[index], index, collection) === false) {\n            break;\n          }\n        }\n      } else {\n        forOwn(collection, callback);\n      }\n      return collection;\n    }\n\n    /**\n     * This method is like `_.forEach` except that it iterates over elements\n     * of a `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @alias eachRight\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function} [callback=identity] The function called per iteration.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array|Object|string} Returns `collection`.\n     * @example\n     *\n     * _([1, 2, 3]).forEachRight(function(num) { console.log(num); }).join(',');\n     * // => logs each number from right to left and returns '3,2,1'\n     */\n    function forEachRight(collection, callback, thisArg) {\n      var length = collection ? collection.length : 0;\n      callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3);\n      if (typeof length == 'number') {\n        while (length--) {\n          if (callback(collection[length], length, collection) === false) {\n            break;\n          }\n        }\n      } else {\n        var props = keys(collection);\n        length = props.length;\n        forOwn(collection, function(value, key, collection) {\n          key = props ? props[--length] : --length;\n          return callback(collection[key], key, collection);\n        });\n      }\n      return collection;\n    }\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of a collection through the callback. The corresponding value\n     * of each key is an array of the elements responsible for generating the key.\n     * The callback is bound to `thisArg` and invoked with three arguments;\n     * (value, index|key, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * _.groupBy([4.2, 6.1, 6.4], function(num) { return Math.floor(num); });\n     * // => { '4': [4.2], '6': [6.1, 6.4] }\n     *\n     * _.groupBy([4.2, 6.1, 6.4], function(num) { return this.floor(num); }, Math);\n     * // => { '4': [4.2], '6': [6.1, 6.4] }\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.groupBy(['one', 'two', 'three'], 'length');\n     * // => { '3': ['one', 'two'], '5': ['three'] }\n     */\n    var groupBy = createAggregator(function(result, value, key) {\n      (hasOwnProperty.call(result, key) ? result[key] : result[key] = []).push(value);\n    });\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of the collection through the given callback. The corresponding\n     * value of each key is the last element responsible for generating the key.\n     * The callback is bound to `thisArg` and invoked with three arguments;\n     * (value, index|key, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * var keys = [\n     *   { 'dir': 'left', 'code': 97 },\n     *   { 'dir': 'right', 'code': 100 }\n     * ];\n     *\n     * _.indexBy(keys, 'dir');\n     * // => { 'left': { 'dir': 'left', 'code': 97 }, 'right': { 'dir': 'right', 'code': 100 } }\n     *\n     * _.indexBy(keys, function(key) { return String.fromCharCode(key.code); });\n     * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }\n     *\n     * _.indexBy(characters, function(key) { this.fromCharCode(key.code); }, String);\n     * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }\n     */\n    var indexBy = createAggregator(function(result, value, key) {\n      result[key] = value;\n    });\n\n    /**\n     * Invokes the method named by `methodName` on each element in the `collection`\n     * returning an array of the results of each invoked method. Additional arguments\n     * will be provided to each invoked method. If `methodName` is a function it\n     * will be invoked for, and `this` bound to, each element in the `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|string} methodName The name of the method to invoke or\n     *  the function invoked per iteration.\n     * @param {...*} [arg] Arguments to invoke the method with.\n     * @returns {Array} Returns a new array of the results of each invoked method.\n     * @example\n     *\n     * _.invoke([[5, 1, 7], [3, 2, 1]], 'sort');\n     * // => [[1, 5, 7], [1, 2, 3]]\n     *\n     * _.invoke([123, 456], String.prototype.split, '');\n     * // => [['1', '2', '3'], ['4', '5', '6']]\n     */\n    function invoke(collection, methodName) {\n      var args = slice(arguments, 2),\n          index = -1,\n          isFunc = typeof methodName == 'function',\n          length = collection ? collection.length : 0,\n          result = Array(typeof length == 'number' ? length : 0);\n\n      forEach(collection, function(value) {\n        result[++index] = (isFunc ? methodName : value[methodName]).apply(value, args);\n      });\n      return result;\n    }\n\n    /**\n     * Creates an array of values by running each element in the collection\n     * through the callback. The callback is bound to `thisArg` and invoked with\n     * three arguments; (value, index|key, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @alias collect\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a new array of the results of each `callback` execution.\n     * @example\n     *\n     * _.map([1, 2, 3], function(num) { return num * 3; });\n     * // => [3, 6, 9]\n     *\n     * _.map({ 'one': 1, 'two': 2, 'three': 3 }, function(num) { return num * 3; });\n     * // => [3, 6, 9] (property order is not guaranteed across environments)\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36 },\n     *   { 'name': 'fred',   'age': 40 }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.map(characters, 'name');\n     * // => ['barney', 'fred']\n     */\n    function map(collection, callback, thisArg) {\n      var index = -1,\n          length = collection ? collection.length : 0;\n\n      callback = lodash.createCallback(callback, thisArg, 3);\n      if (typeof length == 'number') {\n        var result = Array(length);\n        while (++index < length) {\n          result[index] = callback(collection[index], index, collection);\n        }\n      } else {\n        result = [];\n        forOwn(collection, function(value, key, collection) {\n          result[++index] = callback(value, key, collection);\n        });\n      }\n      return result;\n    }\n\n    /**\n     * Retrieves the maximum value of a collection. If the collection is empty or\n     * falsey `-Infinity` is returned. If a callback is provided it will be executed\n     * for each value in the collection to generate the criterion by which the value\n     * is ranked. The callback is bound to `thisArg` and invoked with three\n     * arguments; (value, index, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the maximum value.\n     * @example\n     *\n     * _.max([4, 2, 8, 6]);\n     * // => 8\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36 },\n     *   { 'name': 'fred',   'age': 40 }\n     * ];\n     *\n     * _.max(characters, function(chr) { return chr.age; });\n     * // => { 'name': 'fred', 'age': 40 };\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.max(characters, 'age');\n     * // => { 'name': 'fred', 'age': 40 };\n     */\n    function max(collection, callback, thisArg) {\n      var computed = -Infinity,\n          result = computed;\n\n      // allows working with functions like `_.map` without using\n      // their `index` argument as a callback\n      if (typeof callback != 'function' && thisArg && thisArg[callback] === collection) {\n        callback = null;\n      }\n      if (callback == null && isArray(collection)) {\n        var index = -1,\n            length = collection.length;\n\n        while (++index < length) {\n          var value = collection[index];\n          if (value > result) {\n            result = value;\n          }\n        }\n      } else {\n        callback = (callback == null && isString(collection))\n          ? charAtCallback\n          : lodash.createCallback(callback, thisArg, 3);\n\n        forEach(collection, function(value, index, collection) {\n          var current = callback(value, index, collection);\n          if (current > computed) {\n            computed = current;\n            result = value;\n          }\n        });\n      }\n      return result;\n    }\n\n    /**\n     * Retrieves the minimum value of a collection. If the collection is empty or\n     * falsey `Infinity` is returned. If a callback is provided it will be executed\n     * for each value in the collection to generate the criterion by which the value\n     * is ranked. The callback is bound to `thisArg` and invoked with three\n     * arguments; (value, index, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the minimum value.\n     * @example\n     *\n     * _.min([4, 2, 8, 6]);\n     * // => 2\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36 },\n     *   { 'name': 'fred',   'age': 40 }\n     * ];\n     *\n     * _.min(characters, function(chr) { return chr.age; });\n     * // => { 'name': 'barney', 'age': 36 };\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.min(characters, 'age');\n     * // => { 'name': 'barney', 'age': 36 };\n     */\n    function min(collection, callback, thisArg) {\n      var computed = Infinity,\n          result = computed;\n\n      // allows working with functions like `_.map` without using\n      // their `index` argument as a callback\n      if (typeof callback != 'function' && thisArg && thisArg[callback] === collection) {\n        callback = null;\n      }\n      if (callback == null && isArray(collection)) {\n        var index = -1,\n            length = collection.length;\n\n        while (++index < length) {\n          var value = collection[index];\n          if (value < result) {\n            result = value;\n          }\n        }\n      } else {\n        callback = (callback == null && isString(collection))\n          ? charAtCallback\n          : lodash.createCallback(callback, thisArg, 3);\n\n        forEach(collection, function(value, index, collection) {\n          var current = callback(value, index, collection);\n          if (current < computed) {\n            computed = current;\n            result = value;\n          }\n        });\n      }\n      return result;\n    }\n\n    /**\n     * Retrieves the value of a specified property from all elements in the collection.\n     *\n     * @static\n     * @memberOf _\n     * @type Function\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {string} property The name of the property to pluck.\n     * @returns {Array} Returns a new array of property values.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36 },\n     *   { 'name': 'fred',   'age': 40 }\n     * ];\n     *\n     * _.pluck(characters, 'name');\n     * // => ['barney', 'fred']\n     */\n    var pluck = map;\n\n    /**\n     * Reduces a collection to a value which is the accumulated result of running\n     * each element in the collection through the callback, where each successive\n     * callback execution consumes the return value of the previous execution. If\n     * `accumulator` is not provided the first element of the collection will be\n     * used as the initial `accumulator` value. The callback is bound to `thisArg`\n     * and invoked with four arguments; (accumulator, value, index|key, collection).\n     *\n     * @static\n     * @memberOf _\n     * @alias foldl, inject\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function} [callback=identity] The function called per iteration.\n     * @param {*} [accumulator] Initial value of the accumulator.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the accumulated value.\n     * @example\n     *\n     * var sum = _.reduce([1, 2, 3], function(sum, num) {\n     *   return sum + num;\n     * });\n     * // => 6\n     *\n     * var mapped = _.reduce({ 'a': 1, 'b': 2, 'c': 3 }, function(result, num, key) {\n     *   result[key] = num * 3;\n     *   return result;\n     * }, {});\n     * // => { 'a': 3, 'b': 6, 'c': 9 }\n     */\n    function reduce(collection, callback, accumulator, thisArg) {\n      if (!collection) return accumulator;\n      var noaccum = arguments.length < 3;\n      callback = lodash.createCallback(callback, thisArg, 4);\n\n      var index = -1,\n          length = collection.length;\n\n      if (typeof length == 'number') {\n        if (noaccum) {\n          accumulator = collection[++index];\n        }\n        while (++index < length) {\n          accumulator = callback(accumulator, collection[index], index, collection);\n        }\n      } else {\n        forOwn(collection, function(value, index, collection) {\n          accumulator = noaccum\n            ? (noaccum = false, value)\n            : callback(accumulator, value, index, collection)\n        });\n      }\n      return accumulator;\n    }\n\n    /**\n     * This method is like `_.reduce` except that it iterates over elements\n     * of a `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @alias foldr\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function} [callback=identity] The function called per iteration.\n     * @param {*} [accumulator] Initial value of the accumulator.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the accumulated value.\n     * @example\n     *\n     * var list = [[0, 1], [2, 3], [4, 5]];\n     * var flat = _.reduceRight(list, function(a, b) { return a.concat(b); }, []);\n     * // => [4, 5, 2, 3, 0, 1]\n     */\n    function reduceRight(collection, callback, accumulator, thisArg) {\n      var noaccum = arguments.length < 3;\n      callback = lodash.createCallback(callback, thisArg, 4);\n      forEachRight(collection, function(value, index, collection) {\n        accumulator = noaccum\n          ? (noaccum = false, value)\n          : callback(accumulator, value, index, collection);\n      });\n      return accumulator;\n    }\n\n    /**\n     * The opposite of `_.filter` this method returns the elements of a\n     * collection that the callback does **not** return truey for.\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a new array of elements that failed the callback check.\n     * @example\n     *\n     * var odds = _.reject([1, 2, 3, 4, 5, 6], function(num) { return num % 2 == 0; });\n     * // => [1, 3, 5]\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36, 'blocked': false },\n     *   { 'name': 'fred',   'age': 40, 'blocked': true }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.reject(characters, 'blocked');\n     * // => [{ 'name': 'barney', 'age': 36, 'blocked': false }]\n     *\n     * // using \"_.where\" callback shorthand\n     * _.reject(characters, { 'age': 36 });\n     * // => [{ 'name': 'fred', 'age': 40, 'blocked': true }]\n     */\n    function reject(collection, callback, thisArg) {\n      callback = lodash.createCallback(callback, thisArg, 3);\n      return filter(collection, function(value, index, collection) {\n        return !callback(value, index, collection);\n      });\n    }\n\n    /**\n     * Retrieves a random element or `n` random elements from a collection.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to sample.\n     * @param {number} [n] The number of elements to sample.\n     * @param- {Object} [guard] Allows working with functions like `_.map`\n     *  without using their `index` arguments as `n`.\n     * @returns {Array} Returns the random sample(s) of `collection`.\n     * @example\n     *\n     * _.sample([1, 2, 3, 4]);\n     * // => 2\n     *\n     * _.sample([1, 2, 3, 4], 2);\n     * // => [3, 1]\n     */\n    function sample(collection, n, guard) {\n      if (collection && typeof collection.length != 'number') {\n        collection = values(collection);\n      }\n      if (n == null || guard) {\n        return collection ? collection[baseRandom(0, collection.length - 1)] : undefined;\n      }\n      var result = shuffle(collection);\n      result.length = nativeMin(nativeMax(0, n), result.length);\n      return result;\n    }\n\n    /**\n     * Creates an array of shuffled values, using a version of the Fisher-Yates\n     * shuffle. See http://en.wikipedia.org/wiki/Fisher-Yates_shuffle.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to shuffle.\n     * @returns {Array} Returns a new shuffled collection.\n     * @example\n     *\n     * _.shuffle([1, 2, 3, 4, 5, 6]);\n     * // => [4, 1, 6, 3, 5, 2]\n     */\n    function shuffle(collection) {\n      var index = -1,\n          length = collection ? collection.length : 0,\n          result = Array(typeof length == 'number' ? length : 0);\n\n      forEach(collection, function(value) {\n        var rand = baseRandom(0, ++index);\n        result[index] = result[rand];\n        result[rand] = value;\n      });\n      return result;\n    }\n\n    /**\n     * Gets the size of the `collection` by returning `collection.length` for arrays\n     * and array-like objects or the number of own enumerable properties for objects.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to inspect.\n     * @returns {number} Returns `collection.length` or number of own enumerable properties.\n     * @example\n     *\n     * _.size([1, 2]);\n     * // => 2\n     *\n     * _.size({ 'one': 1, 'two': 2, 'three': 3 });\n     * // => 3\n     *\n     * _.size('pebbles');\n     * // => 7\n     */\n    function size(collection) {\n      var length = collection ? collection.length : 0;\n      return typeof length == 'number' ? length : keys(collection).length;\n    }\n\n    /**\n     * Checks if the callback returns a truey value for **any** element of a\n     * collection. The function returns as soon as it finds a passing value and\n     * does not iterate over the entire collection. The callback is bound to\n     * `thisArg` and invoked with three arguments; (value, index|key, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @alias any\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {boolean} Returns `true` if any element passed the callback check,\n     *  else `false`.\n     * @example\n     *\n     * _.some([null, 0, 'yes', false], Boolean);\n     * // => true\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36, 'blocked': false },\n     *   { 'name': 'fred',   'age': 40, 'blocked': true }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.some(characters, 'blocked');\n     * // => true\n     *\n     * // using \"_.where\" callback shorthand\n     * _.some(characters, { 'age': 1 });\n     * // => false\n     */\n    function some(collection, callback, thisArg) {\n      var result;\n      callback = lodash.createCallback(callback, thisArg, 3);\n\n      var index = -1,\n          length = collection ? collection.length : 0;\n\n      if (typeof length == 'number') {\n        while (++index < length) {\n          if ((result = callback(collection[index], index, collection))) {\n            break;\n          }\n        }\n      } else {\n        forOwn(collection, function(value, index, collection) {\n          return !(result = callback(value, index, collection));\n        });\n      }\n      return !!result;\n    }\n\n    /**\n     * Creates an array of elements, sorted in ascending order by the results of\n     * running each element in a collection through the callback. This method\n     * performs a stable sort, that is, it will preserve the original sort order\n     * of equal elements. The callback is bound to `thisArg` and invoked with\n     * three arguments; (value, index|key, collection).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an array of property names is provided for `callback` the collection\n     * will be sorted by each property value.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Array|Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a new array of sorted elements.\n     * @example\n     *\n     * _.sortBy([1, 2, 3], function(num) { return Math.sin(num); });\n     * // => [3, 1, 2]\n     *\n     * _.sortBy([1, 2, 3], function(num) { return this.sin(num); }, Math);\n     * // => [3, 1, 2]\n     *\n     * var characters = [\n     *   { 'name': 'barney',  'age': 36 },\n     *   { 'name': 'fred',    'age': 40 },\n     *   { 'name': 'barney',  'age': 26 },\n     *   { 'name': 'fred',    'age': 30 }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.map(_.sortBy(characters, 'age'), _.values);\n     * // => [['barney', 26], ['fred', 30], ['barney', 36], ['fred', 40]]\n     *\n     * // sorting by multiple properties\n     * _.map(_.sortBy(characters, ['name', 'age']), _.values);\n     * // = > [['barney', 26], ['barney', 36], ['fred', 30], ['fred', 40]]\n     */\n    function sortBy(collection, callback, thisArg) {\n      var index = -1,\n          isArr = isArray(callback),\n          length = collection ? collection.length : 0,\n          result = Array(typeof length == 'number' ? length : 0);\n\n      if (!isArr) {\n        callback = lodash.createCallback(callback, thisArg, 3);\n      }\n      forEach(collection, function(value, key, collection) {\n        var object = result[++index] = getObject();\n        if (isArr) {\n          object.criteria = map(callback, function(key) { return value[key]; });\n        } else {\n          (object.criteria = getArray())[0] = callback(value, key, collection);\n        }\n        object.index = index;\n        object.value = value;\n      });\n\n      length = result.length;\n      result.sort(compareAscending);\n      while (length--) {\n        var object = result[length];\n        result[length] = object.value;\n        if (!isArr) {\n          releaseArray(object.criteria);\n        }\n        releaseObject(object);\n      }\n      return result;\n    }\n\n    /**\n     * Converts the `collection` to an array.\n     *\n     * @static\n     * @memberOf _\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to convert.\n     * @returns {Array} Returns the new converted array.\n     * @example\n     *\n     * (function() { return _.toArray(arguments).slice(1); })(1, 2, 3, 4);\n     * // => [2, 3, 4]\n     */\n    function toArray(collection) {\n      if (collection && typeof collection.length == 'number') {\n        return slice(collection);\n      }\n      return values(collection);\n    }\n\n    /**\n     * Performs a deep comparison of each element in a `collection` to the given\n     * `properties` object, returning an array of all elements that have equivalent\n     * property values.\n     *\n     * @static\n     * @memberOf _\n     * @type Function\n     * @category Collections\n     * @param {Array|Object|string} collection The collection to iterate over.\n     * @param {Object} props The object of property values to filter by.\n     * @returns {Array} Returns a new array of elements that have the given properties.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36, 'pets': ['hoppy'] },\n     *   { 'name': 'fred',   'age': 40, 'pets': ['baby puss', 'dino'] }\n     * ];\n     *\n     * _.where(characters, { 'age': 36 });\n     * // => [{ 'name': 'barney', 'age': 36, 'pets': ['hoppy'] }]\n     *\n     * _.where(characters, { 'pets': ['dino'] });\n     * // => [{ 'name': 'fred', 'age': 40, 'pets': ['baby puss', 'dino'] }]\n     */\n    var where = filter;\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * Creates an array with all falsey values removed. The values `false`, `null`,\n     * `0`, `\"\"`, `undefined`, and `NaN` are all falsey.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to compact.\n     * @returns {Array} Returns a new array of filtered values.\n     * @example\n     *\n     * _.compact([0, 1, false, 2, '', 3]);\n     * // => [1, 2, 3]\n     */\n    function compact(array) {\n      var index = -1,\n          length = array ? array.length : 0,\n          result = [];\n\n      while (++index < length) {\n        var value = array[index];\n        if (value) {\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Creates an array excluding all values of the provided arrays using strict\n     * equality for comparisons, i.e. `===`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to process.\n     * @param {...Array} [values] The arrays of values to exclude.\n     * @returns {Array} Returns a new array of filtered values.\n     * @example\n     *\n     * _.difference([1, 2, 3, 4, 5], [5, 2, 10]);\n     * // => [1, 3, 4]\n     */\n    function difference(array) {\n      return baseDifference(array, baseFlatten(arguments, true, true, 1));\n    }\n\n    /**\n     * This method is like `_.find` except that it returns the index of the first\n     * element that passes the callback check, instead of the element itself.\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to search.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {number} Returns the index of the found element, else `-1`.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney',  'age': 36, 'blocked': false },\n     *   { 'name': 'fred',    'age': 40, 'blocked': true },\n     *   { 'name': 'pebbles', 'age': 1,  'blocked': false }\n     * ];\n     *\n     * _.findIndex(characters, function(chr) {\n     *   return chr.age < 20;\n     * });\n     * // => 2\n     *\n     * // using \"_.where\" callback shorthand\n     * _.findIndex(characters, { 'age': 36 });\n     * // => 0\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.findIndex(characters, 'blocked');\n     * // => 1\n     */\n    function findIndex(array, callback, thisArg) {\n      var index = -1,\n          length = array ? array.length : 0;\n\n      callback = lodash.createCallback(callback, thisArg, 3);\n      while (++index < length) {\n        if (callback(array[index], index, array)) {\n          return index;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * This method is like `_.findIndex` except that it iterates over elements\n     * of a `collection` from right to left.\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to search.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {number} Returns the index of the found element, else `-1`.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney',  'age': 36, 'blocked': true },\n     *   { 'name': 'fred',    'age': 40, 'blocked': false },\n     *   { 'name': 'pebbles', 'age': 1,  'blocked': true }\n     * ];\n     *\n     * _.findLastIndex(characters, function(chr) {\n     *   return chr.age > 30;\n     * });\n     * // => 1\n     *\n     * // using \"_.where\" callback shorthand\n     * _.findLastIndex(characters, { 'age': 36 });\n     * // => 0\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.findLastIndex(characters, 'blocked');\n     * // => 2\n     */\n    function findLastIndex(array, callback, thisArg) {\n      var length = array ? array.length : 0;\n      callback = lodash.createCallback(callback, thisArg, 3);\n      while (length--) {\n        if (callback(array[length], length, array)) {\n          return length;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * Gets the first element or first `n` elements of an array. If a callback\n     * is provided elements at the beginning of the array are returned as long\n     * as the callback returns truey. The callback is bound to `thisArg` and\n     * invoked with three arguments; (value, index, array).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @alias head, take\n     * @category Arrays\n     * @param {Array} array The array to query.\n     * @param {Function|Object|number|string} [callback] The function called\n     *  per element or the number of elements to return. If a property name or\n     *  object is provided it will be used to create a \"_.pluck\" or \"_.where\"\n     *  style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the first element(s) of `array`.\n     * @example\n     *\n     * _.first([1, 2, 3]);\n     * // => 1\n     *\n     * _.first([1, 2, 3], 2);\n     * // => [1, 2]\n     *\n     * _.first([1, 2, 3], function(num) {\n     *   return num < 3;\n     * });\n     * // => [1, 2]\n     *\n     * var characters = [\n     *   { 'name': 'barney',  'blocked': true,  'employer': 'slate' },\n     *   { 'name': 'fred',    'blocked': false, 'employer': 'slate' },\n     *   { 'name': 'pebbles', 'blocked': true,  'employer': 'na' }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.first(characters, 'blocked');\n     * // => [{ 'name': 'barney', 'blocked': true, 'employer': 'slate' }]\n     *\n     * // using \"_.where\" callback shorthand\n     * _.pluck(_.first(characters, { 'employer': 'slate' }), 'name');\n     * // => ['barney', 'fred']\n     */\n    function first(array, callback, thisArg) {\n      var n = 0,\n          length = array ? array.length : 0;\n\n      if (typeof callback != 'number' && callback != null) {\n        var index = -1;\n        callback = lodash.createCallback(callback, thisArg, 3);\n        while (++index < length && callback(array[index], index, array)) {\n          n++;\n        }\n      } else {\n        n = callback;\n        if (n == null || thisArg) {\n          return array ? array[0] : undefined;\n        }\n      }\n      return slice(array, 0, nativeMin(nativeMax(0, n), length));\n    }\n\n    /**\n     * Flattens a nested array (the nesting can be to any depth). If `isShallow`\n     * is truey, the array will only be flattened a single level. If a callback\n     * is provided each element of the array is passed through the callback before\n     * flattening. The callback is bound to `thisArg` and invoked with three\n     * arguments; (value, index, array).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to flatten.\n     * @param {boolean} [isShallow=false] A flag to restrict flattening to a single level.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a new flattened array.\n     * @example\n     *\n     * _.flatten([1, [2], [3, [[4]]]]);\n     * // => [1, 2, 3, 4];\n     *\n     * _.flatten([1, [2], [3, [[4]]]], true);\n     * // => [1, 2, 3, [[4]]];\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 30, 'pets': ['hoppy'] },\n     *   { 'name': 'fred',   'age': 40, 'pets': ['baby puss', 'dino'] }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.flatten(characters, 'pets');\n     * // => ['hoppy', 'baby puss', 'dino']\n     */\n    function flatten(array, isShallow, callback, thisArg) {\n      // juggle arguments\n      if (typeof isShallow != 'boolean' && isShallow != null) {\n        thisArg = callback;\n        callback = (typeof isShallow != 'function' && thisArg && thisArg[isShallow] === array) ? null : isShallow;\n        isShallow = false;\n      }\n      if (callback != null) {\n        array = map(array, callback, thisArg);\n      }\n      return baseFlatten(array, isShallow);\n    }\n\n    /**\n     * Gets the index at which the first occurrence of `value` is found using\n     * strict equality for comparisons, i.e. `===`. If the array is already sorted\n     * providing `true` for `fromIndex` will run a faster binary search.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to search.\n     * @param {*} value The value to search for.\n     * @param {boolean|number} [fromIndex=0] The index to search from or `true`\n     *  to perform a binary search on a sorted array.\n     * @returns {number} Returns the index of the matched value or `-1`.\n     * @example\n     *\n     * _.indexOf([1, 2, 3, 1, 2, 3], 2);\n     * // => 1\n     *\n     * _.indexOf([1, 2, 3, 1, 2, 3], 2, 3);\n     * // => 4\n     *\n     * _.indexOf([1, 1, 2, 2, 3, 3], 2, true);\n     * // => 2\n     */\n    function indexOf(array, value, fromIndex) {\n      if (typeof fromIndex == 'number') {\n        var length = array ? array.length : 0;\n        fromIndex = (fromIndex < 0 ? nativeMax(0, length + fromIndex) : fromIndex || 0);\n      } else if (fromIndex) {\n        var index = sortedIndex(array, value);\n        return array[index] === value ? index : -1;\n      }\n      return baseIndexOf(array, value, fromIndex);\n    }\n\n    /**\n     * Gets all but the last element or last `n` elements of an array. If a\n     * callback is provided elements at the end of the array are excluded from\n     * the result as long as the callback returns truey. The callback is bound\n     * to `thisArg` and invoked with three arguments; (value, index, array).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to query.\n     * @param {Function|Object|number|string} [callback=1] The function called\n     *  per element or the number of elements to exclude. If a property name or\n     *  object is provided it will be used to create a \"_.pluck\" or \"_.where\"\n     *  style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a slice of `array`.\n     * @example\n     *\n     * _.initial([1, 2, 3]);\n     * // => [1, 2]\n     *\n     * _.initial([1, 2, 3], 2);\n     * // => [1]\n     *\n     * _.initial([1, 2, 3], function(num) {\n     *   return num > 1;\n     * });\n     * // => [1]\n     *\n     * var characters = [\n     *   { 'name': 'barney',  'blocked': false, 'employer': 'slate' },\n     *   { 'name': 'fred',    'blocked': true,  'employer': 'slate' },\n     *   { 'name': 'pebbles', 'blocked': true,  'employer': 'na' }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.initial(characters, 'blocked');\n     * // => [{ 'name': 'barney',  'blocked': false, 'employer': 'slate' }]\n     *\n     * // using \"_.where\" callback shorthand\n     * _.pluck(_.initial(characters, { 'employer': 'na' }), 'name');\n     * // => ['barney', 'fred']\n     */\n    function initial(array, callback, thisArg) {\n      var n = 0,\n          length = array ? array.length : 0;\n\n      if (typeof callback != 'number' && callback != null) {\n        var index = length;\n        callback = lodash.createCallback(callback, thisArg, 3);\n        while (index-- && callback(array[index], index, array)) {\n          n++;\n        }\n      } else {\n        n = (callback == null || thisArg) ? 1 : callback || n;\n      }\n      return slice(array, 0, nativeMin(nativeMax(0, length - n), length));\n    }\n\n    /**\n     * Creates an array of unique values present in all provided arrays using\n     * strict equality for comparisons, i.e. `===`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {...Array} [array] The arrays to inspect.\n     * @returns {Array} Returns an array of shared values.\n     * @example\n     *\n     * _.intersection([1, 2, 3], [5, 2, 1, 4], [2, 1]);\n     * // => [1, 2]\n     */\n    function intersection() {\n      var args = [],\n          argsIndex = -1,\n          argsLength = arguments.length,\n          caches = getArray(),\n          indexOf = getIndexOf(),\n          trustIndexOf = indexOf === baseIndexOf,\n          seen = getArray();\n\n      while (++argsIndex < argsLength) {\n        var value = arguments[argsIndex];\n        if (isArray(value) || isArguments(value)) {\n          args.push(value);\n          caches.push(trustIndexOf && value.length >= largeArraySize &&\n            createCache(argsIndex ? args[argsIndex] : seen));\n        }\n      }\n      var array = args[0],\n          index = -1,\n          length = array ? array.length : 0,\n          result = [];\n\n      outer:\n      while (++index < length) {\n        var cache = caches[0];\n        value = array[index];\n\n        if ((cache ? cacheIndexOf(cache, value) : indexOf(seen, value)) < 0) {\n          argsIndex = argsLength;\n          (cache || seen).push(value);\n          while (--argsIndex) {\n            cache = caches[argsIndex];\n            if ((cache ? cacheIndexOf(cache, value) : indexOf(args[argsIndex], value)) < 0) {\n              continue outer;\n            }\n          }\n          result.push(value);\n        }\n      }\n      while (argsLength--) {\n        cache = caches[argsLength];\n        if (cache) {\n          releaseObject(cache);\n        }\n      }\n      releaseArray(caches);\n      releaseArray(seen);\n      return result;\n    }\n\n    /**\n     * Gets the last element or last `n` elements of an array. If a callback is\n     * provided elements at the end of the array are returned as long as the\n     * callback returns truey. The callback is bound to `thisArg` and invoked\n     * with three arguments; (value, index, array).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to query.\n     * @param {Function|Object|number|string} [callback] The function called\n     *  per element or the number of elements to return. If a property name or\n     *  object is provided it will be used to create a \"_.pluck\" or \"_.where\"\n     *  style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {*} Returns the last element(s) of `array`.\n     * @example\n     *\n     * _.last([1, 2, 3]);\n     * // => 3\n     *\n     * _.last([1, 2, 3], 2);\n     * // => [2, 3]\n     *\n     * _.last([1, 2, 3], function(num) {\n     *   return num > 1;\n     * });\n     * // => [2, 3]\n     *\n     * var characters = [\n     *   { 'name': 'barney',  'blocked': false, 'employer': 'slate' },\n     *   { 'name': 'fred',    'blocked': true,  'employer': 'slate' },\n     *   { 'name': 'pebbles', 'blocked': true,  'employer': 'na' }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.pluck(_.last(characters, 'blocked'), 'name');\n     * // => ['fred', 'pebbles']\n     *\n     * // using \"_.where\" callback shorthand\n     * _.last(characters, { 'employer': 'na' });\n     * // => [{ 'name': 'pebbles', 'blocked': true, 'employer': 'na' }]\n     */\n    function last(array, callback, thisArg) {\n      var n = 0,\n          length = array ? array.length : 0;\n\n      if (typeof callback != 'number' && callback != null) {\n        var index = length;\n        callback = lodash.createCallback(callback, thisArg, 3);\n        while (index-- && callback(array[index], index, array)) {\n          n++;\n        }\n      } else {\n        n = callback;\n        if (n == null || thisArg) {\n          return array ? array[length - 1] : undefined;\n        }\n      }\n      return slice(array, nativeMax(0, length - n));\n    }\n\n    /**\n     * Gets the index at which the last occurrence of `value` is found using strict\n     * equality for comparisons, i.e. `===`. If `fromIndex` is negative, it is used\n     * as the offset from the end of the collection.\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to search.\n     * @param {*} value The value to search for.\n     * @param {number} [fromIndex=array.length-1] The index to search from.\n     * @returns {number} Returns the index of the matched value or `-1`.\n     * @example\n     *\n     * _.lastIndexOf([1, 2, 3, 1, 2, 3], 2);\n     * // => 4\n     *\n     * _.lastIndexOf([1, 2, 3, 1, 2, 3], 2, 3);\n     * // => 1\n     */\n    function lastIndexOf(array, value, fromIndex) {\n      var index = array ? array.length : 0;\n      if (typeof fromIndex == 'number') {\n        index = (fromIndex < 0 ? nativeMax(0, index + fromIndex) : nativeMin(fromIndex, index - 1)) + 1;\n      }\n      while (index--) {\n        if (array[index] === value) {\n          return index;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * Removes all provided values from the given array using strict equality for\n     * comparisons, i.e. `===`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to modify.\n     * @param {...*} [value] The values to remove.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [1, 2, 3, 1, 2, 3];\n     * _.pull(array, 2, 3);\n     * console.log(array);\n     * // => [1, 1]\n     */\n    function pull(array) {\n      var args = arguments,\n          argsIndex = 0,\n          argsLength = args.length,\n          length = array ? array.length : 0;\n\n      while (++argsIndex < argsLength) {\n        var index = -1,\n            value = args[argsIndex];\n        while (++index < length) {\n          if (array[index] === value) {\n            splice.call(array, index--, 1);\n            length--;\n          }\n        }\n      }\n      return array;\n    }\n\n    /**\n     * Creates an array of numbers (positive and/or negative) progressing from\n     * `start` up to but not including `end`. If `start` is less than `stop` a\n     * zero-length range is created unless a negative `step` is specified.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {number} [start=0] The start of the range.\n     * @param {number} end The end of the range.\n     * @param {number} [step=1] The value to increment or decrement by.\n     * @returns {Array} Returns a new range array.\n     * @example\n     *\n     * _.range(4);\n     * // => [0, 1, 2, 3]\n     *\n     * _.range(1, 5);\n     * // => [1, 2, 3, 4]\n     *\n     * _.range(0, 20, 5);\n     * // => [0, 5, 10, 15]\n     *\n     * _.range(0, -4, -1);\n     * // => [0, -1, -2, -3]\n     *\n     * _.range(1, 4, 0);\n     * // => [1, 1, 1]\n     *\n     * _.range(0);\n     * // => []\n     */\n    function range(start, end, step) {\n      start = +start || 0;\n      step = typeof step == 'number' ? step : (+step || 1);\n\n      if (end == null) {\n        end = start;\n        start = 0;\n      }\n      // use `Array(length)` so engines like Chakra and V8 avoid slower modes\n      // http://youtu.be/XAqIpGU8ZZk#t=17m25s\n      var index = -1,\n          length = nativeMax(0, ceil((end - start) / (step || 1))),\n          result = Array(length);\n\n      while (++index < length) {\n        result[index] = start;\n        start += step;\n      }\n      return result;\n    }\n\n    /**\n     * Removes all elements from an array that the callback returns truey for\n     * and returns an array of removed elements. The callback is bound to `thisArg`\n     * and invoked with three arguments; (value, index, array).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to modify.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a new array of removed elements.\n     * @example\n     *\n     * var array = [1, 2, 3, 4, 5, 6];\n     * var evens = _.remove(array, function(num) { return num % 2 == 0; });\n     *\n     * console.log(array);\n     * // => [1, 3, 5]\n     *\n     * console.log(evens);\n     * // => [2, 4, 6]\n     */\n    function remove(array, callback, thisArg) {\n      var index = -1,\n          length = array ? array.length : 0,\n          result = [];\n\n      callback = lodash.createCallback(callback, thisArg, 3);\n      while (++index < length) {\n        var value = array[index];\n        if (callback(value, index, array)) {\n          result.push(value);\n          splice.call(array, index--, 1);\n          length--;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The opposite of `_.initial` this method gets all but the first element or\n     * first `n` elements of an array. If a callback function is provided elements\n     * at the beginning of the array are excluded from the result as long as the\n     * callback returns truey. The callback is bound to `thisArg` and invoked\n     * with three arguments; (value, index, array).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @alias drop, tail\n     * @category Arrays\n     * @param {Array} array The array to query.\n     * @param {Function|Object|number|string} [callback=1] The function called\n     *  per element or the number of elements to exclude. If a property name or\n     *  object is provided it will be used to create a \"_.pluck\" or \"_.where\"\n     *  style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a slice of `array`.\n     * @example\n     *\n     * _.rest([1, 2, 3]);\n     * // => [2, 3]\n     *\n     * _.rest([1, 2, 3], 2);\n     * // => [3]\n     *\n     * _.rest([1, 2, 3], function(num) {\n     *   return num < 3;\n     * });\n     * // => [3]\n     *\n     * var characters = [\n     *   { 'name': 'barney',  'blocked': true,  'employer': 'slate' },\n     *   { 'name': 'fred',    'blocked': false,  'employer': 'slate' },\n     *   { 'name': 'pebbles', 'blocked': true, 'employer': 'na' }\n     * ];\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.pluck(_.rest(characters, 'blocked'), 'name');\n     * // => ['fred', 'pebbles']\n     *\n     * // using \"_.where\" callback shorthand\n     * _.rest(characters, { 'employer': 'slate' });\n     * // => [{ 'name': 'pebbles', 'blocked': true, 'employer': 'na' }]\n     */\n    function rest(array, callback, thisArg) {\n      if (typeof callback != 'number' && callback != null) {\n        var n = 0,\n            index = -1,\n            length = array ? array.length : 0;\n\n        callback = lodash.createCallback(callback, thisArg, 3);\n        while (++index < length && callback(array[index], index, array)) {\n          n++;\n        }\n      } else {\n        n = (callback == null || thisArg) ? 1 : nativeMax(0, callback);\n      }\n      return slice(array, n);\n    }\n\n    /**\n     * Uses a binary search to determine the smallest index at which a value\n     * should be inserted into a given sorted array in order to maintain the sort\n     * order of the array. If a callback is provided it will be executed for\n     * `value` and each element of `array` to compute their sort ranking. The\n     * callback is bound to `thisArg` and invoked with one argument; (value).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * _.sortedIndex([20, 30, 50], 40);\n     * // => 2\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.sortedIndex([{ 'x': 20 }, { 'x': 30 }, { 'x': 50 }], { 'x': 40 }, 'x');\n     * // => 2\n     *\n     * var dict = {\n     *   'wordToNumber': { 'twenty': 20, 'thirty': 30, 'fourty': 40, 'fifty': 50 }\n     * };\n     *\n     * _.sortedIndex(['twenty', 'thirty', 'fifty'], 'fourty', function(word) {\n     *   return dict.wordToNumber[word];\n     * });\n     * // => 2\n     *\n     * _.sortedIndex(['twenty', 'thirty', 'fifty'], 'fourty', function(word) {\n     *   return this.wordToNumber[word];\n     * }, dict);\n     * // => 2\n     */\n    function sortedIndex(array, value, callback, thisArg) {\n      var low = 0,\n          high = array ? array.length : low;\n\n      // explicitly reference `identity` for better inlining in Firefox\n      callback = callback ? lodash.createCallback(callback, thisArg, 1) : identity;\n      value = callback(value);\n\n      while (low < high) {\n        var mid = (low + high) >>> 1;\n        (callback(array[mid]) < value)\n          ? low = mid + 1\n          : high = mid;\n      }\n      return low;\n    }\n\n    /**\n     * Creates an array of unique values, in order, of the provided arrays using\n     * strict equality for comparisons, i.e. `===`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {...Array} [array] The arrays to inspect.\n     * @returns {Array} Returns an array of combined values.\n     * @example\n     *\n     * _.union([1, 2, 3], [5, 2, 1, 4], [2, 1]);\n     * // => [1, 2, 3, 5, 4]\n     */\n    function union() {\n      return baseUniq(baseFlatten(arguments, true, true));\n    }\n\n    /**\n     * Creates a duplicate-value-free version of an array using strict equality\n     * for comparisons, i.e. `===`. If the array is sorted, providing\n     * `true` for `isSorted` will use a faster algorithm. If a callback is provided\n     * each element of `array` is passed through the callback before uniqueness\n     * is computed. The callback is bound to `thisArg` and invoked with three\n     * arguments; (value, index, array).\n     *\n     * If a property name is provided for `callback` the created \"_.pluck\" style\n     * callback will return the property value of the given element.\n     *\n     * If an object is provided for `callback` the created \"_.where\" style callback\n     * will return `true` for elements that have the properties of the given object,\n     * else `false`.\n     *\n     * @static\n     * @memberOf _\n     * @alias unique\n     * @category Arrays\n     * @param {Array} array The array to process.\n     * @param {boolean} [isSorted=false] A flag to indicate that `array` is sorted.\n     * @param {Function|Object|string} [callback=identity] The function called\n     *  per iteration. If a property name or object is provided it will be used\n     *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns a duplicate-value-free array.\n     * @example\n     *\n     * _.uniq([1, 2, 1, 3, 1]);\n     * // => [1, 2, 3]\n     *\n     * _.uniq([1, 1, 2, 2, 3], true);\n     * // => [1, 2, 3]\n     *\n     * _.uniq(['A', 'b', 'C', 'a', 'B', 'c'], function(letter) { return letter.toLowerCase(); });\n     * // => ['A', 'b', 'C']\n     *\n     * _.uniq([1, 2.5, 3, 1.5, 2, 3.5], function(num) { return this.floor(num); }, Math);\n     * // => [1, 2.5, 3]\n     *\n     * // using \"_.pluck\" callback shorthand\n     * _.uniq([{ 'x': 1 }, { 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 1 }, { 'x': 2 }]\n     */\n    function uniq(array, isSorted, callback, thisArg) {\n      // juggle arguments\n      if (typeof isSorted != 'boolean' && isSorted != null) {\n        thisArg = callback;\n        callback = (typeof isSorted != 'function' && thisArg && thisArg[isSorted] === array) ? null : isSorted;\n        isSorted = false;\n      }\n      if (callback != null) {\n        callback = lodash.createCallback(callback, thisArg, 3);\n      }\n      return baseUniq(array, isSorted, callback);\n    }\n\n    /**\n     * Creates an array excluding all provided values using strict equality for\n     * comparisons, i.e. `===`.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {Array} array The array to filter.\n     * @param {...*} [value] The values to exclude.\n     * @returns {Array} Returns a new array of filtered values.\n     * @example\n     *\n     * _.without([1, 2, 1, 0, 3, 1, 4], 0, 1);\n     * // => [2, 3, 4]\n     */\n    function without(array) {\n      return baseDifference(array, slice(arguments, 1));\n    }\n\n    /**\n     * Creates an array that is the symmetric difference of the provided arrays.\n     * See http://en.wikipedia.org/wiki/Symmetric_difference.\n     *\n     * @static\n     * @memberOf _\n     * @category Arrays\n     * @param {...Array} [array] The arrays to inspect.\n     * @returns {Array} Returns an array of values.\n     * @example\n     *\n     * _.xor([1, 2, 3], [5, 2, 1, 4]);\n     * // => [3, 5, 4]\n     *\n     * _.xor([1, 2, 5], [2, 3, 5], [3, 4, 5]);\n     * // => [1, 4, 5]\n     */\n    function xor() {\n      var index = -1,\n          length = arguments.length;\n\n      while (++index < length) {\n        var array = arguments[index];\n        if (isArray(array) || isArguments(array)) {\n          var result = result\n            ? baseUniq(baseDifference(result, array).concat(baseDifference(array, result)))\n            : array;\n        }\n      }\n      return result || [];\n    }\n\n    /**\n     * Creates an array of grouped elements, the first of which contains the first\n     * elements of the given arrays, the second of which contains the second\n     * elements of the given arrays, and so on.\n     *\n     * @static\n     * @memberOf _\n     * @alias unzip\n     * @category Arrays\n     * @param {...Array} [array] Arrays to process.\n     * @returns {Array} Returns a new array of grouped elements.\n     * @example\n     *\n     * _.zip(['fred', 'barney'], [30, 40], [true, false]);\n     * // => [['fred', 30, true], ['barney', 40, false]]\n     */\n    function zip() {\n      var array = arguments.length > 1 ? arguments : arguments[0],\n          index = -1,\n          length = array ? max(pluck(array, 'length')) : 0,\n          result = Array(length < 0 ? 0 : length);\n\n      while (++index < length) {\n        result[index] = pluck(array, index);\n      }\n      return result;\n    }\n\n    /**\n     * Creates an object composed from arrays of `keys` and `values`. Provide\n     * either a single two dimensional array, i.e. `[[key1, value1], [key2, value2]]`\n     * or two arrays, one of `keys` and one of corresponding `values`.\n     *\n     * @static\n     * @memberOf _\n     * @alias object\n     * @category Arrays\n     * @param {Array} keys The array of keys.\n     * @param {Array} [values=[]] The array of values.\n     * @returns {Object} Returns an object composed of the given keys and\n     *  corresponding values.\n     * @example\n     *\n     * _.zipObject(['fred', 'barney'], [30, 40]);\n     * // => { 'fred': 30, 'barney': 40 }\n     */\n    function zipObject(keys, values) {\n      var index = -1,\n          length = keys ? keys.length : 0,\n          result = {};\n\n      if (!values && length && !isArray(keys[0])) {\n        values = [];\n      }\n      while (++index < length) {\n        var key = keys[index];\n        if (values) {\n          result[key] = values[index];\n        } else if (key) {\n          result[key[0]] = key[1];\n        }\n      }\n      return result;\n    }\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * Creates a function that executes `func`, with  the `this` binding and\n     * arguments of the created function, only after being called `n` times.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {number} n The number of times the function must be called before\n     *  `func` is executed.\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * var saves = ['profile', 'settings'];\n     *\n     * var done = _.after(saves.length, function() {\n     *   console.log('Done saving!');\n     * });\n     *\n     * _.forEach(saves, function(type) {\n     *   asyncSave({ 'type': type, 'complete': done });\n     * });\n     * // => logs 'Done saving!', after all saves have completed\n     */\n    function after(n, func) {\n      if (!isFunction(func)) {\n        throw new TypeError;\n      }\n      return function() {\n        if (--n < 1) {\n          return func.apply(this, arguments);\n        }\n      };\n    }\n\n    /**\n     * Creates a function that, when called, invokes `func` with the `this`\n     * binding of `thisArg` and prepends any additional `bind` arguments to those\n     * provided to the bound function.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to bind.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {...*} [arg] Arguments to be partially applied.\n     * @returns {Function} Returns the new bound function.\n     * @example\n     *\n     * var func = function(greeting) {\n     *   return greeting + ' ' + this.name;\n     * };\n     *\n     * func = _.bind(func, { 'name': 'fred' }, 'hi');\n     * func();\n     * // => 'hi fred'\n     */\n    function bind(func, thisArg) {\n      return arguments.length > 2\n        ? createWrapper(func, 17, slice(arguments, 2), null, thisArg)\n        : createWrapper(func, 1, null, null, thisArg);\n    }\n\n    /**\n     * Binds methods of an object to the object itself, overwriting the existing\n     * method. Method names may be specified as individual arguments or as arrays\n     * of method names. If no method names are provided all the function properties\n     * of `object` will be bound.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Object} object The object to bind and assign the bound methods to.\n     * @param {...string} [methodName] The object method names to\n     *  bind, specified as individual method names or arrays of method names.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var view = {\n     *   'label': 'docs',\n     *   'onClick': function() { console.log('clicked ' + this.label); }\n     * };\n     *\n     * _.bindAll(view);\n     * jQuery('#docs').on('click', view.onClick);\n     * // => logs 'clicked docs', when the button is clicked\n     */\n    function bindAll(object) {\n      var funcs = arguments.length > 1 ? baseFlatten(arguments, true, false, 1) : functions(object),\n          index = -1,\n          length = funcs.length;\n\n      while (++index < length) {\n        var key = funcs[index];\n        object[key] = createWrapper(object[key], 1, null, null, object);\n      }\n      return object;\n    }\n\n    /**\n     * Creates a function that, when called, invokes the method at `object[key]`\n     * and prepends any additional `bindKey` arguments to those provided to the bound\n     * function. This method differs from `_.bind` by allowing bound functions to\n     * reference methods that will be redefined or don't yet exist.\n     * See http://michaux.ca/articles/lazy-function-definition-pattern.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Object} object The object the method belongs to.\n     * @param {string} key The key of the method.\n     * @param {...*} [arg] Arguments to be partially applied.\n     * @returns {Function} Returns the new bound function.\n     * @example\n     *\n     * var object = {\n     *   'name': 'fred',\n     *   'greet': function(greeting) {\n     *     return greeting + ' ' + this.name;\n     *   }\n     * };\n     *\n     * var func = _.bindKey(object, 'greet', 'hi');\n     * func();\n     * // => 'hi fred'\n     *\n     * object.greet = function(greeting) {\n     *   return greeting + 'ya ' + this.name + '!';\n     * };\n     *\n     * func();\n     * // => 'hiya fred!'\n     */\n    function bindKey(object, key) {\n      return arguments.length > 2\n        ? createWrapper(key, 19, slice(arguments, 2), null, object)\n        : createWrapper(key, 3, null, null, object);\n    }\n\n    /**\n     * Creates a function that is the composition of the provided functions,\n     * where each function consumes the return value of the function that follows.\n     * For example, composing the functions `f()`, `g()`, and `h()` produces `f(g(h()))`.\n     * Each function is executed with the `this` binding of the composed function.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {...Function} [func] Functions to compose.\n     * @returns {Function} Returns the new composed function.\n     * @example\n     *\n     * var realNameMap = {\n     *   'pebbles': 'penelope'\n     * };\n     *\n     * var format = function(name) {\n     *   name = realNameMap[name.toLowerCase()] || name;\n     *   return name.charAt(0).toUpperCase() + name.slice(1).toLowerCase();\n     * };\n     *\n     * var greet = function(formatted) {\n     *   return 'Hiya ' + formatted + '!';\n     * };\n     *\n     * var welcome = _.compose(greet, format);\n     * welcome('pebbles');\n     * // => 'Hiya Penelope!'\n     */\n    function compose() {\n      var funcs = arguments,\n          length = funcs.length;\n\n      while (length--) {\n        if (!isFunction(funcs[length])) {\n          throw new TypeError;\n        }\n      }\n      return function() {\n        var args = arguments,\n            length = funcs.length;\n\n        while (length--) {\n          args = [funcs[length].apply(this, args)];\n        }\n        return args[0];\n      };\n    }\n\n    /**\n     * Creates a function which accepts one or more arguments of `func` that when\n     * invoked either executes `func` returning its result, if all `func` arguments\n     * have been provided, or returns a function that accepts one or more of the\n     * remaining `func` arguments, and so on. The arity of `func` can be specified\n     * if `func.length` is not sufficient.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to curry.\n     * @param {number} [arity=func.length] The arity of `func`.\n     * @returns {Function} Returns the new curried function.\n     * @example\n     *\n     * var curried = _.curry(function(a, b, c) {\n     *   console.log(a + b + c);\n     * });\n     *\n     * curried(1)(2)(3);\n     * // => 6\n     *\n     * curried(1, 2)(3);\n     * // => 6\n     *\n     * curried(1, 2, 3);\n     * // => 6\n     */\n    function curry(func, arity) {\n      arity = typeof arity == 'number' ? arity : (+arity || func.length);\n      return createWrapper(func, 4, null, null, null, arity);\n    }\n\n    /**\n     * Creates a function that will delay the execution of `func` until after\n     * `wait` milliseconds have elapsed since the last time it was invoked.\n     * Provide an options object to indicate that `func` should be invoked on\n     * the leading and/or trailing edge of the `wait` timeout. Subsequent calls\n     * to the debounced function will return the result of the last `func` call.\n     *\n     * Note: If `leading` and `trailing` options are `true` `func` will be called\n     * on the trailing edge of the timeout only if the the debounced function is\n     * invoked more than once during the `wait` timeout.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to debounce.\n     * @param {number} wait The number of milliseconds to delay.\n     * @param {Object} [options] The options object.\n     * @param {boolean} [options.leading=false] Specify execution on the leading edge of the timeout.\n     * @param {number} [options.maxWait] The maximum time `func` is allowed to be delayed before it's called.\n     * @param {boolean} [options.trailing=true] Specify execution on the trailing edge of the timeout.\n     * @returns {Function} Returns the new debounced function.\n     * @example\n     *\n     * // avoid costly calculations while the window size is in flux\n     * var lazyLayout = _.debounce(calculateLayout, 150);\n     * jQuery(window).on('resize', lazyLayout);\n     *\n     * // execute `sendMail` when the click event is fired, debouncing subsequent calls\n     * jQuery('#postbox').on('click', _.debounce(sendMail, 300, {\n     *   'leading': true,\n     *   'trailing': false\n     * });\n     *\n     * // ensure `batchLog` is executed once after 1 second of debounced calls\n     * var source = new EventSource('/stream');\n     * source.addEventListener('message', _.debounce(batchLog, 250, {\n     *   'maxWait': 1000\n     * }, false);\n     */\n    function debounce(func, wait, options) {\n      var args,\n          maxTimeoutId,\n          result,\n          stamp,\n          thisArg,\n          timeoutId,\n          trailingCall,\n          lastCalled = 0,\n          maxWait = false,\n          trailing = true;\n\n      if (!isFunction(func)) {\n        throw new TypeError;\n      }\n      wait = nativeMax(0, wait) || 0;\n      if (options === true) {\n        var leading = true;\n        trailing = false;\n      } else if (isObject(options)) {\n        leading = options.leading;\n        maxWait = 'maxWait' in options && (nativeMax(wait, options.maxWait) || 0);\n        trailing = 'trailing' in options ? options.trailing : trailing;\n      }\n      var delayed = function() {\n        var remaining = wait - (now() - stamp);\n        if (remaining <= 0) {\n          if (maxTimeoutId) {\n            clearTimeout(maxTimeoutId);\n          }\n          var isCalled = trailingCall;\n          maxTimeoutId = timeoutId = trailingCall = undefined;\n          if (isCalled) {\n            lastCalled = now();\n            result = func.apply(thisArg, args);\n            if (!timeoutId && !maxTimeoutId) {\n              args = thisArg = null;\n            }\n          }\n        } else {\n          timeoutId = setTimeout(delayed, remaining);\n        }\n      };\n\n      var maxDelayed = function() {\n        if (timeoutId) {\n          clearTimeout(timeoutId);\n        }\n        maxTimeoutId = timeoutId = trailingCall = undefined;\n        if (trailing || (maxWait !== wait)) {\n          lastCalled = now();\n          result = func.apply(thisArg, args);\n          if (!timeoutId && !maxTimeoutId) {\n            args = thisArg = null;\n          }\n        }\n      };\n\n      return function() {\n        args = arguments;\n        stamp = now();\n        thisArg = this;\n        trailingCall = trailing && (timeoutId || !leading);\n\n        if (maxWait === false) {\n          var leadingCall = leading && !timeoutId;\n        } else {\n          if (!maxTimeoutId && !leading) {\n            lastCalled = stamp;\n          }\n          var remaining = maxWait - (stamp - lastCalled),\n              isCalled = remaining <= 0;\n\n          if (isCalled) {\n            if (maxTimeoutId) {\n              maxTimeoutId = clearTimeout(maxTimeoutId);\n            }\n            lastCalled = stamp;\n            result = func.apply(thisArg, args);\n          }\n          else if (!maxTimeoutId) {\n            maxTimeoutId = setTimeout(maxDelayed, remaining);\n          }\n        }\n        if (isCalled && timeoutId) {\n          timeoutId = clearTimeout(timeoutId);\n        }\n        else if (!timeoutId && wait !== maxWait) {\n          timeoutId = setTimeout(delayed, wait);\n        }\n        if (leadingCall) {\n          isCalled = true;\n          result = func.apply(thisArg, args);\n        }\n        if (isCalled && !timeoutId && !maxTimeoutId) {\n          args = thisArg = null;\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Defers executing the `func` function until the current call stack has cleared.\n     * Additional arguments will be provided to `func` when it is invoked.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to defer.\n     * @param {...*} [arg] Arguments to invoke the function with.\n     * @returns {number} Returns the timer id.\n     * @example\n     *\n     * _.defer(function(text) { console.log(text); }, 'deferred');\n     * // logs 'deferred' after one or more milliseconds\n     */\n    function defer(func) {\n      if (!isFunction(func)) {\n        throw new TypeError;\n      }\n      var args = slice(arguments, 1);\n      return setTimeout(function() { func.apply(undefined, args); }, 1);\n    }\n\n    /**\n     * Executes the `func` function after `wait` milliseconds. Additional arguments\n     * will be provided to `func` when it is invoked.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to delay.\n     * @param {number} wait The number of milliseconds to delay execution.\n     * @param {...*} [arg] Arguments to invoke the function with.\n     * @returns {number} Returns the timer id.\n     * @example\n     *\n     * _.delay(function(text) { console.log(text); }, 1000, 'later');\n     * // => logs 'later' after one second\n     */\n    function delay(func, wait) {\n      if (!isFunction(func)) {\n        throw new TypeError;\n      }\n      var args = slice(arguments, 2);\n      return setTimeout(function() { func.apply(undefined, args); }, wait);\n    }\n\n    /**\n     * Creates a function that memoizes the result of `func`. If `resolver` is\n     * provided it will be used to determine the cache key for storing the result\n     * based on the arguments provided to the memoized function. By default, the\n     * first argument provided to the memoized function is used as the cache key.\n     * The `func` is executed with the `this` binding of the memoized function.\n     * The result cache is exposed as the `cache` property on the memoized function.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to have its output memoized.\n     * @param {Function} [resolver] A function used to resolve the cache key.\n     * @returns {Function} Returns the new memoizing function.\n     * @example\n     *\n     * var fibonacci = _.memoize(function(n) {\n     *   return n < 2 ? n : fibonacci(n - 1) + fibonacci(n - 2);\n     * });\n     *\n     * fibonacci(9)\n     * // => 34\n     *\n     * var data = {\n     *   'fred': { 'name': 'fred', 'age': 40 },\n     *   'pebbles': { 'name': 'pebbles', 'age': 1 }\n     * };\n     *\n     * // modifying the result cache\n     * var get = _.memoize(function(name) { return data[name]; }, _.identity);\n     * get('pebbles');\n     * // => { 'name': 'pebbles', 'age': 1 }\n     *\n     * get.cache.pebbles.name = 'penelope';\n     * get('pebbles');\n     * // => { 'name': 'penelope', 'age': 1 }\n     */\n    function memoize(func, resolver) {\n      if (!isFunction(func)) {\n        throw new TypeError;\n      }\n      var memoized = function() {\n        var cache = memoized.cache,\n            key = resolver ? resolver.apply(this, arguments) : keyPrefix + arguments[0];\n\n        return hasOwnProperty.call(cache, key)\n          ? cache[key]\n          : (cache[key] = func.apply(this, arguments));\n      }\n      memoized.cache = {};\n      return memoized;\n    }\n\n    /**\n     * Creates a function that is restricted to execute `func` once. Repeat calls to\n     * the function will return the value of the first call. The `func` is executed\n     * with the `this` binding of the created function.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * var initialize = _.once(createApplication);\n     * initialize();\n     * initialize();\n     * // `initialize` executes `createApplication` once\n     */\n    function once(func) {\n      var ran,\n          result;\n\n      if (!isFunction(func)) {\n        throw new TypeError;\n      }\n      return function() {\n        if (ran) {\n          return result;\n        }\n        ran = true;\n        result = func.apply(this, arguments);\n\n        // clear the `func` variable so the function may be garbage collected\n        func = null;\n        return result;\n      };\n    }\n\n    /**\n     * Creates a function that, when called, invokes `func` with any additional\n     * `partial` arguments prepended to those provided to the new function. This\n     * method is similar to `_.bind` except it does **not** alter the `this` binding.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to partially apply arguments to.\n     * @param {...*} [arg] Arguments to be partially applied.\n     * @returns {Function} Returns the new partially applied function.\n     * @example\n     *\n     * var greet = function(greeting, name) { return greeting + ' ' + name; };\n     * var hi = _.partial(greet, 'hi');\n     * hi('fred');\n     * // => 'hi fred'\n     */\n    function partial(func) {\n      return createWrapper(func, 16, slice(arguments, 1));\n    }\n\n    /**\n     * This method is like `_.partial` except that `partial` arguments are\n     * appended to those provided to the new function.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to partially apply arguments to.\n     * @param {...*} [arg] Arguments to be partially applied.\n     * @returns {Function} Returns the new partially applied function.\n     * @example\n     *\n     * var defaultsDeep = _.partialRight(_.merge, _.defaults);\n     *\n     * var options = {\n     *   'variable': 'data',\n     *   'imports': { 'jq': $ }\n     * };\n     *\n     * defaultsDeep(options, _.templateSettings);\n     *\n     * options.variable\n     * // => 'data'\n     *\n     * options.imports\n     * // => { '_': _, 'jq': $ }\n     */\n    function partialRight(func) {\n      return createWrapper(func, 32, null, slice(arguments, 1));\n    }\n\n    /**\n     * Creates a function that, when executed, will only call the `func` function\n     * at most once per every `wait` milliseconds. Provide an options object to\n     * indicate that `func` should be invoked on the leading and/or trailing edge\n     * of the `wait` timeout. Subsequent calls to the throttled function will\n     * return the result of the last `func` call.\n     *\n     * Note: If `leading` and `trailing` options are `true` `func` will be called\n     * on the trailing edge of the timeout only if the the throttled function is\n     * invoked more than once during the `wait` timeout.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {Function} func The function to throttle.\n     * @param {number} wait The number of milliseconds to throttle executions to.\n     * @param {Object} [options] The options object.\n     * @param {boolean} [options.leading=true] Specify execution on the leading edge of the timeout.\n     * @param {boolean} [options.trailing=true] Specify execution on the trailing edge of the timeout.\n     * @returns {Function} Returns the new throttled function.\n     * @example\n     *\n     * // avoid excessively updating the position while scrolling\n     * var throttled = _.throttle(updatePosition, 100);\n     * jQuery(window).on('scroll', throttled);\n     *\n     * // execute `renewToken` when the click event is fired, but not more than once every 5 minutes\n     * jQuery('.interactive').on('click', _.throttle(renewToken, 300000, {\n     *   'trailing': false\n     * }));\n     */\n    function throttle(func, wait, options) {\n      var leading = true,\n          trailing = true;\n\n      if (!isFunction(func)) {\n        throw new TypeError;\n      }\n      if (options === false) {\n        leading = false;\n      } else if (isObject(options)) {\n        leading = 'leading' in options ? options.leading : leading;\n        trailing = 'trailing' in options ? options.trailing : trailing;\n      }\n      debounceOptions.leading = leading;\n      debounceOptions.maxWait = wait;\n      debounceOptions.trailing = trailing;\n\n      return debounce(func, wait, debounceOptions);\n    }\n\n    /**\n     * Creates a function that provides `value` to the wrapper function as its\n     * first argument. Additional arguments provided to the function are appended\n     * to those provided to the wrapper function. The wrapper is executed with\n     * the `this` binding of the created function.\n     *\n     * @static\n     * @memberOf _\n     * @category Functions\n     * @param {*} value The value to wrap.\n     * @param {Function} wrapper The wrapper function.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var p = _.wrap(_.escape, function(func, text) {\n     *   return '<p>' + func(text) + '</p>';\n     * });\n     *\n     * p('Fred, Wilma, & Pebbles');\n     * // => '<p>Fred, Wilma, &amp; Pebbles</p>'\n     */\n    function wrap(value, wrapper) {\n      return createWrapper(wrapper, 16, [value]);\n    }\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * Creates a function that returns `value`.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {*} value The value to return from the new function.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var object = { 'name': 'fred' };\n     * var getter = _.constant(object);\n     * getter() === object;\n     * // => true\n     */\n    function constant(value) {\n      return function() {\n        return value;\n      };\n    }\n\n    /**\n     * Produces a callback bound to an optional `thisArg`. If `func` is a property\n     * name the created callback will return the property value for a given element.\n     * If `func` is an object the created callback will return `true` for elements\n     * that contain the equivalent object properties, otherwise it will return `false`.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {*} [func=identity] The value to convert to a callback.\n     * @param {*} [thisArg] The `this` binding of the created callback.\n     * @param {number} [argCount] The number of arguments the callback accepts.\n     * @returns {Function} Returns a callback function.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36 },\n     *   { 'name': 'fred',   'age': 40 }\n     * ];\n     *\n     * // wrap to create custom callback shorthands\n     * _.createCallback = _.wrap(_.createCallback, function(func, callback, thisArg) {\n     *   var match = /^(.+?)__([gl]t)(.+)$/.exec(callback);\n     *   return !match ? func(callback, thisArg) : function(object) {\n     *     return match[2] == 'gt' ? object[match[1]] > match[3] : object[match[1]] < match[3];\n     *   };\n     * });\n     *\n     * _.filter(characters, 'age__gt38');\n     * // => [{ 'name': 'fred', 'age': 40 }]\n     */\n    function createCallback(func, thisArg, argCount) {\n      var type = typeof func;\n      if (func == null || type == 'function') {\n        return baseCreateCallback(func, thisArg, argCount);\n      }\n      // handle \"_.pluck\" style callback shorthands\n      if (type != 'object') {\n        return property(func);\n      }\n      var props = keys(func),\n          key = props[0],\n          a = func[key];\n\n      // handle \"_.where\" style callback shorthands\n      if (props.length == 1 && a === a && !isObject(a)) {\n        // fast path the common case of providing an object with a single\n        // property containing a primitive value\n        return function(object) {\n          var b = object[key];\n          return a === b && (a !== 0 || (1 / a == 1 / b));\n        };\n      }\n      return function(object) {\n        var length = props.length,\n            result = false;\n\n        while (length--) {\n          if (!(result = baseIsEqual(object[props[length]], func[props[length]], null, true))) {\n            break;\n          }\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Converts the characters `&`, `<`, `>`, `\"`, and `'` in `string` to their\n     * corresponding HTML entities.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {string} string The string to escape.\n     * @returns {string} Returns the escaped string.\n     * @example\n     *\n     * _.escape('Fred, Wilma, & Pebbles');\n     * // => 'Fred, Wilma, &amp; Pebbles'\n     */\n    function escape(string) {\n      return string == null ? '' : String(string).replace(reUnescapedHtml, escapeHtmlChar);\n    }\n\n    /**\n     * This method returns the first argument provided to it.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {*} value Any value.\n     * @returns {*} Returns `value`.\n     * @example\n     *\n     * var object = { 'name': 'fred' };\n     * _.identity(object) === object;\n     * // => true\n     */\n    function identity(value) {\n      return value;\n    }\n\n    /**\n     * Adds function properties of a source object to the destination object.\n     * If `object` is a function methods will be added to its prototype as well.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {Function|Object} [object=lodash] object The destination object.\n     * @param {Object} source The object of functions to add.\n     * @param {Object} [options] The options object.\n     * @param {boolean} [options.chain=true] Specify whether the functions added are chainable.\n     * @example\n     *\n     * function capitalize(string) {\n     *   return string.charAt(0).toUpperCase() + string.slice(1).toLowerCase();\n     * }\n     *\n     * _.mixin({ 'capitalize': capitalize });\n     * _.capitalize('fred');\n     * // => 'Fred'\n     *\n     * _('fred').capitalize().value();\n     * // => 'Fred'\n     *\n     * _.mixin({ 'capitalize': capitalize }, { 'chain': false });\n     * _('fred').capitalize();\n     * // => 'Fred'\n     */\n    function mixin(object, source, options) {\n      var chain = true,\n          methodNames = source && functions(source);\n\n      if (!source || (!options && !methodNames.length)) {\n        if (options == null) {\n          options = source;\n        }\n        ctor = lodashWrapper;\n        source = object;\n        object = lodash;\n        methodNames = functions(source);\n      }\n      if (options === false) {\n        chain = false;\n      } else if (isObject(options) && 'chain' in options) {\n        chain = options.chain;\n      }\n      var ctor = object,\n          isFunc = isFunction(ctor);\n\n      forEach(methodNames, function(methodName) {\n        var func = object[methodName] = source[methodName];\n        if (isFunc) {\n          ctor.prototype[methodName] = function() {\n            var chainAll = this.__chain__,\n                value = this.__wrapped__,\n                args = [value];\n\n            push.apply(args, arguments);\n            var result = func.apply(object, args);\n            if (chain || chainAll) {\n              if (value === result && isObject(result)) {\n                return this;\n              }\n              result = new ctor(result);\n              result.__chain__ = chainAll;\n            }\n            return result;\n          };\n        }\n      });\n    }\n\n    /**\n     * Reverts the '_' variable to its previous value and returns a reference to\n     * the `lodash` function.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @returns {Function} Returns the `lodash` function.\n     * @example\n     *\n     * var lodash = _.noConflict();\n     */\n    function noConflict() {\n      context._ = oldDash;\n      return this;\n    }\n\n    /**\n     * A no-operation function.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @example\n     *\n     * var object = { 'name': 'fred' };\n     * _.noop(object) === undefined;\n     * // => true\n     */\n    function noop() {\n      // no operation performed\n    }\n\n    /**\n     * Gets the number of milliseconds that have elapsed since the Unix epoch\n     * (1 January 1970 00:00:00 UTC).\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @example\n     *\n     * var stamp = _.now();\n     * _.defer(function() { console.log(_.now() - stamp); });\n     * // => logs the number of milliseconds it took for the deferred function to be called\n     */\n    var now = isNative(now = Date.now) && now || function() {\n      return new Date().getTime();\n    };\n\n    /**\n     * Converts the given value into an integer of the specified radix.\n     * If `radix` is `undefined` or `0` a `radix` of `10` is used unless the\n     * `value` is a hexadecimal, in which case a `radix` of `16` is used.\n     *\n     * Note: This method avoids differences in native ES3 and ES5 `parseInt`\n     * implementations. See http://es5.github.io/#E.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {string} value The value to parse.\n     * @param {number} [radix] The radix used to interpret the value to parse.\n     * @returns {number} Returns the new integer value.\n     * @example\n     *\n     * _.parseInt('08');\n     * // => 8\n     */\n    var parseInt = nativeParseInt(whitespace + '08') == 8 ? nativeParseInt : function(value, radix) {\n      // Firefox < 21 and Opera < 15 follow the ES3 specified implementation of `parseInt`\n      return nativeParseInt(isString(value) ? value.replace(reLeadingSpacesAndZeros, '') : value, radix || 0);\n    };\n\n    /**\n     * Creates a \"_.pluck\" style function, which returns the `key` value of a\n     * given object.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {string} key The name of the property to retrieve.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'fred',   'age': 40 },\n     *   { 'name': 'barney', 'age': 36 }\n     * ];\n     *\n     * var getName = _.property('name');\n     *\n     * _.map(characters, getName);\n     * // => ['barney', 'fred']\n     *\n     * _.sortBy(characters, getName);\n     * // => [{ 'name': 'barney', 'age': 36 }, { 'name': 'fred',   'age': 40 }]\n     */\n    function property(key) {\n      return function(object) {\n        return object[key];\n      };\n    }\n\n    /**\n     * Produces a random number between `min` and `max` (inclusive). If only one\n     * argument is provided a number between `0` and the given number will be\n     * returned. If `floating` is truey or either `min` or `max` are floats a\n     * floating-point number will be returned instead of an integer.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {number} [min=0] The minimum possible value.\n     * @param {number} [max=1] The maximum possible value.\n     * @param {boolean} [floating=false] Specify returning a floating-point number.\n     * @returns {number} Returns a random number.\n     * @example\n     *\n     * _.random(0, 5);\n     * // => an integer between 0 and 5\n     *\n     * _.random(5);\n     * // => also an integer between 0 and 5\n     *\n     * _.random(5, true);\n     * // => a floating-point number between 0 and 5\n     *\n     * _.random(1.2, 5.2);\n     * // => a floating-point number between 1.2 and 5.2\n     */\n    function random(min, max, floating) {\n      var noMin = min == null,\n          noMax = max == null;\n\n      if (floating == null) {\n        if (typeof min == 'boolean' && noMax) {\n          floating = min;\n          min = 1;\n        }\n        else if (!noMax && typeof max == 'boolean') {\n          floating = max;\n          noMax = true;\n        }\n      }\n      if (noMin && noMax) {\n        max = 1;\n      }\n      min = +min || 0;\n      if (noMax) {\n        max = min;\n        min = 0;\n      } else {\n        max = +max || 0;\n      }\n      if (floating || min % 1 || max % 1) {\n        var rand = nativeRandom();\n        return nativeMin(min + (rand * (max - min + parseFloat('1e-' + ((rand +'').length - 1)))), max);\n      }\n      return baseRandom(min, max);\n    }\n\n    /**\n     * Resolves the value of property `key` on `object`. If `key` is a function\n     * it will be invoked with the `this` binding of `object` and its result returned,\n     * else the property value is returned. If `object` is falsey then `undefined`\n     * is returned.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {Object} object The object to inspect.\n     * @param {string} key The name of the property to resolve.\n     * @returns {*} Returns the resolved value.\n     * @example\n     *\n     * var object = {\n     *   'cheese': 'crumpets',\n     *   'stuff': function() {\n     *     return 'nonsense';\n     *   }\n     * };\n     *\n     * _.result(object, 'cheese');\n     * // => 'crumpets'\n     *\n     * _.result(object, 'stuff');\n     * // => 'nonsense'\n     */\n    function result(object, key) {\n      if (object) {\n        var value = object[key];\n        return isFunction(value) ? object[key]() : value;\n      }\n    }\n\n    /**\n     * A micro-templating method that handles arbitrary delimiters, preserves\n     * whitespace, and correctly escapes quotes within interpolated code.\n     *\n     * Note: In the development build, `_.template` utilizes sourceURLs for easier\n     * debugging. See http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/#toc-sourceurl\n     *\n     * For more information on precompiling templates see:\n     * http://lodash.com/custom-builds\n     *\n     * For more information on Chrome extension sandboxes see:\n     * http://developer.chrome.com/stable/extensions/sandboxingEval.html\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {string} text The template text.\n     * @param {Object} data The data object used to populate the text.\n     * @param {Object} [options] The options object.\n     * @param {RegExp} [options.escape] The \"escape\" delimiter.\n     * @param {RegExp} [options.evaluate] The \"evaluate\" delimiter.\n     * @param {Object} [options.imports] An object to import into the template as local variables.\n     * @param {RegExp} [options.interpolate] The \"interpolate\" delimiter.\n     * @param {string} [sourceURL] The sourceURL of the template's compiled source.\n     * @param {string} [variable] The data object variable name.\n     * @returns {Function|string} Returns a compiled function when no `data` object\n     *  is given, else it returns the interpolated text.\n     * @example\n     *\n     * // using the \"interpolate\" delimiter to create a compiled template\n     * var compiled = _.template('hello <%= name %>');\n     * compiled({ 'name': 'fred' });\n     * // => 'hello fred'\n     *\n     * // using the \"escape\" delimiter to escape HTML in data property values\n     * _.template('<b><%- value %></b>', { 'value': '<script>' });\n     * // => '<b>&lt;script&gt;</b>'\n     *\n     * // using the \"evaluate\" delimiter to generate HTML\n     * var list = '<% _.forEach(people, function(name) { %><li><%- name %></li><% }); %>';\n     * _.template(list, { 'people': ['fred', 'barney'] });\n     * // => '<li>fred</li><li>barney</li>'\n     *\n     * // using the ES6 delimiter as an alternative to the default \"interpolate\" delimiter\n     * _.template('hello ${ name }', { 'name': 'pebbles' });\n     * // => 'hello pebbles'\n     *\n     * // using the internal `print` function in \"evaluate\" delimiters\n     * _.template('<% print(\"hello \" + name); %>!', { 'name': 'barney' });\n     * // => 'hello barney!'\n     *\n     * // using a custom template delimiters\n     * _.templateSettings = {\n     *   'interpolate': /{{([\\s\\S]+?)}}/g\n     * };\n     *\n     * _.template('hello {{ name }}!', { 'name': 'mustache' });\n     * // => 'hello mustache!'\n     *\n     * // using the `imports` option to import jQuery\n     * var list = '<% jq.each(people, function(name) { %><li><%- name %></li><% }); %>';\n     * _.template(list, { 'people': ['fred', 'barney'] }, { 'imports': { 'jq': jQuery } });\n     * // => '<li>fred</li><li>barney</li>'\n     *\n     * // using the `sourceURL` option to specify a custom sourceURL for the template\n     * var compiled = _.template('hello <%= name %>', null, { 'sourceURL': '/basic/greeting.jst' });\n     * compiled(data);\n     * // => find the source of \"greeting.jst\" under the Sources tab or Resources panel of the web inspector\n     *\n     * // using the `variable` option to ensure a with-statement isn't used in the compiled template\n     * var compiled = _.template('hi <%= data.name %>!', null, { 'variable': 'data' });\n     * compiled.source;\n     * // => function(data) {\n     *   var __t, __p = '', __e = _.escape;\n     *   __p += 'hi ' + ((__t = ( data.name )) == null ? '' : __t) + '!';\n     *   return __p;\n     * }\n     *\n     * // using the `source` property to inline compiled templates for meaningful\n     * // line numbers in error messages and a stack trace\n     * fs.writeFileSync(path.join(cwd, 'jst.js'), '\\\n     *   var JST = {\\\n     *     \"main\": ' + _.template(mainText).source + '\\\n     *   };\\\n     * ');\n     */\n    function template(text, data, options) {\n      // based on John Resig's `tmpl` implementation\n      // http://ejohn.org/blog/javascript-micro-templating/\n      // and Laura Doktorova's doT.js\n      // https://github.com/olado/doT\n      var settings = lodash.templateSettings;\n      text = String(text || '');\n\n      // avoid missing dependencies when `iteratorTemplate` is not defined\n      options = defaults({}, options, settings);\n\n      var imports = defaults({}, options.imports, settings.imports),\n          importsKeys = keys(imports),\n          importsValues = values(imports);\n\n      var isEvaluating,\n          index = 0,\n          interpolate = options.interpolate || reNoMatch,\n          source = \"__p += '\";\n\n      // compile the regexp to match each delimiter\n      var reDelimiters = RegExp(\n        (options.escape || reNoMatch).source + '|' +\n        interpolate.source + '|' +\n        (interpolate === reInterpolate ? reEsTemplate : reNoMatch).source + '|' +\n        (options.evaluate || reNoMatch).source + '|$'\n      , 'g');\n\n      text.replace(reDelimiters, function(match, escapeValue, interpolateValue, esTemplateValue, evaluateValue, offset) {\n        interpolateValue || (interpolateValue = esTemplateValue);\n\n        // escape characters that cannot be included in string literals\n        source += text.slice(index, offset).replace(reUnescapedString, escapeStringChar);\n\n        // replace delimiters with snippets\n        if (escapeValue) {\n          source += \"' +\\n__e(\" + escapeValue + \") +\\n'\";\n        }\n        if (evaluateValue) {\n          isEvaluating = true;\n          source += \"';\\n\" + evaluateValue + \";\\n__p += '\";\n        }\n        if (interpolateValue) {\n          source += \"' +\\n((__t = (\" + interpolateValue + \")) == null ? '' : __t) +\\n'\";\n        }\n        index = offset + match.length;\n\n        // the JS engine embedded in Adobe products requires returning the `match`\n        // string in order to produce the correct `offset` value\n        return match;\n      });\n\n      source += \"';\\n\";\n\n      // if `variable` is not specified, wrap a with-statement around the generated\n      // code to add the data object to the top of the scope chain\n      var variable = options.variable,\n          hasVariable = variable;\n\n      if (!hasVariable) {\n        variable = 'obj';\n        source = 'with (' + variable + ') {\\n' + source + '\\n}\\n';\n      }\n      // cleanup code by stripping empty strings\n      source = (isEvaluating ? source.replace(reEmptyStringLeading, '') : source)\n        .replace(reEmptyStringMiddle, '$1')\n        .replace(reEmptyStringTrailing, '$1;');\n\n      // frame code as the function body\n      source = 'function(' + variable + ') {\\n' +\n        (hasVariable ? '' : variable + ' || (' + variable + ' = {});\\n') +\n        \"var __t, __p = '', __e = _.escape\" +\n        (isEvaluating\n          ? ', __j = Array.prototype.join;\\n' +\n            \"function print() { __p += __j.call(arguments, '') }\\n\"\n          : ';\\n'\n        ) +\n        source +\n        'return __p\\n}';\n\n      // Use a sourceURL for easier debugging.\n      // http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/#toc-sourceurl\n      var sourceURL = '\\n/*\\n//# sourceURL=' + (options.sourceURL || '/lodash/template/source[' + (templateCounter++) + ']') + '\\n*/';\n\n      try {\n        var result = Function(importsKeys, 'return ' + source + sourceURL).apply(undefined, importsValues);\n      } catch(e) {\n        e.source = source;\n        throw e;\n      }\n      if (data) {\n        return result(data);\n      }\n      // provide the compiled function's source by its `toString` method, in\n      // supported environments, or the `source` property as a convenience for\n      // inlining compiled templates during the build process\n      result.source = source;\n      return result;\n    }\n\n    /**\n     * Executes the callback `n` times, returning an array of the results\n     * of each callback execution. The callback is bound to `thisArg` and invoked\n     * with one argument; (index).\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {number} n The number of times to execute the callback.\n     * @param {Function} callback The function called per iteration.\n     * @param {*} [thisArg] The `this` binding of `callback`.\n     * @returns {Array} Returns an array of the results of each `callback` execution.\n     * @example\n     *\n     * var diceRolls = _.times(3, _.partial(_.random, 1, 6));\n     * // => [3, 6, 4]\n     *\n     * _.times(3, function(n) { mage.castSpell(n); });\n     * // => calls `mage.castSpell(n)` three times, passing `n` of `0`, `1`, and `2` respectively\n     *\n     * _.times(3, function(n) { this.cast(n); }, mage);\n     * // => also calls `mage.castSpell(n)` three times\n     */\n    function times(n, callback, thisArg) {\n      n = (n = +n) > -1 ? n : 0;\n      var index = -1,\n          result = Array(n);\n\n      callback = baseCreateCallback(callback, thisArg, 1);\n      while (++index < n) {\n        result[index] = callback(index);\n      }\n      return result;\n    }\n\n    /**\n     * The inverse of `_.escape` this method converts the HTML entities\n     * `&amp;`, `&lt;`, `&gt;`, `&quot;`, and `&#39;` in `string` to their\n     * corresponding characters.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {string} string The string to unescape.\n     * @returns {string} Returns the unescaped string.\n     * @example\n     *\n     * _.unescape('Fred, Barney &amp; Pebbles');\n     * // => 'Fred, Barney & Pebbles'\n     */\n    function unescape(string) {\n      return string == null ? '' : String(string).replace(reEscapedHtml, unescapeHtmlChar);\n    }\n\n    /**\n     * Generates a unique ID. If `prefix` is provided the ID will be appended to it.\n     *\n     * @static\n     * @memberOf _\n     * @category Utilities\n     * @param {string} [prefix] The value to prefix the ID with.\n     * @returns {string} Returns the unique ID.\n     * @example\n     *\n     * _.uniqueId('contact_');\n     * // => 'contact_104'\n     *\n     * _.uniqueId();\n     * // => '105'\n     */\n    function uniqueId(prefix) {\n      var id = ++idCounter;\n      return String(prefix == null ? '' : prefix) + id;\n    }\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * Creates a `lodash` object that wraps the given value with explicit\n     * method chaining enabled.\n     *\n     * @static\n     * @memberOf _\n     * @category Chaining\n     * @param {*} value The value to wrap.\n     * @returns {Object} Returns the wrapper object.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney',  'age': 36 },\n     *   { 'name': 'fred',    'age': 40 },\n     *   { 'name': 'pebbles', 'age': 1 }\n     * ];\n     *\n     * var youngest = _.chain(characters)\n     *     .sortBy('age')\n     *     .map(function(chr) { return chr.name + ' is ' + chr.age; })\n     *     .first()\n     *     .value();\n     * // => 'pebbles is 1'\n     */\n    function chain(value) {\n      value = new lodashWrapper(value);\n      value.__chain__ = true;\n      return value;\n    }\n\n    /**\n     * Invokes `interceptor` with the `value` as the first argument and then\n     * returns `value`. The purpose of this method is to \"tap into\" a method\n     * chain in order to perform operations on intermediate results within\n     * the chain.\n     *\n     * @static\n     * @memberOf _\n     * @category Chaining\n     * @param {*} value The value to provide to `interceptor`.\n     * @param {Function} interceptor The function to invoke.\n     * @returns {*} Returns `value`.\n     * @example\n     *\n     * _([1, 2, 3, 4])\n     *  .tap(function(array) { array.pop(); })\n     *  .reverse()\n     *  .value();\n     * // => [3, 2, 1]\n     */\n    function tap(value, interceptor) {\n      interceptor(value);\n      return value;\n    }\n\n    /**\n     * Enables explicit method chaining on the wrapper object.\n     *\n     * @name chain\n     * @memberOf _\n     * @category Chaining\n     * @returns {*} Returns the wrapper object.\n     * @example\n     *\n     * var characters = [\n     *   { 'name': 'barney', 'age': 36 },\n     *   { 'name': 'fred',   'age': 40 }\n     * ];\n     *\n     * // without explicit chaining\n     * _(characters).first();\n     * // => { 'name': 'barney', 'age': 36 }\n     *\n     * // with explicit chaining\n     * _(characters).chain()\n     *   .first()\n     *   .pick('age')\n     *   .value();\n     * // => { 'age': 36 }\n     */\n    function wrapperChain() {\n      this.__chain__ = true;\n      return this;\n    }\n\n    /**\n     * Produces the `toString` result of the wrapped value.\n     *\n     * @name toString\n     * @memberOf _\n     * @category Chaining\n     * @returns {string} Returns the string result.\n     * @example\n     *\n     * _([1, 2, 3]).toString();\n     * // => '1,2,3'\n     */\n    function wrapperToString() {\n      return String(this.__wrapped__);\n    }\n\n    /**\n     * Extracts the wrapped value.\n     *\n     * @name valueOf\n     * @memberOf _\n     * @alias value\n     * @category Chaining\n     * @returns {*} Returns the wrapped value.\n     * @example\n     *\n     * _([1, 2, 3]).valueOf();\n     * // => [1, 2, 3]\n     */\n    function wrapperValueOf() {\n      return this.__wrapped__;\n    }\n\n    /*--------------------------------------------------------------------------*/\n\n    // add functions that return wrapped values when chaining\n    lodash.after = after;\n    lodash.assign = assign;\n    lodash.at = at;\n    lodash.bind = bind;\n    lodash.bindAll = bindAll;\n    lodash.bindKey = bindKey;\n    lodash.chain = chain;\n    lodash.compact = compact;\n    lodash.compose = compose;\n    lodash.constant = constant;\n    lodash.countBy = countBy;\n    lodash.create = create;\n    lodash.createCallback = createCallback;\n    lodash.curry = curry;\n    lodash.debounce = debounce;\n    lodash.defaults = defaults;\n    lodash.defer = defer;\n    lodash.delay = delay;\n    lodash.difference = difference;\n    lodash.filter = filter;\n    lodash.flatten = flatten;\n    lodash.forEach = forEach;\n    lodash.forEachRight = forEachRight;\n    lodash.forIn = forIn;\n    lodash.forInRight = forInRight;\n    lodash.forOwn = forOwn;\n    lodash.forOwnRight = forOwnRight;\n    lodash.functions = functions;\n    lodash.groupBy = groupBy;\n    lodash.indexBy = indexBy;\n    lodash.initial = initial;\n    lodash.intersection = intersection;\n    lodash.invert = invert;\n    lodash.invoke = invoke;\n    lodash.keys = keys;\n    lodash.map = map;\n    lodash.mapValues = mapValues;\n    lodash.max = max;\n    lodash.memoize = memoize;\n    lodash.merge = merge;\n    lodash.min = min;\n    lodash.omit = omit;\n    lodash.once = once;\n    lodash.pairs = pairs;\n    lodash.partial = partial;\n    lodash.partialRight = partialRight;\n    lodash.pick = pick;\n    lodash.pluck = pluck;\n    lodash.property = property;\n    lodash.pull = pull;\n    lodash.range = range;\n    lodash.reject = reject;\n    lodash.remove = remove;\n    lodash.rest = rest;\n    lodash.shuffle = shuffle;\n    lodash.sortBy = sortBy;\n    lodash.tap = tap;\n    lodash.throttle = throttle;\n    lodash.times = times;\n    lodash.toArray = toArray;\n    lodash.transform = transform;\n    lodash.union = union;\n    lodash.uniq = uniq;\n    lodash.values = values;\n    lodash.where = where;\n    lodash.without = without;\n    lodash.wrap = wrap;\n    lodash.xor = xor;\n    lodash.zip = zip;\n    lodash.zipObject = zipObject;\n\n    // add aliases\n    lodash.collect = map;\n    lodash.drop = rest;\n    lodash.each = forEach;\n    lodash.eachRight = forEachRight;\n    lodash.extend = assign;\n    lodash.methods = functions;\n    lodash.object = zipObject;\n    lodash.select = filter;\n    lodash.tail = rest;\n    lodash.unique = uniq;\n    lodash.unzip = zip;\n\n    // add functions to `lodash.prototype`\n    mixin(lodash);\n\n    /*--------------------------------------------------------------------------*/\n\n    // add functions that return unwrapped values when chaining\n    lodash.clone = clone;\n    lodash.cloneDeep = cloneDeep;\n    lodash.contains = contains;\n    lodash.escape = escape;\n    lodash.every = every;\n    lodash.find = find;\n    lodash.findIndex = findIndex;\n    lodash.findKey = findKey;\n    lodash.findLast = findLast;\n    lodash.findLastIndex = findLastIndex;\n    lodash.findLastKey = findLastKey;\n    lodash.has = has;\n    lodash.identity = identity;\n    lodash.indexOf = indexOf;\n    lodash.isArguments = isArguments;\n    lodash.isArray = isArray;\n    lodash.isBoolean = isBoolean;\n    lodash.isDate = isDate;\n    lodash.isElement = isElement;\n    lodash.isEmpty = isEmpty;\n    lodash.isEqual = isEqual;\n    lodash.isFinite = isFinite;\n    lodash.isFunction = isFunction;\n    lodash.isNaN = isNaN;\n    lodash.isNull = isNull;\n    lodash.isNumber = isNumber;\n    lodash.isObject = isObject;\n    lodash.isPlainObject = isPlainObject;\n    lodash.isRegExp = isRegExp;\n    lodash.isString = isString;\n    lodash.isUndefined = isUndefined;\n    lodash.lastIndexOf = lastIndexOf;\n    lodash.mixin = mixin;\n    lodash.noConflict = noConflict;\n    lodash.noop = noop;\n    lodash.now = now;\n    lodash.parseInt = parseInt;\n    lodash.random = random;\n    lodash.reduce = reduce;\n    lodash.reduceRight = reduceRight;\n    lodash.result = result;\n    lodash.runInContext = runInContext;\n    lodash.size = size;\n    lodash.some = some;\n    lodash.sortedIndex = sortedIndex;\n    lodash.template = template;\n    lodash.unescape = unescape;\n    lodash.uniqueId = uniqueId;\n\n    // add aliases\n    lodash.all = every;\n    lodash.any = some;\n    lodash.detect = find;\n    lodash.findWhere = find;\n    lodash.foldl = reduce;\n    lodash.foldr = reduceRight;\n    lodash.include = contains;\n    lodash.inject = reduce;\n\n    mixin(function() {\n      var source = {}\n      forOwn(lodash, function(func, methodName) {\n        if (!lodash.prototype[methodName]) {\n          source[methodName] = func;\n        }\n      });\n      return source;\n    }(), false);\n\n    /*--------------------------------------------------------------------------*/\n\n    // add functions capable of returning wrapped and unwrapped values when chaining\n    lodash.first = first;\n    lodash.last = last;\n    lodash.sample = sample;\n\n    // add aliases\n    lodash.take = first;\n    lodash.head = first;\n\n    forOwn(lodash, function(func, methodName) {\n      var callbackable = methodName !== 'sample';\n      if (!lodash.prototype[methodName]) {\n        lodash.prototype[methodName]= function(n, guard) {\n          var chainAll = this.__chain__,\n              result = func(this.__wrapped__, n, guard);\n\n          return !chainAll && (n == null || (guard && !(callbackable && typeof n == 'function')))\n            ? result\n            : new lodashWrapper(result, chainAll);\n        };\n      }\n    });\n\n    /*--------------------------------------------------------------------------*/\n\n    /**\n     * The semantic version number.\n     *\n     * @static\n     * @memberOf _\n     * @type string\n     */\n    lodash.VERSION = '2.4.1';\n\n    // add \"Chaining\" functions to the wrapper\n    lodash.prototype.chain = wrapperChain;\n    lodash.prototype.toString = wrapperToString;\n    lodash.prototype.value = wrapperValueOf;\n    lodash.prototype.valueOf = wrapperValueOf;\n\n    // add `Array` functions that return unwrapped values\n    forEach(['join', 'pop', 'shift'], function(methodName) {\n      var func = arrayRef[methodName];\n      lodash.prototype[methodName] = function() {\n        var chainAll = this.__chain__,\n            result = func.apply(this.__wrapped__, arguments);\n\n        return chainAll\n          ? new lodashWrapper(result, chainAll)\n          : result;\n      };\n    });\n\n    // add `Array` functions that return the existing wrapped value\n    forEach(['push', 'reverse', 'sort', 'unshift'], function(methodName) {\n      var func = arrayRef[methodName];\n      lodash.prototype[methodName] = function() {\n        func.apply(this.__wrapped__, arguments);\n        return this;\n      };\n    });\n\n    // add `Array` functions that return new wrapped values\n    forEach(['concat', 'slice', 'splice'], function(methodName) {\n      var func = arrayRef[methodName];\n      lodash.prototype[methodName] = function() {\n        return new lodashWrapper(func.apply(this.__wrapped__, arguments), this.__chain__);\n      };\n    });\n\n    return lodash;\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  // expose Lo-Dash\n  var _ = runInContext();\n\n  // some AMD build optimizers like r.js check for condition patterns like the following:\n  if (typeof define == 'function' && typeof define.amd == 'object' && define.amd) {\n    // Expose Lo-Dash to the global object even when an AMD loader is present in\n    // case Lo-Dash is loaded with a RequireJS shim config.\n    // See http://requirejs.org/docs/api.html#config-shim\n    root._ = _;\n\n    // define as an anonymous module so, through path mapping, it can be\n    // referenced as the \"underscore\" module\n    define(function() {\n      return _;\n    });\n  }\n  // check for `exports` after `define` in case a build optimizer adds an `exports` object\n  else if (freeExports && freeModule) {\n    // in Node.js or RingoJS\n    if (moduleExports) {\n      (freeModule.exports = _)._ = _;\n    }\n    // in Narwhal or Rhino -require\n    else {\n      freeExports._ = _;\n    }\n  }\n  else {\n    // in a browser or Rhino\n    root._ = _;\n  }\n}.call(this));\n","\n;(function(){\n\n  /**\n   * Perform initial dispatch.\n   */\n\n  var dispatch = true;\n\n  /**\n   * Base path.\n   */\n\n  var base = '';\n\n  /**\n   * Running flag.\n   */\n\n  var running;\n\n  /**\n   * Register `path` with callback `fn()`,\n   * or route `path`, or `page.start()`.\n   *\n   *   page(fn);\n   *   page('*', fn);\n   *   page('/user/:id', load, user);\n   *   page('/user/' + user.id, { some: 'thing' });\n   *   page('/user/' + user.id);\n   *   page();\n   *\n   * @param {String|Function} path\n   * @param {Function} fn...\n   * @api public\n   */\n\n  function page(path, fn) {\n    // <callback>\n    if ('function' == typeof path) {\n      return page('*', path);\n    }\n\n    // route <path> to <callback ...>\n    if ('function' == typeof fn) {\n      var route = new Route(path);\n      for (var i = 1; i < arguments.length; ++i) {\n        page.callbacks.push(route.middleware(arguments[i]));\n      }\n    // show <path> with [state]\n    } else if ('string' == typeof path) {\n      page.show(path, fn);\n    // start [options]\n    } else {\n      page.start(path);\n    }\n  }\n\n  /**\n   * Callback functions.\n   */\n\n  page.callbacks = [];\n\n  /**\n   * Get or set basepath to `path`.\n   *\n   * @param {String} path\n   * @api public\n   */\n\n  page.base = function(path){\n    if (0 == arguments.length) return base;\n    base = path;\n  };\n\n  /**\n   * Bind with the given `options`.\n   *\n   * Options:\n   *\n   *    - `click` bind to click events [true]\n   *    - `popstate` bind to popstate [true]\n   *    - `dispatch` perform initial dispatch [true]\n   *\n   * @param {Object} options\n   * @api public\n   */\n\n  page.start = function(options){\n    options = options || {};\n    if (running) return;\n    running = true;\n    if (false === options.dispatch) dispatch = false;\n    if (false !== options.popstate) window.addEventListener('popstate', onpopstate, false);\n    if (false !== options.click) window.addEventListener('click', onclick, false);\n    if (!dispatch) return;\n    var url = location.pathname + location.search + location.hash;\n    page.replace(url, null, true, dispatch);\n  };\n\n  /**\n   * Unbind click and popstate event handlers.\n   *\n   * @api public\n   */\n\n  page.stop = function(){\n    running = false;\n    removeEventListener('click', onclick, false);\n    removeEventListener('popstate', onpopstate, false);\n  };\n\n  /**\n   * Show `path` with optional `state` object.\n   *\n   * @param {String} path\n   * @param {Object} state\n   * @param {Boolean} dispatch\n   * @return {Context}\n   * @api public\n   */\n\n  page.show = function(path, state, dispatch){\n    var ctx = new Context(path, state);\n    if (false !== dispatch) page.dispatch(ctx);\n    if (!ctx.unhandled) ctx.pushState();\n    return ctx;\n  };\n\n  /**\n   * Replace `path` with optional `state` object.\n   *\n   * @param {String} path\n   * @param {Object} state\n   * @return {Context}\n   * @api public\n   */\n\n  page.replace = function(path, state, init, dispatch){\n    var ctx = new Context(path, state);\n    ctx.init = init;\n    if (null == dispatch) dispatch = true;\n    if (dispatch) page.dispatch(ctx);\n    ctx.save();\n    return ctx;\n  };\n\n  /**\n   * Dispatch the given `ctx`.\n   *\n   * @param {Object} ctx\n   * @api private\n   */\n\n  page.dispatch = function(ctx){\n    var i = 0;\n\n    function next() {\n      var fn = page.callbacks[i++];\n      if (!fn) return unhandled(ctx);\n      fn(ctx, next);\n    }\n\n    next();\n  };\n\n  /**\n   * Unhandled `ctx`. When it's not the initial\n   * popstate then redirect. If you wish to handle\n   * 404s on your own use `page('*', callback)`.\n   *\n   * @param {Context} ctx\n   * @api private\n   */\n\n  function unhandled(ctx) {\n    var current = window.location.pathname + window.location.search;\n    if (current == ctx.canonicalPath) return;\n    page.stop();\n    ctx.unhandled = true;\n    window.location = ctx.canonicalPath;\n  }\n\n  /**\n   * Initialize a new \"request\" `Context`\n   * with the given `path` and optional initial `state`.\n   *\n   * @param {String} path\n   * @param {Object} state\n   * @api public\n   */\n\n  function Context(path, state) {\n    if ('/' == path[0] && 0 != path.indexOf(base)) path = base + path;\n    var i = path.indexOf('?');\n\n    this.canonicalPath = path;\n    this.path = path.replace(base, '') || '/';\n\n    this.title = document.title;\n    this.state = state || {};\n    this.state.path = path;\n    this.querystring = ~i ? path.slice(i + 1) : '';\n    this.pathname = ~i ? path.slice(0, i) : path;\n    this.params = [];\n\n    // fragment\n    this.hash = '';\n    if (!~this.path.indexOf('#')) return;\n    var parts = this.path.split('#');\n    this.path = parts[0];\n    this.hash = parts[1] || '';\n    this.querystring = this.querystring.split('#')[0];\n  }\n\n  /**\n   * Expose `Context`.\n   */\n\n  page.Context = Context;\n\n  /**\n   * Push state.\n   *\n   * @api private\n   */\n\n  Context.prototype.pushState = function(){\n    history.pushState(this.state, this.title, this.canonicalPath);\n  };\n\n  /**\n   * Save the context state.\n   *\n   * @api public\n   */\n\n  Context.prototype.save = function(){\n    history.replaceState(this.state, this.title, this.canonicalPath);\n  };\n\n  /**\n   * Initialize `Route` with the given HTTP `path`,\n   * and an array of `callbacks` and `options`.\n   *\n   * Options:\n   *\n   *   - `sensitive`    enable case-sensitive routes\n   *   - `strict`       enable strict matching for trailing slashes\n   *\n   * @param {String} path\n   * @param {Object} options.\n   * @api private\n   */\n\n  function Route(path, options) {\n    options = options || {};\n    this.path = path;\n    this.method = 'GET';\n    this.regexp = pathtoRegexp(path\n      , this.keys = []\n      , options.sensitive\n      , options.strict);\n  }\n\n  /**\n   * Expose `Route`.\n   */\n\n  page.Route = Route;\n\n  /**\n   * Return route middleware with\n   * the given callback `fn()`.\n   *\n   * @param {Function} fn\n   * @return {Function}\n   * @api public\n   */\n\n  Route.prototype.middleware = function(fn){\n    var self = this;\n    return function(ctx, next){\n      if (self.match(ctx.path, ctx.params)) return fn(ctx, next);\n      next();\n    };\n  };\n\n  /**\n   * Check if this route matches `path`, if so\n   * populate `params`.\n   *\n   * @param {String} path\n   * @param {Array} params\n   * @return {Boolean}\n   * @api private\n   */\n\n  Route.prototype.match = function(path, params){\n    var keys = this.keys\n      , qsIndex = path.indexOf('?')\n      , pathname = ~qsIndex ? path.slice(0, qsIndex) : path\n      , m = this.regexp.exec(pathname);\n\n    if (!m) return false;\n\n    for (var i = 1, len = m.length; i < len; ++i) {\n      var key = keys[i - 1];\n\n      var val = 'string' == typeof m[i]\n        ? decodeURIComponent(m[i])\n        : m[i];\n\n      if (key) {\n        params[key.name] = undefined !== params[key.name]\n          ? params[key.name]\n          : val;\n      } else {\n        params.push(val);\n      }\n    }\n\n    return true;\n  };\n\n  /**\n   * Normalize the given path string,\n   * returning a regular expression.\n   *\n   * An empty array should be passed,\n   * which will contain the placeholder\n   * key names. For example \"/user/:id\" will\n   * then contain [\"id\"].\n   *\n   * @param  {String|RegExp|Array} path\n   * @param  {Array} keys\n   * @param  {Boolean} sensitive\n   * @param  {Boolean} strict\n   * @return {RegExp}\n   * @api private\n   */\n\n  function pathtoRegexp(path, keys, sensitive, strict) {\n    if (path instanceof RegExp) return path;\n    if (path instanceof Array) path = '(' + path.join('|') + ')';\n    path = path\n      .concat(strict ? '' : '/?')\n      .replace(/\\/\\(/g, '(?:/')\n      .replace(/(\\/)?(\\.)?:(\\w+)(?:(\\(.*?\\)))?(\\?)?/g, function(_, slash, format, key, capture, optional){\n        keys.push({ name: key, optional: !! optional });\n        slash = slash || '';\n        return ''\n          + (optional ? '' : slash)\n          + '(?:'\n          + (optional ? slash : '')\n          + (format || '') + (capture || (format && '([^/.]+?)' || '([^/]+?)')) + ')'\n          + (optional || '');\n      })\n      .replace(/([\\/.])/g, '\\\\$1')\n      .replace(/\\*/g, '(.*)');\n    return new RegExp('^' + path + '$', sensitive ? '' : 'i');\n  }\n\n  /**\n   * Handle \"populate\" events.\n   */\n\n  function onpopstate(e) {\n    if (e.state) {\n      var path = e.state.path;\n      page.replace(path, e.state);\n    }\n  }\n\n  /**\n   * Handle \"click\" events.\n   */\n\n  function onclick(e) {\n    if (1 != which(e)) return;\n    if (e.metaKey || e.ctrlKey || e.shiftKey) return;\n    if (e.defaultPrevented) return;\n\n    // ensure link\n    var el = e.target;\n    while (el && 'A' != el.nodeName) el = el.parentNode;\n    if (!el || 'A' != el.nodeName) return;\n\n    // ensure non-hash for the same path\n    var link = el.getAttribute('href');\n    if (el.pathname == location.pathname && (el.hash || '#' == link)) return;\n\n    // check target\n    if (el.target) return;\n\n    // x-origin\n    if (!sameOrigin(el.href)) return;\n\n    // rebuild path\n    var path = el.pathname + el.search + (el.hash || '');\n\n    // same page\n    var orig = path + el.hash;\n\n    path = path.replace(base, '');\n    if (base && orig == path) return;\n\n    e.preventDefault();\n    page.show(orig);\n  }\n\n  /**\n   * Event button.\n   */\n\n  function which(e) {\n    e = e || window.event;\n    return null == e.which\n      ? e.button\n      : e.which;\n  }\n\n  /**\n   * Check if `href` is the same origin.\n   */\n\n  function sameOrigin(href) {\n    var origin = location.protocol + '//' + location.hostname;\n    if (location.port) origin += ':' + location.port;\n    return 0 == href.indexOf(origin);\n  }\n\n  /**\n   * Expose `page`.\n   */\n\n  if ('undefined' == typeof module) {\n    window.page = page;\n  } else {\n    module.exports = page;\n  }\n\n})();\n","/*!\n\tquery-string\n\tParse and stringify URL query strings\n\thttps://github.com/sindresorhus/query-string\n\tby Sindre Sorhus\n\tMIT License\n*/\n(function () {\n\t'use strict';\n\tvar queryString = {};\n\n\tqueryString.parse = function (str) {\n\t\tif (typeof str !== 'string') {\n\t\t\treturn {};\n\t\t}\n\n\t\tstr = str.trim().replace(/^(\\?|#)/, '');\n\n\t\tif (!str) {\n\t\t\treturn {};\n\t\t}\n\n\t\treturn str.trim().split('&').reduce(function (ret, param) {\n\t\t\tvar parts = param.replace(/\\+/g, ' ').split('=');\n\t\t\tvar key = parts[0];\n\t\t\tvar val = parts[1];\n\n\t\t\tkey = decodeURIComponent(key);\n\t\t\t// missing `=` should be `null`:\n\t\t\t// http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n\t\t\tval = val === undefined ? null : decodeURIComponent(val);\n\n\t\t\tif (!ret.hasOwnProperty(key)) {\n\t\t\t\tret[key] = val;\n\t\t\t} else if (Array.isArray(ret[key])) {\n\t\t\t\tret[key].push(val);\n\t\t\t} else {\n\t\t\t\tret[key] = [ret[key], val];\n\t\t\t}\n\n\t\t\treturn ret;\n\t\t}, {});\n\t};\n\n\tqueryString.stringify = function (obj) {\n\t\treturn obj ? Object.keys(obj).map(function (key) {\n\t\t\tvar val = obj[key];\n\n\t\t\tif (Array.isArray(val)) {\n\t\t\t\treturn val.map(function (val2) {\n\t\t\t\t\treturn encodeURIComponent(key) + '=' + encodeURIComponent(val2);\n\t\t\t\t}).join('&');\n\t\t\t}\n\n\t\t\treturn encodeURIComponent(key) + '=' + encodeURIComponent(val);\n\t\t}).join('&') : '';\n\t};\n\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(function() { return queryString; });\n\t} else if (typeof module !== 'undefined' && module.exports) {\n\t\tmodule.exports = queryString;\n\t} else {\n\t\twindow.queryString = queryString;\n\t}\n})();\n","/*\n\tractive.js v0.6.1\n\t2014-10-25 - commit 3a576eb3 \n\n\thttp://ractivejs.org\n\thttp://twitter.com/RactiveJS\n\n\tReleased under the MIT License.\n*/\n\n( function( global ) {\n\n\t'use strict';\n\n\tvar noConflict = global.Ractive;\n\n\t/* config/defaults/options.js */\n\tvar options = function() {\n\n\t\tvar defaultOptions = {\n\t\t\t// render placement:\n\t\t\tel: void 0,\n\t\t\tappend: false,\n\t\t\t// template:\n\t\t\ttemplate: {\n\t\t\t\tv: 1,\n\t\t\t\tt: []\n\t\t\t},\n\t\t\tyield: null,\n\t\t\t// parse:\n\t\t\tpreserveWhitespace: false,\n\t\t\tsanitize: false,\n\t\t\tstripComments: true,\n\t\t\t// data & binding:\n\t\t\tdata: {},\n\t\t\tcomputed: {},\n\t\t\tmagic: false,\n\t\t\tmodifyArrays: true,\n\t\t\tadapt: [],\n\t\t\tisolated: false,\n\t\t\ttwoway: true,\n\t\t\tlazy: false,\n\t\t\t// transitions:\n\t\t\tnoIntro: false,\n\t\t\ttransitionsEnabled: true,\n\t\t\tcomplete: void 0,\n\t\t\t// css:\n\t\t\tnoCssTransform: false,\n\t\t\t// debug:\n\t\t\tdebug: false\n\t\t};\n\t\treturn defaultOptions;\n\t}();\n\n\t/* config/defaults/easing.js */\n\tvar easing = {\n\t\tlinear: function( pos ) {\n\t\t\treturn pos;\n\t\t},\n\t\teaseIn: function( pos ) {\n\t\t\treturn Math.pow( pos, 3 );\n\t\t},\n\t\teaseOut: function( pos ) {\n\t\t\treturn Math.pow( pos - 1, 3 ) + 1;\n\t\t},\n\t\teaseInOut: function( pos ) {\n\t\t\tif ( ( pos /= 0.5 ) < 1 ) {\n\t\t\t\treturn 0.5 * Math.pow( pos, 3 );\n\t\t\t}\n\t\t\treturn 0.5 * ( Math.pow( pos - 2, 3 ) + 2 );\n\t\t}\n\t};\n\n\t/* circular.js */\n\tvar circular = [];\n\n\t/* utils/hasOwnProperty.js */\n\tvar hasOwn = Object.prototype.hasOwnProperty;\n\n\t/* utils/isArray.js */\n\tvar isArray = function() {\n\n\t\tvar toString = Object.prototype.toString;\n\t\t// thanks, http://perfectionkills.com/instanceof-considered-harmful-or-how-to-write-a-robust-isarray/\n\t\treturn function( thing ) {\n\t\t\treturn toString.call( thing ) === '[object Array]';\n\t\t};\n\t}();\n\n\t/* utils/isObject.js */\n\tvar isObject = function() {\n\n\t\tvar toString = Object.prototype.toString;\n\t\treturn function( thing ) {\n\t\t\treturn thing && toString.call( thing ) === '[object Object]';\n\t\t};\n\t}();\n\n\t/* utils/isNumeric.js */\n\tvar isNumeric = function( thing ) {\n\t\treturn !isNaN( parseFloat( thing ) ) && isFinite( thing );\n\t};\n\n\t/* config/defaults/interpolators.js */\n\tvar interpolators = function( circular, hasOwnProperty, isArray, isObject, isNumeric ) {\n\n\t\tvar interpolators, interpolate, cssLengthPattern;\n\t\tcircular.push( function() {\n\t\t\tinterpolate = circular.interpolate;\n\t\t} );\n\t\tcssLengthPattern = /^([+-]?[0-9]+\\.?(?:[0-9]+)?)(px|em|ex|%|in|cm|mm|pt|pc)$/;\n\t\tinterpolators = {\n\t\t\tnumber: function( from, to ) {\n\t\t\t\tvar delta;\n\t\t\t\tif ( !isNumeric( from ) || !isNumeric( to ) ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tfrom = +from;\n\t\t\t\tto = +to;\n\t\t\t\tdelta = to - from;\n\t\t\t\tif ( !delta ) {\n\t\t\t\t\treturn function() {\n\t\t\t\t\t\treturn from;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn function( t ) {\n\t\t\t\t\treturn from + t * delta;\n\t\t\t\t};\n\t\t\t},\n\t\t\tarray: function( from, to ) {\n\t\t\t\tvar intermediate, interpolators, len, i;\n\t\t\t\tif ( !isArray( from ) || !isArray( to ) ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tintermediate = [];\n\t\t\t\tinterpolators = [];\n\t\t\t\ti = len = Math.min( from.length, to.length );\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tinterpolators[ i ] = interpolate( from[ i ], to[ i ] );\n\t\t\t\t}\n\t\t\t\t// surplus values - don't interpolate, but don't exclude them either\n\t\t\t\tfor ( i = len; i < from.length; i += 1 ) {\n\t\t\t\t\tintermediate[ i ] = from[ i ];\n\t\t\t\t}\n\t\t\t\tfor ( i = len; i < to.length; i += 1 ) {\n\t\t\t\t\tintermediate[ i ] = to[ i ];\n\t\t\t\t}\n\t\t\t\treturn function( t ) {\n\t\t\t\t\tvar i = len;\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tintermediate[ i ] = interpolators[ i ]( t );\n\t\t\t\t\t}\n\t\t\t\t\treturn intermediate;\n\t\t\t\t};\n\t\t\t},\n\t\t\tobject: function( from, to ) {\n\t\t\t\tvar properties, len, interpolators, intermediate, prop;\n\t\t\t\tif ( !isObject( from ) || !isObject( to ) ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tproperties = [];\n\t\t\t\tintermediate = {};\n\t\t\t\tinterpolators = {};\n\t\t\t\tfor ( prop in from ) {\n\t\t\t\t\tif ( hasOwnProperty.call( from, prop ) ) {\n\t\t\t\t\t\tif ( hasOwnProperty.call( to, prop ) ) {\n\t\t\t\t\t\t\tproperties.push( prop );\n\t\t\t\t\t\t\tinterpolators[ prop ] = interpolate( from[ prop ], to[ prop ] );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tintermediate[ prop ] = from[ prop ];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor ( prop in to ) {\n\t\t\t\t\tif ( hasOwnProperty.call( to, prop ) && !hasOwnProperty.call( from, prop ) ) {\n\t\t\t\t\t\tintermediate[ prop ] = to[ prop ];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlen = properties.length;\n\t\t\t\treturn function( t ) {\n\t\t\t\t\tvar i = len,\n\t\t\t\t\t\tprop;\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tprop = properties[ i ];\n\t\t\t\t\t\tintermediate[ prop ] = interpolators[ prop ]( t );\n\t\t\t\t\t}\n\t\t\t\t\treturn intermediate;\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t\treturn interpolators;\n\t}( circular, hasOwn, isArray, isObject, isNumeric );\n\n\t/* config/svg.js */\n\tvar svg = function() {\n\n\t\tvar svg;\n\t\tif ( typeof document === 'undefined' ) {\n\t\t\tsvg = false;\n\t\t} else {\n\t\t\tsvg = document && document.implementation.hasFeature( 'http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1' );\n\t\t}\n\t\treturn svg;\n\t}();\n\n\t/* utils/warn.js */\n\tvar warn = function() {\n\n\t\t/* global console */\n\t\tvar warn, warned = {};\n\t\tif ( typeof console !== 'undefined' && typeof console.warn === 'function' && typeof console.warn.apply === 'function' ) {\n\t\t\twarn = function( message, allowDuplicates ) {\n\t\t\t\tif ( !allowDuplicates ) {\n\t\t\t\t\tif ( warned[ message ] ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\twarned[ message ] = true;\n\t\t\t\t}\n\t\t\t\tconsole.warn( '%cRactive.js: %c' + message, 'color: rgb(114, 157, 52);', 'color: rgb(85, 85, 85);' );\n\t\t\t};\n\t\t} else {\n\t\t\twarn = function() {};\n\t\t}\n\t\treturn warn;\n\t}();\n\n\t/* config/errors.js */\n\tvar errors = {\n\t\tmissingParser: 'Missing Ractive.parse - cannot parse template. Either preparse or use the version that includes the parser',\n\t\tmergeComparisonFail: 'Merge operation: comparison failed. Falling back to identity checking',\n\t\tnoComponentEventArguments: 'Components currently only support simple events - you cannot include arguments. Sorry!',\n\t\tnoTemplateForPartial: 'Could not find template for partial \"{name}\"',\n\t\tnoNestedPartials: 'Partials ({{>{name}}}) cannot contain nested inline partials',\n\t\tevaluationError: 'Error evaluating \"{uniqueString}\": {err}',\n\t\tbadArguments: 'Bad arguments \"{arguments}\". I\\'m not allowed to argue unless you\\'ve paid.',\n\t\tfailedComputation: 'Failed to compute \"{key}\": {err}',\n\t\tmissingPlugin: 'Missing \"{name}\" {plugin} plugin. You may need to download a {plugin} via http://docs.ractivejs.org/latest/plugins#{plugin}s',\n\t\tbadRadioInputBinding: 'A radio input can have two-way binding on its name attribute, or its checked attribute - not both',\n\t\tnoRegistryFunctionReturn: 'A function was specified for \"{name}\" {registry}, but no {registry} was returned',\n\t\tdefaultElSpecified: 'The <{name}/> component has a default `el` property; it has been disregarded',\n\t\tnoElementProxyEventWildcards: 'Only component proxy-events may contain \"*\" wildcards, <{element} on-{event}/> is not valid.',\n\t\tmethodDeprecated: 'The method \"{deprecated}\" has been deprecated in favor of \"{replacement}\" and will likely be removed in a future release. See http://docs.ractivejs.org/latest/migrating for more information.'\n\t};\n\n\t/* utils/log.js */\n\tvar log = function( consolewarn, errors ) {\n\n\t\tvar log = {\n\t\t\twarn: function( options, passthru ) {\n\t\t\t\tif ( !options.debug && !passthru ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.warnAlways( options );\n\t\t\t},\n\t\t\twarnAlways: function( options ) {\n\t\t\t\tthis.logger( getMessage( options ), options.allowDuplicates );\n\t\t\t},\n\t\t\terror: function( options ) {\n\t\t\t\tthis.errorOnly( options );\n\t\t\t\tif ( !options.debug ) {\n\t\t\t\t\tthis.warn( options, true );\n\t\t\t\t}\n\t\t\t},\n\t\t\terrorOnly: function( options ) {\n\t\t\t\tif ( options.debug ) {\n\t\t\t\t\tthis.critical( options );\n\t\t\t\t}\n\t\t\t},\n\t\t\tcritical: function( options ) {\n\t\t\t\tvar err = options.err || new Error( getMessage( options ) );\n\t\t\t\tthis.thrower( err );\n\t\t\t},\n\t\t\tlogger: consolewarn,\n\t\t\tthrower: function( err ) {\n\t\t\t\tthrow err;\n\t\t\t}\n\t\t};\n\n\t\tfunction getMessage( options ) {\n\t\t\tvar message = errors[ options.message ] || options.message || '';\n\t\t\treturn interpolate( message, options.args );\n\t\t}\n\t\t// simple interpolation. probably quicker (and better) out there,\n\t\t// but log is not in golden path of execution, only exceptions\n\t\tfunction interpolate( message, args ) {\n\t\t\treturn message.replace( /{([^{}]*)}/g, function( a, b ) {\n\t\t\t\treturn args[ b ];\n\t\t\t} );\n\t\t}\n\t\treturn log;\n\t}( warn, errors );\n\n\t/* Ractive/prototype/shared/hooks/Hook.js */\n\tvar Ractive$shared_hooks_Hook = function( log ) {\n\n\t\tvar deprecations = {\n\t\t\tconstruct: {\n\t\t\t\tdeprecated: 'beforeInit',\n\t\t\t\treplacement: 'onconstruct'\n\t\t\t},\n\t\t\trender: {\n\t\t\t\tdeprecated: 'init',\n\t\t\t\tmessage: 'The \"init\" method has been deprecated ' + 'and will likely be removed in a future release. ' + 'You can either use the \"oninit\" method which will fire ' + 'only once prior to, and regardless of, any eventual ractive ' + 'instance being rendered, or if you need to access the ' + 'rendered DOM, use \"onrender\" instead. ' + 'See http://docs.ractivejs.org/latest/migrating for more information.'\n\t\t\t},\n\t\t\tcomplete: {\n\t\t\t\tdeprecated: 'complete',\n\t\t\t\treplacement: 'oncomplete'\n\t\t\t}\n\t\t};\n\n\t\tfunction Hook( event ) {\n\t\t\tthis.event = event;\n\t\t\tthis.method = 'on' + event;\n\t\t\tthis.deprecate = deprecations[ event ];\n\t\t}\n\t\tHook.prototype.fire = function( ractive, arg ) {\n\t\t\tfunction call( method ) {\n\t\t\t\tif ( ractive[ method ] ) {\n\t\t\t\t\targ ? ractive[ method ]( arg ) : ractive[ method ]();\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tcall( this.method );\n\t\t\tif ( !ractive[ this.method ] && this.deprecate && call( this.deprecate.deprecated ) ) {\n\t\t\t\tlog.warnAlways( {\n\t\t\t\t\tdebug: ractive.debug,\n\t\t\t\t\tmessage: this.deprecate.message || 'methodDeprecated',\n\t\t\t\t\targs: this.deprecate\n\t\t\t\t} );\n\t\t\t}\n\t\t\targ ? ractive.fire( this.event, arg ) : ractive.fire( this.event );\n\t\t};\n\t\treturn Hook;\n\t}( log );\n\n\t/* utils/removeFromArray.js */\n\tvar removeFromArray = function( array, member ) {\n\t\tvar index = array.indexOf( member );\n\t\tif ( index !== -1 ) {\n\t\t\tarray.splice( index, 1 );\n\t\t}\n\t};\n\n\t/* utils/Promise.js */\n\tvar Promise = function() {\n\n\t\tvar __export;\n\t\tvar _Promise, PENDING = {},\n\t\t\tFULFILLED = {},\n\t\t\tREJECTED = {};\n\t\tif ( typeof Promise === 'function' ) {\n\t\t\t// use native Promise\n\t\t\t_Promise = Promise;\n\t\t} else {\n\t\t\t_Promise = function( callback ) {\n\t\t\t\tvar fulfilledHandlers = [],\n\t\t\t\t\trejectedHandlers = [],\n\t\t\t\t\tstate = PENDING,\n\t\t\t\t\tresult, dispatchHandlers, makeResolver, fulfil, reject, promise;\n\t\t\t\tmakeResolver = function( newState ) {\n\t\t\t\t\treturn function( value ) {\n\t\t\t\t\t\tif ( state !== PENDING ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresult = value;\n\t\t\t\t\t\tstate = newState;\n\t\t\t\t\t\tdispatchHandlers = makeDispatcher( state === FULFILLED ? fulfilledHandlers : rejectedHandlers, result );\n\t\t\t\t\t\t// dispatch onFulfilled and onRejected handlers asynchronously\n\t\t\t\t\t\twait( dispatchHandlers );\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t\tfulfil = makeResolver( FULFILLED );\n\t\t\t\treject = makeResolver( REJECTED );\n\t\t\t\ttry {\n\t\t\t\t\tcallback( fulfil, reject );\n\t\t\t\t} catch ( err ) {\n\t\t\t\t\treject( err );\n\t\t\t\t}\n\t\t\t\tpromise = {\n\t\t\t\t\t// `then()` returns a Promise - 2.2.7\n\t\t\t\t\tthen: function( onFulfilled, onRejected ) {\n\t\t\t\t\t\tvar promise2 = new _Promise( function( fulfil, reject ) {\n\t\t\t\t\t\t\tvar processResolutionHandler = function( handler, handlers, forward ) {\n\t\t\t\t\t\t\t\t// 2.2.1.1\n\t\t\t\t\t\t\t\tif ( typeof handler === 'function' ) {\n\t\t\t\t\t\t\t\t\thandlers.push( function( p1result ) {\n\t\t\t\t\t\t\t\t\t\tvar x;\n\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\tx = handler( p1result );\n\t\t\t\t\t\t\t\t\t\t\tresolve( promise2, x, fulfil, reject );\n\t\t\t\t\t\t\t\t\t\t} catch ( err ) {\n\t\t\t\t\t\t\t\t\t\t\treject( err );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// Forward the result of promise1 to promise2, if resolution handlers\n\t\t\t\t\t\t\t\t\t// are not given\n\t\t\t\t\t\t\t\t\thandlers.push( forward );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t// 2.2\n\t\t\t\t\t\t\tprocessResolutionHandler( onFulfilled, fulfilledHandlers, fulfil );\n\t\t\t\t\t\t\tprocessResolutionHandler( onRejected, rejectedHandlers, reject );\n\t\t\t\t\t\t\tif ( state !== PENDING ) {\n\t\t\t\t\t\t\t\t// If the promise has resolved already, dispatch the appropriate handlers asynchronously\n\t\t\t\t\t\t\t\twait( dispatchHandlers );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t\treturn promise2;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tpromise[ 'catch' ] = function( onRejected ) {\n\t\t\t\t\treturn this.then( null, onRejected );\n\t\t\t\t};\n\t\t\t\treturn promise;\n\t\t\t};\n\t\t\t_Promise.all = function( promises ) {\n\t\t\t\treturn new _Promise( function( fulfil, reject ) {\n\t\t\t\t\tvar result = [],\n\t\t\t\t\t\tpending, i, processPromise;\n\t\t\t\t\tif ( !promises.length ) {\n\t\t\t\t\t\tfulfil( result );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tprocessPromise = function( i ) {\n\t\t\t\t\t\tpromises[ i ].then( function( value ) {\n\t\t\t\t\t\t\tresult[ i ] = value;\n\t\t\t\t\t\t\tif ( !--pending ) {\n\t\t\t\t\t\t\t\tfulfil( result );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, reject );\n\t\t\t\t\t};\n\t\t\t\t\tpending = i = promises.length;\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tprocessPromise( i );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t};\n\t\t\t_Promise.resolve = function( value ) {\n\t\t\t\treturn new _Promise( function( fulfil ) {\n\t\t\t\t\tfulfil( value );\n\t\t\t\t} );\n\t\t\t};\n\t\t\t_Promise.reject = function( reason ) {\n\t\t\t\treturn new _Promise( function( fulfil, reject ) {\n\t\t\t\t\treject( reason );\n\t\t\t\t} );\n\t\t\t};\n\t\t}\n\t\t__export = _Promise;\n\t\t// TODO use MutationObservers or something to simulate setImmediate\n\t\tfunction wait( callback ) {\n\t\t\tsetTimeout( callback, 0 );\n\t\t}\n\n\t\tfunction makeDispatcher( handlers, result ) {\n\t\t\treturn function() {\n\t\t\t\tvar handler;\n\t\t\t\twhile ( handler = handlers.shift() ) {\n\t\t\t\t\thandler( result );\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tfunction resolve( promise, x, fulfil, reject ) {\n\t\t\t// Promise Resolution Procedure\n\t\t\tvar then;\n\t\t\t// 2.3.1\n\t\t\tif ( x === promise ) {\n\t\t\t\tthrow new TypeError( 'A promise\\'s fulfillment handler cannot return the same promise' );\n\t\t\t}\n\t\t\t// 2.3.2\n\t\t\tif ( x instanceof _Promise ) {\n\t\t\t\tx.then( fulfil, reject );\n\t\t\t} else if ( x && ( typeof x === 'object' || typeof x === 'function' ) ) {\n\t\t\t\ttry {\n\t\t\t\t\tthen = x.then;\n\t\t\t\t} catch ( e ) {\n\t\t\t\t\treject( e );\n\t\t\t\t\t// 2.3.3.2\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// 2.3.3.3\n\t\t\t\tif ( typeof then === 'function' ) {\n\t\t\t\t\tvar called, resolvePromise, rejectPromise;\n\t\t\t\t\tresolvePromise = function( y ) {\n\t\t\t\t\t\tif ( called ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcalled = true;\n\t\t\t\t\t\tresolve( promise, y, fulfil, reject );\n\t\t\t\t\t};\n\t\t\t\t\trejectPromise = function( r ) {\n\t\t\t\t\t\tif ( called ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcalled = true;\n\t\t\t\t\t\treject( r );\n\t\t\t\t\t};\n\t\t\t\t\ttry {\n\t\t\t\t\t\tthen.call( x, resolvePromise, rejectPromise );\n\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\tif ( !called ) {\n\t\t\t\t\t\t\t// 2.3.3.3.4.1\n\t\t\t\t\t\t\treject( e );\n\t\t\t\t\t\t\t// 2.3.3.3.4.2\n\t\t\t\t\t\t\tcalled = true;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfulfil( x );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfulfil( x );\n\t\t\t}\n\t\t}\n\t\treturn __export;\n\t}();\n\n\t/* utils/normaliseRef.js */\n\tvar normaliseRef = function() {\n\n\t\tvar regex = /\\[\\s*(\\*|[0-9]|[1-9][0-9]+)\\s*\\]/g;\n\t\treturn function normaliseRef( ref ) {\n\t\t\treturn ( ref || '' ).replace( regex, '.$1' );\n\t\t};\n\t}();\n\n\t/* shared/getInnerContext.js */\n\tvar getInnerContext = function( fragment ) {\n\t\tdo {\n\t\t\tif ( fragment.context !== undefined ) {\n\t\t\t\treturn fragment.context;\n\t\t\t}\n\t\t} while ( fragment = fragment.parent );\n\t\treturn '';\n\t};\n\n\t/* utils/isEqual.js */\n\tvar isEqual = function( a, b ) {\n\t\tif ( a === null && b === null ) {\n\t\t\treturn true;\n\t\t}\n\t\tif ( typeof a === 'object' || typeof b === 'object' ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn a === b;\n\t};\n\n\t/* shared/createComponentBinding.js */\n\tvar createComponentBinding = function( circular, isEqual ) {\n\n\t\tvar runloop;\n\t\tcircular.push( function() {\n\t\t\treturn runloop = circular.runloop;\n\t\t} );\n\t\tvar Binding = function( ractive, keypath, otherInstance, otherKeypath ) {\n\t\t\tvar this$0 = this;\n\t\t\tthis.root = ractive;\n\t\t\tthis.keypath = keypath;\n\t\t\tthis.otherInstance = otherInstance;\n\t\t\tthis.otherKeypath = otherKeypath;\n\t\t\tthis.lock = function() {\n\t\t\t\treturn this$0.updating = true;\n\t\t\t};\n\t\t\tthis.unlock = function() {\n\t\t\t\treturn this$0.updating = false;\n\t\t\t};\n\t\t\tthis.bind();\n\t\t\tthis.value = this.root.viewmodel.get( this.keypath );\n\t\t};\n\t\tBinding.prototype = {\n\t\t\tisLocked: function() {\n\t\t\t\treturn this.updating || this.counterpart && this.counterpart.updating;\n\t\t\t},\n\t\t\tshuffle: function( newIndices, value ) {\n\t\t\t\tthis.propagateChange( value, newIndices );\n\t\t\t},\n\t\t\tsetValue: function( value ) {\n\t\t\t\tthis.propagateChange( value );\n\t\t\t},\n\t\t\tpropagateChange: function( value, newIndices ) {\n\t\t\t\tvar other;\n\t\t\t\t// Only *you* can prevent infinite loops\n\t\t\t\tif ( this.isLocked() ) {\n\t\t\t\t\tthis.value = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif ( !isEqual( value, this.value ) ) {\n\t\t\t\t\tthis.lock();\n\t\t\t\t\t// TODO maybe the case that `value === this.value` - should that result\n\t\t\t\t\t// in an update rather than a set?\n\t\t\t\t\t// if the other viewmodel is already locked up, need to do a deferred update\n\t\t\t\t\tif ( !runloop.addViewmodel( other = this.otherInstance.viewmodel ) && this.counterpart.value !== value ) {\n\t\t\t\t\t\trunloop.scheduleTask( function() {\n\t\t\t\t\t\t\treturn runloop.addViewmodel( other );\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t\tif ( newIndices ) {\n\t\t\t\t\t\tother.smartUpdate( this.otherKeypath, value, newIndices );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( isSettable( other, this.otherKeypath ) ) {\n\t\t\t\t\t\t\tother.set( this.otherKeypath, value );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.value = value;\n\t\t\t\t\t// TODO will the counterpart update after this line, during\n\t\t\t\t\t// the runloop end cycle? may be a problem...\n\t\t\t\t\trunloop.scheduleTask( this.unlock );\n\t\t\t\t}\n\t\t\t},\n\t\t\trefineValue: function( keypaths ) {\n\t\t\t\tvar this$0 = this;\n\t\t\t\tvar other;\n\t\t\t\tif ( this.isLocked() ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.lock();\n\t\t\t\trunloop.addViewmodel( other = this.otherInstance.viewmodel );\n\t\t\t\tkeypaths.map( function( keypath ) {\n\t\t\t\t\treturn this$0.otherKeypath + keypath.substr( this$0.keypath.length );\n\t\t\t\t} ).forEach( function( keypath ) {\n\t\t\t\t\treturn other.mark( keypath );\n\t\t\t\t} );\n\t\t\t\trunloop.scheduleTask( this.unlock );\n\t\t\t},\n\t\t\tbind: function() {\n\t\t\t\tthis.root.viewmodel.register( this.keypath, this );\n\t\t\t},\n\t\t\trebind: function( newKeypath ) {\n\t\t\t\tthis.unbind();\n\t\t\t\tthis.keypath = newKeypath;\n\t\t\t\tthis.counterpart.otherKeypath = newKeypath;\n\t\t\t\tthis.bind();\n\t\t\t},\n\t\t\tunbind: function() {\n\t\t\t\tthis.root.viewmodel.unregister( this.keypath, this );\n\t\t\t}\n\t\t};\n\n\t\tfunction isSettable( viewmodel, keypath ) {\n\t\t\tvar computed = viewmodel.computations[ keypath ];\n\t\t\treturn !computed || computed.setter;\n\t\t}\n\t\treturn function createComponentBinding( component, parentInstance, parentKeypath, childKeypath ) {\n\t\t\tvar hash, childInstance, bindings, parentToChildBinding, childToParentBinding;\n\t\t\thash = parentKeypath + '=' + childKeypath;\n\t\t\tbindings = component.bindings;\n\t\t\tif ( bindings[ hash ] ) {\n\t\t\t\t// TODO does this ever happen?\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tchildInstance = component.instance;\n\t\t\tparentToChildBinding = new Binding( parentInstance, parentKeypath, childInstance, childKeypath );\n\t\t\tbindings.push( parentToChildBinding );\n\t\t\tif ( childInstance.twoway ) {\n\t\t\t\tchildToParentBinding = new Binding( childInstance, childKeypath, parentInstance, parentKeypath );\n\t\t\t\tbindings.push( childToParentBinding );\n\t\t\t\tparentToChildBinding.counterpart = childToParentBinding;\n\t\t\t\tchildToParentBinding.counterpart = parentToChildBinding;\n\t\t\t}\n\t\t\tbindings[ hash ] = parentToChildBinding;\n\t\t};\n\t}( circular, isEqual );\n\n\t/* shared/resolveRef.js */\n\tvar resolveRef = function( normaliseRef, getInnerContext, createComponentBinding ) {\n\n\t\tvar __export;\n\t\tvar ancestorErrorMessage, getOptions;\n\t\tancestorErrorMessage = 'Could not resolve reference - too many \"../\" prefixes';\n\t\tgetOptions = {\n\t\t\tevaluateWrapped: true\n\t\t};\n\t\t__export = function resolveRef( ractive, ref, fragment, isParentLookup ) {\n\t\t\tvar context, key, index, keypath, parentValue, hasContextChain, parentKeys, childKeys, parentKeypath, childKeypath;\n\t\t\tref = normaliseRef( ref );\n\t\t\t// If a reference begins '~/', it's a top-level reference\n\t\t\tif ( ref.substr( 0, 2 ) === '~/' ) {\n\t\t\t\treturn ref.substring( 2 );\n\t\t\t}\n\t\t\t// If a reference begins with '.', it's either a restricted reference or\n\t\t\t// an ancestor reference...\n\t\t\tif ( ref.charAt( 0 ) === '.' ) {\n\t\t\t\treturn resolveAncestorReference( getInnerContext( fragment ), ref );\n\t\t\t}\n\t\t\t// ...otherwise we need to find the keypath\n\t\t\tkey = ref.split( '.' )[ 0 ];\n\t\t\t// get() in viewmodel creation means no fragment (yet)\n\t\t\tfragment = fragment || {};\n\t\t\tdo {\n\t\t\t\tcontext = fragment.context;\n\t\t\t\tif ( !context ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\thasContextChain = true;\n\t\t\t\tparentValue = ractive.viewmodel.get( context, getOptions );\n\t\t\t\tif ( parentValue && ( typeof parentValue === 'object' || typeof parentValue === 'function' ) && key in parentValue ) {\n\t\t\t\t\treturn context + '.' + ref;\n\t\t\t\t}\n\t\t\t} while ( fragment = fragment.parent );\n\t\t\t// Root/computed property?\n\t\t\tif ( key in ractive.data || key in ractive.viewmodel.computations ) {\n\t\t\t\treturn ref;\n\t\t\t}\n\t\t\t// If this is an inline component, and it's not isolated, we\n\t\t\t// can try going up the scope chain\n\t\t\tif ( ractive._parent && !ractive.isolated ) {\n\t\t\t\thasContextChain = true;\n\t\t\t\tfragment = ractive.component.parentFragment;\n\t\t\t\t// Special case - index refs\n\t\t\t\tif ( fragment.indexRefs && ( index = fragment.indexRefs[ ref ] ) !== undefined ) {\n\t\t\t\t\t// Create an index ref binding, so that it can be rebound letter if necessary.\n\t\t\t\t\t// It doesn't have an alias since it's an implicit binding, hence `...[ ref ] = ref`\n\t\t\t\t\tractive.component.indexRefBindings[ ref ] = ref;\n\t\t\t\t\tractive.viewmodel.set( ref, index, true );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tkeypath = resolveRef( ractive._parent, ref, fragment, true );\n\t\t\t\tif ( keypath ) {\n\t\t\t\t\t// We need to create an inter-component binding\n\t\t\t\t\t// If parent keypath is 'one.foo' and child is 'two.foo', we bind\n\t\t\t\t\t// 'one' to 'two' as it's more efficient and avoids edge cases\n\t\t\t\t\tparentKeys = keypath.split( '.' );\n\t\t\t\t\tchildKeys = ref.split( '.' );\n\t\t\t\t\twhile ( parentKeys.length > 1 && childKeys.length > 1 && parentKeys[ parentKeys.length - 1 ] === childKeys[ childKeys.length - 1 ] ) {\n\t\t\t\t\t\tparentKeys.pop();\n\t\t\t\t\t\tchildKeys.pop();\n\t\t\t\t\t}\n\t\t\t\t\tparentKeypath = parentKeys.join( '.' );\n\t\t\t\t\tchildKeypath = childKeys.join( '.' );\n\t\t\t\t\tractive.viewmodel.set( childKeypath, ractive._parent.viewmodel.get( parentKeypath ), true );\n\t\t\t\t\tcreateComponentBinding( ractive.component, ractive._parent, parentKeypath, childKeypath );\n\t\t\t\t\treturn ref;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// If there's no context chain, and the instance is either a) isolated or\n\t\t\t// b) an orphan, then we know that the keypath is identical to the reference\n\t\t\tif ( !isParentLookup && !hasContextChain ) {\n\t\t\t\t// the data object needs to have a property by this name,\n\t\t\t\t// to prevent future failed lookups\n\t\t\t\tractive.viewmodel.set( ref, undefined );\n\t\t\t\treturn ref;\n\t\t\t}\n\t\t\tif ( ractive.viewmodel.get( ref ) !== undefined ) {\n\t\t\t\treturn ref;\n\t\t\t}\n\t\t};\n\n\t\tfunction resolveAncestorReference( baseContext, ref ) {\n\t\t\tvar contextKeys;\n\t\t\t// {{.}} means 'current context'\n\t\t\tif ( ref === '.' )\n\t\t\t\treturn baseContext;\n\t\t\tcontextKeys = baseContext ? baseContext.split( '.' ) : [];\n\t\t\t// ancestor references (starting \"../\") go up the tree\n\t\t\tif ( ref.substr( 0, 3 ) === '../' ) {\n\t\t\t\twhile ( ref.substr( 0, 3 ) === '../' ) {\n\t\t\t\t\tif ( !contextKeys.length ) {\n\t\t\t\t\t\tthrow new Error( ancestorErrorMessage );\n\t\t\t\t\t}\n\t\t\t\t\tcontextKeys.pop();\n\t\t\t\t\tref = ref.substring( 3 );\n\t\t\t\t}\n\t\t\t\tcontextKeys.push( ref );\n\t\t\t\treturn contextKeys.join( '.' );\n\t\t\t}\n\t\t\t// not an ancestor reference - must be a restricted reference (prepended with \".\" or \"./\")\n\t\t\tif ( !baseContext ) {\n\t\t\t\treturn ref.replace( /^\\.\\/?/, '' );\n\t\t\t}\n\t\t\treturn baseContext + ref.replace( /^\\.\\//, '.' );\n\t\t}\n\t\treturn __export;\n\t}( normaliseRef, getInnerContext, createComponentBinding );\n\n\t/* global/TransitionManager.js */\n\tvar TransitionManager = function( removeFromArray ) {\n\n\t\tvar TransitionManager = function( callback, parent ) {\n\t\t\tthis.callback = callback;\n\t\t\tthis.parent = parent;\n\t\t\tthis.intros = [];\n\t\t\tthis.outros = [];\n\t\t\tthis.children = [];\n\t\t\tthis.totalChildren = this.outroChildren = 0;\n\t\t\tthis.detachQueue = [];\n\t\t\tthis.outrosComplete = false;\n\t\t\tif ( parent ) {\n\t\t\t\tparent.addChild( this );\n\t\t\t}\n\t\t};\n\t\tTransitionManager.prototype = {\n\t\t\taddChild: function( child ) {\n\t\t\t\tthis.children.push( child );\n\t\t\t\tthis.totalChildren += 1;\n\t\t\t\tthis.outroChildren += 1;\n\t\t\t},\n\t\t\tdecrementOutros: function() {\n\t\t\t\tthis.outroChildren -= 1;\n\t\t\t\tcheck( this );\n\t\t\t},\n\t\t\tdecrementTotal: function() {\n\t\t\t\tthis.totalChildren -= 1;\n\t\t\t\tcheck( this );\n\t\t\t},\n\t\t\tadd: function( transition ) {\n\t\t\t\tvar list = transition.isIntro ? this.intros : this.outros;\n\t\t\t\tlist.push( transition );\n\t\t\t},\n\t\t\tremove: function( transition ) {\n\t\t\t\tvar list = transition.isIntro ? this.intros : this.outros;\n\t\t\t\tremoveFromArray( list, transition );\n\t\t\t\tcheck( this );\n\t\t\t},\n\t\t\tinit: function() {\n\t\t\t\tthis.ready = true;\n\t\t\t\tcheck( this );\n\t\t\t},\n\t\t\tdetachNodes: function() {\n\t\t\t\tthis.detachQueue.forEach( detach );\n\t\t\t\tthis.children.forEach( detachNodes );\n\t\t\t}\n\t\t};\n\n\t\tfunction detach( element ) {\n\t\t\telement.detach();\n\t\t}\n\n\t\tfunction detachNodes( tm ) {\n\t\t\ttm.detachNodes();\n\t\t}\n\n\t\tfunction check( tm ) {\n\t\t\tif ( !tm.ready || tm.outros.length || tm.outroChildren )\n\t\t\t\treturn;\n\t\t\t// If all outros are complete, and we haven't already done this,\n\t\t\t// we notify the parent if there is one, otherwise\n\t\t\t// start detaching nodes\n\t\t\tif ( !tm.outrosComplete ) {\n\t\t\t\tif ( tm.parent ) {\n\t\t\t\t\ttm.parent.decrementOutros( tm );\n\t\t\t\t} else {\n\t\t\t\t\ttm.detachNodes();\n\t\t\t\t}\n\t\t\t\ttm.outrosComplete = true;\n\t\t\t}\n\t\t\t// Once everything is done, we can notify parent transition\n\t\t\t// manager and call the callback\n\t\t\tif ( !tm.intros.length && !tm.totalChildren ) {\n\t\t\t\tif ( typeof tm.callback === 'function' ) {\n\t\t\t\t\ttm.callback();\n\t\t\t\t}\n\t\t\t\tif ( tm.parent ) {\n\t\t\t\t\ttm.parent.decrementTotal();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn TransitionManager;\n\t}( removeFromArray );\n\n\t/* global/runloop.js */\n\tvar runloop = function( circular, Hook, removeFromArray, Promise, resolveRef, TransitionManager ) {\n\n\t\tvar __export;\n\t\tvar batch, runloop, unresolved = [],\n\t\t\tchangeHook = new Hook( 'change' );\n\t\trunloop = {\n\t\t\tstart: function( instance, returnPromise ) {\n\t\t\t\tvar promise, fulfilPromise;\n\t\t\t\tif ( returnPromise ) {\n\t\t\t\t\tpromise = new Promise( function( f ) {\n\t\t\t\t\t\treturn fulfilPromise = f;\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tbatch = {\n\t\t\t\t\tpreviousBatch: batch,\n\t\t\t\t\ttransitionManager: new TransitionManager( fulfilPromise, batch && batch.transitionManager ),\n\t\t\t\t\tviews: [],\n\t\t\t\t\ttasks: [],\n\t\t\t\t\tviewmodels: [],\n\t\t\t\t\tinstance: instance\n\t\t\t\t};\n\t\t\t\tif ( instance ) {\n\t\t\t\t\tbatch.viewmodels.push( instance.viewmodel );\n\t\t\t\t}\n\t\t\t\treturn promise;\n\t\t\t},\n\t\t\tend: function() {\n\t\t\t\tflushChanges();\n\t\t\t\tbatch.transitionManager.init();\n\t\t\t\tif ( !batch.previousBatch && !!batch.instance )\n\t\t\t\t\tbatch.instance.viewmodel.changes = [];\n\t\t\t\tbatch = batch.previousBatch;\n\t\t\t},\n\t\t\taddViewmodel: function( viewmodel ) {\n\t\t\t\tif ( batch ) {\n\t\t\t\t\tif ( batch.viewmodels.indexOf( viewmodel ) === -1 ) {\n\t\t\t\t\t\tbatch.viewmodels.push( viewmodel );\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tviewmodel.applyChanges();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\t\t\tregisterTransition: function( transition ) {\n\t\t\t\ttransition._manager = batch.transitionManager;\n\t\t\t\tbatch.transitionManager.add( transition );\n\t\t\t},\n\t\t\taddView: function( view ) {\n\t\t\t\tbatch.views.push( view );\n\t\t\t},\n\t\t\taddUnresolved: function( thing ) {\n\t\t\t\tunresolved.push( thing );\n\t\t\t},\n\t\t\tremoveUnresolved: function( thing ) {\n\t\t\t\tremoveFromArray( unresolved, thing );\n\t\t\t},\n\t\t\t// synchronise node detachments with transition ends\n\t\t\tdetachWhenReady: function( thing ) {\n\t\t\t\tbatch.transitionManager.detachQueue.push( thing );\n\t\t\t},\n\t\t\tscheduleTask: function( task, postRender ) {\n\t\t\t\tvar _batch;\n\t\t\t\tif ( !batch ) {\n\t\t\t\t\ttask();\n\t\t\t\t} else {\n\t\t\t\t\t_batch = batch;\n\t\t\t\t\twhile ( postRender && _batch.previousBatch ) {\n\t\t\t\t\t\t// this can't happen until the DOM has been fully updated\n\t\t\t\t\t\t// otherwise in some situations (with components inside elements)\n\t\t\t\t\t\t// transitions and decorators will initialise prematurely\n\t\t\t\t\t\t_batch = _batch.previousBatch;\n\t\t\t\t\t}\n\t\t\t\t\t_batch.tasks.push( task );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tcircular.runloop = runloop;\n\t\t__export = runloop;\n\n\t\tfunction flushChanges() {\n\t\t\tvar i, thing, changeHash;\n\t\t\tfor ( i = 0; i < batch.viewmodels.length; i += 1 ) {\n\t\t\t\tthing = batch.viewmodels[ i ];\n\t\t\t\tchangeHash = thing.applyChanges();\n\t\t\t\tif ( changeHash ) {\n\t\t\t\t\tchangeHook.fire( thing.ractive, changeHash );\n\t\t\t\t}\n\t\t\t}\n\t\t\tbatch.viewmodels.length = 0;\n\t\t\tattemptKeypathResolution();\n\t\t\t// Now that changes have been fully propagated, we can update the DOM\n\t\t\t// and complete other tasks\n\t\t\tfor ( i = 0; i < batch.views.length; i += 1 ) {\n\t\t\t\tbatch.views[ i ].update();\n\t\t\t}\n\t\t\tbatch.views.length = 0;\n\t\t\tfor ( i = 0; i < batch.tasks.length; i += 1 ) {\n\t\t\t\tbatch.tasks[ i ]();\n\t\t\t}\n\t\t\tbatch.tasks.length = 0;\n\t\t\t// If updating the view caused some model blowback - e.g. a triple\n\t\t\t// containing <option> elements caused the binding on the <select>\n\t\t\t// to update - then we start over\n\t\t\tif ( batch.viewmodels.length )\n\t\t\t\treturn flushChanges();\n\t\t}\n\n\t\tfunction attemptKeypathResolution() {\n\t\t\tvar i, item, keypath, resolved;\n\t\t\ti = unresolved.length;\n\t\t\t// see if we can resolve any unresolved references\n\t\t\twhile ( i-- ) {\n\t\t\t\titem = unresolved[ i ];\n\t\t\t\tif ( item.keypath ) {\n\t\t\t\t\t// it resolved some other way. TODO how? two-way binding? Seems\n\t\t\t\t\t// weird that we'd still end up here\n\t\t\t\t\tunresolved.splice( i, 1 );\n\t\t\t\t}\n\t\t\t\tif ( keypath = resolveRef( item.root, item.ref, item.parentFragment ) ) {\n\t\t\t\t\t( resolved || ( resolved = [] ) ).push( {\n\t\t\t\t\t\titem: item,\n\t\t\t\t\t\tkeypath: keypath\n\t\t\t\t\t} );\n\t\t\t\t\tunresolved.splice( i, 1 );\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( resolved ) {\n\t\t\t\tresolved.forEach( resolve );\n\t\t\t}\n\t\t}\n\n\t\tfunction resolve( resolved ) {\n\t\t\tresolved.item.resolve( resolved.keypath );\n\t\t}\n\t\treturn __export;\n\t}( circular, Ractive$shared_hooks_Hook, removeFromArray, Promise, resolveRef, TransitionManager );\n\n\t/* utils/createBranch.js */\n\tvar createBranch = function() {\n\n\t\tvar numeric = /^\\s*[0-9]+\\s*$/;\n\t\treturn function( key ) {\n\t\t\treturn numeric.test( key ) ? [] : {};\n\t\t};\n\t}();\n\n\t/* viewmodel/prototype/get/magicAdaptor.js */\n\tvar viewmodel$get_magicAdaptor = function( runloop, createBranch, isArray ) {\n\n\t\tvar __export;\n\t\tvar magicAdaptor, MagicWrapper;\n\t\ttry {\n\t\t\tObject.defineProperty( {}, 'test', {\n\t\t\t\tvalue: 0\n\t\t\t} );\n\t\t\tmagicAdaptor = {\n\t\t\t\tfilter: function( object, keypath, ractive ) {\n\t\t\t\t\tvar keys, key, parentKeypath, parentWrapper, parentValue;\n\t\t\t\t\tif ( !keypath ) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tkeys = keypath.split( '.' );\n\t\t\t\t\tkey = keys.pop();\n\t\t\t\t\tparentKeypath = keys.join( '.' );\n\t\t\t\t\t// If the parent value is a wrapper, other than a magic wrapper,\n\t\t\t\t\t// we shouldn't wrap this property\n\t\t\t\t\tif ( ( parentWrapper = ractive.viewmodel.wrapped[ parentKeypath ] ) && !parentWrapper.magic ) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tparentValue = ractive.get( parentKeypath );\n\t\t\t\t\t// if parentValue is an array that doesn't include this member,\n\t\t\t\t\t// we should return false otherwise lengths will get messed up\n\t\t\t\t\tif ( isArray( parentValue ) && /^[0-9]+$/.test( key ) ) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\treturn parentValue && ( typeof parentValue === 'object' || typeof parentValue === 'function' );\n\t\t\t\t},\n\t\t\t\twrap: function( ractive, property, keypath ) {\n\t\t\t\t\treturn new MagicWrapper( ractive, property, keypath );\n\t\t\t\t}\n\t\t\t};\n\t\t\tMagicWrapper = function( ractive, value, keypath ) {\n\t\t\t\tvar keys, objKeypath, template, siblings;\n\t\t\t\tthis.magic = true;\n\t\t\t\tthis.ractive = ractive;\n\t\t\t\tthis.keypath = keypath;\n\t\t\t\tthis.value = value;\n\t\t\t\tkeys = keypath.split( '.' );\n\t\t\t\tthis.prop = keys.pop();\n\t\t\t\tobjKeypath = keys.join( '.' );\n\t\t\t\tthis.obj = objKeypath ? ractive.get( objKeypath ) : ractive.data;\n\t\t\t\ttemplate = this.originalDescriptor = Object.getOwnPropertyDescriptor( this.obj, this.prop );\n\t\t\t\t// Has this property already been wrapped?\n\t\t\t\tif ( template && template.set && ( siblings = template.set._ractiveWrappers ) ) {\n\t\t\t\t\t// Yes. Register this wrapper to this property, if it hasn't been already\n\t\t\t\t\tif ( siblings.indexOf( this ) === -1 ) {\n\t\t\t\t\t\tsiblings.push( this );\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// No, it hasn't been wrapped\n\t\t\t\tcreateAccessors( this, value, template );\n\t\t\t};\n\t\t\tMagicWrapper.prototype = {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn this.value;\n\t\t\t\t},\n\t\t\t\treset: function( value ) {\n\t\t\t\t\tif ( this.updating ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.updating = true;\n\t\t\t\t\tthis.obj[ this.prop ] = value;\n\t\t\t\t\t// trigger set() accessor\n\t\t\t\t\trunloop.addViewmodel( this.ractive.viewmodel );\n\t\t\t\t\tthis.ractive.viewmodel.mark( this.keypath );\n\t\t\t\t\tthis.updating = false;\n\t\t\t\t},\n\t\t\t\tset: function( key, value ) {\n\t\t\t\t\tif ( this.updating ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif ( !this.obj[ this.prop ] ) {\n\t\t\t\t\t\tthis.updating = true;\n\t\t\t\t\t\tthis.obj[ this.prop ] = createBranch( key );\n\t\t\t\t\t\tthis.updating = false;\n\t\t\t\t\t}\n\t\t\t\t\tthis.obj[ this.prop ][ key ] = value;\n\t\t\t\t},\n\t\t\t\tteardown: function() {\n\t\t\t\t\tvar template, set, value, wrappers, index;\n\t\t\t\t\t// If this method was called because the cache was being cleared as a\n\t\t\t\t\t// result of a set()/update() call made by this wrapper, we return false\n\t\t\t\t\t// so that it doesn't get torn down\n\t\t\t\t\tif ( this.updating ) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\ttemplate = Object.getOwnPropertyDescriptor( this.obj, this.prop );\n\t\t\t\t\tset = template && template.set;\n\t\t\t\t\tif ( !set ) {\n\t\t\t\t\t\t// most likely, this was an array member that was spliced out\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\twrappers = set._ractiveWrappers;\n\t\t\t\t\tindex = wrappers.indexOf( this );\n\t\t\t\t\tif ( index !== -1 ) {\n\t\t\t\t\t\twrappers.splice( index, 1 );\n\t\t\t\t\t}\n\t\t\t\t\t// Last one out, turn off the lights\n\t\t\t\t\tif ( !wrappers.length ) {\n\t\t\t\t\t\tvalue = this.obj[ this.prop ];\n\t\t\t\t\t\tObject.defineProperty( this.obj, this.prop, this.originalDescriptor || {\n\t\t\t\t\t\t\twritable: true,\n\t\t\t\t\t\t\tenumerable: true,\n\t\t\t\t\t\t\tconfigurable: true\n\t\t\t\t\t\t} );\n\t\t\t\t\t\tthis.obj[ this.prop ] = value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t} catch ( err ) {\n\t\t\tmagicAdaptor = false;\n\t\t}\n\t\t__export = magicAdaptor;\n\n\t\tfunction createAccessors( originalWrapper, value, template ) {\n\t\t\tvar object, property, oldGet, oldSet, get, set;\n\t\t\tobject = originalWrapper.obj;\n\t\t\tproperty = originalWrapper.prop;\n\t\t\t// Is this template configurable?\n\t\t\tif ( template && !template.configurable ) {\n\t\t\t\t// Special case - array length\n\t\t\t\tif ( property === 'length' ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthrow new Error( 'Cannot use magic mode with property \"' + property + '\" - object is not configurable' );\n\t\t\t}\n\t\t\t// Time to wrap this property\n\t\t\tif ( template ) {\n\t\t\t\toldGet = template.get;\n\t\t\t\toldSet = template.set;\n\t\t\t}\n\t\t\tget = oldGet || function() {\n\t\t\t\treturn value;\n\t\t\t};\n\t\t\tset = function( v ) {\n\t\t\t\tif ( oldSet ) {\n\t\t\t\t\toldSet( v );\n\t\t\t\t}\n\t\t\t\tvalue = oldGet ? oldGet() : v;\n\t\t\t\tset._ractiveWrappers.forEach( updateWrapper );\n\t\t\t};\n\n\t\t\tfunction updateWrapper( wrapper ) {\n\t\t\t\tvar keypath, ractive;\n\t\t\t\twrapper.value = value;\n\t\t\t\tif ( wrapper.updating ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tractive = wrapper.ractive;\n\t\t\t\tkeypath = wrapper.keypath;\n\t\t\t\twrapper.updating = true;\n\t\t\t\trunloop.start( ractive );\n\t\t\t\tractive.viewmodel.mark( keypath );\n\t\t\t\trunloop.end();\n\t\t\t\twrapper.updating = false;\n\t\t\t}\n\t\t\t// Create an array of wrappers, in case other keypaths/ractives depend on this property.\n\t\t\t// Handily, we can store them as a property of the set function. Yay JavaScript.\n\t\t\tset._ractiveWrappers = [ originalWrapper ];\n\t\t\tObject.defineProperty( object, property, {\n\t\t\t\tget: get,\n\t\t\t\tset: set,\n\t\t\t\tenumerable: true,\n\t\t\t\tconfigurable: true\n\t\t\t} );\n\t\t}\n\t\treturn __export;\n\t}( runloop, createBranch, isArray );\n\n\t/* config/magic.js */\n\tvar magic = function( magicAdaptor ) {\n\n\t\treturn !!magicAdaptor;\n\t}( viewmodel$get_magicAdaptor );\n\n\t/* config/namespaces.js */\n\tvar namespaces = {\n\t\thtml: 'http://www.w3.org/1999/xhtml',\n\t\tmathml: 'http://www.w3.org/1998/Math/MathML',\n\t\tsvg: 'http://www.w3.org/2000/svg',\n\t\txlink: 'http://www.w3.org/1999/xlink',\n\t\txml: 'http://www.w3.org/XML/1998/namespace',\n\t\txmlns: 'http://www.w3.org/2000/xmlns/'\n\t};\n\n\t/* utils/createElement.js */\n\tvar createElement = function( svg, namespaces ) {\n\n\t\tvar createElement;\n\t\t// Test for SVG support\n\t\tif ( !svg ) {\n\t\t\tcreateElement = function( type, ns ) {\n\t\t\t\tif ( ns && ns !== namespaces.html ) {\n\t\t\t\t\tthrow 'This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you\\'re trying to render SVG in an older browser. See http://docs.ractivejs.org/latest/svg-and-older-browsers for more information';\n\t\t\t\t}\n\t\t\t\treturn document.createElement( type );\n\t\t\t};\n\t\t} else {\n\t\t\tcreateElement = function( type, ns ) {\n\t\t\t\tif ( !ns || ns === namespaces.html ) {\n\t\t\t\t\treturn document.createElement( type );\n\t\t\t\t}\n\t\t\t\treturn document.createElementNS( ns, type );\n\t\t\t};\n\t\t}\n\t\treturn createElement;\n\t}( svg, namespaces );\n\n\t/* config/isClient.js */\n\tvar isClient = function() {\n\n\t\tvar isClient = typeof document === 'object';\n\t\treturn isClient;\n\t}();\n\n\t/* utils/defineProperty.js */\n\tvar defineProperty = function( isClient ) {\n\n\t\tvar defineProperty;\n\t\ttry {\n\t\t\tObject.defineProperty( {}, 'test', {\n\t\t\t\tvalue: 0\n\t\t\t} );\n\t\t\tif ( isClient ) {\n\t\t\t\tObject.defineProperty( document.createElement( 'div' ), 'test', {\n\t\t\t\t\tvalue: 0\n\t\t\t\t} );\n\t\t\t}\n\t\t\tdefineProperty = Object.defineProperty;\n\t\t} catch ( err ) {\n\t\t\t// Object.defineProperty doesn't exist, or we're in IE8 where you can\n\t\t\t// only use it with DOM objects (what the fuck were you smoking, MSFT?)\n\t\t\tdefineProperty = function( obj, prop, desc ) {\n\t\t\t\tobj[ prop ] = desc.value;\n\t\t\t};\n\t\t}\n\t\treturn defineProperty;\n\t}( isClient );\n\n\t/* utils/defineProperties.js */\n\tvar defineProperties = function( createElement, defineProperty, isClient ) {\n\n\t\tvar defineProperties;\n\t\ttry {\n\t\t\ttry {\n\t\t\t\tObject.defineProperties( {}, {\n\t\t\t\t\ttest: {\n\t\t\t\t\t\tvalue: 0\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} catch ( err ) {\n\t\t\t\t// TODO how do we account for this? noMagic = true;\n\t\t\t\tthrow err;\n\t\t\t}\n\t\t\tif ( isClient ) {\n\t\t\t\tObject.defineProperties( createElement( 'div' ), {\n\t\t\t\t\ttest: {\n\t\t\t\t\t\tvalue: 0\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t\tdefineProperties = Object.defineProperties;\n\t\t} catch ( err ) {\n\t\t\tdefineProperties = function( obj, props ) {\n\t\t\t\tvar prop;\n\t\t\t\tfor ( prop in props ) {\n\t\t\t\t\tif ( props.hasOwnProperty( prop ) ) {\n\t\t\t\t\t\tdefineProperty( obj, prop, props[ prop ] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\treturn defineProperties;\n\t}( createElement, defineProperty, isClient );\n\n\t/* Ractive/prototype/shared/add.js */\n\tvar Ractive$shared_add = function( isNumeric ) {\n\n\t\treturn function add( root, keypath, d ) {\n\t\t\tvar value;\n\t\t\tif ( typeof keypath !== 'string' || !isNumeric( d ) ) {\n\t\t\t\tthrow new Error( 'Bad arguments' );\n\t\t\t}\n\t\t\tvalue = +root.get( keypath ) || 0;\n\t\t\tif ( !isNumeric( value ) ) {\n\t\t\t\tthrow new Error( 'Cannot add to a non-numeric value' );\n\t\t\t}\n\t\t\treturn root.set( keypath, value + d );\n\t\t};\n\t}( isNumeric );\n\n\t/* Ractive/prototype/add.js */\n\tvar Ractive$add = function( add ) {\n\n\t\treturn function Ractive$add( keypath, d ) {\n\t\t\treturn add( this, keypath, d === undefined ? 1 : +d );\n\t\t};\n\t}( Ractive$shared_add );\n\n\t/* utils/normaliseKeypath.js */\n\tvar normaliseKeypath = function( normaliseRef ) {\n\n\t\tvar leadingDot = /^\\.+/;\n\t\treturn function normaliseKeypath( keypath ) {\n\t\t\treturn normaliseRef( keypath ).replace( leadingDot, '' );\n\t\t};\n\t}( normaliseRef );\n\n\t/* config/vendors.js */\n\tvar vendors = [\n\t\t'o',\n\t\t'ms',\n\t\t'moz',\n\t\t'webkit'\n\t];\n\n\t/* utils/requestAnimationFrame.js */\n\tvar requestAnimationFrame = function( vendors ) {\n\n\t\tvar requestAnimationFrame;\n\t\t// If window doesn't exist, we don't need requestAnimationFrame\n\t\tif ( typeof window === 'undefined' ) {\n\t\t\trequestAnimationFrame = null;\n\t\t} else {\n\t\t\t// https://gist.github.com/paulirish/1579671\n\t\t\t( function( vendors, lastTime, window ) {\n\t\t\t\tvar x, setTimeout;\n\t\t\t\tif ( window.requestAnimationFrame ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tfor ( x = 0; x < vendors.length && !window.requestAnimationFrame; ++x ) {\n\t\t\t\t\twindow.requestAnimationFrame = window[ vendors[ x ] + 'RequestAnimationFrame' ];\n\t\t\t\t}\n\t\t\t\tif ( !window.requestAnimationFrame ) {\n\t\t\t\t\tsetTimeout = window.setTimeout;\n\t\t\t\t\twindow.requestAnimationFrame = function( callback ) {\n\t\t\t\t\t\tvar currTime, timeToCall, id;\n\t\t\t\t\t\tcurrTime = Date.now();\n\t\t\t\t\t\ttimeToCall = Math.max( 0, 16 - ( currTime - lastTime ) );\n\t\t\t\t\t\tid = setTimeout( function() {\n\t\t\t\t\t\t\tcallback( currTime + timeToCall );\n\t\t\t\t\t\t}, timeToCall );\n\t\t\t\t\t\tlastTime = currTime + timeToCall;\n\t\t\t\t\t\treturn id;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}( vendors, 0, window ) );\n\t\t\trequestAnimationFrame = window.requestAnimationFrame;\n\t\t}\n\t\treturn requestAnimationFrame;\n\t}( vendors );\n\n\t/* utils/getTime.js */\n\tvar getTime = function() {\n\n\t\tvar getTime;\n\t\tif ( typeof window !== 'undefined' && window.performance && typeof window.performance.now === 'function' ) {\n\t\t\tgetTime = function() {\n\t\t\t\treturn window.performance.now();\n\t\t\t};\n\t\t} else {\n\t\t\tgetTime = function() {\n\t\t\t\treturn Date.now();\n\t\t\t};\n\t\t}\n\t\treturn getTime;\n\t}();\n\n\t/* shared/animations.js */\n\tvar animations = function( rAF, getTime, runloop ) {\n\n\t\tvar queue = [];\n\t\tvar animations = {\n\t\t\ttick: function() {\n\t\t\t\tvar i, animation, now;\n\t\t\t\tnow = getTime();\n\t\t\t\trunloop.start();\n\t\t\t\tfor ( i = 0; i < queue.length; i += 1 ) {\n\t\t\t\t\tanimation = queue[ i ];\n\t\t\t\t\tif ( !animation.tick( now ) ) {\n\t\t\t\t\t\t// animation is complete, remove it from the stack, and decrement i so we don't miss one\n\t\t\t\t\t\tqueue.splice( i--, 1 );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trunloop.end();\n\t\t\t\tif ( queue.length ) {\n\t\t\t\t\trAF( animations.tick );\n\t\t\t\t} else {\n\t\t\t\t\tanimations.running = false;\n\t\t\t\t}\n\t\t\t},\n\t\t\tadd: function( animation ) {\n\t\t\t\tqueue.push( animation );\n\t\t\t\tif ( !animations.running ) {\n\t\t\t\t\tanimations.running = true;\n\t\t\t\t\trAF( animations.tick );\n\t\t\t\t}\n\t\t\t},\n\t\t\t// TODO optimise this\n\t\t\tabort: function( keypath, root ) {\n\t\t\t\tvar i = queue.length,\n\t\t\t\t\tanimation;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tanimation = queue[ i ];\n\t\t\t\t\tif ( animation.root === root && animation.keypath === keypath ) {\n\t\t\t\t\t\tanimation.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn animations;\n\t}( requestAnimationFrame, getTime, runloop );\n\n\t/* config/options/css/transform.js */\n\tvar transform = function() {\n\n\t\tvar __export;\n\t\tvar selectorsPattern = /(?:^|\\})?\\s*([^\\{\\}]+)\\s*\\{/g,\n\t\t\tcommentsPattern = /\\/\\*.*?\\*\\//g,\n\t\t\tselectorUnitPattern = /((?:(?:\\[[^\\]+]\\])|(?:[^\\s\\+\\>\\~:]))+)((?::[^\\s\\+\\>\\~]+)?\\s*[\\s\\+\\>\\~]?)\\s*/g,\n\t\t\tmediaQueryPattern = /^@media/,\n\t\t\tdataRvcGuidPattern = /\\[data-rvcguid=\"[a-z0-9-]+\"]/g;\n\t\t__export = function transformCss( css, guid ) {\n\t\t\tvar transformed, addGuid;\n\t\t\taddGuid = function( selector ) {\n\t\t\t\tvar selectorUnits, match, unit, dataAttr, base, prepended, appended, i, transformed = [];\n\t\t\t\tselectorUnits = [];\n\t\t\t\twhile ( match = selectorUnitPattern.exec( selector ) ) {\n\t\t\t\t\tselectorUnits.push( {\n\t\t\t\t\t\tstr: match[ 0 ],\n\t\t\t\t\t\tbase: match[ 1 ],\n\t\t\t\t\t\tmodifiers: match[ 2 ]\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\t// For each simple selector within the selector, we need to create a version\n\t\t\t\t// that a) combines with the guid, and b) is inside the guid\n\t\t\t\tdataAttr = '[data-rvcguid=\"' + guid + '\"]';\n\t\t\t\tbase = selectorUnits.map( extractString );\n\t\t\t\ti = selectorUnits.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tappended = base.slice();\n\t\t\t\t\t// Pseudo-selectors should go after the attribute selector\n\t\t\t\t\tunit = selectorUnits[ i ];\n\t\t\t\t\tappended[ i ] = unit.base + dataAttr + unit.modifiers || '';\n\t\t\t\t\tprepended = base.slice();\n\t\t\t\t\tprepended[ i ] = dataAttr + ' ' + prepended[ i ];\n\t\t\t\t\ttransformed.push( appended.join( ' ' ), prepended.join( ' ' ) );\n\t\t\t\t}\n\t\t\t\treturn transformed.join( ', ' );\n\t\t\t};\n\t\t\tif ( dataRvcGuidPattern.test( css ) ) {\n\t\t\t\ttransformed = css.replace( dataRvcGuidPattern, '[data-rvcguid=\"' + guid + '\"]' );\n\t\t\t} else {\n\t\t\t\ttransformed = css.replace( commentsPattern, '' ).replace( selectorsPattern, function( match, $1 ) {\n\t\t\t\t\tvar selectors, transformed;\n\t\t\t\t\t// don't transform media queries!\n\t\t\t\t\tif ( mediaQueryPattern.test( $1 ) )\n\t\t\t\t\t\treturn match;\n\t\t\t\t\tselectors = $1.split( ',' ).map( trim );\n\t\t\t\t\ttransformed = selectors.map( addGuid ).join( ', ' ) + ' ';\n\t\t\t\t\treturn match.replace( $1, transformed );\n\t\t\t\t} );\n\t\t\t}\n\t\t\treturn transformed;\n\t\t};\n\n\t\tfunction trim( str ) {\n\t\t\tif ( str.trim ) {\n\t\t\t\treturn str.trim();\n\t\t\t}\n\t\t\treturn str.replace( /^\\s+/, '' ).replace( /\\s+$/, '' );\n\t\t}\n\n\t\tfunction extractString( unit ) {\n\t\t\treturn unit.str;\n\t\t}\n\t\treturn __export;\n\t}();\n\n\t/* config/options/css/css.js */\n\tvar css = function( transformCss ) {\n\n\t\tvar cssConfig = {\n\t\t\tname: 'css',\n\t\t\textend: extend,\n\t\t\tinit: function() {}\n\t\t};\n\n\t\tfunction extend( Parent, proto, options ) {\n\t\t\tvar guid = proto.constructor._guid,\n\t\t\t\tcss;\n\t\t\tif ( css = getCss( options.css, options, guid ) || getCss( Parent.css, Parent, guid ) ) {\n\t\t\t\tproto.constructor.css = css;\n\t\t\t}\n\t\t}\n\n\t\tfunction getCss( css, target, guid ) {\n\t\t\tif ( !css ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn target.noCssTransform ? css : transformCss( css, guid );\n\t\t}\n\t\treturn cssConfig;\n\t}( transform );\n\n\t/* utils/wrapMethod.js */\n\tvar wrapMethod = function() {\n\n\t\tvar __export;\n\t\t__export = function( method, superMethod, force ) {\n\t\t\tif ( force || needsSuper( method, superMethod ) ) {\n\t\t\t\treturn function() {\n\t\t\t\t\tvar hasSuper = '_super' in this,\n\t\t\t\t\t\t_super = this._super,\n\t\t\t\t\t\tresult;\n\t\t\t\t\tthis._super = superMethod;\n\t\t\t\t\tresult = method.apply( this, arguments );\n\t\t\t\t\tif ( hasSuper ) {\n\t\t\t\t\t\tthis._super = _super;\n\t\t\t\t\t}\n\t\t\t\t\treturn result;\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn method;\n\t\t\t}\n\t\t};\n\n\t\tfunction needsSuper( method, superMethod ) {\n\t\t\treturn typeof superMethod === 'function' && /_super/.test( method );\n\t\t}\n\t\treturn __export;\n\t}();\n\n\t/* config/options/data.js */\n\tvar data = function( wrap ) {\n\n\t\tvar __export;\n\t\tvar dataConfig = {\n\t\t\tname: 'data',\n\t\t\textend: extend,\n\t\t\tinit: init,\n\t\t\treset: reset\n\t\t};\n\t\t__export = dataConfig;\n\n\t\tfunction combine( Parent, target, options ) {\n\t\t\tvar value = options.data || {},\n\t\t\t\tparentValue = getAddedKeys( Parent.prototype.data );\n\t\t\tif ( typeof value !== 'object' && typeof value !== 'function' ) {\n\t\t\t\tthrow new TypeError( 'data option must be an object or a function, \"' + value + '\" is not valid' );\n\t\t\t}\n\t\t\treturn dispatch( parentValue, value );\n\t\t}\n\n\t\tfunction extend( Parent, proto, options ) {\n\t\t\tproto.data = combine( Parent, proto, options );\n\t\t}\n\n\t\tfunction init( Parent, ractive, options ) {\n\t\t\tvar value = options.data,\n\t\t\t\tresult = combine( Parent, ractive, options );\n\t\t\tif ( typeof result === 'function' ) {\n\t\t\t\tresult = result.call( ractive, value ) || value;\n\t\t\t}\n\t\t\treturn ractive.data = result || {};\n\t\t}\n\n\t\tfunction reset( ractive ) {\n\t\t\tvar result = this.init( ractive.constructor, ractive, ractive );\n\t\t\tif ( result ) {\n\t\t\t\tractive.data = result;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tfunction getAddedKeys( parent ) {\n\t\t\t// only for functions that had keys added\n\t\t\tif ( typeof parent !== 'function' || !Object.keys( parent ).length ) {\n\t\t\t\treturn parent;\n\t\t\t}\n\t\t\t// copy the added keys to temp 'object', otherwise\n\t\t\t// parent would be interpreted as 'function' by dispatch\n\t\t\tvar temp = {};\n\t\t\tcopy( parent, temp );\n\t\t\t// roll in added keys\n\t\t\treturn dispatch( parent, temp );\n\t\t}\n\n\t\tfunction dispatch( parent, child ) {\n\t\t\tif ( typeof child === 'function' ) {\n\t\t\t\treturn extendFn( child, parent );\n\t\t\t} else if ( typeof parent === 'function' ) {\n\t\t\t\treturn fromFn( child, parent );\n\t\t\t} else {\n\t\t\t\treturn fromProperties( child, parent );\n\t\t\t}\n\t\t}\n\n\t\tfunction copy( from, to, fillOnly ) {\n\t\t\tfor ( var key in from ) {\n\t\t\t\tif ( fillOnly && key in to ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tto[ key ] = from[ key ];\n\t\t\t}\n\t\t}\n\n\t\tfunction fromProperties( child, parent ) {\n\t\t\tchild = child || {};\n\t\t\tif ( !parent ) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t\tcopy( parent, child, true );\n\t\t\treturn child;\n\t\t}\n\n\t\tfunction fromFn( child, parentFn ) {\n\t\t\treturn function( data ) {\n\t\t\t\tvar keys;\n\t\t\t\tif ( child ) {\n\t\t\t\t\t// Track the keys that our on the child,\n\t\t\t\t\t// but not on the data. We'll need to apply these\n\t\t\t\t\t// after the parent function returns.\n\t\t\t\t\tkeys = [];\n\t\t\t\t\tfor ( var key in child ) {\n\t\t\t\t\t\tif ( !data || !( key in data ) ) {\n\t\t\t\t\t\t\tkeys.push( key );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// call the parent fn, use data if no return value\n\t\t\t\tdata = parentFn.call( this, data ) || data;\n\t\t\t\t// Copy child keys back onto data. The child keys\n\t\t\t\t// should take precedence over whatever the\n\t\t\t\t// parent did with the data.\n\t\t\t\tif ( keys && keys.length ) {\n\t\t\t\t\tdata = data || {};\n\t\t\t\t\tkeys.forEach( function( key ) {\n\t\t\t\t\t\tdata[ key ] = child[ key ];\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\treturn data;\n\t\t\t};\n\t\t}\n\n\t\tfunction extendFn( childFn, parent ) {\n\t\t\tvar parentFn;\n\t\t\tif ( typeof parent !== 'function' ) {\n\t\t\t\t// copy props to data\n\t\t\t\tparentFn = function( data ) {\n\t\t\t\t\tfromProperties( data, parent );\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tparentFn = function( data ) {\n\t\t\t\t\t// give parent function it's own this._super context,\n\t\t\t\t\t// otherwise this._super is from child and\n\t\t\t\t\t// causes infinite loop\n\t\t\t\t\tparent = wrap( parent, function() {}, true );\n\t\t\t\t\treturn parent.call( this, data ) || data;\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn wrap( childFn, parentFn );\n\t\t}\n\t\treturn __export;\n\t}( wrapMethod );\n\n\t/* config/types.js */\n\tvar types = {\n\t\tTEXT: 1,\n\t\tINTERPOLATOR: 2,\n\t\tTRIPLE: 3,\n\t\tSECTION: 4,\n\t\tINVERTED: 5,\n\t\tCLOSING: 6,\n\t\tELEMENT: 7,\n\t\tPARTIAL: 8,\n\t\tCOMMENT: 9,\n\t\tDELIMCHANGE: 10,\n\t\tMUSTACHE: 11,\n\t\tTAG: 12,\n\t\tATTRIBUTE: 13,\n\t\tCLOSING_TAG: 14,\n\t\tCOMPONENT: 15,\n\t\tNUMBER_LITERAL: 20,\n\t\tSTRING_LITERAL: 21,\n\t\tARRAY_LITERAL: 22,\n\t\tOBJECT_LITERAL: 23,\n\t\tBOOLEAN_LITERAL: 24,\n\t\tGLOBAL: 26,\n\t\tKEY_VALUE_PAIR: 27,\n\t\tREFERENCE: 30,\n\t\tREFINEMENT: 31,\n\t\tMEMBER: 32,\n\t\tPREFIX_OPERATOR: 33,\n\t\tBRACKETED: 34,\n\t\tCONDITIONAL: 35,\n\t\tINFIX_OPERATOR: 36,\n\t\tINVOCATION: 40,\n\t\tSECTION_IF: 50,\n\t\tSECTION_UNLESS: 51,\n\t\tSECTION_EACH: 52,\n\t\tSECTION_WITH: 53,\n\t\tSECTION_IF_WITH: 54\n\t};\n\n\t/* utils/create.js */\n\tvar create = function() {\n\n\t\tvar create;\n\t\ttry {\n\t\t\tObject.create( null );\n\t\t\tcreate = Object.create;\n\t\t} catch ( err ) {\n\t\t\t// sigh\n\t\t\tcreate = function() {\n\t\t\t\tvar F = function() {};\n\t\t\t\treturn function( proto, props ) {\n\t\t\t\t\tvar obj;\n\t\t\t\t\tif ( proto === null ) {\n\t\t\t\t\t\treturn {};\n\t\t\t\t\t}\n\t\t\t\t\tF.prototype = proto;\n\t\t\t\t\tobj = new F();\n\t\t\t\t\tif ( props ) {\n\t\t\t\t\t\tObject.defineProperties( obj, props );\n\t\t\t\t\t}\n\t\t\t\t\treturn obj;\n\t\t\t\t};\n\t\t\t}();\n\t\t}\n\t\treturn create;\n\t}();\n\n\t/* parse/Parser/expressions/shared/errors.js */\n\tvar parse_Parser_expressions_shared_errors = {\n\t\texpectedExpression: 'Expected a JavaScript expression',\n\t\texpectedParen: 'Expected closing paren'\n\t};\n\n\t/* parse/Parser/expressions/primary/literal/numberLiteral.js */\n\tvar numberLiteral = function( types ) {\n\n\t\tvar numberPattern = /^(?:[+-]?)(?:(?:(?:0|[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\n\t\treturn function( parser ) {\n\t\t\tvar result;\n\t\t\tif ( result = parser.matchPattern( numberPattern ) ) {\n\t\t\t\treturn {\n\t\t\t\t\tt: types.NUMBER_LITERAL,\n\t\t\t\t\tv: result\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\t}( types );\n\n\t/* parse/Parser/expressions/primary/literal/booleanLiteral.js */\n\tvar booleanLiteral = function( types ) {\n\n\t\treturn function( parser ) {\n\t\t\tvar remaining = parser.remaining();\n\t\t\tif ( remaining.substr( 0, 4 ) === 'true' ) {\n\t\t\t\tparser.pos += 4;\n\t\t\t\treturn {\n\t\t\t\t\tt: types.BOOLEAN_LITERAL,\n\t\t\t\t\tv: 'true'\n\t\t\t\t};\n\t\t\t}\n\t\t\tif ( remaining.substr( 0, 5 ) === 'false' ) {\n\t\t\t\tparser.pos += 5;\n\t\t\t\treturn {\n\t\t\t\t\tt: types.BOOLEAN_LITERAL,\n\t\t\t\t\tv: 'false'\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\t}( types );\n\n\t/* parse/Parser/expressions/primary/literal/stringLiteral/makeQuotedStringMatcher.js */\n\tvar makeQuotedStringMatcher = function() {\n\n\t\tvar stringMiddlePattern, escapeSequencePattern, lineContinuationPattern;\n\t\t// Match one or more characters until: \", ', \\, or EOL/EOF.\n\t\t// EOL/EOF is written as (?!.) (meaning there's no non-newline char next).\n\t\tstringMiddlePattern = /^(?=.)[^\"'\\\\]+?(?:(?!.)|(?=[\"'\\\\]))/;\n\t\t// Match one escape sequence, including the backslash.\n\t\tescapeSequencePattern = /^\\\\(?:['\"\\\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/;\n\t\t// Match one ES5 line continuation (backslash + line terminator).\n\t\tlineContinuationPattern = /^\\\\(?:\\r\\n|[\\u000A\\u000D\\u2028\\u2029])/;\n\t\t// Helper for defining getDoubleQuotedString and getSingleQuotedString.\n\t\treturn function( okQuote ) {\n\t\t\treturn function( parser ) {\n\t\t\t\tvar start, literal, done, next;\n\t\t\t\tstart = parser.pos;\n\t\t\t\tliteral = '\"';\n\t\t\t\tdone = false;\n\t\t\t\twhile ( !done ) {\n\t\t\t\t\tnext = parser.matchPattern( stringMiddlePattern ) || parser.matchPattern( escapeSequencePattern ) || parser.matchString( okQuote );\n\t\t\t\t\tif ( next ) {\n\t\t\t\t\t\tif ( next === '\"' ) {\n\t\t\t\t\t\t\tliteral += '\\\\\"';\n\t\t\t\t\t\t} else if ( next === '\\\\\\'' ) {\n\t\t\t\t\t\t\tliteral += '\\'';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tliteral += next;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnext = parser.matchPattern( lineContinuationPattern );\n\t\t\t\t\t\tif ( next ) {\n\t\t\t\t\t\t\t// convert \\(newline-like) into a \\u escape, which is allowed in JSON\n\t\t\t\t\t\t\tliteral += '\\\\u' + ( '000' + next.charCodeAt( 1 ).toString( 16 ) ).slice( -4 );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdone = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tliteral += '\"';\n\t\t\t\t// use JSON.parse to interpret escapes\n\t\t\t\treturn JSON.parse( literal );\n\t\t\t};\n\t\t};\n\t}();\n\n\t/* parse/Parser/expressions/primary/literal/stringLiteral/singleQuotedString.js */\n\tvar singleQuotedString = function( makeQuotedStringMatcher ) {\n\n\t\treturn makeQuotedStringMatcher( '\"' );\n\t}( makeQuotedStringMatcher );\n\n\t/* parse/Parser/expressions/primary/literal/stringLiteral/doubleQuotedString.js */\n\tvar doubleQuotedString = function( makeQuotedStringMatcher ) {\n\n\t\treturn makeQuotedStringMatcher( '\\'' );\n\t}( makeQuotedStringMatcher );\n\n\t/* parse/Parser/expressions/primary/literal/stringLiteral/_stringLiteral.js */\n\tvar stringLiteral = function( types, getSingleQuotedString, getDoubleQuotedString ) {\n\n\t\treturn function( parser ) {\n\t\t\tvar start, string;\n\t\t\tstart = parser.pos;\n\t\t\tif ( parser.matchString( '\"' ) ) {\n\t\t\t\tstring = getDoubleQuotedString( parser );\n\t\t\t\tif ( !parser.matchString( '\"' ) ) {\n\t\t\t\t\tparser.pos = start;\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tt: types.STRING_LITERAL,\n\t\t\t\t\tv: string\n\t\t\t\t};\n\t\t\t}\n\t\t\tif ( parser.matchString( '\\'' ) ) {\n\t\t\t\tstring = getSingleQuotedString( parser );\n\t\t\t\tif ( !parser.matchString( '\\'' ) ) {\n\t\t\t\t\tparser.pos = start;\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tt: types.STRING_LITERAL,\n\t\t\t\t\tv: string\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\t}( types, singleQuotedString, doubleQuotedString );\n\n\t/* parse/Parser/expressions/shared/patterns.js */\n\tvar patterns = {\n\t\tname: /^[a-zA-Z_$][a-zA-Z_$0-9]*/\n\t};\n\n\t/* parse/Parser/expressions/shared/key.js */\n\tvar key = function( getStringLiteral, getNumberLiteral, patterns ) {\n\n\t\tvar identifier = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;\n\t\t// http://mathiasbynens.be/notes/javascript-properties\n\t\t// can be any name, string literal, or number literal\n\t\treturn function( parser ) {\n\t\t\tvar token;\n\t\t\tif ( token = getStringLiteral( parser ) ) {\n\t\t\t\treturn identifier.test( token.v ) ? token.v : '\"' + token.v.replace( /\"/g, '\\\\\"' ) + '\"';\n\t\t\t}\n\t\t\tif ( token = getNumberLiteral( parser ) ) {\n\t\t\t\treturn token.v;\n\t\t\t}\n\t\t\tif ( token = parser.matchPattern( patterns.name ) ) {\n\t\t\t\treturn token;\n\t\t\t}\n\t\t};\n\t}( stringLiteral, numberLiteral, patterns );\n\n\t/* parse/Parser/expressions/primary/literal/objectLiteral/keyValuePair.js */\n\tvar keyValuePair = function( types, getKey ) {\n\n\t\treturn function( parser ) {\n\t\t\tvar start, key, value;\n\t\t\tstart = parser.pos;\n\t\t\t// allow whitespace between '{' and key\n\t\t\tparser.allowWhitespace();\n\t\t\tkey = getKey( parser );\n\t\t\tif ( key === null ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\t// allow whitespace between key and ':'\n\t\t\tparser.allowWhitespace();\n\t\t\t// next character must be ':'\n\t\t\tif ( !parser.matchString( ':' ) ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\t// allow whitespace between ':' and value\n\t\t\tparser.allowWhitespace();\n\t\t\t// next expression must be a, well... expression\n\t\t\tvalue = parser.readExpression();\n\t\t\tif ( value === null ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tt: types.KEY_VALUE_PAIR,\n\t\t\t\tk: key,\n\t\t\t\tv: value\n\t\t\t};\n\t\t};\n\t}( types, key );\n\n\t/* parse/Parser/expressions/primary/literal/objectLiteral/keyValuePairs.js */\n\tvar keyValuePairs = function( getKeyValuePair ) {\n\n\t\treturn function getKeyValuePairs( parser ) {\n\t\t\tvar start, pairs, pair, keyValuePairs;\n\t\t\tstart = parser.pos;\n\t\t\tpair = getKeyValuePair( parser );\n\t\t\tif ( pair === null ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tpairs = [ pair ];\n\t\t\tif ( parser.matchString( ',' ) ) {\n\t\t\t\tkeyValuePairs = getKeyValuePairs( parser );\n\t\t\t\tif ( !keyValuePairs ) {\n\t\t\t\t\tparser.pos = start;\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treturn pairs.concat( keyValuePairs );\n\t\t\t}\n\t\t\treturn pairs;\n\t\t};\n\t}( keyValuePair );\n\n\t/* parse/Parser/expressions/primary/literal/objectLiteral/_objectLiteral.js */\n\tvar objectLiteral = function( types, getKeyValuePairs ) {\n\n\t\treturn function( parser ) {\n\t\t\tvar start, keyValuePairs;\n\t\t\tstart = parser.pos;\n\t\t\t// allow whitespace\n\t\t\tparser.allowWhitespace();\n\t\t\tif ( !parser.matchString( '{' ) ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tkeyValuePairs = getKeyValuePairs( parser );\n\t\t\t// allow whitespace between final value and '}'\n\t\t\tparser.allowWhitespace();\n\t\t\tif ( !parser.matchString( '}' ) ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tt: types.OBJECT_LITERAL,\n\t\t\t\tm: keyValuePairs\n\t\t\t};\n\t\t};\n\t}( types, keyValuePairs );\n\n\t/* parse/Parser/expressions/shared/expressionList.js */\n\tvar expressionList = function( errors ) {\n\n\t\treturn function getExpressionList( parser ) {\n\t\t\tvar start, expressions, expr, next;\n\t\t\tstart = parser.pos;\n\t\t\tparser.allowWhitespace();\n\t\t\texpr = parser.readExpression();\n\t\t\tif ( expr === null ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\texpressions = [ expr ];\n\t\t\t// allow whitespace between expression and ','\n\t\t\tparser.allowWhitespace();\n\t\t\tif ( parser.matchString( ',' ) ) {\n\t\t\t\tnext = getExpressionList( parser );\n\t\t\t\tif ( next === null ) {\n\t\t\t\t\tparser.error( errors.expectedExpression );\n\t\t\t\t}\n\t\t\t\tnext.forEach( append );\n\t\t\t}\n\n\t\t\tfunction append( expression ) {\n\t\t\t\texpressions.push( expression );\n\t\t\t}\n\t\t\treturn expressions;\n\t\t};\n\t}( parse_Parser_expressions_shared_errors );\n\n\t/* parse/Parser/expressions/primary/literal/arrayLiteral.js */\n\tvar arrayLiteral = function( types, getExpressionList ) {\n\n\t\treturn function( parser ) {\n\t\t\tvar start, expressionList;\n\t\t\tstart = parser.pos;\n\t\t\t// allow whitespace before '['\n\t\t\tparser.allowWhitespace();\n\t\t\tif ( !parser.matchString( '[' ) ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\texpressionList = getExpressionList( parser );\n\t\t\tif ( !parser.matchString( ']' ) ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tt: types.ARRAY_LITERAL,\n\t\t\t\tm: expressionList\n\t\t\t};\n\t\t};\n\t}( types, expressionList );\n\n\t/* parse/Parser/expressions/primary/literal/_literal.js */\n\tvar literal = function( getNumberLiteral, getBooleanLiteral, getStringLiteral, getObjectLiteral, getArrayLiteral ) {\n\n\t\treturn function( parser ) {\n\t\t\tvar literal = getNumberLiteral( parser ) || getBooleanLiteral( parser ) || getStringLiteral( parser ) || getObjectLiteral( parser ) || getArrayLiteral( parser );\n\t\t\treturn literal;\n\t\t};\n\t}( numberLiteral, booleanLiteral, stringLiteral, objectLiteral, arrayLiteral );\n\n\t/* parse/Parser/expressions/primary/reference.js */\n\tvar reference = function( types, patterns ) {\n\n\t\tvar dotRefinementPattern, arrayMemberPattern, getArrayRefinement, globals, keywords;\n\t\tdotRefinementPattern = /^\\.[a-zA-Z_$0-9]+/;\n\t\tgetArrayRefinement = function( parser ) {\n\t\t\tvar num = parser.matchPattern( arrayMemberPattern );\n\t\t\tif ( num ) {\n\t\t\t\treturn '.' + num;\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\t\tarrayMemberPattern = /^\\[(0|[1-9][0-9]*)\\]/;\n\t\t// if a reference is a browser global, we don't deference it later, so it needs special treatment\n\t\tglobals = /^(?:Array|console|Date|RegExp|decodeURIComponent|decodeURI|encodeURIComponent|encodeURI|isFinite|isNaN|parseFloat|parseInt|JSON|Math|NaN|undefined|null)$/;\n\t\t// keywords are not valid references, with the exception of `this`\n\t\tkeywords = /^(?:break|case|catch|continue|debugger|default|delete|do|else|finally|for|function|if|in|instanceof|new|return|switch|throw|try|typeof|var|void|while|with)$/;\n\t\treturn function( parser ) {\n\t\t\tvar startPos, ancestor, name, dot, combo, refinement, lastDotIndex;\n\t\t\tstartPos = parser.pos;\n\t\t\t// we might have a root-level reference\n\t\t\tif ( parser.matchString( '~/' ) ) {\n\t\t\t\tancestor = '~/';\n\t\t\t} else {\n\t\t\t\t// we might have ancestor refs...\n\t\t\t\tancestor = '';\n\t\t\t\twhile ( parser.matchString( '../' ) ) {\n\t\t\t\t\tancestor += '../';\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( !ancestor ) {\n\t\t\t\t// we might have an implicit iterator or a restricted reference\n\t\t\t\tdot = parser.matchString( './' ) || parser.matchString( '.' ) || '';\n\t\t\t}\n\t\t\tname = parser.matchPattern( /^@(?:keypath|index|key)/ ) || parser.matchPattern( patterns.name ) || '';\n\t\t\t// bug out if it's a keyword\n\t\t\tif ( keywords.test( name ) ) {\n\t\t\t\tparser.pos = startPos;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\t// if this is a browser global, stop here\n\t\t\tif ( !ancestor && !dot && globals.test( name ) ) {\n\t\t\t\treturn {\n\t\t\t\t\tt: types.GLOBAL,\n\t\t\t\t\tv: name\n\t\t\t\t};\n\t\t\t}\n\t\t\tcombo = ( ancestor || dot ) + name;\n\t\t\tif ( !combo ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\twhile ( refinement = parser.matchPattern( dotRefinementPattern ) || getArrayRefinement( parser ) ) {\n\t\t\t\tcombo += refinement;\n\t\t\t}\n\t\t\tif ( parser.matchString( '(' ) ) {\n\t\t\t\t// if this is a method invocation (as opposed to a function) we need\n\t\t\t\t// to strip the method name from the reference combo, else the context\n\t\t\t\t// will be wrong\n\t\t\t\tlastDotIndex = combo.lastIndexOf( '.' );\n\t\t\t\tif ( lastDotIndex !== -1 ) {\n\t\t\t\t\tcombo = combo.substr( 0, lastDotIndex );\n\t\t\t\t\tparser.pos = startPos + combo.length;\n\t\t\t\t} else {\n\t\t\t\t\tparser.pos -= 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tt: types.REFERENCE,\n\t\t\t\tn: combo.replace( /^this\\./, './' ).replace( /^this$/, '.' )\n\t\t\t};\n\t\t};\n\t}( types, patterns );\n\n\t/* parse/Parser/expressions/primary/bracketedExpression.js */\n\tvar bracketedExpression = function( types, errors ) {\n\n\t\treturn function( parser ) {\n\t\t\tvar start, expr;\n\t\t\tstart = parser.pos;\n\t\t\tif ( !parser.matchString( '(' ) ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tparser.allowWhitespace();\n\t\t\texpr = parser.readExpression();\n\t\t\tif ( !expr ) {\n\t\t\t\tparser.error( errors.expectedExpression );\n\t\t\t}\n\t\t\tparser.allowWhitespace();\n\t\t\tif ( !parser.matchString( ')' ) ) {\n\t\t\t\tparser.error( errors.expectedParen );\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tt: types.BRACKETED,\n\t\t\t\tx: expr\n\t\t\t};\n\t\t};\n\t}( types, parse_Parser_expressions_shared_errors );\n\n\t/* parse/Parser/expressions/primary/_primary.js */\n\tvar primary = function( getLiteral, getReference, getBracketedExpression ) {\n\n\t\treturn function( parser ) {\n\t\t\treturn getLiteral( parser ) || getReference( parser ) || getBracketedExpression( parser );\n\t\t};\n\t}( literal, reference, bracketedExpression );\n\n\t/* parse/Parser/expressions/shared/refinement.js */\n\tvar refinement = function( types, errors, patterns ) {\n\n\t\treturn function getRefinement( parser ) {\n\t\t\tvar start, name, expr;\n\t\t\tstart = parser.pos;\n\t\t\tparser.allowWhitespace();\n\t\t\t// \".\" name\n\t\t\tif ( parser.matchString( '.' ) ) {\n\t\t\t\tparser.allowWhitespace();\n\t\t\t\tif ( name = parser.matchPattern( patterns.name ) ) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tt: types.REFINEMENT,\n\t\t\t\t\t\tn: name\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tparser.error( 'Expected a property name' );\n\t\t\t}\n\t\t\t// \"[\" expression \"]\"\n\t\t\tif ( parser.matchString( '[' ) ) {\n\t\t\t\tparser.allowWhitespace();\n\t\t\t\texpr = parser.readExpression();\n\t\t\t\tif ( !expr ) {\n\t\t\t\t\tparser.error( errors.expectedExpression );\n\t\t\t\t}\n\t\t\t\tparser.allowWhitespace();\n\t\t\t\tif ( !parser.matchString( ']' ) ) {\n\t\t\t\t\tparser.error( 'Expected \\']\\'' );\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tt: types.REFINEMENT,\n\t\t\t\t\tx: expr\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\t}( types, parse_Parser_expressions_shared_errors, patterns );\n\n\t/* parse/Parser/expressions/memberOrInvocation.js */\n\tvar memberOrInvocation = function( types, getPrimary, getExpressionList, getRefinement, errors ) {\n\n\t\treturn function( parser ) {\n\t\t\tvar current, expression, refinement, expressionList;\n\t\t\texpression = getPrimary( parser );\n\t\t\tif ( !expression ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\twhile ( expression ) {\n\t\t\t\tcurrent = parser.pos;\n\t\t\t\tif ( refinement = getRefinement( parser ) ) {\n\t\t\t\t\texpression = {\n\t\t\t\t\t\tt: types.MEMBER,\n\t\t\t\t\t\tx: expression,\n\t\t\t\t\t\tr: refinement\n\t\t\t\t\t};\n\t\t\t\t} else if ( parser.matchString( '(' ) ) {\n\t\t\t\t\tparser.allowWhitespace();\n\t\t\t\t\texpressionList = getExpressionList( parser );\n\t\t\t\t\tparser.allowWhitespace();\n\t\t\t\t\tif ( !parser.matchString( ')' ) ) {\n\t\t\t\t\t\tparser.error( errors.expectedParen );\n\t\t\t\t\t}\n\t\t\t\t\texpression = {\n\t\t\t\t\t\tt: types.INVOCATION,\n\t\t\t\t\t\tx: expression\n\t\t\t\t\t};\n\t\t\t\t\tif ( expressionList ) {\n\t\t\t\t\t\texpression.o = expressionList;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn expression;\n\t\t};\n\t}( types, primary, expressionList, refinement, parse_Parser_expressions_shared_errors );\n\n\t/* parse/Parser/expressions/typeof.js */\n\tvar _typeof = function( types, errors, getMemberOrInvocation ) {\n\n\t\tvar getTypeof, makePrefixSequenceMatcher;\n\t\tmakePrefixSequenceMatcher = function( symbol, fallthrough ) {\n\t\t\treturn function( parser ) {\n\t\t\t\tvar expression;\n\t\t\t\tif ( expression = fallthrough( parser ) ) {\n\t\t\t\t\treturn expression;\n\t\t\t\t}\n\t\t\t\tif ( !parser.matchString( symbol ) ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tparser.allowWhitespace();\n\t\t\t\texpression = parser.readExpression();\n\t\t\t\tif ( !expression ) {\n\t\t\t\t\tparser.error( errors.expectedExpression );\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\ts: symbol,\n\t\t\t\t\to: expression,\n\t\t\t\t\tt: types.PREFIX_OPERATOR\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t\t// create all prefix sequence matchers, return getTypeof\n\t\t( function() {\n\t\t\tvar i, len, matcher, prefixOperators, fallthrough;\n\t\t\tprefixOperators = '! ~ + - typeof'.split( ' ' );\n\t\t\tfallthrough = getMemberOrInvocation;\n\t\t\tfor ( i = 0, len = prefixOperators.length; i < len; i += 1 ) {\n\t\t\t\tmatcher = makePrefixSequenceMatcher( prefixOperators[ i ], fallthrough );\n\t\t\t\tfallthrough = matcher;\n\t\t\t}\n\t\t\t// typeof operator is higher precedence than multiplication, so provides the\n\t\t\t// fallthrough for the multiplication sequence matcher we're about to create\n\t\t\t// (we're skipping void and delete)\n\t\t\tgetTypeof = fallthrough;\n\t\t}() );\n\t\treturn getTypeof;\n\t}( types, parse_Parser_expressions_shared_errors, memberOrInvocation );\n\n\t/* parse/Parser/expressions/logicalOr.js */\n\tvar logicalOr = function( types, getTypeof ) {\n\n\t\tvar getLogicalOr, makeInfixSequenceMatcher;\n\t\tmakeInfixSequenceMatcher = function( symbol, fallthrough ) {\n\t\t\treturn function( parser ) {\n\t\t\t\tvar start, left, right;\n\t\t\t\tleft = fallthrough( parser );\n\t\t\t\tif ( !left ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\t// Loop to handle left-recursion in a case like `a * b * c` and produce\n\t\t\t\t// left association, i.e. `(a * b) * c`.  The matcher can't call itself\n\t\t\t\t// to parse `left` because that would be infinite regress.\n\t\t\t\twhile ( true ) {\n\t\t\t\t\tstart = parser.pos;\n\t\t\t\t\tparser.allowWhitespace();\n\t\t\t\t\tif ( !parser.matchString( symbol ) ) {\n\t\t\t\t\t\tparser.pos = start;\n\t\t\t\t\t\treturn left;\n\t\t\t\t\t}\n\t\t\t\t\t// special case - in operator must not be followed by [a-zA-Z_$0-9]\n\t\t\t\t\tif ( symbol === 'in' && /[a-zA-Z_$0-9]/.test( parser.remaining().charAt( 0 ) ) ) {\n\t\t\t\t\t\tparser.pos = start;\n\t\t\t\t\t\treturn left;\n\t\t\t\t\t}\n\t\t\t\t\tparser.allowWhitespace();\n\t\t\t\t\t// right operand must also consist of only higher-precedence operators\n\t\t\t\t\tright = fallthrough( parser );\n\t\t\t\t\tif ( !right ) {\n\t\t\t\t\t\tparser.pos = start;\n\t\t\t\t\t\treturn left;\n\t\t\t\t\t}\n\t\t\t\t\tleft = {\n\t\t\t\t\t\tt: types.INFIX_OPERATOR,\n\t\t\t\t\t\ts: symbol,\n\t\t\t\t\t\to: [\n\t\t\t\t\t\t\tleft,\n\t\t\t\t\t\t\tright\n\t\t\t\t\t\t]\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\t// create all infix sequence matchers, and return getLogicalOr\n\t\t( function() {\n\t\t\tvar i, len, matcher, infixOperators, fallthrough;\n\t\t\t// All the infix operators on order of precedence (source: https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Operator_Precedence)\n\t\t\t// Each sequence matcher will initially fall through to its higher precedence\n\t\t\t// neighbour, and only attempt to match if one of the higher precedence operators\n\t\t\t// (or, ultimately, a literal, reference, or bracketed expression) already matched\n\t\t\tinfixOperators = '* / % + - << >> >>> < <= > >= in instanceof == != === !== & ^ | && ||'.split( ' ' );\n\t\t\t// A typeof operator is higher precedence than multiplication\n\t\t\tfallthrough = getTypeof;\n\t\t\tfor ( i = 0, len = infixOperators.length; i < len; i += 1 ) {\n\t\t\t\tmatcher = makeInfixSequenceMatcher( infixOperators[ i ], fallthrough );\n\t\t\t\tfallthrough = matcher;\n\t\t\t}\n\t\t\t// Logical OR is the fallthrough for the conditional matcher\n\t\t\tgetLogicalOr = fallthrough;\n\t\t}() );\n\t\treturn getLogicalOr;\n\t}( types, _typeof );\n\n\t/* parse/Parser/expressions/conditional.js */\n\tvar conditional = function( types, getLogicalOr, errors ) {\n\n\t\treturn function( parser ) {\n\t\t\tvar start, expression, ifTrue, ifFalse;\n\t\t\texpression = getLogicalOr( parser );\n\t\t\tif ( !expression ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tstart = parser.pos;\n\t\t\tparser.allowWhitespace();\n\t\t\tif ( !parser.matchString( '?' ) ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn expression;\n\t\t\t}\n\t\t\tparser.allowWhitespace();\n\t\t\tifTrue = parser.readExpression();\n\t\t\tif ( !ifTrue ) {\n\t\t\t\tparser.error( errors.expectedExpression );\n\t\t\t}\n\t\t\tparser.allowWhitespace();\n\t\t\tif ( !parser.matchString( ':' ) ) {\n\t\t\t\tparser.error( 'Expected \":\"' );\n\t\t\t}\n\t\t\tparser.allowWhitespace();\n\t\t\tifFalse = parser.readExpression();\n\t\t\tif ( !ifFalse ) {\n\t\t\t\tparser.error( errors.expectedExpression );\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tt: types.CONDITIONAL,\n\t\t\t\to: [\n\t\t\t\t\texpression,\n\t\t\t\t\tifTrue,\n\t\t\t\t\tifFalse\n\t\t\t\t]\n\t\t\t};\n\t\t};\n\t}( types, logicalOr, parse_Parser_expressions_shared_errors );\n\n\t/* parse/Parser/utils/flattenExpression.js */\n\tvar flattenExpression = function( types, isObject ) {\n\n\t\tvar __export;\n\t\t__export = function( expression ) {\n\t\t\tvar refs = [],\n\t\t\t\tflattened;\n\t\t\textractRefs( expression, refs );\n\t\t\tflattened = {\n\t\t\t\tr: refs,\n\t\t\t\ts: stringify( this, expression, refs )\n\t\t\t};\n\t\t\treturn flattened;\n\t\t};\n\n\t\tfunction quoteStringLiteral( str ) {\n\t\t\treturn JSON.stringify( String( str ) );\n\t\t}\n\t\t// TODO maybe refactor this?\n\t\tfunction extractRefs( node, refs ) {\n\t\t\tvar i, list;\n\t\t\tif ( node.t === types.REFERENCE ) {\n\t\t\t\tif ( refs.indexOf( node.n ) === -1 ) {\n\t\t\t\t\trefs.unshift( node.n );\n\t\t\t\t}\n\t\t\t}\n\t\t\tlist = node.o || node.m;\n\t\t\tif ( list ) {\n\t\t\t\tif ( isObject( list ) ) {\n\t\t\t\t\textractRefs( list, refs );\n\t\t\t\t} else {\n\t\t\t\t\ti = list.length;\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\textractRefs( list[ i ], refs );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( node.x ) {\n\t\t\t\textractRefs( node.x, refs );\n\t\t\t}\n\t\t\tif ( node.r ) {\n\t\t\t\textractRefs( node.r, refs );\n\t\t\t}\n\t\t\tif ( node.v ) {\n\t\t\t\textractRefs( node.v, refs );\n\t\t\t}\n\t\t}\n\n\t\tfunction stringify( parser, node, refs ) {\n\t\t\tvar stringifyAll = function( item ) {\n\t\t\t\treturn stringify( parser, item, refs );\n\t\t\t};\n\t\t\tswitch ( node.t ) {\n\t\t\t\tcase types.BOOLEAN_LITERAL:\n\t\t\t\tcase types.GLOBAL:\n\t\t\t\tcase types.NUMBER_LITERAL:\n\t\t\t\t\treturn node.v;\n\t\t\t\tcase types.STRING_LITERAL:\n\t\t\t\t\treturn quoteStringLiteral( node.v );\n\t\t\t\tcase types.ARRAY_LITERAL:\n\t\t\t\t\treturn '[' + ( node.m ? node.m.map( stringifyAll ).join( ',' ) : '' ) + ']';\n\t\t\t\tcase types.OBJECT_LITERAL:\n\t\t\t\t\treturn '{' + ( node.m ? node.m.map( stringifyAll ).join( ',' ) : '' ) + '}';\n\t\t\t\tcase types.KEY_VALUE_PAIR:\n\t\t\t\t\treturn node.k + ':' + stringify( parser, node.v, refs );\n\t\t\t\tcase types.PREFIX_OPERATOR:\n\t\t\t\t\treturn ( node.s === 'typeof' ? 'typeof ' : node.s ) + stringify( parser, node.o, refs );\n\t\t\t\tcase types.INFIX_OPERATOR:\n\t\t\t\t\treturn stringify( parser, node.o[ 0 ], refs ) + ( node.s.substr( 0, 2 ) === 'in' ? ' ' + node.s + ' ' : node.s ) + stringify( parser, node.o[ 1 ], refs );\n\t\t\t\tcase types.INVOCATION:\n\t\t\t\t\treturn stringify( parser, node.x, refs ) + '(' + ( node.o ? node.o.map( stringifyAll ).join( ',' ) : '' ) + ')';\n\t\t\t\tcase types.BRACKETED:\n\t\t\t\t\treturn '(' + stringify( parser, node.x, refs ) + ')';\n\t\t\t\tcase types.MEMBER:\n\t\t\t\t\treturn stringify( parser, node.x, refs ) + stringify( parser, node.r, refs );\n\t\t\t\tcase types.REFINEMENT:\n\t\t\t\t\treturn node.n ? '.' + node.n : '[' + stringify( parser, node.x, refs ) + ']';\n\t\t\t\tcase types.CONDITIONAL:\n\t\t\t\t\treturn stringify( parser, node.o[ 0 ], refs ) + '?' + stringify( parser, node.o[ 1 ], refs ) + ':' + stringify( parser, node.o[ 2 ], refs );\n\t\t\t\tcase types.REFERENCE:\n\t\t\t\t\treturn '_' + refs.indexOf( node.n );\n\t\t\t\tdefault:\n\t\t\t\t\tparser.error( 'Expected legal JavaScript' );\n\t\t\t}\n\t\t}\n\t\treturn __export;\n\t}( types, isObject );\n\n\t/* parse/Parser/_Parser.js */\n\tvar Parser = function( circular, create, hasOwnProperty, getConditional, flattenExpression ) {\n\n\t\tvar Parser, ParseError, leadingWhitespace = /^\\s+/;\n\t\tParseError = function( message ) {\n\t\t\tthis.name = 'ParseError';\n\t\t\tthis.message = message;\n\t\t\ttry {\n\t\t\t\tthrow new Error( message );\n\t\t\t} catch ( e ) {\n\t\t\t\tthis.stack = e.stack;\n\t\t\t}\n\t\t};\n\t\tParseError.prototype = Error.prototype;\n\t\tParser = function( str, options ) {\n\t\t\tvar items, item, lineStart = 0;\n\t\t\tthis.str = str;\n\t\t\tthis.options = options || {};\n\t\t\tthis.pos = 0;\n\t\t\tthis.lines = this.str.split( '\\n' );\n\t\t\tthis.lineEnds = this.lines.map( function( line ) {\n\t\t\t\tvar lineEnd = lineStart + line.length + 1;\n\t\t\t\t// +1 for the newline\n\t\t\t\tlineStart = lineEnd;\n\t\t\t\treturn lineEnd;\n\t\t\t}, 0 );\n\t\t\t// Custom init logic\n\t\t\tif ( this.init )\n\t\t\t\tthis.init( str, options );\n\t\t\titems = [];\n\t\t\twhile ( this.pos < this.str.length && ( item = this.read() ) ) {\n\t\t\t\titems.push( item );\n\t\t\t}\n\t\t\tthis.leftover = this.remaining();\n\t\t\tthis.result = this.postProcess ? this.postProcess( items, options ) : items;\n\t\t};\n\t\tParser.prototype = {\n\t\t\tread: function( converters ) {\n\t\t\t\tvar pos, i, len, item;\n\t\t\t\tif ( !converters )\n\t\t\t\t\tconverters = this.converters;\n\t\t\t\tpos = this.pos;\n\t\t\t\tlen = converters.length;\n\t\t\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\t\t\tthis.pos = pos;\n\t\t\t\t\t// reset for each attempt\n\t\t\t\t\tif ( item = converters[ i ]( this ) ) {\n\t\t\t\t\t\treturn item;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\treadExpression: function() {\n\t\t\t\t// The conditional operator is the lowest precedence operator (except yield,\n\t\t\t\t// assignment operators, and commas, none of which are supported), so we\n\t\t\t\t// start there. If it doesn't match, it 'falls through' to progressively\n\t\t\t\t// higher precedence operators, until it eventually matches (or fails to\n\t\t\t\t// match) a 'primary' - a literal or a reference. This way, the abstract syntax\n\t\t\t\t// tree has everything in its proper place, i.e. 2 + 3 * 4 === 14, not 20.\n\t\t\t\treturn getConditional( this );\n\t\t\t},\n\t\t\tflattenExpression: flattenExpression,\n\t\t\tgetLinePos: function( char ) {\n\t\t\t\tvar lineNum = 0,\n\t\t\t\t\tlineStart = 0,\n\t\t\t\t\tcolumnNum;\n\t\t\t\twhile ( char >= this.lineEnds[ lineNum ] ) {\n\t\t\t\t\tlineStart = this.lineEnds[ lineNum ];\n\t\t\t\t\tlineNum += 1;\n\t\t\t\t}\n\t\t\t\tcolumnNum = char - lineStart;\n\t\t\t\treturn [\n\t\t\t\t\tlineNum + 1,\n\t\t\t\t\tcolumnNum + 1,\n\t\t\t\t\tchar\n\t\t\t\t];\n\t\t\t},\n\t\t\terror: function( message ) {\n\t\t\t\tvar pos, lineNum, columnNum, line, annotation, error;\n\t\t\t\tpos = this.getLinePos( this.pos );\n\t\t\t\tlineNum = pos[ 0 ];\n\t\t\t\tcolumnNum = pos[ 1 ];\n\t\t\t\tline = this.lines[ pos[ 0 ] - 1 ];\n\t\t\t\tannotation = line + '\\n' + new Array( pos[ 1 ] ).join( ' ' ) + '^----';\n\t\t\t\terror = new ParseError( message + ' at line ' + lineNum + ' character ' + columnNum + ':\\n' + annotation );\n\t\t\t\terror.line = pos[ 0 ];\n\t\t\t\terror.character = pos[ 1 ];\n\t\t\t\terror.shortMessage = message;\n\t\t\t\tthrow error;\n\t\t\t},\n\t\t\tmatchString: function( string ) {\n\t\t\t\tif ( this.str.substr( this.pos, string.length ) === string ) {\n\t\t\t\t\tthis.pos += string.length;\n\t\t\t\t\treturn string;\n\t\t\t\t}\n\t\t\t},\n\t\t\tmatchPattern: function( pattern ) {\n\t\t\t\tvar match;\n\t\t\t\tif ( match = pattern.exec( this.remaining() ) ) {\n\t\t\t\t\tthis.pos += match[ 0 ].length;\n\t\t\t\t\treturn match[ 1 ] || match[ 0 ];\n\t\t\t\t}\n\t\t\t},\n\t\t\tallowWhitespace: function() {\n\t\t\t\tthis.matchPattern( leadingWhitespace );\n\t\t\t},\n\t\t\tremaining: function() {\n\t\t\t\treturn this.str.substring( this.pos );\n\t\t\t},\n\t\t\tnextChar: function() {\n\t\t\t\treturn this.str.charAt( this.pos );\n\t\t\t}\n\t\t};\n\t\tParser.extend = function( proto ) {\n\t\t\tvar Parent = this,\n\t\t\t\tChild, key;\n\t\t\tChild = function( str, options ) {\n\t\t\t\tParser.call( this, str, options );\n\t\t\t};\n\t\t\tChild.prototype = create( Parent.prototype );\n\t\t\tfor ( key in proto ) {\n\t\t\t\tif ( hasOwnProperty.call( proto, key ) ) {\n\t\t\t\t\tChild.prototype[ key ] = proto[ key ];\n\t\t\t\t}\n\t\t\t}\n\t\t\tChild.extend = Parser.extend;\n\t\t\treturn Child;\n\t\t};\n\t\tcircular.Parser = Parser;\n\t\treturn Parser;\n\t}( circular, create, hasOwn, conditional, flattenExpression );\n\n\t/* parse/converters/mustache/delimiterChange.js */\n\tvar delimiterChange = function() {\n\n\t\tvar delimiterChangePattern = /^[^\\s=]+/,\n\t\t\twhitespacePattern = /^\\s+/;\n\t\treturn function( parser ) {\n\t\t\tvar start, opening, closing;\n\t\t\tif ( !parser.matchString( '=' ) ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tstart = parser.pos;\n\t\t\t// allow whitespace before new opening delimiter\n\t\t\tparser.allowWhitespace();\n\t\t\topening = parser.matchPattern( delimiterChangePattern );\n\t\t\tif ( !opening ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\t// allow whitespace (in fact, it's necessary...)\n\t\t\tif ( !parser.matchPattern( whitespacePattern ) ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tclosing = parser.matchPattern( delimiterChangePattern );\n\t\t\tif ( !closing ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\t// allow whitespace before closing '='\n\t\t\tparser.allowWhitespace();\n\t\t\tif ( !parser.matchString( '=' ) ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn [\n\t\t\t\topening,\n\t\t\t\tclosing\n\t\t\t];\n\t\t};\n\t}();\n\n\t/* parse/converters/mustache/delimiterTypes.js */\n\tvar delimiterTypes = [ {\n\t\tdelimiters: 'delimiters',\n\t\tisTriple: false,\n\t\tisStatic: false\n\t}, {\n\t\tdelimiters: 'tripleDelimiters',\n\t\tisTriple: true,\n\t\tisStatic: false\n\t}, {\n\t\tdelimiters: 'staticDelimiters',\n\t\tisTriple: false,\n\t\tisStatic: true\n\t}, {\n\t\tdelimiters: 'staticTripleDelimiters',\n\t\tisTriple: true,\n\t\tisStatic: true\n\t} ];\n\n\t/* parse/converters/mustache/type.js */\n\tvar type = function( types ) {\n\n\t\tvar mustacheTypes = {\n\t\t\t'#': types.SECTION,\n\t\t\t'^': types.INVERTED,\n\t\t\t'/': types.CLOSING,\n\t\t\t'>': types.PARTIAL,\n\t\t\t'!': types.COMMENT,\n\t\t\t'&': types.TRIPLE\n\t\t};\n\t\treturn function( parser ) {\n\t\t\tvar type = mustacheTypes[ parser.str.charAt( parser.pos ) ];\n\t\t\tif ( !type ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tparser.pos += 1;\n\t\t\treturn type;\n\t\t};\n\t}( types );\n\n\t/* parse/converters/mustache/handlebarsBlockCodes.js */\n\tvar handlebarsBlockCodes = function( types ) {\n\n\t\treturn {\n\t\t\t'each': types.SECTION_EACH,\n\t\t\t'if': types.SECTION_IF,\n\t\t\t'if-with': types.SECTION_IF_WITH,\n\t\t\t'with': types.SECTION_WITH,\n\t\t\t'unless': types.SECTION_UNLESS\n\t\t};\n\t}( types );\n\n\t/* empty/legacy.js */\n\tvar legacy = null;\n\n\t/* parse/converters/mustache/content.js */\n\tvar content = function( types, mustacheType, handlebarsBlockCodes ) {\n\n\t\tvar __export;\n\t\tvar indexRefPattern = /^\\s*:\\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/,\n\t\t\tarrayMemberPattern = /^[0-9][1-9]*$/,\n\t\t\thandlebarsBlockPattern = new RegExp( '^(' + Object.keys( handlebarsBlockCodes ).join( '|' ) + ')\\\\b' ),\n\t\t\tlegalReference;\n\t\tlegalReference = /^[a-zA-Z$_0-9]+(?:(\\.[a-zA-Z$_0-9]+)|(\\[[a-zA-Z$_0-9]+\\]))*$/;\n\t\t__export = function( parser, delimiterType ) {\n\t\t\tvar start, pos, mustache, type, block, expression, i, remaining, index, delimiters;\n\t\t\tstart = parser.pos;\n\t\t\tmustache = {};\n\t\t\tdelimiters = parser[ delimiterType.delimiters ];\n\t\t\tif ( delimiterType.isStatic ) {\n\t\t\t\tmustache.s = true;\n\t\t\t}\n\t\t\t// Determine mustache type\n\t\t\tif ( delimiterType.isTriple ) {\n\t\t\t\tmustache.t = types.TRIPLE;\n\t\t\t} else {\n\t\t\t\t// We need to test for expressions before we test for mustache type, because\n\t\t\t\t// an expression that begins '!' looks a lot like a comment\n\t\t\t\tif ( parser.remaining()[ 0 ] === '!' ) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\texpression = parser.readExpression();\n\t\t\t\t\t\t// Was it actually an expression, or a comment block in disguise?\n\t\t\t\t\t\tparser.allowWhitespace();\n\t\t\t\t\t\tif ( parser.remaining().indexOf( delimiters[ 1 ] ) ) {\n\t\t\t\t\t\t\texpression = null;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmustache.t = types.INTERPOLATOR;\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch ( err ) {}\n\t\t\t\t\tif ( !expression ) {\n\t\t\t\t\t\tindex = parser.remaining().indexOf( delimiters[ 1 ] );\n\t\t\t\t\t\tif ( ~index ) {\n\t\t\t\t\t\t\tparser.pos += index;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tparser.error( 'Expected closing delimiter (\\'' + delimiters[ 1 ] + '\\')' );\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tt: types.COMMENT\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( !expression ) {\n\t\t\t\t\ttype = mustacheType( parser );\n\t\t\t\t\tmustache.t = type || types.INTERPOLATOR;\n\t\t\t\t\t// default\n\t\t\t\t\t// See if there's an explicit section type e.g. {{#with}}...{{/with}}\n\t\t\t\t\tif ( type === types.SECTION ) {\n\t\t\t\t\t\tif ( block = parser.matchPattern( handlebarsBlockPattern ) ) {\n\t\t\t\t\t\t\tmustache.n = block;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparser.allowWhitespace();\n\t\t\t\t\t} else if ( type === types.COMMENT || type === types.CLOSING ) {\n\t\t\t\t\t\tremaining = parser.remaining();\n\t\t\t\t\t\tindex = remaining.indexOf( delimiters[ 1 ] );\n\t\t\t\t\t\tif ( index !== -1 ) {\n\t\t\t\t\t\t\tmustache.r = remaining.substr( 0, index ).split( ' ' )[ 0 ];\n\t\t\t\t\t\t\tparser.pos += index;\n\t\t\t\t\t\t\treturn mustache;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( !expression ) {\n\t\t\t\t// allow whitespace\n\t\t\t\tparser.allowWhitespace();\n\t\t\t\t// get expression\n\t\t\t\texpression = parser.readExpression();\n\t\t\t\t// If this is a partial, it may have a context (e.g. `{{>item foo}}`). These\n\t\t\t\t// cases involve a bit of a hack - we want to turn it into the equivalent of\n\t\t\t\t// `{{#with foo}}{{>item}}{{/with}}`, but to get there we temporarily append\n\t\t\t\t// a 'contextPartialExpression' to the mustache, and process the context instead of\n\t\t\t\t// the reference\n\t\t\t\tvar temp;\n\t\t\t\tif ( mustache.t === types.PARTIAL && expression && ( temp = parser.readExpression() ) ) {\n\t\t\t\t\tmustache = {\n\t\t\t\t\t\tcontextPartialExpression: expression\n\t\t\t\t\t};\n\t\t\t\t\texpression = temp;\n\t\t\t\t}\n\t\t\t\t// With certain valid references that aren't valid expressions,\n\t\t\t\t// e.g. {{1.foo}}, we have a problem: it looks like we've got an\n\t\t\t\t// expression, but the expression didn't consume the entire\n\t\t\t\t// reference. So we need to check that the mustache delimiters\n\t\t\t\t// appear next, unless there's an index reference (i.e. a colon)\n\t\t\t\tremaining = parser.remaining();\n\t\t\t\tif ( remaining.substr( 0, delimiters[ 1 ].length ) !== delimiters[ 1 ] && remaining.charAt( 0 ) !== ':' ) {\n\t\t\t\t\tpos = parser.pos;\n\t\t\t\t\tparser.pos = start;\n\t\t\t\t\tremaining = parser.remaining();\n\t\t\t\t\tindex = remaining.indexOf( delimiters[ 1 ] );\n\t\t\t\t\tif ( index !== -1 ) {\n\t\t\t\t\t\tmustache.r = remaining.substr( 0, index ).trim();\n\t\t\t\t\t\t// Check it's a legal reference\n\t\t\t\t\t\tif ( !legalReference.test( mustache.r ) ) {\n\t\t\t\t\t\t\tparser.error( 'Expected a legal Mustache reference' );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparser.pos += index;\n\t\t\t\t\t\treturn mustache;\n\t\t\t\t\t}\n\t\t\t\t\tparser.pos = pos;\n\t\t\t\t}\n\t\t\t}\n\t\t\trefineExpression( parser, expression, mustache );\n\t\t\t// if there was context, process the expression now and save it for later\n\t\t\tif ( mustache.contextPartialExpression ) {\n\t\t\t\tmustache.contextPartialExpression = [ refineExpression( parser, mustache.contextPartialExpression, {\n\t\t\t\t\tt: types.PARTIAL\n\t\t\t\t} ) ];\n\t\t\t}\n\t\t\t// optional index reference\n\t\t\tif ( i = parser.matchPattern( indexRefPattern ) ) {\n\t\t\t\tmustache.i = i;\n\t\t\t}\n\t\t\treturn mustache;\n\t\t};\n\n\t\tfunction refineExpression( parser, expression, mustache ) {\n\t\t\tvar referenceExpression;\n\t\t\tif ( expression ) {\n\t\t\t\twhile ( expression.t === types.BRACKETED && expression.x ) {\n\t\t\t\t\texpression = expression.x;\n\t\t\t\t}\n\t\t\t\t// special case - integers should be treated as array members references,\n\t\t\t\t// rather than as expressions in their own right\n\t\t\t\tif ( expression.t === types.REFERENCE ) {\n\t\t\t\t\tmustache.r = expression.n;\n\t\t\t\t} else {\n\t\t\t\t\tif ( expression.t === types.NUMBER_LITERAL && arrayMemberPattern.test( expression.v ) ) {\n\t\t\t\t\t\tmustache.r = expression.v;\n\t\t\t\t\t} else if ( referenceExpression = getReferenceExpression( parser, expression ) ) {\n\t\t\t\t\t\tmustache.rx = referenceExpression;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmustache.x = parser.flattenExpression( expression );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn mustache;\n\t\t\t}\n\t\t}\n\t\t// TODO refactor this! it's bewildering\n\t\tfunction getReferenceExpression( parser, expression ) {\n\t\t\tvar members = [],\n\t\t\t\trefinement;\n\t\t\twhile ( expression.t === types.MEMBER && expression.r.t === types.REFINEMENT ) {\n\t\t\t\trefinement = expression.r;\n\t\t\t\tif ( refinement.x ) {\n\t\t\t\t\tif ( refinement.x.t === types.REFERENCE ) {\n\t\t\t\t\t\tmembers.unshift( refinement.x );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmembers.unshift( parser.flattenExpression( refinement.x ) );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tmembers.unshift( refinement.n );\n\t\t\t\t}\n\t\t\t\texpression = expression.x;\n\t\t\t}\n\t\t\tif ( expression.t !== types.REFERENCE ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tr: expression.n,\n\t\t\t\tm: members\n\t\t\t};\n\t\t}\n\t\treturn __export;\n\t}( types, type, handlebarsBlockCodes, legacy );\n\n\t/* parse/converters/mustache.js */\n\tvar mustache = function( types, delimiterChange, delimiterTypes, mustacheContent, handlebarsBlockCodes ) {\n\n\t\tvar __export;\n\t\tvar delimiterChangeToken = {\n\t\t\tt: types.DELIMCHANGE,\n\t\t\texclude: true\n\t\t};\n\t\t__export = getMustache;\n\n\t\tfunction getMustache( parser ) {\n\t\t\tvar types;\n\t\t\t// If we're inside a <script> or <style> tag, and we're not\n\t\t\t// interpolating, bug out\n\t\t\tif ( parser.interpolate[ parser.inside ] === false ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\ttypes = delimiterTypes.slice().sort( function compare( a, b ) {\n\t\t\t\t// Sort in order of descending opening delimiter length (longer first),\n\t\t\t\t// to protect against opening delimiters being substrings of each other\n\t\t\t\treturn parser[ b.delimiters ][ 0 ].length - parser[ a.delimiters ][ 0 ].length;\n\t\t\t} );\n\t\t\treturn function r( type ) {\n\t\t\t\tif ( !type ) {\n\t\t\t\t\treturn null;\n\t\t\t\t} else {\n\t\t\t\t\treturn getMustacheOfType( parser, type ) || r( types.shift() );\n\t\t\t\t}\n\t\t\t}( types.shift() );\n\t\t}\n\n\t\tfunction getMustacheOfType( parser, delimiterType ) {\n\t\t\tvar start, mustache, delimiters, children, expectedClose, elseChildren, currentChildren, child;\n\t\t\tstart = parser.pos;\n\t\t\tdelimiters = parser[ delimiterType.delimiters ];\n\t\t\tif ( !parser.matchString( delimiters[ 0 ] ) ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\t// delimiter change?\n\t\t\tif ( mustache = delimiterChange( parser ) ) {\n\t\t\t\t// find closing delimiter or abort...\n\t\t\t\tif ( !parser.matchString( delimiters[ 1 ] ) ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\t// ...then make the switch\n\t\t\t\tparser[ delimiterType.delimiters ] = mustache;\n\t\t\t\treturn delimiterChangeToken;\n\t\t\t}\n\t\t\tparser.allowWhitespace();\n\t\t\tmustache = mustacheContent( parser, delimiterType );\n\t\t\tif ( mustache === null ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\t// allow whitespace before closing delimiter\n\t\t\tparser.allowWhitespace();\n\t\t\tif ( !parser.matchString( delimiters[ 1 ] ) ) {\n\t\t\t\tparser.error( 'Expected closing delimiter \\'' + delimiters[ 1 ] + '\\' after reference' );\n\t\t\t}\n\t\t\tif ( mustache.t === types.COMMENT ) {\n\t\t\t\tmustache.exclude = true;\n\t\t\t}\n\t\t\tif ( mustache.t === types.CLOSING ) {\n\t\t\t\tparser.sectionDepth -= 1;\n\t\t\t\tif ( parser.sectionDepth < 0 ) {\n\t\t\t\t\tparser.pos = start;\n\t\t\t\t\tparser.error( 'Attempted to close a section that wasn\\'t open' );\n\t\t\t\t}\n\t\t\t}\n\t\t\t// partials with context\n\t\t\tif ( mustache.contextPartialExpression ) {\n\t\t\t\tmustache.f = mustache.contextPartialExpression;\n\t\t\t\tmustache.t = types.SECTION;\n\t\t\t\tmustache.n = 'with';\n\t\t\t\tdelete mustache.contextPartialExpression;\n\t\t\t} else if ( isSection( mustache ) ) {\n\t\t\t\tparser.sectionDepth += 1;\n\t\t\t\tchildren = [];\n\t\t\t\tcurrentChildren = children;\n\t\t\t\texpectedClose = mustache.n;\n\t\t\t\twhile ( child = parser.read() ) {\n\t\t\t\t\tif ( child.t === types.CLOSING ) {\n\t\t\t\t\t\tif ( expectedClose && child.r !== expectedClose ) {\n\t\t\t\t\t\t\tparser.error( 'Expected {{/' + expectedClose + '}}' );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\t// {{else}} tags require special treatment\n\t\t\t\t\tif ( child.t === types.INTERPOLATOR && child.r === 'else' ) {\n\t\t\t\t\t\t// no {{else}} allowed in {{#unless}}\n\t\t\t\t\t\tif ( mustache.n === 'unless' ) {\n\t\t\t\t\t\t\tparser.error( '{{else}} not allowed in {{#unless}}' );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcurrentChildren = elseChildren = [];\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcurrentChildren.push( child );\n\t\t\t\t}\n\t\t\t\tif ( children.length ) {\n\t\t\t\t\tmustache.f = children;\n\t\t\t\t}\n\t\t\t\tif ( elseChildren && elseChildren.length ) {\n\t\t\t\t\tmustache.l = elseChildren;\n\t\t\t\t\tif ( mustache.n === 'with' ) {\n\t\t\t\t\t\tmustache.n = 'if-with';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( parser.includeLinePositions ) {\n\t\t\t\tmustache.p = parser.getLinePos( start );\n\t\t\t}\n\t\t\t// Replace block name with code\n\t\t\tif ( mustache.n ) {\n\t\t\t\tmustache.n = handlebarsBlockCodes[ mustache.n ];\n\t\t\t} else if ( mustache.t === types.INVERTED ) {\n\t\t\t\tmustache.t = types.SECTION;\n\t\t\t\tmustache.n = types.SECTION_UNLESS;\n\t\t\t}\n\t\t\treturn mustache;\n\t\t}\n\n\t\tfunction isSection( mustache ) {\n\t\t\treturn mustache.t === types.SECTION || mustache.t === types.INVERTED;\n\t\t}\n\t\treturn __export;\n\t}( types, delimiterChange, delimiterTypes, content, handlebarsBlockCodes );\n\n\t/* parse/converters/comment.js */\n\tvar comment = function( types ) {\n\n\t\tvar OPEN_COMMENT = '<!--',\n\t\t\tCLOSE_COMMENT = '-->';\n\t\treturn function( parser ) {\n\t\t\tvar start, content, remaining, endIndex, comment;\n\t\t\tstart = parser.pos;\n\t\t\tif ( !parser.matchString( OPEN_COMMENT ) ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tremaining = parser.remaining();\n\t\t\tendIndex = remaining.indexOf( CLOSE_COMMENT );\n\t\t\tif ( endIndex === -1 ) {\n\t\t\t\tparser.error( 'Illegal HTML - expected closing comment sequence (\\'-->\\')' );\n\t\t\t}\n\t\t\tcontent = remaining.substr( 0, endIndex );\n\t\t\tparser.pos += endIndex + 3;\n\t\t\tcomment = {\n\t\t\t\tt: types.COMMENT,\n\t\t\t\tc: content\n\t\t\t};\n\t\t\tif ( parser.includeLinePositions ) {\n\t\t\t\tcomment.p = parser.getLinePos( start );\n\t\t\t}\n\t\t\treturn comment;\n\t\t};\n\t}( types );\n\n\t/* config/voidElementNames.js */\n\tvar voidElementNames = function() {\n\n\t\tvar voidElementNames = /^(?:area|base|br|col|command|doctype|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i;\n\t\treturn voidElementNames;\n\t}();\n\n\t/* parse/converters/utils/getLowestIndex.js */\n\tvar getLowestIndex = function( haystack, needles ) {\n\t\tvar i, index, lowest;\n\t\ti = needles.length;\n\t\twhile ( i-- ) {\n\t\t\tindex = haystack.indexOf( needles[ i ] );\n\t\t\t// short circuit\n\t\t\tif ( !index ) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif ( index === -1 ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif ( !lowest || index < lowest ) {\n\t\t\t\tlowest = index;\n\t\t\t}\n\t\t}\n\t\treturn lowest || -1;\n\t};\n\n\t/* shared/decodeCharacterReferences.js */\n\tvar decodeCharacterReferences = function() {\n\n\t\tvar __export;\n\t\tvar htmlEntities, controlCharacters, entityPattern;\n\t\thtmlEntities = {\n\t\t\tquot: 34,\n\t\t\tamp: 38,\n\t\t\tapos: 39,\n\t\t\tlt: 60,\n\t\t\tgt: 62,\n\t\t\tnbsp: 160,\n\t\t\tiexcl: 161,\n\t\t\tcent: 162,\n\t\t\tpound: 163,\n\t\t\tcurren: 164,\n\t\t\tyen: 165,\n\t\t\tbrvbar: 166,\n\t\t\tsect: 167,\n\t\t\tuml: 168,\n\t\t\tcopy: 169,\n\t\t\tordf: 170,\n\t\t\tlaquo: 171,\n\t\t\tnot: 172,\n\t\t\tshy: 173,\n\t\t\treg: 174,\n\t\t\tmacr: 175,\n\t\t\tdeg: 176,\n\t\t\tplusmn: 177,\n\t\t\tsup2: 178,\n\t\t\tsup3: 179,\n\t\t\tacute: 180,\n\t\t\tmicro: 181,\n\t\t\tpara: 182,\n\t\t\tmiddot: 183,\n\t\t\tcedil: 184,\n\t\t\tsup1: 185,\n\t\t\tordm: 186,\n\t\t\traquo: 187,\n\t\t\tfrac14: 188,\n\t\t\tfrac12: 189,\n\t\t\tfrac34: 190,\n\t\t\tiquest: 191,\n\t\t\tAgrave: 192,\n\t\t\tAacute: 193,\n\t\t\tAcirc: 194,\n\t\t\tAtilde: 195,\n\t\t\tAuml: 196,\n\t\t\tAring: 197,\n\t\t\tAElig: 198,\n\t\t\tCcedil: 199,\n\t\t\tEgrave: 200,\n\t\t\tEacute: 201,\n\t\t\tEcirc: 202,\n\t\t\tEuml: 203,\n\t\t\tIgrave: 204,\n\t\t\tIacute: 205,\n\t\t\tIcirc: 206,\n\t\t\tIuml: 207,\n\t\t\tETH: 208,\n\t\t\tNtilde: 209,\n\t\t\tOgrave: 210,\n\t\t\tOacute: 211,\n\t\t\tOcirc: 212,\n\t\t\tOtilde: 213,\n\t\t\tOuml: 214,\n\t\t\ttimes: 215,\n\t\t\tOslash: 216,\n\t\t\tUgrave: 217,\n\t\t\tUacute: 218,\n\t\t\tUcirc: 219,\n\t\t\tUuml: 220,\n\t\t\tYacute: 221,\n\t\t\tTHORN: 222,\n\t\t\tszlig: 223,\n\t\t\tagrave: 224,\n\t\t\taacute: 225,\n\t\t\tacirc: 226,\n\t\t\tatilde: 227,\n\t\t\tauml: 228,\n\t\t\taring: 229,\n\t\t\taelig: 230,\n\t\t\tccedil: 231,\n\t\t\tegrave: 232,\n\t\t\teacute: 233,\n\t\t\tecirc: 234,\n\t\t\teuml: 235,\n\t\t\tigrave: 236,\n\t\t\tiacute: 237,\n\t\t\ticirc: 238,\n\t\t\tiuml: 239,\n\t\t\teth: 240,\n\t\t\tntilde: 241,\n\t\t\tograve: 242,\n\t\t\toacute: 243,\n\t\t\tocirc: 244,\n\t\t\totilde: 245,\n\t\t\touml: 246,\n\t\t\tdivide: 247,\n\t\t\toslash: 248,\n\t\t\tugrave: 249,\n\t\t\tuacute: 250,\n\t\t\tucirc: 251,\n\t\t\tuuml: 252,\n\t\t\tyacute: 253,\n\t\t\tthorn: 254,\n\t\t\tyuml: 255,\n\t\t\tOElig: 338,\n\t\t\toelig: 339,\n\t\t\tScaron: 352,\n\t\t\tscaron: 353,\n\t\t\tYuml: 376,\n\t\t\tfnof: 402,\n\t\t\tcirc: 710,\n\t\t\ttilde: 732,\n\t\t\tAlpha: 913,\n\t\t\tBeta: 914,\n\t\t\tGamma: 915,\n\t\t\tDelta: 916,\n\t\t\tEpsilon: 917,\n\t\t\tZeta: 918,\n\t\t\tEta: 919,\n\t\t\tTheta: 920,\n\t\t\tIota: 921,\n\t\t\tKappa: 922,\n\t\t\tLambda: 923,\n\t\t\tMu: 924,\n\t\t\tNu: 925,\n\t\t\tXi: 926,\n\t\t\tOmicron: 927,\n\t\t\tPi: 928,\n\t\t\tRho: 929,\n\t\t\tSigma: 931,\n\t\t\tTau: 932,\n\t\t\tUpsilon: 933,\n\t\t\tPhi: 934,\n\t\t\tChi: 935,\n\t\t\tPsi: 936,\n\t\t\tOmega: 937,\n\t\t\talpha: 945,\n\t\t\tbeta: 946,\n\t\t\tgamma: 947,\n\t\t\tdelta: 948,\n\t\t\tepsilon: 949,\n\t\t\tzeta: 950,\n\t\t\teta: 951,\n\t\t\ttheta: 952,\n\t\t\tiota: 953,\n\t\t\tkappa: 954,\n\t\t\tlambda: 955,\n\t\t\tmu: 956,\n\t\t\tnu: 957,\n\t\t\txi: 958,\n\t\t\tomicron: 959,\n\t\t\tpi: 960,\n\t\t\trho: 961,\n\t\t\tsigmaf: 962,\n\t\t\tsigma: 963,\n\t\t\ttau: 964,\n\t\t\tupsilon: 965,\n\t\t\tphi: 966,\n\t\t\tchi: 967,\n\t\t\tpsi: 968,\n\t\t\tomega: 969,\n\t\t\tthetasym: 977,\n\t\t\tupsih: 978,\n\t\t\tpiv: 982,\n\t\t\tensp: 8194,\n\t\t\temsp: 8195,\n\t\t\tthinsp: 8201,\n\t\t\tzwnj: 8204,\n\t\t\tzwj: 8205,\n\t\t\tlrm: 8206,\n\t\t\trlm: 8207,\n\t\t\tndash: 8211,\n\t\t\tmdash: 8212,\n\t\t\tlsquo: 8216,\n\t\t\trsquo: 8217,\n\t\t\tsbquo: 8218,\n\t\t\tldquo: 8220,\n\t\t\trdquo: 8221,\n\t\t\tbdquo: 8222,\n\t\t\tdagger: 8224,\n\t\t\tDagger: 8225,\n\t\t\tbull: 8226,\n\t\t\thellip: 8230,\n\t\t\tpermil: 8240,\n\t\t\tprime: 8242,\n\t\t\tPrime: 8243,\n\t\t\tlsaquo: 8249,\n\t\t\trsaquo: 8250,\n\t\t\toline: 8254,\n\t\t\tfrasl: 8260,\n\t\t\teuro: 8364,\n\t\t\timage: 8465,\n\t\t\tweierp: 8472,\n\t\t\treal: 8476,\n\t\t\ttrade: 8482,\n\t\t\talefsym: 8501,\n\t\t\tlarr: 8592,\n\t\t\tuarr: 8593,\n\t\t\trarr: 8594,\n\t\t\tdarr: 8595,\n\t\t\tharr: 8596,\n\t\t\tcrarr: 8629,\n\t\t\tlArr: 8656,\n\t\t\tuArr: 8657,\n\t\t\trArr: 8658,\n\t\t\tdArr: 8659,\n\t\t\thArr: 8660,\n\t\t\tforall: 8704,\n\t\t\tpart: 8706,\n\t\t\texist: 8707,\n\t\t\tempty: 8709,\n\t\t\tnabla: 8711,\n\t\t\tisin: 8712,\n\t\t\tnotin: 8713,\n\t\t\tni: 8715,\n\t\t\tprod: 8719,\n\t\t\tsum: 8721,\n\t\t\tminus: 8722,\n\t\t\tlowast: 8727,\n\t\t\tradic: 8730,\n\t\t\tprop: 8733,\n\t\t\tinfin: 8734,\n\t\t\tang: 8736,\n\t\t\tand: 8743,\n\t\t\tor: 8744,\n\t\t\tcap: 8745,\n\t\t\tcup: 8746,\n\t\t\t'int': 8747,\n\t\t\tthere4: 8756,\n\t\t\tsim: 8764,\n\t\t\tcong: 8773,\n\t\t\tasymp: 8776,\n\t\t\tne: 8800,\n\t\t\tequiv: 8801,\n\t\t\tle: 8804,\n\t\t\tge: 8805,\n\t\t\tsub: 8834,\n\t\t\tsup: 8835,\n\t\t\tnsub: 8836,\n\t\t\tsube: 8838,\n\t\t\tsupe: 8839,\n\t\t\toplus: 8853,\n\t\t\totimes: 8855,\n\t\t\tperp: 8869,\n\t\t\tsdot: 8901,\n\t\t\tlceil: 8968,\n\t\t\trceil: 8969,\n\t\t\tlfloor: 8970,\n\t\t\trfloor: 8971,\n\t\t\tlang: 9001,\n\t\t\trang: 9002,\n\t\t\tloz: 9674,\n\t\t\tspades: 9824,\n\t\t\tclubs: 9827,\n\t\t\thearts: 9829,\n\t\t\tdiams: 9830\n\t\t};\n\t\tcontrolCharacters = [\n\t\t\t8364,\n\t\t\t129,\n\t\t\t8218,\n\t\t\t402,\n\t\t\t8222,\n\t\t\t8230,\n\t\t\t8224,\n\t\t\t8225,\n\t\t\t710,\n\t\t\t8240,\n\t\t\t352,\n\t\t\t8249,\n\t\t\t338,\n\t\t\t141,\n\t\t\t381,\n\t\t\t143,\n\t\t\t144,\n\t\t\t8216,\n\t\t\t8217,\n\t\t\t8220,\n\t\t\t8221,\n\t\t\t8226,\n\t\t\t8211,\n\t\t\t8212,\n\t\t\t732,\n\t\t\t8482,\n\t\t\t353,\n\t\t\t8250,\n\t\t\t339,\n\t\t\t157,\n\t\t\t382,\n\t\t\t376\n\t\t];\n\t\tentityPattern = new RegExp( '&(#?(?:x[\\\\w\\\\d]+|\\\\d+|' + Object.keys( htmlEntities ).join( '|' ) + '));?', 'g' );\n\t\t__export = function decodeCharacterReferences( html ) {\n\t\t\treturn html.replace( entityPattern, function( match, entity ) {\n\t\t\t\tvar code;\n\t\t\t\t// Handle named entities\n\t\t\t\tif ( entity[ 0 ] !== '#' ) {\n\t\t\t\t\tcode = htmlEntities[ entity ];\n\t\t\t\t} else if ( entity[ 1 ] === 'x' ) {\n\t\t\t\t\tcode = parseInt( entity.substring( 2 ), 16 );\n\t\t\t\t} else {\n\t\t\t\t\tcode = parseInt( entity.substring( 1 ), 10 );\n\t\t\t\t}\n\t\t\t\tif ( !code ) {\n\t\t\t\t\treturn match;\n\t\t\t\t}\n\t\t\t\treturn String.fromCharCode( validateCode( code ) );\n\t\t\t} );\n\t\t};\n\t\t// some code points are verboten. If we were inserting HTML, the browser would replace the illegal\n\t\t// code points with alternatives in some cases - since we're bypassing that mechanism, we need\n\t\t// to replace them ourselves\n\t\t//\n\t\t// Source: http://en.wikipedia.org/wiki/Character_encodings_in_HTML#Illegal_characters\n\t\tfunction validateCode( code ) {\n\t\t\tif ( !code ) {\n\t\t\t\treturn 65533;\n\t\t\t}\n\t\t\t// line feed becomes generic whitespace\n\t\t\tif ( code === 10 ) {\n\t\t\t\treturn 32;\n\t\t\t}\n\t\t\t// ASCII range. (Why someone would use HTML entities for ASCII characters I don't know, but...)\n\t\t\tif ( code < 128 ) {\n\t\t\t\treturn code;\n\t\t\t}\n\t\t\t// code points 128-159 are dealt with leniently by browsers, but they're incorrect. We need\n\t\t\t// to correct the mistake or we'll end up with missing  signs and so on\n\t\t\tif ( code <= 159 ) {\n\t\t\t\treturn controlCharacters[ code - 128 ];\n\t\t\t}\n\t\t\t// basic multilingual plane\n\t\t\tif ( code < 55296 ) {\n\t\t\t\treturn code;\n\t\t\t}\n\t\t\t// UTF-16 surrogate halves\n\t\t\tif ( code <= 57343 ) {\n\t\t\t\treturn 65533;\n\t\t\t}\n\t\t\t// rest of the basic multilingual plane\n\t\t\tif ( code <= 65535 ) {\n\t\t\t\treturn code;\n\t\t\t}\n\t\t\treturn 65533;\n\t\t}\n\t\treturn __export;\n\t}( legacy );\n\n\t/* parse/converters/text.js */\n\tvar text = function( getLowestIndex, decodeCharacterReferences ) {\n\n\t\treturn function( parser ) {\n\t\t\tvar index, remaining, disallowed, barrier;\n\t\t\tremaining = parser.remaining();\n\t\t\tbarrier = parser.inside ? '</' + parser.inside : '<';\n\t\t\tif ( parser.inside && !parser.interpolate[ parser.inside ] ) {\n\t\t\t\tindex = remaining.indexOf( barrier );\n\t\t\t} else {\n\t\t\t\tdisallowed = [\n\t\t\t\t\tparser.delimiters[ 0 ],\n\t\t\t\t\tparser.tripleDelimiters[ 0 ],\n\t\t\t\t\tparser.staticDelimiters[ 0 ],\n\t\t\t\t\tparser.staticTripleDelimiters[ 0 ]\n\t\t\t\t];\n\t\t\t\t// http://developers.whatwg.org/syntax.html#syntax-attributes\n\t\t\t\tif ( parser.inAttribute === true ) {\n\t\t\t\t\t// we're inside an unquoted attribute value\n\t\t\t\t\tdisallowed.push( '\"', '\\'', '=', '<', '>', '`' );\n\t\t\t\t} else if ( parser.inAttribute ) {\n\t\t\t\t\t// quoted attribute value\n\t\t\t\t\tdisallowed.push( parser.inAttribute );\n\t\t\t\t} else {\n\t\t\t\t\tdisallowed.push( barrier );\n\t\t\t\t}\n\t\t\t\tindex = getLowestIndex( remaining, disallowed );\n\t\t\t}\n\t\t\tif ( !index ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tif ( index === -1 ) {\n\t\t\t\tindex = remaining.length;\n\t\t\t}\n\t\t\tparser.pos += index;\n\t\t\treturn parser.inside ? remaining.substr( 0, index ) : decodeCharacterReferences( remaining.substr( 0, index ) );\n\t\t};\n\t}( getLowestIndex, decodeCharacterReferences );\n\n\t/* parse/converters/element/closingTag.js */\n\tvar closingTag = function( types ) {\n\n\t\tvar closingTagPattern = /^([a-zA-Z]{1,}:?[a-zA-Z0-9\\-]*)\\s*\\>/;\n\t\treturn function( parser ) {\n\t\t\tvar tag;\n\t\t\t// are we looking at a closing tag?\n\t\t\tif ( !parser.matchString( '</' ) ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tif ( tag = parser.matchPattern( closingTagPattern ) ) {\n\t\t\t\treturn {\n\t\t\t\t\tt: types.CLOSING_TAG,\n\t\t\t\t\te: tag\n\t\t\t\t};\n\t\t\t}\n\t\t\t// We have an illegal closing tag, report it\n\t\t\tparser.pos -= 2;\n\t\t\tparser.error( 'Illegal closing tag' );\n\t\t};\n\t}( types );\n\n\t/* parse/converters/element/attribute.js */\n\tvar attribute = function( getLowestIndex, getMustache, decodeCharacterReferences ) {\n\n\t\tvar __export;\n\t\tvar attributeNamePattern = /^[^\\s\"'>\\/=]+/,\n\t\t\tunquotedAttributeValueTextPattern = /^[^\\s\"'=<>`]+/;\n\t\t__export = getAttribute;\n\n\t\tfunction getAttribute( parser ) {\n\t\t\tvar attr, name, value;\n\t\t\tparser.allowWhitespace();\n\t\t\tname = parser.matchPattern( attributeNamePattern );\n\t\t\tif ( !name ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tattr = {\n\t\t\t\tname: name\n\t\t\t};\n\t\t\tvalue = getAttributeValue( parser );\n\t\t\tif ( value ) {\n\t\t\t\tattr.value = value;\n\t\t\t}\n\t\t\treturn attr;\n\t\t}\n\n\t\tfunction getAttributeValue( parser ) {\n\t\t\tvar start, valueStart, startDepth, value;\n\t\t\tstart = parser.pos;\n\t\t\tparser.allowWhitespace();\n\t\t\tif ( !parser.matchString( '=' ) ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tparser.allowWhitespace();\n\t\t\tvalueStart = parser.pos;\n\t\t\tstartDepth = parser.sectionDepth;\n\t\t\tvalue = getQuotedAttributeValue( parser, '\\'' ) || getQuotedAttributeValue( parser, '\"' ) || getUnquotedAttributeValue( parser );\n\t\t\tif ( parser.sectionDepth !== startDepth ) {\n\t\t\t\tparser.pos = valueStart;\n\t\t\t\tparser.error( 'An attribute value must contain as many opening section tags as closing section tags' );\n\t\t\t}\n\t\t\tif ( value === null ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tif ( !value.length ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tif ( value.length === 1 && typeof value[ 0 ] === 'string' ) {\n\t\t\t\treturn decodeCharacterReferences( value[ 0 ] );\n\t\t\t}\n\t\t\treturn value;\n\t\t}\n\n\t\tfunction getUnquotedAttributeValueToken( parser ) {\n\t\t\tvar start, text, haystack, needles, index;\n\t\t\tstart = parser.pos;\n\t\t\ttext = parser.matchPattern( unquotedAttributeValueTextPattern );\n\t\t\tif ( !text ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\thaystack = text;\n\t\t\tneedles = [\n\t\t\t\tparser.delimiters[ 0 ],\n\t\t\t\tparser.tripleDelimiters[ 0 ],\n\t\t\t\tparser.staticDelimiters[ 0 ],\n\t\t\t\tparser.staticTripleDelimiters[ 0 ]\n\t\t\t];\n\t\t\tif ( ( index = getLowestIndex( haystack, needles ) ) !== -1 ) {\n\t\t\t\ttext = text.substr( 0, index );\n\t\t\t\tparser.pos = start + text.length;\n\t\t\t}\n\t\t\treturn text;\n\t\t}\n\n\t\tfunction getUnquotedAttributeValue( parser ) {\n\t\t\tvar tokens, token;\n\t\t\tparser.inAttribute = true;\n\t\t\ttokens = [];\n\t\t\ttoken = getMustache( parser ) || getUnquotedAttributeValueToken( parser );\n\t\t\twhile ( token !== null ) {\n\t\t\t\ttokens.push( token );\n\t\t\t\ttoken = getMustache( parser ) || getUnquotedAttributeValueToken( parser );\n\t\t\t}\n\t\t\tif ( !tokens.length ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tparser.inAttribute = false;\n\t\t\treturn tokens;\n\t\t}\n\n\t\tfunction getQuotedAttributeValue( parser, quoteMark ) {\n\t\t\tvar start, tokens, token;\n\t\t\tstart = parser.pos;\n\t\t\tif ( !parser.matchString( quoteMark ) ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tparser.inAttribute = quoteMark;\n\t\t\ttokens = [];\n\t\t\ttoken = getMustache( parser ) || getQuotedStringToken( parser, quoteMark );\n\t\t\twhile ( token !== null ) {\n\t\t\t\ttokens.push( token );\n\t\t\t\ttoken = getMustache( parser ) || getQuotedStringToken( parser, quoteMark );\n\t\t\t}\n\t\t\tif ( !parser.matchString( quoteMark ) ) {\n\t\t\t\tparser.pos = start;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tparser.inAttribute = false;\n\t\t\treturn tokens;\n\t\t}\n\n\t\tfunction getQuotedStringToken( parser, quoteMark ) {\n\t\t\tvar start, index, haystack, needles;\n\t\t\tstart = parser.pos;\n\t\t\thaystack = parser.remaining();\n\t\t\tneedles = [\n\t\t\t\tquoteMark,\n\t\t\t\tparser.delimiters[ 0 ],\n\t\t\t\tparser.tripleDelimiters[ 0 ],\n\t\t\t\tparser.staticDelimiters[ 0 ],\n\t\t\t\tparser.staticTripleDelimiters[ 0 ]\n\t\t\t];\n\t\t\tindex = getLowestIndex( haystack, needles );\n\t\t\tif ( index === -1 ) {\n\t\t\t\tparser.error( 'Quoted attribute value must have a closing quote' );\n\t\t\t}\n\t\t\tif ( !index ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tparser.pos += index;\n\t\t\treturn haystack.substr( 0, index );\n\t\t}\n\t\treturn __export;\n\t}( getLowestIndex, mustache, decodeCharacterReferences );\n\n\t/* utils/parseJSON.js */\n\tvar parseJSON = function( Parser, getStringLiteral, getKey ) {\n\n\t\tvar JsonParser, specials, specialsPattern, numberPattern, placeholderPattern, placeholderAtStartPattern, onlyWhitespace;\n\t\tspecials = {\n\t\t\t'true': true,\n\t\t\t'false': false,\n\t\t\t'undefined': undefined,\n\t\t\t'null': null\n\t\t};\n\t\tspecialsPattern = new RegExp( '^(?:' + Object.keys( specials ).join( '|' ) + ')' );\n\t\tnumberPattern = /^(?:[+-]?)(?:(?:(?:0|[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\n\t\tplaceholderPattern = /\\$\\{([^\\}]+)\\}/g;\n\t\tplaceholderAtStartPattern = /^\\$\\{([^\\}]+)\\}/;\n\t\tonlyWhitespace = /^\\s*$/;\n\t\tJsonParser = Parser.extend( {\n\t\t\tinit: function( str, options ) {\n\t\t\t\tthis.values = options.values;\n\t\t\t\tthis.allowWhitespace();\n\t\t\t},\n\t\t\tpostProcess: function( result ) {\n\t\t\t\tif ( result.length !== 1 || !onlyWhitespace.test( this.leftover ) ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tvalue: result[ 0 ].v\n\t\t\t\t};\n\t\t\t},\n\t\t\tconverters: [\n\n\t\t\t\tfunction getPlaceholder( parser ) {\n\t\t\t\t\tvar placeholder;\n\t\t\t\t\tif ( !parser.values ) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\tplaceholder = parser.matchPattern( placeholderAtStartPattern );\n\t\t\t\t\tif ( placeholder && parser.values.hasOwnProperty( placeholder ) ) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tv: parser.values[ placeholder ]\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfunction getSpecial( parser ) {\n\t\t\t\t\tvar special;\n\t\t\t\t\tif ( special = parser.matchPattern( specialsPattern ) ) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tv: specials[ special ]\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfunction getNumber( parser ) {\n\t\t\t\t\tvar number;\n\t\t\t\t\tif ( number = parser.matchPattern( numberPattern ) ) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tv: +number\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfunction getString( parser ) {\n\t\t\t\t\tvar stringLiteral = getStringLiteral( parser ),\n\t\t\t\t\t\tvalues;\n\t\t\t\t\tif ( stringLiteral && ( values = parser.values ) ) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tv: stringLiteral.v.replace( placeholderPattern, function( match, $1 ) {\n\t\t\t\t\t\t\t\treturn $1 in values ? values[ $1 ] : $1;\n\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\treturn stringLiteral;\n\t\t\t\t},\n\t\t\t\tfunction getObject( parser ) {\n\t\t\t\t\tvar result, pair;\n\t\t\t\t\tif ( !parser.matchString( '{' ) ) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\tresult = {};\n\t\t\t\t\tparser.allowWhitespace();\n\t\t\t\t\tif ( parser.matchString( '}' ) ) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tv: result\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\twhile ( pair = getKeyValuePair( parser ) ) {\n\t\t\t\t\t\tresult[ pair.key ] = pair.value;\n\t\t\t\t\t\tparser.allowWhitespace();\n\t\t\t\t\t\tif ( parser.matchString( '}' ) ) {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tv: result\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( !parser.matchString( ',' ) ) {\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t},\n\t\t\t\tfunction getArray( parser ) {\n\t\t\t\t\tvar result, valueToken;\n\t\t\t\t\tif ( !parser.matchString( '[' ) ) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\tresult = [];\n\t\t\t\t\tparser.allowWhitespace();\n\t\t\t\t\tif ( parser.matchString( ']' ) ) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tv: result\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\twhile ( valueToken = parser.read() ) {\n\t\t\t\t\t\tresult.push( valueToken.v );\n\t\t\t\t\t\tparser.allowWhitespace();\n\t\t\t\t\t\tif ( parser.matchString( ']' ) ) {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tv: result\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( !parser.matchString( ',' ) ) {\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparser.allowWhitespace();\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t]\n\t\t} );\n\n\t\tfunction getKeyValuePair( parser ) {\n\t\t\tvar key, valueToken, pair;\n\t\t\tparser.allowWhitespace();\n\t\t\tkey = getKey( parser );\n\t\t\tif ( !key ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tpair = {\n\t\t\t\tkey: key\n\t\t\t};\n\t\t\tparser.allowWhitespace();\n\t\t\tif ( !parser.matchString( ':' ) ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tparser.allowWhitespace();\n\t\t\tvalueToken = parser.read();\n\t\t\tif ( !valueToken ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tpair.value = valueToken.v;\n\t\t\treturn pair;\n\t\t}\n\t\treturn function( str, values ) {\n\t\t\tvar parser = new JsonParser( str, {\n\t\t\t\tvalues: values\n\t\t\t} );\n\t\t\treturn parser.result;\n\t\t};\n\t}( Parser, stringLiteral, key );\n\n\t/* parse/converters/element/processDirective.js */\n\tvar processDirective = function( Parser, conditional, flattenExpression, parseJSON ) {\n\n\t\tvar methodCallPattern = /^([a-zA-Z_$][a-zA-Z_$0-9]*)\\(/,\n\t\t\tExpressionParser;\n\t\tExpressionParser = Parser.extend( {\n\t\t\tconverters: [ conditional ]\n\t\t} );\n\t\t// TODO clean this up, it's shocking\n\t\treturn function( tokens ) {\n\t\t\tvar result, match, parser, args, token, colonIndex, directiveName, directiveArgs, parsed;\n\t\t\tif ( typeof tokens === 'string' ) {\n\t\t\t\tif ( match = methodCallPattern.exec( tokens ) ) {\n\t\t\t\t\tresult = {\n\t\t\t\t\t\tm: match[ 1 ]\n\t\t\t\t\t};\n\t\t\t\t\targs = '[' + tokens.slice( result.m.length + 1, -1 ) + ']';\n\t\t\t\t\tparser = new ExpressionParser( args );\n\t\t\t\t\tresult.a = flattenExpression( parser.result[ 0 ] );\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t\tif ( tokens.indexOf( ':' ) === -1 ) {\n\t\t\t\t\treturn tokens.trim();\n\t\t\t\t}\n\t\t\t\ttokens = [ tokens ];\n\t\t\t}\n\t\t\tresult = {};\n\t\t\tdirectiveName = [];\n\t\t\tdirectiveArgs = [];\n\t\t\tif ( tokens ) {\n\t\t\t\twhile ( tokens.length ) {\n\t\t\t\t\ttoken = tokens.shift();\n\t\t\t\t\tif ( typeof token === 'string' ) {\n\t\t\t\t\t\tcolonIndex = token.indexOf( ':' );\n\t\t\t\t\t\tif ( colonIndex === -1 ) {\n\t\t\t\t\t\t\tdirectiveName.push( token );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// is the colon the first character?\n\t\t\t\t\t\t\tif ( colonIndex ) {\n\t\t\t\t\t\t\t\t// no\n\t\t\t\t\t\t\t\tdirectiveName.push( token.substr( 0, colonIndex ) );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// if there is anything after the colon in this token, treat\n\t\t\t\t\t\t\t// it as the first token of the directiveArgs fragment\n\t\t\t\t\t\t\tif ( token.length > colonIndex + 1 ) {\n\t\t\t\t\t\t\t\tdirectiveArgs[ 0 ] = token.substring( colonIndex + 1 );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdirectiveName.push( token );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdirectiveArgs = directiveArgs.concat( tokens );\n\t\t\t}\n\t\t\tif ( !directiveName.length ) {\n\t\t\t\tresult = '';\n\t\t\t} else if ( directiveArgs.length || typeof directiveName !== 'string' ) {\n\t\t\t\tresult = {\n\t\t\t\t\t// TODO is this really necessary? just use the array\n\t\t\t\t\tn: directiveName.length === 1 && typeof directiveName[ 0 ] === 'string' ? directiveName[ 0 ] : directiveName\n\t\t\t\t};\n\t\t\t\tif ( directiveArgs.length === 1 && typeof directiveArgs[ 0 ] === 'string' ) {\n\t\t\t\t\tparsed = parseJSON( '[' + directiveArgs[ 0 ] + ']' );\n\t\t\t\t\tresult.a = parsed ? parsed.value : directiveArgs[ 0 ].trim();\n\t\t\t\t} else {\n\t\t\t\t\tresult.d = directiveArgs;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresult = directiveName;\n\t\t\t}\n\t\t\treturn result;\n\t\t};\n\t}( Parser, conditional, flattenExpression, parseJSON );\n\n\t/* parse/converters/element.js */\n\tvar element = function( types, voidElementNames, getMustache, getComment, getText, getClosingTag, getAttribute, processDirective ) {\n\n\t\tvar __export;\n\t\tvar tagNamePattern = /^[a-zA-Z]{1,}:?[a-zA-Z0-9\\-]*/,\n\t\t\tvalidTagNameFollower = /^[\\s\\n\\/>]/,\n\t\t\tonPattern = /^on/,\n\t\t\tproxyEventPattern = /^on-([a-zA-Z\\\\*\\\\.$_][a-zA-Z\\\\*\\\\.$_0-9\\-]+)$/,\n\t\t\treservedEventNames = /^(?:change|reset|teardown|update|construct|config|init|render|unrender|detach|insert)$/,\n\t\t\tdirectives = {\n\t\t\t\t'intro-outro': 't0',\n\t\t\t\tintro: 't1',\n\t\t\t\toutro: 't2',\n\t\t\t\tdecorator: 'o'\n\t\t\t},\n\t\t\texclude = {\n\t\t\t\texclude: true\n\t\t\t},\n\t\t\tconverters, disallowedContents;\n\t\t// Different set of converters, because this time we're looking for closing tags\n\t\tconverters = [\n\t\t\tgetMustache,\n\t\t\tgetComment,\n\t\t\tgetElement,\n\t\t\tgetText,\n\t\t\tgetClosingTag\n\t\t];\n\t\t// based on http://developers.whatwg.org/syntax.html#syntax-tag-omission\n\t\tdisallowedContents = {\n\t\t\tli: [ 'li' ],\n\t\t\tdt: [\n\t\t\t\t'dt',\n\t\t\t\t'dd'\n\t\t\t],\n\t\t\tdd: [\n\t\t\t\t'dt',\n\t\t\t\t'dd'\n\t\t\t],\n\t\t\tp: 'address article aside blockquote div dl fieldset footer form h1 h2 h3 h4 h5 h6 header hgroup hr main menu nav ol p pre section table ul'.split( ' ' ),\n\t\t\trt: [\n\t\t\t\t'rt',\n\t\t\t\t'rp'\n\t\t\t],\n\t\t\trp: [\n\t\t\t\t'rt',\n\t\t\t\t'rp'\n\t\t\t],\n\t\t\toptgroup: [ 'optgroup' ],\n\t\t\toption: [\n\t\t\t\t'option',\n\t\t\t\t'optgroup'\n\t\t\t],\n\t\t\tthead: [\n\t\t\t\t'tbody',\n\t\t\t\t'tfoot'\n\t\t\t],\n\t\t\ttbody: [\n\t\t\t\t'tbody',\n\t\t\t\t'tfoot'\n\t\t\t],\n\t\t\ttfoot: [ 'tbody' ],\n\t\t\ttr: [\n\t\t\t\t'tr',\n\t\t\t\t'tbody'\n\t\t\t],\n\t\t\ttd: [\n\t\t\t\t'td',\n\t\t\t\t'th',\n\t\t\t\t'tr'\n\t\t\t],\n\t\t\tth: [\n\t\t\t\t'td',\n\t\t\t\t'th',\n\t\t\t\t'tr'\n\t\t\t]\n\t\t};\n\t\t__export = getElement;\n\n\t\tfunction getElement( parser ) {\n\t\t\tvar start, element, lowerCaseName, directiveName, match, addProxyEvent, attribute, directive, selfClosing, children, child;\n\t\t\tstart = parser.pos;\n\t\t\tif ( parser.inside || parser.inAttribute ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tif ( !parser.matchString( '<' ) ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\t// if this is a closing tag, abort straight away\n\t\t\tif ( parser.nextChar() === '/' ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\telement = {\n\t\t\t\tt: types.ELEMENT\n\t\t\t};\n\t\t\tif ( parser.includeLinePositions ) {\n\t\t\t\telement.p = parser.getLinePos( start );\n\t\t\t}\n\t\t\tif ( parser.matchString( '!' ) ) {\n\t\t\t\telement.y = 1;\n\t\t\t}\n\t\t\t// element name\n\t\t\telement.e = parser.matchPattern( tagNamePattern );\n\t\t\tif ( !element.e ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\t// next character must be whitespace, closing solidus or '>'\n\t\t\tif ( !validTagNameFollower.test( parser.nextChar() ) ) {\n\t\t\t\tparser.error( 'Illegal tag name' );\n\t\t\t}\n\t\t\taddProxyEvent = function( name, directive ) {\n\t\t\t\tvar directiveName = directive.n || directive;\n\t\t\t\tif ( reservedEventNames.test( directiveName ) ) {\n\t\t\t\t\tparser.pos -= directiveName.length;\n\t\t\t\t\tparser.error( 'Cannot use reserved event names (change, reset, teardown, update, construct, config, init, render, unrender, detach, insert)' );\n\t\t\t\t}\n\t\t\t\telement.v[ name ] = directive;\n\t\t\t};\n\t\t\tparser.allowWhitespace();\n\t\t\t// directives and attributes\n\t\t\twhile ( attribute = getMustache( parser ) || getAttribute( parser ) ) {\n\t\t\t\t// regular attributes\n\t\t\t\tif ( attribute.name ) {\n\t\t\t\t\t// intro, outro, decorator\n\t\t\t\t\tif ( directiveName = directives[ attribute.name ] ) {\n\t\t\t\t\t\telement[ directiveName ] = processDirective( attribute.value );\n\t\t\t\t\t} else if ( match = proxyEventPattern.exec( attribute.name ) ) {\n\t\t\t\t\t\tif ( !element.v )\n\t\t\t\t\t\t\telement.v = {};\n\t\t\t\t\t\tdirective = processDirective( attribute.value );\n\t\t\t\t\t\taddProxyEvent( match[ 1 ], directive );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif ( !parser.sanitizeEventAttributes || !onPattern.test( attribute.name ) ) {\n\t\t\t\t\t\t\tif ( !element.a )\n\t\t\t\t\t\t\t\telement.a = {};\n\t\t\t\t\t\t\telement.a[ attribute.name ] = attribute.value || 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ( !element.m )\n\t\t\t\t\t\telement.m = [];\n\t\t\t\t\telement.m.push( attribute );\n\t\t\t\t}\n\t\t\t\tparser.allowWhitespace();\n\t\t\t}\n\t\t\t// allow whitespace before closing solidus\n\t\t\tparser.allowWhitespace();\n\t\t\t// self-closing solidus?\n\t\t\tif ( parser.matchString( '/' ) ) {\n\t\t\t\tselfClosing = true;\n\t\t\t}\n\t\t\t// closing angle bracket\n\t\t\tif ( !parser.matchString( '>' ) ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tlowerCaseName = element.e.toLowerCase();\n\t\t\tif ( !selfClosing && !voidElementNames.test( element.e ) ) {\n\t\t\t\t// Special case - if we open a script element, further tags should\n\t\t\t\t// be ignored unless they're a closing script element\n\t\t\t\tif ( lowerCaseName === 'script' || lowerCaseName === 'style' ) {\n\t\t\t\t\tparser.inside = lowerCaseName;\n\t\t\t\t}\n\t\t\t\tchildren = [];\n\t\t\t\twhile ( canContain( lowerCaseName, parser.remaining() ) && ( child = parser.read( converters ) ) ) {\n\t\t\t\t\t// Special case - closing section tag\n\t\t\t\t\tif ( child.t === types.CLOSING ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif ( child.t === types.CLOSING_TAG ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tchildren.push( child );\n\t\t\t\t}\n\t\t\t\tif ( children.length ) {\n\t\t\t\t\telement.f = children;\n\t\t\t\t}\n\t\t\t}\n\t\t\tparser.inside = null;\n\t\t\tif ( parser.sanitizeElements && parser.sanitizeElements.indexOf( lowerCaseName ) !== -1 ) {\n\t\t\t\treturn exclude;\n\t\t\t}\n\t\t\treturn element;\n\t\t}\n\n\t\tfunction canContain( name, remaining ) {\n\t\t\tvar match, disallowed;\n\t\t\tmatch = /^<([a-zA-Z][a-zA-Z0-9]*)/.exec( remaining );\n\t\t\tdisallowed = disallowedContents[ name ];\n\t\t\tif ( !match || !disallowed ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn !~disallowed.indexOf( match[ 1 ].toLowerCase() );\n\t\t}\n\t\treturn __export;\n\t}( types, voidElementNames, mustache, comment, text, closingTag, attribute, processDirective );\n\n\t/* parse/utils/trimWhitespace.js */\n\tvar trimWhitespace = function() {\n\n\t\tvar leadingWhitespace = /^[ \\t\\f\\r\\n]+/,\n\t\t\ttrailingWhitespace = /[ \\t\\f\\r\\n]+$/;\n\t\treturn function( items, leading, trailing ) {\n\t\t\tvar item;\n\t\t\tif ( leading ) {\n\t\t\t\titem = items[ 0 ];\n\t\t\t\tif ( typeof item === 'string' ) {\n\t\t\t\t\titem = item.replace( leadingWhitespace, '' );\n\t\t\t\t\tif ( !item ) {\n\t\t\t\t\t\titems.shift();\n\t\t\t\t\t} else {\n\t\t\t\t\t\titems[ 0 ] = item;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( trailing ) {\n\t\t\t\titem = items[ items.length - 1 ];\n\t\t\t\tif ( typeof item === 'string' ) {\n\t\t\t\t\titem = item.replace( trailingWhitespace, '' );\n\t\t\t\t\tif ( !item ) {\n\t\t\t\t\t\titems.pop();\n\t\t\t\t\t} else {\n\t\t\t\t\t\titems[ items.length - 1 ] = item;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}();\n\n\t/* parse/utils/stripStandalones.js */\n\tvar stripStandalones = function( types ) {\n\n\t\tvar __export;\n\t\tvar leadingLinebreak = /^\\s*\\r?\\n/,\n\t\t\ttrailingLinebreak = /\\r?\\n\\s*$/;\n\t\t__export = function( items ) {\n\t\t\tvar i, current, backOne, backTwo, lastSectionItem;\n\t\t\tfor ( i = 1; i < items.length; i += 1 ) {\n\t\t\t\tcurrent = items[ i ];\n\t\t\t\tbackOne = items[ i - 1 ];\n\t\t\t\tbackTwo = items[ i - 2 ];\n\t\t\t\t// if we're at the end of a [text][comment][text] sequence...\n\t\t\t\tif ( isString( current ) && isComment( backOne ) && isString( backTwo ) ) {\n\t\t\t\t\t// ... and the comment is a standalone (i.e. line breaks either side)...\n\t\t\t\t\tif ( trailingLinebreak.test( backTwo ) && leadingLinebreak.test( current ) ) {\n\t\t\t\t\t\t// ... then we want to remove the whitespace after the first line break\n\t\t\t\t\t\titems[ i - 2 ] = backTwo.replace( trailingLinebreak, '\\n' );\n\t\t\t\t\t\t// and the leading line break of the second text token\n\t\t\t\t\t\titems[ i ] = current.replace( leadingLinebreak, '' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// if the current item is a section, and it is preceded by a linebreak, and\n\t\t\t\t// its first item is a linebreak...\n\t\t\t\tif ( isSection( current ) && isString( backOne ) ) {\n\t\t\t\t\tif ( trailingLinebreak.test( backOne ) && isString( current.f[ 0 ] ) && leadingLinebreak.test( current.f[ 0 ] ) ) {\n\t\t\t\t\t\titems[ i - 1 ] = backOne.replace( trailingLinebreak, '\\n' );\n\t\t\t\t\t\tcurrent.f[ 0 ] = current.f[ 0 ].replace( leadingLinebreak, '' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// if the last item was a section, and it is followed by a linebreak, and\n\t\t\t\t// its last item is a linebreak...\n\t\t\t\tif ( isString( current ) && isSection( backOne ) ) {\n\t\t\t\t\tlastSectionItem = backOne.f[ backOne.f.length - 1 ];\n\t\t\t\t\tif ( isString( lastSectionItem ) && trailingLinebreak.test( lastSectionItem ) && leadingLinebreak.test( current ) ) {\n\t\t\t\t\t\tbackOne.f[ backOne.f.length - 1 ] = lastSectionItem.replace( trailingLinebreak, '\\n' );\n\t\t\t\t\t\titems[ i ] = current.replace( leadingLinebreak, '' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn items;\n\t\t};\n\n\t\tfunction isString( item ) {\n\t\t\treturn typeof item === 'string';\n\t\t}\n\n\t\tfunction isComment( item ) {\n\t\t\treturn item.t === types.COMMENT || item.t === types.DELIMCHANGE;\n\t\t}\n\n\t\tfunction isSection( item ) {\n\t\t\treturn ( item.t === types.SECTION || item.t === types.INVERTED ) && item.f;\n\t\t}\n\t\treturn __export;\n\t}( types );\n\n\t/* utils/escapeRegExp.js */\n\tvar escapeRegExp = function() {\n\n\t\tvar pattern = /[-/\\\\^$*+?.()|[\\]{}]/g;\n\t\treturn function escapeRegExp( str ) {\n\t\t\treturn str.replace( pattern, '\\\\$&' );\n\t\t};\n\t}();\n\n\t/* parse/_parse.js */\n\tvar parse = function( types, Parser, mustache, comment, element, text, trimWhitespace, stripStandalones, escapeRegExp ) {\n\n\t\tvar __export;\n\t\tvar StandardParser, parse, contiguousWhitespace = /[ \\t\\f\\r\\n]+/g,\n\t\t\tpreserveWhitespaceElements = /^(?:pre|script|style|textarea)$/i,\n\t\t\tleadingWhitespace = /^\\s+/,\n\t\t\ttrailingWhitespace = /\\s+$/;\n\t\tStandardParser = Parser.extend( {\n\t\t\tinit: function( str, options ) {\n\t\t\t\t// config\n\t\t\t\tsetDelimiters( options, this );\n\t\t\t\tthis.sectionDepth = 0;\n\t\t\t\tthis.interpolate = {\n\t\t\t\t\tscript: !options.interpolate || options.interpolate.script !== false,\n\t\t\t\t\tstyle: !options.interpolate || options.interpolate.style !== false\n\t\t\t\t};\n\t\t\t\tif ( options.sanitize === true ) {\n\t\t\t\t\toptions.sanitize = {\n\t\t\t\t\t\t// blacklist from https://code.google.com/p/google-caja/source/browse/trunk/src/com/google/caja/lang/html/html4-elements-whitelist.json\n\t\t\t\t\t\telements: 'applet base basefont body frame frameset head html isindex link meta noframes noscript object param script style title'.split( ' ' ),\n\t\t\t\t\t\teventAttributes: true\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tthis.sanitizeElements = options.sanitize && options.sanitize.elements;\n\t\t\t\tthis.sanitizeEventAttributes = options.sanitize && options.sanitize.eventAttributes;\n\t\t\t\tthis.includeLinePositions = options.includeLinePositions;\n\t\t\t},\n\t\t\tpostProcess: function( items, options ) {\n\t\t\t\tif ( this.sectionDepth > 0 ) {\n\t\t\t\t\tthis.error( 'A section was left open' );\n\t\t\t\t}\n\t\t\t\tcleanup( items, options.stripComments !== false, options.preserveWhitespace, !options.preserveWhitespace, !options.preserveWhitespace, options.rewriteElse !== false );\n\t\t\t\treturn items;\n\t\t\t},\n\t\t\tconverters: [\n\t\t\t\tmustache,\n\t\t\t\tcomment,\n\t\t\t\telement,\n\t\t\t\ttext\n\t\t\t]\n\t\t} );\n\t\tparse = function( template ) {\n\t\t\tvar options = arguments[ 1 ];\n\t\t\tif ( options === void 0 )\n\t\t\t\toptions = {};\n\t\t\tvar result, remaining, partials, name, startMatch, endMatch, inlinePartialStart, inlinePartialEnd;\n\t\t\tsetDelimiters( options );\n\t\t\tinlinePartialStart = new RegExp( '<!--\\\\s*' + escapeRegExp( options.delimiters[ 0 ] ) + '\\\\s*>\\\\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\\\\s*' + escapeRegExp( options.delimiters[ 1 ] ) + '\\\\s*-->' );\n\t\t\tinlinePartialEnd = new RegExp( '<!--\\\\s*' + escapeRegExp( options.delimiters[ 0 ] ) + '\\\\s*\\\\/\\\\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\\\\s*' + escapeRegExp( options.delimiters[ 1 ] ) + '\\\\s*-->' );\n\t\t\tresult = {\n\t\t\t\tv: 1\n\t\t\t};\n\t\t\tif ( inlinePartialStart.test( template ) ) {\n\t\t\t\tremaining = template;\n\t\t\t\ttemplate = '';\n\t\t\t\twhile ( startMatch = inlinePartialStart.exec( remaining ) ) {\n\t\t\t\t\tname = startMatch[ 1 ];\n\t\t\t\t\ttemplate += remaining.substr( 0, startMatch.index );\n\t\t\t\t\tremaining = remaining.substring( startMatch.index + startMatch[ 0 ].length );\n\t\t\t\t\tendMatch = inlinePartialEnd.exec( remaining );\n\t\t\t\t\tif ( !endMatch || endMatch[ 1 ] !== name ) {\n\t\t\t\t\t\tthrow new Error( 'Inline partials must have a closing delimiter, and cannot be nested. Expected closing for \"' + name + '\", but ' + ( endMatch ? 'instead found \"' + endMatch[ 1 ] + '\"' : ' no closing found' ) );\n\t\t\t\t\t}\n\t\t\t\t\t( partials || ( partials = {} ) )[ name ] = new StandardParser( remaining.substr( 0, endMatch.index ), options ).result;\n\t\t\t\t\tremaining = remaining.substring( endMatch.index + endMatch[ 0 ].length );\n\t\t\t\t}\n\t\t\t\ttemplate += remaining;\n\t\t\t\tresult.p = partials;\n\t\t\t}\n\t\t\tresult.t = new StandardParser( template, options ).result;\n\t\t\treturn result;\n\t\t};\n\t\t__export = parse;\n\n\t\tfunction cleanup( items, stripComments, preserveWhitespace, removeLeadingWhitespace, removeTrailingWhitespace, rewriteElse ) {\n\t\t\tvar i, item, previousItem, nextItem, preserveWhitespaceInsideFragment, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespaceInsideFragment, unlessBlock, key;\n\t\t\t// First pass - remove standalones and comments etc\n\t\t\tstripStandalones( items );\n\t\t\ti = items.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\titem = items[ i ];\n\t\t\t\t// Remove delimiter changes, unsafe elements etc\n\t\t\t\tif ( item.exclude ) {\n\t\t\t\t\titems.splice( i, 1 );\n\t\t\t\t} else if ( stripComments && item.t === types.COMMENT ) {\n\t\t\t\t\titems.splice( i, 1 );\n\t\t\t\t}\n\t\t\t}\n\t\t\t// If necessary, remove leading and trailing whitespace\n\t\t\ttrimWhitespace( items, removeLeadingWhitespace, removeTrailingWhitespace );\n\t\t\ti = items.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\titem = items[ i ];\n\t\t\t\t// Recurse\n\t\t\t\tif ( item.f ) {\n\t\t\t\t\tpreserveWhitespaceInsideFragment = preserveWhitespace || item.t === types.ELEMENT && preserveWhitespaceElements.test( item.e );\n\t\t\t\t\tif ( !preserveWhitespaceInsideFragment ) {\n\t\t\t\t\t\tpreviousItem = items[ i - 1 ];\n\t\t\t\t\t\tnextItem = items[ i + 1 ];\n\t\t\t\t\t\t// if the previous item was a text item with trailing whitespace,\n\t\t\t\t\t\t// remove leading whitespace inside the fragment\n\t\t\t\t\t\tif ( !previousItem || typeof previousItem === 'string' && trailingWhitespace.test( previousItem ) ) {\n\t\t\t\t\t\t\tremoveLeadingWhitespaceInsideFragment = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// and vice versa\n\t\t\t\t\t\tif ( !nextItem || typeof nextItem === 'string' && leadingWhitespace.test( nextItem ) ) {\n\t\t\t\t\t\t\tremoveTrailingWhitespaceInsideFragment = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcleanup( item.f, stripComments, preserveWhitespaceInsideFragment, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespaceInsideFragment, rewriteElse );\n\t\t\t\t}\n\t\t\t\t// Split if-else blocks into two (an if, and an unless)\n\t\t\t\tif ( item.l ) {\n\t\t\t\t\tcleanup( item.l, stripComments, preserveWhitespace, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespaceInsideFragment, rewriteElse );\n\t\t\t\t\tif ( rewriteElse ) {\n\t\t\t\t\t\tunlessBlock = {\n\t\t\t\t\t\t\tt: 4,\n\t\t\t\t\t\t\tn: types.SECTION_UNLESS,\n\t\t\t\t\t\t\tf: item.l\n\t\t\t\t\t\t};\n\t\t\t\t\t\t// copy the conditional based on its type\n\t\t\t\t\t\tif ( item.r ) {\n\t\t\t\t\t\t\tunlessBlock.r = item.r;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( item.x ) {\n\t\t\t\t\t\t\tunlessBlock.x = item.x;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( item.rx ) {\n\t\t\t\t\t\t\tunlessBlock.rx = item.rx;\n\t\t\t\t\t\t}\n\t\t\t\t\t\titems.splice( i + 1, 0, unlessBlock );\n\t\t\t\t\t\tdelete item.l;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Clean up element attributes\n\t\t\t\tif ( item.a ) {\n\t\t\t\t\tfor ( key in item.a ) {\n\t\t\t\t\t\tif ( item.a.hasOwnProperty( key ) && typeof item.a[ key ] !== 'string' ) {\n\t\t\t\t\t\t\tcleanup( item.a[ key ], stripComments, preserveWhitespace, removeLeadingWhitespaceInsideFragment, removeTrailingWhitespaceInsideFragment, rewriteElse );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// final pass - fuse text nodes together\n\t\t\ti = items.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( typeof items[ i ] === 'string' ) {\n\t\t\t\t\tif ( typeof items[ i + 1 ] === 'string' ) {\n\t\t\t\t\t\titems[ i ] = items[ i ] + items[ i + 1 ];\n\t\t\t\t\t\titems.splice( i + 1, 1 );\n\t\t\t\t\t}\n\t\t\t\t\tif ( !preserveWhitespace ) {\n\t\t\t\t\t\titems[ i ] = items[ i ].replace( contiguousWhitespace, ' ' );\n\t\t\t\t\t}\n\t\t\t\t\tif ( items[ i ] === '' ) {\n\t\t\t\t\t\titems.splice( i, 1 );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction setDelimiters( source ) {\n\t\t\tvar target = arguments[ 1 ];\n\t\t\tif ( target === void 0 )\n\t\t\t\ttarget = source;\n\t\t\ttarget.delimiters = source.delimiters || [\n\t\t\t\t'{{',\n\t\t\t\t'}}'\n\t\t\t];\n\t\t\ttarget.tripleDelimiters = source.tripleDelimiters || [\n\t\t\t\t'{{{',\n\t\t\t\t'}}}'\n\t\t\t];\n\t\t\ttarget.staticDelimiters = source.staticDelimiters || [\n\t\t\t\t'[[',\n\t\t\t\t']]'\n\t\t\t];\n\t\t\ttarget.staticTripleDelimiters = source.staticTripleDelimiters || [\n\t\t\t\t'[[[',\n\t\t\t\t']]]'\n\t\t\t];\n\t\t}\n\t\treturn __export;\n\t}( types, Parser, mustache, comment, element, text, trimWhitespace, stripStandalones, escapeRegExp );\n\n\t/* config/options/groups/optionGroup.js */\n\tvar optionGroup = function() {\n\n\t\treturn function createOptionGroup( keys, config ) {\n\t\t\tvar group = keys.map( config );\n\t\t\tkeys.forEach( function( key, i ) {\n\t\t\t\tgroup[ key ] = group[ i ];\n\t\t\t} );\n\t\t\treturn group;\n\t\t};\n\t}( legacy );\n\n\t/* config/options/groups/parseOptions.js */\n\tvar parseOptions = function( optionGroup ) {\n\n\t\tvar keys, parseOptions;\n\t\tkeys = [\n\t\t\t'preserveWhitespace',\n\t\t\t'sanitize',\n\t\t\t'stripComments',\n\t\t\t'delimiters',\n\t\t\t'tripleDelimiters',\n\t\t\t'interpolate'\n\t\t];\n\t\tparseOptions = optionGroup( keys, function( key ) {\n\t\t\treturn key;\n\t\t} );\n\t\treturn parseOptions;\n\t}( optionGroup );\n\n\t/* config/options/template/parser.js */\n\tvar parser = function( errors, isClient, parse, create, parseOptions ) {\n\n\t\tvar parser = {\n\t\t\tparse: doParse,\n\t\t\tfromId: fromId,\n\t\t\tisHashedId: isHashedId,\n\t\t\tisParsed: isParsed,\n\t\t\tgetParseOptions: getParseOptions,\n\t\t\tcreateHelper: createHelper\n\t\t};\n\n\t\tfunction createHelper( parseOptions ) {\n\t\t\tvar helper = create( parser );\n\t\t\thelper.parse = function( template, options ) {\n\t\t\t\treturn doParse( template, options || parseOptions );\n\t\t\t};\n\t\t\treturn helper;\n\t\t}\n\n\t\tfunction doParse( template, parseOptions ) {\n\t\t\tif ( !parse ) {\n\t\t\t\tthrow new Error( errors.missingParser );\n\t\t\t}\n\t\t\treturn parse( template, parseOptions || this.options );\n\t\t}\n\n\t\tfunction fromId( id, options ) {\n\t\t\tvar template;\n\t\t\tif ( !isClient ) {\n\t\t\t\tif ( options && options.noThrow ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthrow new Error( 'Cannot retrieve template #' + id + ' as Ractive is not running in a browser.' );\n\t\t\t}\n\t\t\tif ( isHashedId( id ) ) {\n\t\t\t\tid = id.substring( 1 );\n\t\t\t}\n\t\t\tif ( !( template = document.getElementById( id ) ) ) {\n\t\t\t\tif ( options && options.noThrow ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthrow new Error( 'Could not find template element with id #' + id );\n\t\t\t}\n\t\t\tif ( template.tagName.toUpperCase() !== 'SCRIPT' ) {\n\t\t\t\tif ( options && options.noThrow ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthrow new Error( 'Template element with id #' + id + ', must be a <script> element' );\n\t\t\t}\n\t\t\treturn template.innerHTML;\n\t\t}\n\n\t\tfunction isHashedId( id ) {\n\t\t\treturn id && id.charAt( 0 ) === '#';\n\t\t}\n\n\t\tfunction isParsed( template ) {\n\t\t\treturn !( typeof template === 'string' );\n\t\t}\n\n\t\tfunction getParseOptions( ractive ) {\n\t\t\t// Could be Ractive or a Component\n\t\t\tif ( ractive.defaults ) {\n\t\t\t\tractive = ractive.defaults;\n\t\t\t}\n\t\t\treturn parseOptions.reduce( function( val, key ) {\n\t\t\t\tval[ key ] = ractive[ key ];\n\t\t\t\treturn val;\n\t\t\t}, {} );\n\t\t}\n\t\treturn parser;\n\t}( errors, isClient, parse, create, parseOptions );\n\n\t/* config/options/template/template.js */\n\tvar template = function( parser, parse ) {\n\n\t\tvar templateConfig = {\n\t\t\tname: 'template',\n\t\t\textend: function extend( Parent, proto, options ) {\n\t\t\t\tvar template;\n\t\t\t\t// only assign if exists\n\t\t\t\tif ( 'template' in options ) {\n\t\t\t\t\ttemplate = options.template;\n\t\t\t\t\tif ( typeof template === 'function' ) {\n\t\t\t\t\t\tproto.template = template;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tproto.template = parseIfString( template, proto );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tinit: function init( Parent, ractive, options ) {\n\t\t\t\tvar template, fn;\n\t\t\t\t// TODO because of prototypal inheritance, we might just be able to use\n\t\t\t\t// ractive.template, and not bother passing through the Parent object.\n\t\t\t\t// At present that breaks the test mocks' expectations\n\t\t\t\ttemplate = 'template' in options ? options.template : Parent.prototype.template;\n\t\t\t\tif ( typeof template === 'function' ) {\n\t\t\t\t\tfn = template;\n\t\t\t\t\ttemplate = getDynamicTemplate( ractive, fn );\n\t\t\t\t\tractive._config.template = {\n\t\t\t\t\t\tfn: fn,\n\t\t\t\t\t\tresult: template\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\ttemplate = parseIfString( template, ractive );\n\t\t\t\t// TODO the naming of this is confusing - ractive.template refers to [...],\n\t\t\t\t// but Component.prototype.template refers to {v:1,t:[],p:[]}...\n\t\t\t\t// it's unnecessary, because the developer never needs to access\n\t\t\t\t// ractive.template\n\t\t\t\tractive.template = template.t;\n\t\t\t\tif ( template.p ) {\n\t\t\t\t\textendPartials( ractive.partials, template.p );\n\t\t\t\t}\n\t\t\t},\n\t\t\treset: function( ractive ) {\n\t\t\t\tvar result = resetValue( ractive ),\n\t\t\t\t\tparsed;\n\t\t\t\tif ( result ) {\n\t\t\t\t\tparsed = parseIfString( result, ractive );\n\t\t\t\t\tractive.template = parsed.t;\n\t\t\t\t\textendPartials( ractive.partials, parsed.p, true );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tfunction resetValue( ractive ) {\n\t\t\tvar initial = ractive._config.template,\n\t\t\t\tresult;\n\t\t\t// If this isn't a dynamic template, there's nothing to do\n\t\t\tif ( !initial || !initial.fn ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = getDynamicTemplate( ractive, initial.fn );\n\t\t\t// TODO deep equality check to prevent unnecessary re-rendering\n\t\t\t// in the case of already-parsed templates\n\t\t\tif ( result !== initial.result ) {\n\t\t\t\tinitial.result = result;\n\t\t\t\tresult = parseIfString( result, ractive );\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\n\t\tfunction getDynamicTemplate( ractive, fn ) {\n\t\t\tvar helper = parser.createHelper( parser.getParseOptions( ractive ) );\n\t\t\treturn fn.call( ractive, ractive.data, helper );\n\t\t}\n\n\t\tfunction parseIfString( template, ractive ) {\n\t\t\tif ( typeof template === 'string' ) {\n\t\t\t\t// ID of an element containing the template?\n\t\t\t\tif ( template[ 0 ] === '#' ) {\n\t\t\t\t\ttemplate = parser.fromId( template );\n\t\t\t\t}\n\t\t\t\ttemplate = parse( template, parser.getParseOptions( ractive ) );\n\t\t\t} else if ( template.v !== 1 ) {\n\t\t\t\tthrow new Error( 'Mismatched template version! Please ensure you are using the latest version of Ractive.js in your build process as well as in your app' );\n\t\t\t}\n\t\t\treturn template;\n\t\t}\n\n\t\tfunction extendPartials( existingPartials, newPartials, overwrite ) {\n\t\t\tif ( !newPartials )\n\t\t\t\treturn;\n\t\t\t// TODO there's an ambiguity here - we need to overwrite in the `reset()`\n\t\t\t// case, but not initially...\n\t\t\tfor ( var key in newPartials ) {\n\t\t\t\tif ( overwrite || !existingPartials.hasOwnProperty( key ) ) {\n\t\t\t\t\texistingPartials[ key ] = newPartials[ key ];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn templateConfig;\n\t}( parser, parse );\n\n\t/* config/options/Registry.js */\n\tvar Registry = function( create ) {\n\n\t\tfunction Registry( name, useDefaults ) {\n\t\t\tthis.name = name;\n\t\t\tthis.useDefaults = useDefaults;\n\t\t}\n\t\tRegistry.prototype = {\n\t\t\tconstructor: Registry,\n\t\t\textend: function( Parent, proto, options ) {\n\t\t\t\tthis.configure( this.useDefaults ? Parent.defaults : Parent, this.useDefaults ? proto : proto.constructor, options );\n\t\t\t},\n\t\t\tinit: function( Parent, ractive, options ) {\n\t\t\t\tthis.configure( this.useDefaults ? Parent.defaults : Parent, ractive, options );\n\t\t\t},\n\t\t\tconfigure: function( Parent, target, options ) {\n\t\t\t\tvar name = this.name,\n\t\t\t\t\toption = options[ name ],\n\t\t\t\t\tregistry;\n\t\t\t\tregistry = create( Parent[ name ] );\n\t\t\t\tfor ( var key in option ) {\n\t\t\t\t\tregistry[ key ] = option[ key ];\n\t\t\t\t}\n\t\t\t\ttarget[ name ] = registry;\n\t\t\t},\n\t\t\treset: function( ractive ) {\n\t\t\t\tvar registry = ractive[ this.name ];\n\t\t\t\tvar changed = false;\n\t\t\t\tObject.keys( registry ).forEach( function( key ) {\n\t\t\t\t\tvar item = registry[ key ];\n\t\t\t\t\tif ( item._fn ) {\n\t\t\t\t\t\tif ( item._fn.isOwner ) {\n\t\t\t\t\t\t\tregistry[ key ] = item._fn;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdelete registry[ key ];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tchanged = true;\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\treturn changed;\n\t\t\t},\n\t\t\tfindOwner: function( ractive, key ) {\n\t\t\t\treturn ractive[ this.name ].hasOwnProperty( key ) ? ractive : this.findConstructor( ractive.constructor, key );\n\t\t\t},\n\t\t\tfindConstructor: function( constructor, key ) {\n\t\t\t\tif ( !constructor ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\treturn constructor[ this.name ].hasOwnProperty( key ) ? constructor : this.findConstructor( constructor._parent, key );\n\t\t\t},\n\t\t\tfind: function( ractive, key ) {\n\t\t\t\tvar this$0 = this;\n\t\t\t\treturn recurseFind( ractive, function( r ) {\n\t\t\t\t\treturn r[ this$0.name ][ key ];\n\t\t\t\t} );\n\t\t\t},\n\t\t\tfindInstance: function( ractive, key ) {\n\t\t\t\tvar this$0 = this;\n\t\t\t\treturn recurseFind( ractive, function( r ) {\n\t\t\t\t\treturn r[ this$0.name ][ key ] ? r : void 0;\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\n\t\tfunction recurseFind( ractive, fn ) {\n\t\t\tvar find, parent;\n\t\t\tif ( find = fn( ractive ) ) {\n\t\t\t\treturn find;\n\t\t\t}\n\t\t\tif ( !ractive.isolated && ( parent = ractive._parent ) ) {\n\t\t\t\treturn recurseFind( parent, fn );\n\t\t\t}\n\t\t}\n\t\treturn Registry;\n\t}( create, legacy );\n\n\t/* config/options/groups/registries.js */\n\tvar registries = function( optionGroup, Registry ) {\n\n\t\tvar keys = [\n\t\t\t\t'adaptors',\n\t\t\t\t'components',\n\t\t\t\t'computed',\n\t\t\t\t'decorators',\n\t\t\t\t'easing',\n\t\t\t\t'events',\n\t\t\t\t'interpolators',\n\t\t\t\t'partials',\n\t\t\t\t'transitions'\n\t\t\t],\n\t\t\tregistries = optionGroup( keys, function( key ) {\n\t\t\t\treturn new Registry( key, key === 'computed' );\n\t\t\t} );\n\t\treturn registries;\n\t}( optionGroup, Registry );\n\n\t/* utils/noop.js */\n\tvar noop = function() {};\n\n\t/* utils/wrapPrototypeMethod.js */\n\tvar wrapPrototypeMethod = function( noop ) {\n\n\t\tvar __export;\n\t\t__export = function wrap( parent, name, method ) {\n\t\t\tif ( !/_super/.test( method ) ) {\n\t\t\t\treturn method;\n\t\t\t}\n\t\t\tvar wrapper = function wrapSuper() {\n\t\t\t\tvar superMethod = getSuperMethod( wrapper._parent, name ),\n\t\t\t\t\thasSuper = '_super' in this,\n\t\t\t\t\toldSuper = this._super,\n\t\t\t\t\tresult;\n\t\t\t\tthis._super = superMethod;\n\t\t\t\tresult = method.apply( this, arguments );\n\t\t\t\tif ( hasSuper ) {\n\t\t\t\t\tthis._super = oldSuper;\n\t\t\t\t} else {\n\t\t\t\t\tdelete this._super;\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t};\n\t\t\twrapper._parent = parent;\n\t\t\twrapper._method = method;\n\t\t\treturn wrapper;\n\t\t};\n\n\t\tfunction getSuperMethod( parent, name ) {\n\t\t\tvar method;\n\t\t\tif ( name in parent ) {\n\t\t\t\tvar value = parent[ name ];\n\t\t\t\tif ( typeof value === 'function' ) {\n\t\t\t\t\tmethod = value;\n\t\t\t\t} else {\n\t\t\t\t\tmethod = function returnValue() {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tmethod = noop;\n\t\t\t}\n\t\t\treturn method;\n\t\t}\n\t\treturn __export;\n\t}( noop );\n\n\t/* config/deprecate.js */\n\tvar deprecate = function( warn, isArray ) {\n\n\t\tfunction deprecate( options, deprecated, correct ) {\n\t\t\tif ( deprecated in options ) {\n\t\t\t\tif ( !( correct in options ) ) {\n\t\t\t\t\twarn( getMessage( deprecated, correct ) );\n\t\t\t\t\toptions[ correct ] = options[ deprecated ];\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error( getMessage( deprecated, correct, true ) );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction getMessage( deprecated, correct, isError ) {\n\t\t\treturn 'options.' + deprecated + ' has been deprecated in favour of options.' + correct + '.' + ( isError ? ' You cannot specify both options, please use options.' + correct + '.' : '' );\n\t\t}\n\n\t\tfunction deprecateEventDefinitions( options ) {\n\t\t\tdeprecate( options, 'eventDefinitions', 'events' );\n\t\t}\n\n\t\tfunction deprecateAdaptors( options ) {\n\t\t\t// Using extend with Component instead of options,\n\t\t\t// like Human.extend( Spider ) means adaptors as a registry\n\t\t\t// gets copied to options. So we have to check if actually an array\n\t\t\tif ( isArray( options.adaptors ) ) {\n\t\t\t\tdeprecate( options, 'adaptors', 'adapt' );\n\t\t\t}\n\t\t}\n\t\treturn function deprecateOptions( options ) {\n\t\t\tdeprecate( options, 'beforeInit', 'onconstruct' );\n\t\t\tdeprecate( options, 'init', 'onrender' );\n\t\t\tdeprecate( options, 'complete', 'oncomplete' );\n\t\t\tdeprecateEventDefinitions( options );\n\t\t\tdeprecateAdaptors( options );\n\t\t};\n\t}( warn, isArray );\n\n\t/* config/config.js */\n\tvar config = function( css, data, defaults, template, parseOptions, registries, wrapPrototype, deprecate ) {\n\n\t\tvar custom, options, config, blacklisted;\n\t\t// would be nice to not have these here,\n\t\t// they get added during initialise, so for now we have\n\t\t// to make sure not to try and extend them.\n\t\t// Possibly, we could re-order and not add till later\n\t\t// in process.\n\t\tblacklisted = {\n\t\t\t'_parent': true,\n\t\t\t'_component': true\n\t\t};\n\t\tcustom = {\n\t\t\tdata: data,\n\t\t\ttemplate: template,\n\t\t\tcss: css\n\t\t};\n\t\toptions = Object.keys( defaults ).filter( function( key ) {\n\t\t\treturn !registries[ key ] && !custom[ key ] && !parseOptions[ key ];\n\t\t} );\n\t\t// this defines the order:\n\t\tconfig = [].concat( custom.data, parseOptions, options, registries, custom.template, custom.css );\n\t\tfor ( var key in custom ) {\n\t\t\tconfig[ key ] = custom[ key ];\n\t\t}\n\t\t// for iteration\n\t\tconfig.keys = Object.keys( defaults ).concat( registries.map( function( r ) {\n\t\t\treturn r.name;\n\t\t} ) ).concat( [ 'css' ] );\n\t\t// add these to blacklisted key's that we don't double extend\n\t\tconfig.keys.forEach( function( key ) {\n\t\t\treturn blacklisted[ key ] = true;\n\t\t} );\n\t\tconfig.parseOptions = parseOptions;\n\t\tconfig.registries = registries;\n\n\t\tfunction customConfig( method, key, Parent, instance, options ) {\n\t\t\tcustom[ key ][ method ]( Parent, instance, options );\n\t\t}\n\t\tconfig.extend = function( Parent, proto, options ) {\n\t\t\tconfigure( 'extend', Parent, proto, options );\n\t\t};\n\t\tconfig.init = function( Parent, ractive, options ) {\n\t\t\tconfigure( 'init', Parent, ractive, options );\n\t\t};\n\n\t\tfunction isStandardDefaultKey( key ) {\n\t\t\treturn key in defaults && !( key in config.parseOptions ) && !( key in custom );\n\t\t}\n\n\t\tfunction configure( method, Parent, instance, options ) {\n\t\t\tdeprecate( options );\n\t\t\tcustomConfig( method, 'data', Parent, instance, options );\n\t\t\tconfig.parseOptions.forEach( function( key ) {\n\t\t\t\tif ( key in options ) {\n\t\t\t\t\tinstance[ key ] = options[ key ];\n\t\t\t\t}\n\t\t\t} );\n\t\t\tfor ( var key in options ) {\n\t\t\t\tif ( isStandardDefaultKey( key ) ) {\n\t\t\t\t\tvar value = options[ key ];\n\t\t\t\t\tinstance[ key ] = typeof value === 'function' ? wrapPrototype( Parent.prototype, key, value ) : value;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconfig.registries.forEach( function( registry ) {\n\t\t\t\tregistry[ method ]( Parent, instance, options );\n\t\t\t} );\n\t\t\tcustomConfig( method, 'template', Parent, instance, options );\n\t\t\tcustomConfig( method, 'css', Parent, instance, options );\n\t\t\textendOtherMethods( Parent.prototype, instance, options );\n\t\t}\n\n\t\tfunction extendOtherMethods( parent, instance, options ) {\n\t\t\tfor ( var key in options ) {\n\t\t\t\tif ( !( key in blacklisted ) && options.hasOwnProperty( key ) ) {\n\t\t\t\t\tvar member = options[ key ];\n\t\t\t\t\t// if this is a method that overwrites a method, wrap it:\n\t\t\t\t\tif ( typeof member === 'function' ) {\n\t\t\t\t\t\tmember = wrapPrototype( parent, key, member );\n\t\t\t\t\t}\n\t\t\t\t\tinstance[ key ] = member;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tconfig.reset = function( ractive ) {\n\t\t\treturn config.filter( function( c ) {\n\t\t\t\treturn c.reset && c.reset( ractive );\n\t\t\t} ).map( function( c ) {\n\t\t\t\treturn c.name;\n\t\t\t} );\n\t\t};\n\t\tconfig.getConstructTarget = function( ractive, options ) {\n\t\t\tif ( options.onconstruct ) {\n\t\t\t\t// pretend this object literal is the ractive instance\n\t\t\t\treturn {\n\t\t\t\t\tonconstruct: wrapPrototype( ractive, 'onconstruct', options.onconstruct ).bind( ractive ),\n\t\t\t\t\tfire: ractive.fire.bind( ractive )\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn ractive;\n\t\t\t}\n\t\t};\n\t\treturn config;\n\t}( css, data, options, template, parseOptions, registries, wrapPrototypeMethod, deprecate );\n\n\t/* shared/interpolate.js */\n\tvar interpolate = function( circular, warn, interpolators, config ) {\n\n\t\tvar __export;\n\t\tvar interpolate = function( from, to, ractive, type ) {\n\t\t\tif ( from === to ) {\n\t\t\t\treturn snap( to );\n\t\t\t}\n\t\t\tif ( type ) {\n\t\t\t\tvar interpol = config.registries.interpolators.find( ractive, type );\n\t\t\t\tif ( interpol ) {\n\t\t\t\t\treturn interpol( from, to ) || snap( to );\n\t\t\t\t}\n\t\t\t\twarn( 'Missing \"' + type + '\" interpolator. You may need to download a plugin from [TODO]' );\n\t\t\t}\n\t\t\treturn interpolators.number( from, to ) || interpolators.array( from, to ) || interpolators.object( from, to ) || snap( to );\n\t\t};\n\t\tcircular.interpolate = interpolate;\n\t\t__export = interpolate;\n\n\t\tfunction snap( to ) {\n\t\t\treturn function() {\n\t\t\t\treturn to;\n\t\t\t};\n\t\t}\n\t\treturn __export;\n\t}( circular, warn, interpolators, config );\n\n\t/* Ractive/prototype/animate/Animation.js */\n\tvar Ractive$animate_Animation = function( warn, runloop, interpolate ) {\n\n\t\tvar Animation = function( options ) {\n\t\t\tvar key;\n\t\t\tthis.startTime = Date.now();\n\t\t\t// from and to\n\t\t\tfor ( key in options ) {\n\t\t\t\tif ( options.hasOwnProperty( key ) ) {\n\t\t\t\t\tthis[ key ] = options[ key ];\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.interpolator = interpolate( this.from, this.to, this.root, this.interpolator );\n\t\t\tthis.running = true;\n\t\t\tthis.tick();\n\t\t};\n\t\tAnimation.prototype = {\n\t\t\ttick: function() {\n\t\t\t\tvar elapsed, t, value, timeNow, index, keypath;\n\t\t\t\tkeypath = this.keypath;\n\t\t\t\tif ( this.running ) {\n\t\t\t\t\ttimeNow = Date.now();\n\t\t\t\t\telapsed = timeNow - this.startTime;\n\t\t\t\t\tif ( elapsed >= this.duration ) {\n\t\t\t\t\t\tif ( keypath !== null ) {\n\t\t\t\t\t\t\trunloop.start( this.root );\n\t\t\t\t\t\t\tthis.root.viewmodel.set( keypath, this.to );\n\t\t\t\t\t\t\trunloop.end();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( this.step ) {\n\t\t\t\t\t\t\tthis.step( 1, this.to );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.complete( this.to );\n\t\t\t\t\t\tindex = this.root._animations.indexOf( this );\n\t\t\t\t\t\t// TODO investigate why this happens\n\t\t\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\t\t\twarn( 'Animation was not found' );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.root._animations.splice( index, 1 );\n\t\t\t\t\t\tthis.running = false;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tt = this.easing ? this.easing( elapsed / this.duration ) : elapsed / this.duration;\n\t\t\t\t\tif ( keypath !== null ) {\n\t\t\t\t\t\tvalue = this.interpolator( t );\n\t\t\t\t\t\trunloop.start( this.root );\n\t\t\t\t\t\tthis.root.viewmodel.set( keypath, value );\n\t\t\t\t\t\trunloop.end();\n\t\t\t\t\t}\n\t\t\t\t\tif ( this.step ) {\n\t\t\t\t\t\tthis.step( t, value );\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tstop: function() {\n\t\t\t\tvar index;\n\t\t\t\tthis.running = false;\n\t\t\t\tindex = this.root._animations.indexOf( this );\n\t\t\t\t// TODO investigate why this happens\n\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\twarn( 'Animation was not found' );\n\t\t\t\t}\n\t\t\t\tthis.root._animations.splice( index, 1 );\n\t\t\t}\n\t\t};\n\t\treturn Animation;\n\t}( warn, runloop, interpolate );\n\n\t/* Ractive/prototype/animate.js */\n\tvar Ractive$animate = function( isEqual, Promise, normaliseKeypath, animations, Animation ) {\n\n\t\tvar __export;\n\t\tvar noop = function() {},\n\t\t\tnoAnimation = {\n\t\t\t\tstop: noop\n\t\t\t};\n\t\t__export = function Ractive$animate( keypath, to, options ) {\n\t\t\tvar promise, fulfilPromise, k, animation, animations, easing, duration, step, complete, makeValueCollector, currentValues, collectValue, dummy, dummyOptions;\n\t\t\tpromise = new Promise( function( fulfil ) {\n\t\t\t\tfulfilPromise = fulfil;\n\t\t\t} );\n\t\t\t// animate multiple keypaths\n\t\t\tif ( typeof keypath === 'object' ) {\n\t\t\t\toptions = to || {};\n\t\t\t\teasing = options.easing;\n\t\t\t\tduration = options.duration;\n\t\t\t\tanimations = [];\n\t\t\t\t// we don't want to pass the `step` and `complete` handlers, as they will\n\t\t\t\t// run for each animation! So instead we'll store the handlers and create\n\t\t\t\t// our own...\n\t\t\t\tstep = options.step;\n\t\t\t\tcomplete = options.complete;\n\t\t\t\tif ( step || complete ) {\n\t\t\t\t\tcurrentValues = {};\n\t\t\t\t\toptions.step = null;\n\t\t\t\t\toptions.complete = null;\n\t\t\t\t\tmakeValueCollector = function( keypath ) {\n\t\t\t\t\t\treturn function( t, value ) {\n\t\t\t\t\t\t\tcurrentValues[ keypath ] = value;\n\t\t\t\t\t\t};\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tfor ( k in keypath ) {\n\t\t\t\t\tif ( keypath.hasOwnProperty( k ) ) {\n\t\t\t\t\t\tif ( step || complete ) {\n\t\t\t\t\t\t\tcollectValue = makeValueCollector( k );\n\t\t\t\t\t\t\toptions = {\n\t\t\t\t\t\t\t\teasing: easing,\n\t\t\t\t\t\t\t\tduration: duration\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tif ( step ) {\n\t\t\t\t\t\t\t\toptions.step = collectValue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\toptions.complete = complete ? collectValue : noop;\n\t\t\t\t\t\tanimations.push( animate( this, k, keypath[ k ], options ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Create a dummy animation, to facilitate step/complete\n\t\t\t\t// callbacks, and Promise fulfilment\n\t\t\t\tdummyOptions = {\n\t\t\t\t\teasing: easing,\n\t\t\t\t\tduration: duration\n\t\t\t\t};\n\t\t\t\tif ( step ) {\n\t\t\t\t\tdummyOptions.step = function( t ) {\n\t\t\t\t\t\tstep( t, currentValues );\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tif ( complete ) {\n\t\t\t\t\tpromise.then( function( t ) {\n\t\t\t\t\t\tcomplete( t, currentValues );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tdummyOptions.complete = fulfilPromise;\n\t\t\t\tdummy = animate( this, null, null, dummyOptions );\n\t\t\t\tanimations.push( dummy );\n\t\t\t\tpromise.stop = function() {\n\t\t\t\t\tvar animation;\n\t\t\t\t\twhile ( animation = animations.pop() ) {\n\t\t\t\t\t\tanimation.stop();\n\t\t\t\t\t}\n\t\t\t\t\tif ( dummy ) {\n\t\t\t\t\t\tdummy.stop();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\treturn promise;\n\t\t\t}\n\t\t\t// animate a single keypath\n\t\t\toptions = options || {};\n\t\t\tif ( options.complete ) {\n\t\t\t\tpromise.then( options.complete );\n\t\t\t}\n\t\t\toptions.complete = fulfilPromise;\n\t\t\tanimation = animate( this, keypath, to, options );\n\t\t\tpromise.stop = function() {\n\t\t\t\tanimation.stop();\n\t\t\t};\n\t\t\treturn promise;\n\t\t};\n\n\t\tfunction animate( root, keypath, to, options ) {\n\t\t\tvar easing, duration, animation, from;\n\t\t\tif ( keypath ) {\n\t\t\t\tkeypath = normaliseKeypath( keypath );\n\t\t\t}\n\t\t\tif ( keypath !== null ) {\n\t\t\t\tfrom = root.viewmodel.get( keypath );\n\t\t\t}\n\t\t\t// cancel any existing animation\n\t\t\t// TODO what about upstream/downstream keypaths?\n\t\t\tanimations.abort( keypath, root );\n\t\t\t// don't bother animating values that stay the same\n\t\t\tif ( isEqual( from, to ) ) {\n\t\t\t\tif ( options.complete ) {\n\t\t\t\t\toptions.complete( options.to );\n\t\t\t\t}\n\t\t\t\treturn noAnimation;\n\t\t\t}\n\t\t\t// easing function\n\t\t\tif ( options.easing ) {\n\t\t\t\tif ( typeof options.easing === 'function' ) {\n\t\t\t\t\teasing = options.easing;\n\t\t\t\t} else {\n\t\t\t\t\teasing = root.easing[ options.easing ];\n\t\t\t\t}\n\t\t\t\tif ( typeof easing !== 'function' ) {\n\t\t\t\t\teasing = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// duration\n\t\t\tduration = options.duration === undefined ? 400 : options.duration;\n\t\t\t// TODO store keys, use an internal set method\n\t\t\tanimation = new Animation( {\n\t\t\t\tkeypath: keypath,\n\t\t\t\tfrom: from,\n\t\t\t\tto: to,\n\t\t\t\troot: root,\n\t\t\t\tduration: duration,\n\t\t\t\teasing: easing,\n\t\t\t\tinterpolator: options.interpolator,\n\t\t\t\t// TODO wrap callbacks if necessary, to use instance as context\n\t\t\t\tstep: options.step,\n\t\t\t\tcomplete: options.complete\n\t\t\t} );\n\t\t\tanimations.add( animation );\n\t\t\troot._animations.push( animation );\n\t\t\treturn animation;\n\t\t}\n\t\treturn __export;\n\t}( isEqual, Promise, normaliseKeypath, animations, Ractive$animate_Animation );\n\n\t/* Ractive/prototype/detach.js */\n\tvar Ractive$detach = function( Hook, removeFromArray ) {\n\n\t\tvar detachHook = new Hook( 'detach' );\n\t\treturn function Ractive$detach() {\n\t\t\tif ( this.detached ) {\n\t\t\t\treturn this.detached;\n\t\t\t}\n\t\t\tif ( this.el ) {\n\t\t\t\tremoveFromArray( this.el.__ractive_instances__, this );\n\t\t\t}\n\t\t\tthis.detached = this.fragment.detach();\n\t\t\tdetachHook.fire( this );\n\t\t\treturn this.detached;\n\t\t};\n\t}( Ractive$shared_hooks_Hook, removeFromArray );\n\n\t/* Ractive/prototype/find.js */\n\tvar Ractive$find = function Ractive$find( selector ) {\n\t\tif ( !this.el ) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this.fragment.find( selector );\n\t};\n\n\t/* utils/matches.js */\n\tvar matches = function( isClient, vendors, createElement ) {\n\n\t\tvar matches, div, methodNames, unprefixed, prefixed, i, j, makeFunction;\n\t\tif ( !isClient ) {\n\t\t\tmatches = null;\n\t\t} else {\n\t\t\tdiv = createElement( 'div' );\n\t\t\tmethodNames = [\n\t\t\t\t'matches',\n\t\t\t\t'matchesSelector'\n\t\t\t];\n\t\t\tmakeFunction = function( methodName ) {\n\t\t\t\treturn function( node, selector ) {\n\t\t\t\t\treturn node[ methodName ]( selector );\n\t\t\t\t};\n\t\t\t};\n\t\t\ti = methodNames.length;\n\t\t\twhile ( i-- && !matches ) {\n\t\t\t\tunprefixed = methodNames[ i ];\n\t\t\t\tif ( div[ unprefixed ] ) {\n\t\t\t\t\tmatches = makeFunction( unprefixed );\n\t\t\t\t} else {\n\t\t\t\t\tj = vendors.length;\n\t\t\t\t\twhile ( j-- ) {\n\t\t\t\t\t\tprefixed = vendors[ i ] + unprefixed.substr( 0, 1 ).toUpperCase() + unprefixed.substring( 1 );\n\t\t\t\t\t\tif ( div[ prefixed ] ) {\n\t\t\t\t\t\t\tmatches = makeFunction( prefixed );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// IE8...\n\t\t\tif ( !matches ) {\n\t\t\t\tmatches = function( node, selector ) {\n\t\t\t\t\tvar nodes, parentNode, i;\n\t\t\t\t\tparentNode = node.parentNode;\n\t\t\t\t\tif ( !parentNode ) {\n\t\t\t\t\t\t// empty dummy <div>\n\t\t\t\t\t\tdiv.innerHTML = '';\n\t\t\t\t\t\tparentNode = div;\n\t\t\t\t\t\tnode = node.cloneNode();\n\t\t\t\t\t\tdiv.appendChild( node );\n\t\t\t\t\t}\n\t\t\t\t\tnodes = parentNode.querySelectorAll( selector );\n\t\t\t\t\ti = nodes.length;\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tif ( nodes[ i ] === node ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\treturn matches;\n\t}( isClient, vendors, createElement );\n\n\t/* Ractive/prototype/shared/makeQuery/test.js */\n\tvar Ractive$shared_makeQuery_test = function( matches ) {\n\n\t\treturn function( item, noDirty ) {\n\t\t\tvar itemMatches = this._isComponentQuery ? !this.selector || item.name === this.selector : matches( item.node, this.selector );\n\t\t\tif ( itemMatches ) {\n\t\t\t\tthis.push( item.node || item.instance );\n\t\t\t\tif ( !noDirty ) {\n\t\t\t\t\tthis._makeDirty();\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t};\n\t}( matches );\n\n\t/* Ractive/prototype/shared/makeQuery/cancel.js */\n\tvar Ractive$shared_makeQuery_cancel = function() {\n\t\tvar liveQueries, selector, index;\n\t\tliveQueries = this._root[ this._isComponentQuery ? 'liveComponentQueries' : 'liveQueries' ];\n\t\tselector = this.selector;\n\t\tindex = liveQueries.indexOf( selector );\n\t\tif ( index !== -1 ) {\n\t\t\tliveQueries.splice( index, 1 );\n\t\t\tliveQueries[ selector ] = null;\n\t\t}\n\t};\n\n\t/* Ractive/prototype/shared/makeQuery/sortByItemPosition.js */\n\tvar Ractive$shared_makeQuery_sortByItemPosition = function() {\n\n\t\tvar __export;\n\t\t__export = function( a, b ) {\n\t\t\tvar ancestryA, ancestryB, oldestA, oldestB, mutualAncestor, indexA, indexB, fragments, fragmentA, fragmentB;\n\t\t\tancestryA = getAncestry( a.component || a._ractive.proxy );\n\t\t\tancestryB = getAncestry( b.component || b._ractive.proxy );\n\t\t\toldestA = ancestryA[ ancestryA.length - 1 ];\n\t\t\toldestB = ancestryB[ ancestryB.length - 1 ];\n\t\t\t// remove items from the end of both ancestries as long as they are identical\n\t\t\t// - the final one removed is the closest mutual ancestor\n\t\t\twhile ( oldestA && oldestA === oldestB ) {\n\t\t\t\tancestryA.pop();\n\t\t\t\tancestryB.pop();\n\t\t\t\tmutualAncestor = oldestA;\n\t\t\t\toldestA = ancestryA[ ancestryA.length - 1 ];\n\t\t\t\toldestB = ancestryB[ ancestryB.length - 1 ];\n\t\t\t}\n\t\t\t// now that we have the mutual ancestor, we can find which is earliest\n\t\t\toldestA = oldestA.component || oldestA;\n\t\t\toldestB = oldestB.component || oldestB;\n\t\t\tfragmentA = oldestA.parentFragment;\n\t\t\tfragmentB = oldestB.parentFragment;\n\t\t\t// if both items share a parent fragment, our job is easy\n\t\t\tif ( fragmentA === fragmentB ) {\n\t\t\t\tindexA = fragmentA.items.indexOf( oldestA );\n\t\t\t\tindexB = fragmentB.items.indexOf( oldestB );\n\t\t\t\t// if it's the same index, it means one contains the other,\n\t\t\t\t// so we see which has the longest ancestry\n\t\t\t\treturn indexA - indexB || ancestryA.length - ancestryB.length;\n\t\t\t}\n\t\t\t// if mutual ancestor is a section, we first test to see which section\n\t\t\t// fragment comes first\n\t\t\tif ( fragments = mutualAncestor.fragments ) {\n\t\t\t\tindexA = fragments.indexOf( fragmentA );\n\t\t\t\tindexB = fragments.indexOf( fragmentB );\n\t\t\t\treturn indexA - indexB || ancestryA.length - ancestryB.length;\n\t\t\t}\n\t\t\tthrow new Error( 'An unexpected condition was met while comparing the position of two components. Please file an issue at https://github.com/RactiveJS/Ractive/issues - thanks!' );\n\t\t};\n\n\t\tfunction getParent( item ) {\n\t\t\tvar parentFragment;\n\t\t\tif ( parentFragment = item.parentFragment ) {\n\t\t\t\treturn parentFragment.owner;\n\t\t\t}\n\t\t\tif ( item.component && ( parentFragment = item.component.parentFragment ) ) {\n\t\t\t\treturn parentFragment.owner;\n\t\t\t}\n\t\t}\n\n\t\tfunction getAncestry( item ) {\n\t\t\tvar ancestry, ancestor;\n\t\t\tancestry = [ item ];\n\t\t\tancestor = getParent( item );\n\t\t\twhile ( ancestor ) {\n\t\t\t\tancestry.push( ancestor );\n\t\t\t\tancestor = getParent( ancestor );\n\t\t\t}\n\t\t\treturn ancestry;\n\t\t}\n\t\treturn __export;\n\t}();\n\n\t/* Ractive/prototype/shared/makeQuery/sortByDocumentPosition.js */\n\tvar Ractive$shared_makeQuery_sortByDocumentPosition = function( sortByItemPosition ) {\n\n\t\treturn function( node, otherNode ) {\n\t\t\tvar bitmask;\n\t\t\tif ( node.compareDocumentPosition ) {\n\t\t\t\tbitmask = node.compareDocumentPosition( otherNode );\n\t\t\t\treturn bitmask & 2 ? 1 : -1;\n\t\t\t}\n\t\t\t// In old IE, we can piggy back on the mechanism for\n\t\t\t// comparing component positions\n\t\t\treturn sortByItemPosition( node, otherNode );\n\t\t};\n\t}( Ractive$shared_makeQuery_sortByItemPosition );\n\n\t/* Ractive/prototype/shared/makeQuery/sort.js */\n\tvar Ractive$shared_makeQuery_sort = function( sortByDocumentPosition, sortByItemPosition ) {\n\n\t\treturn function() {\n\t\t\tthis.sort( this._isComponentQuery ? sortByItemPosition : sortByDocumentPosition );\n\t\t\tthis._dirty = false;\n\t\t};\n\t}( Ractive$shared_makeQuery_sortByDocumentPosition, Ractive$shared_makeQuery_sortByItemPosition );\n\n\t/* Ractive/prototype/shared/makeQuery/dirty.js */\n\tvar Ractive$shared_makeQuery_dirty = function( runloop ) {\n\n\t\treturn function() {\n\t\t\tvar this$0 = this;\n\t\t\tif ( !this._dirty ) {\n\t\t\t\tthis._dirty = true;\n\t\t\t\t// Once the DOM has been updated, ensure the query\n\t\t\t\t// is correctly ordered\n\t\t\t\trunloop.scheduleTask( function() {\n\t\t\t\t\tthis$0._sort();\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\t}( runloop );\n\n\t/* Ractive/prototype/shared/makeQuery/remove.js */\n\tvar Ractive$shared_makeQuery_remove = function( nodeOrComponent ) {\n\t\tvar index = this.indexOf( this._isComponentQuery ? nodeOrComponent.instance : nodeOrComponent );\n\t\tif ( index !== -1 ) {\n\t\t\tthis.splice( index, 1 );\n\t\t}\n\t};\n\n\t/* Ractive/prototype/shared/makeQuery/_makeQuery.js */\n\tvar Ractive$shared_makeQuery__makeQuery = function( defineProperties, test, cancel, sort, dirty, remove ) {\n\n\t\treturn function makeQuery( ractive, selector, live, isComponentQuery ) {\n\t\t\tvar query = [];\n\t\t\tdefineProperties( query, {\n\t\t\t\tselector: {\n\t\t\t\t\tvalue: selector\n\t\t\t\t},\n\t\t\t\tlive: {\n\t\t\t\t\tvalue: live\n\t\t\t\t},\n\t\t\t\t_isComponentQuery: {\n\t\t\t\t\tvalue: isComponentQuery\n\t\t\t\t},\n\t\t\t\t_test: {\n\t\t\t\t\tvalue: test\n\t\t\t\t}\n\t\t\t} );\n\t\t\tif ( !live ) {\n\t\t\t\treturn query;\n\t\t\t}\n\t\t\tdefineProperties( query, {\n\t\t\t\tcancel: {\n\t\t\t\t\tvalue: cancel\n\t\t\t\t},\n\t\t\t\t_root: {\n\t\t\t\t\tvalue: ractive\n\t\t\t\t},\n\t\t\t\t_sort: {\n\t\t\t\t\tvalue: sort\n\t\t\t\t},\n\t\t\t\t_makeDirty: {\n\t\t\t\t\tvalue: dirty\n\t\t\t\t},\n\t\t\t\t_remove: {\n\t\t\t\t\tvalue: remove\n\t\t\t\t},\n\t\t\t\t_dirty: {\n\t\t\t\t\tvalue: false,\n\t\t\t\t\twritable: true\n\t\t\t\t}\n\t\t\t} );\n\t\t\treturn query;\n\t\t};\n\t}( defineProperties, Ractive$shared_makeQuery_test, Ractive$shared_makeQuery_cancel, Ractive$shared_makeQuery_sort, Ractive$shared_makeQuery_dirty, Ractive$shared_makeQuery_remove );\n\n\t/* Ractive/prototype/findAll.js */\n\tvar Ractive$findAll = function( makeQuery ) {\n\n\t\treturn function Ractive$findAll( selector, options ) {\n\t\t\tvar liveQueries, query;\n\t\t\tif ( !this.el ) {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t\toptions = options || {};\n\t\t\tliveQueries = this._liveQueries;\n\t\t\t// Shortcut: if we're maintaining a live query with this\n\t\t\t// selector, we don't need to traverse the parallel DOM\n\t\t\tif ( query = liveQueries[ selector ] ) {\n\t\t\t\t// Either return the exact same query, or (if not live) a snapshot\n\t\t\t\treturn options && options.live ? query : query.slice();\n\t\t\t}\n\t\t\tquery = makeQuery( this, selector, !!options.live, false );\n\t\t\t// Add this to the list of live queries Ractive needs to maintain,\n\t\t\t// if applicable\n\t\t\tif ( query.live ) {\n\t\t\t\tliveQueries.push( selector );\n\t\t\t\tliveQueries[ '_' + selector ] = query;\n\t\t\t}\n\t\t\tthis.fragment.findAll( selector, query );\n\t\t\treturn query;\n\t\t};\n\t}( Ractive$shared_makeQuery__makeQuery );\n\n\t/* Ractive/prototype/findAllComponents.js */\n\tvar Ractive$findAllComponents = function( makeQuery ) {\n\n\t\treturn function Ractive$findAllComponents( selector, options ) {\n\t\t\tvar liveQueries, query;\n\t\t\toptions = options || {};\n\t\t\tliveQueries = this._liveComponentQueries;\n\t\t\t// Shortcut: if we're maintaining a live query with this\n\t\t\t// selector, we don't need to traverse the parallel DOM\n\t\t\tif ( query = liveQueries[ selector ] ) {\n\t\t\t\t// Either return the exact same query, or (if not live) a snapshot\n\t\t\t\treturn options && options.live ? query : query.slice();\n\t\t\t}\n\t\t\tquery = makeQuery( this, selector, !!options.live, true );\n\t\t\t// Add this to the list of live queries Ractive needs to maintain,\n\t\t\t// if applicable\n\t\t\tif ( query.live ) {\n\t\t\t\tliveQueries.push( selector );\n\t\t\t\tliveQueries[ '_' + selector ] = query;\n\t\t\t}\n\t\t\tthis.fragment.findAllComponents( selector, query );\n\t\t\treturn query;\n\t\t};\n\t}( Ractive$shared_makeQuery__makeQuery );\n\n\t/* Ractive/prototype/findComponent.js */\n\tvar Ractive$findComponent = function Ractive$findComponent( selector ) {\n\t\treturn this.fragment.findComponent( selector );\n\t};\n\n\t/* utils/getPotentialWildcardMatches.js */\n\tvar getPotentialWildcardMatches = function() {\n\n\t\tvar __export;\n\t\tvar starMaps = {};\n\t\t// This function takes a keypath such as 'foo.bar.baz', and returns\n\t\t// all the variants of that keypath that include a wildcard in place\n\t\t// of a key, such as 'foo.bar.*', 'foo.*.baz', 'foo.*.*' and so on.\n\t\t// These are then checked against the dependants map (ractive.viewmodel.depsMap)\n\t\t// to see if any pattern observers are downstream of one or more of\n\t\t// these wildcard keypaths (e.g. 'foo.bar.*.status')\n\t\t__export = function getPotentialWildcardMatches( keypath ) {\n\t\t\tvar keys, starMap, mapper, i, result, wildcardKeypath;\n\t\t\tkeys = keypath.split( '.' );\n\t\t\tif ( !( starMap = starMaps[ keys.length ] ) ) {\n\t\t\t\tstarMap = getStarMap( keys.length );\n\t\t\t}\n\t\t\tresult = [];\n\t\t\tmapper = function( star, i ) {\n\t\t\t\treturn star ? '*' : keys[ i ];\n\t\t\t};\n\t\t\ti = starMap.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\twildcardKeypath = starMap[ i ].map( mapper ).join( '.' );\n\t\t\t\tif ( !result.hasOwnProperty( wildcardKeypath ) ) {\n\t\t\t\t\tresult.push( wildcardKeypath );\n\t\t\t\t\tresult[ wildcardKeypath ] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t};\n\t\t// This function returns all the possible true/false combinations for\n\t\t// a given number - e.g. for two, the possible combinations are\n\t\t// [ true, true ], [ true, false ], [ false, true ], [ false, false ].\n\t\t// It does so by getting all the binary values between 0 and e.g. 11\n\t\tfunction getStarMap( num ) {\n\t\t\tvar ones = '',\n\t\t\t\tmax, binary, starMap, mapper, i;\n\t\t\tif ( !starMaps[ num ] ) {\n\t\t\t\tstarMap = [];\n\t\t\t\twhile ( ones.length < num ) {\n\t\t\t\t\tones += 1;\n\t\t\t\t}\n\t\t\t\tmax = parseInt( ones, 2 );\n\t\t\t\tmapper = function( digit ) {\n\t\t\t\t\treturn digit === '1';\n\t\t\t\t};\n\t\t\t\tfor ( i = 0; i <= max; i += 1 ) {\n\t\t\t\t\tbinary = i.toString( 2 );\n\t\t\t\t\twhile ( binary.length < num ) {\n\t\t\t\t\t\tbinary = '0' + binary;\n\t\t\t\t\t}\n\t\t\t\t\tstarMap[ i ] = Array.prototype.map.call( binary, mapper );\n\t\t\t\t}\n\t\t\t\tstarMaps[ num ] = starMap;\n\t\t\t}\n\t\t\treturn starMaps[ num ];\n\t\t}\n\t\treturn __export;\n\t}();\n\n\t/* Ractive/prototype/shared/fireEvent.js */\n\tvar Ractive$shared_fireEvent = function( getPotentialWildcardMatches ) {\n\n\t\tvar __export;\n\t\t__export = function fireEvent( ractive, eventName ) {\n\t\t\tvar options = arguments[ 2 ];\n\t\t\tif ( options === void 0 )\n\t\t\t\toptions = {};\n\t\t\tif ( !eventName ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif ( !options.event ) {\n\t\t\t\toptions.event = {\n\t\t\t\t\tname: eventName,\n\t\t\t\t\tcontext: ractive.data,\n\t\t\t\t\tkeypath: '',\n\t\t\t\t\t// until event not included as argument default\n\t\t\t\t\t_noArg: true\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\toptions.event.name = eventName;\n\t\t\t}\n\t\t\tvar eventNames = getPotentialWildcardMatches( eventName );\n\t\t\tfireEventAs( ractive, eventNames, options.event, options.args, true );\n\t\t};\n\n\t\tfunction fireEventAs( ractive, eventNames, event, args ) {\n\t\t\tvar initialFire = arguments[ 4 ];\n\t\t\tif ( initialFire === void 0 )\n\t\t\t\tinitialFire = false;\n\t\t\tvar subscribers, i, bubble = true;\n\t\t\tif ( event ) {\n\t\t\t\tractive.event = event;\n\t\t\t}\n\t\t\tfor ( i = eventNames.length; i >= 0; i-- ) {\n\t\t\t\tsubscribers = ractive._subs[ eventNames[ i ] ];\n\t\t\t\tif ( subscribers ) {\n\t\t\t\t\tbubble = notifySubscribers( ractive, subscribers, event, args ) && bubble;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( event ) {\n\t\t\t\tdelete ractive.event;\n\t\t\t}\n\t\t\tif ( ractive._parent && bubble ) {\n\t\t\t\tif ( initialFire && ractive.component ) {\n\t\t\t\t\tvar fullName = ractive.component.name + '.' + eventNames[ eventNames.length - 1 ];\n\t\t\t\t\teventNames = getPotentialWildcardMatches( fullName );\n\t\t\t\t\tif ( event ) {\n\t\t\t\t\t\tevent.component = ractive;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfireEventAs( ractive._parent, eventNames, event, args );\n\t\t\t}\n\t\t}\n\n\t\tfunction notifySubscribers( ractive, subscribers, event, args ) {\n\t\t\tvar originalEvent = null,\n\t\t\t\tstopEvent = false;\n\t\t\tif ( event && !event._noArg ) {\n\t\t\t\targs = [ event ].concat( args );\n\t\t\t}\n\t\t\tfor ( var i = 0, len = subscribers.length; i < len; i += 1 ) {\n\t\t\t\tif ( subscribers[ i ].apply( ractive, args ) === false ) {\n\t\t\t\t\tstopEvent = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( event && !event._noArg && stopEvent && ( originalEvent = event.original ) ) {\n\t\t\t\toriginalEvent.preventDefault && originalEvent.preventDefault();\n\t\t\t\toriginalEvent.stopPropagation && originalEvent.stopPropagation();\n\t\t\t}\n\t\t\treturn !stopEvent;\n\t\t}\n\t\treturn __export;\n\t}( getPotentialWildcardMatches );\n\n\t/* Ractive/prototype/fire.js */\n\tvar Ractive$fire = function( fireEvent ) {\n\n\t\treturn function Ractive$fire( eventName ) {\n\t\t\tvar options = {\n\t\t\t\targs: Array.prototype.slice.call( arguments, 1 )\n\t\t\t};\n\t\t\tfireEvent( this, eventName, options );\n\t\t};\n\t}( Ractive$shared_fireEvent );\n\n\t/* Ractive/prototype/get.js */\n\tvar Ractive$get = function( normaliseKeypath, resolveRef ) {\n\n\t\tvar options = {\n\t\t\tcapture: true\n\t\t};\n\t\t// top-level calls should be intercepted\n\t\treturn function Ractive$get( keypath ) {\n\t\t\tvar value;\n\t\t\tkeypath = normaliseKeypath( keypath );\n\t\t\tvalue = this.viewmodel.get( keypath, options );\n\t\t\t// Create inter-component binding, if necessary\n\t\t\tif ( value === undefined && this._parent && !this.isolated ) {\n\t\t\t\tif ( resolveRef( this, keypath, this.fragment ) ) {\n\t\t\t\t\t// creates binding as side-effect, if appropriate\n\t\t\t\t\tvalue = this.viewmodel.get( keypath );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn value;\n\t\t};\n\t}( normaliseKeypath, resolveRef );\n\n\t/* utils/getElement.js */\n\tvar getElement = function getElement( input ) {\n\t\tvar output;\n\t\tif ( !input || typeof input === 'boolean' ) {\n\t\t\treturn;\n\t\t}\n\t\tif ( typeof window === 'undefined' || !document || !input ) {\n\t\t\treturn null;\n\t\t}\n\t\t// We already have a DOM node - no work to do. (Duck typing alert!)\n\t\tif ( input.nodeType ) {\n\t\t\treturn input;\n\t\t}\n\t\t// Get node from string\n\t\tif ( typeof input === 'string' ) {\n\t\t\t// try ID first\n\t\t\toutput = document.getElementById( input );\n\t\t\t// then as selector, if possible\n\t\t\tif ( !output && document.querySelector ) {\n\t\t\t\toutput = document.querySelector( input );\n\t\t\t}\n\t\t\t// did it work?\n\t\t\tif ( output && output.nodeType ) {\n\t\t\t\treturn output;\n\t\t\t}\n\t\t}\n\t\t// If we've been given a collection (jQuery, Zepto etc), extract the first item\n\t\tif ( input[ 0 ] && input[ 0 ].nodeType ) {\n\t\t\treturn input[ 0 ];\n\t\t}\n\t\treturn null;\n\t};\n\n\t/* Ractive/prototype/insert.js */\n\tvar Ractive$insert = function( Hook, getElement ) {\n\n\t\tvar __export;\n\t\tvar insertHook = new Hook( 'insert' );\n\t\t__export = function Ractive$insert( target, anchor ) {\n\t\t\tif ( !this.fragment.rendered ) {\n\t\t\t\t// TODO create, and link to, documentation explaining this\n\t\t\t\tthrow new Error( 'The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.' );\n\t\t\t}\n\t\t\ttarget = getElement( target );\n\t\t\tanchor = getElement( anchor ) || null;\n\t\t\tif ( !target ) {\n\t\t\t\tthrow new Error( 'You must specify a valid target to insert into' );\n\t\t\t}\n\t\t\ttarget.insertBefore( this.detach(), anchor );\n\t\t\tthis.el = target;\n\t\t\t( target.__ractive_instances__ || ( target.__ractive_instances__ = [] ) ).push( this );\n\t\t\tthis.detached = null;\n\t\t\tfireInsertHook( this );\n\t\t};\n\n\t\tfunction fireInsertHook( ractive ) {\n\t\t\tinsertHook.fire( ractive );\n\t\t\tractive.findAllComponents( '*' ).forEach( function( child ) {\n\t\t\t\tfireInsertHook( child.instance );\n\t\t\t} );\n\t\t}\n\t\treturn __export;\n\t}( Ractive$shared_hooks_Hook, getElement );\n\n\t/* Ractive/prototype/merge.js */\n\tvar Ractive$merge = function( runloop, isArray, normaliseKeypath ) {\n\n\t\treturn function Ractive$merge( keypath, array, options ) {\n\t\t\tvar currentArray, promise;\n\t\t\tkeypath = normaliseKeypath( keypath );\n\t\t\tcurrentArray = this.viewmodel.get( keypath );\n\t\t\t// If either the existing value or the new value isn't an\n\t\t\t// array, just do a regular set\n\t\t\tif ( !isArray( currentArray ) || !isArray( array ) ) {\n\t\t\t\treturn this.set( keypath, array, options && options.complete );\n\t\t\t}\n\t\t\t// Manage transitions\n\t\t\tpromise = runloop.start( this, true );\n\t\t\tthis.viewmodel.merge( keypath, currentArray, array, options );\n\t\t\trunloop.end();\n\t\t\t// attach callback as fulfilment handler, if specified\n\t\t\tif ( options && options.complete ) {\n\t\t\t\tpromise.then( options.complete );\n\t\t\t}\n\t\t\treturn promise;\n\t\t};\n\t}( runloop, isArray, normaliseKeypath );\n\n\t/* Ractive/prototype/observe/Observer.js */\n\tvar Ractive$observe_Observer = function( runloop, isEqual ) {\n\n\t\tvar Observer = function( ractive, keypath, callback, options ) {\n\t\t\tthis.root = ractive;\n\t\t\tthis.keypath = keypath;\n\t\t\tthis.callback = callback;\n\t\t\tthis.defer = options.defer;\n\t\t\t// default to root as context, but allow it to be overridden\n\t\t\tthis.context = options && options.context ? options.context : ractive;\n\t\t};\n\t\tObserver.prototype = {\n\t\t\tinit: function( immediate ) {\n\t\t\t\tthis.value = this.root.get( this.keypath );\n\t\t\t\tif ( immediate !== false ) {\n\t\t\t\t\tthis.update();\n\t\t\t\t} else {\n\t\t\t\t\tthis.oldValue = this.value;\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetValue: function( value ) {\n\t\t\t\tvar this$0 = this;\n\t\t\t\tif ( !isEqual( value, this.value ) ) {\n\t\t\t\t\tthis.value = value;\n\t\t\t\t\tif ( this.defer && this.ready ) {\n\t\t\t\t\t\trunloop.scheduleTask( function() {\n\t\t\t\t\t\t\treturn this$0.update();\n\t\t\t\t\t\t} );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.update();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: function() {\n\t\t\t\t// Prevent infinite loops\n\t\t\t\tif ( this.updating ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.updating = true;\n\t\t\t\tthis.callback.call( this.context, this.value, this.oldValue, this.keypath );\n\t\t\t\tthis.oldValue = this.value;\n\t\t\t\tthis.updating = false;\n\t\t\t}\n\t\t};\n\t\treturn Observer;\n\t}( runloop, isEqual );\n\n\t/* shared/getMatchingKeypaths.js */\n\tvar getMatchingKeypaths = function( isArray ) {\n\n\t\treturn function getMatchingKeypaths( ractive, pattern ) {\n\t\t\tvar keys, key, matchingKeypaths;\n\t\t\tkeys = pattern.split( '.' );\n\t\t\tmatchingKeypaths = [ '' ];\n\t\t\twhile ( key = keys.shift() ) {\n\t\t\t\tif ( key === '*' ) {\n\t\t\t\t\t// expand to find all valid child keypaths\n\t\t\t\t\tmatchingKeypaths = matchingKeypaths.reduce( expand, [] );\n\t\t\t\t} else {\n\t\t\t\t\tif ( matchingKeypaths[ 0 ] === '' ) {\n\t\t\t\t\t\t// first key\n\t\t\t\t\t\tmatchingKeypaths[ 0 ] = key;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmatchingKeypaths = matchingKeypaths.map( concatenate( key ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn matchingKeypaths;\n\n\t\t\tfunction expand( matchingKeypaths, keypath ) {\n\t\t\t\tvar value, key, childKeypath;\n\t\t\t\tvalue = ractive.viewmodel.wrapped[ keypath ] ? ractive.viewmodel.wrapped[ keypath ].get() : ractive.get( keypath );\n\t\t\t\tfor ( key in value ) {\n\t\t\t\t\tif ( value.hasOwnProperty( key ) && ( key !== '_ractive' || !isArray( value ) ) ) {\n\t\t\t\t\t\t// for benefit of IE8\n\t\t\t\t\t\tchildKeypath = keypath ? keypath + '.' + key : key;\n\t\t\t\t\t\tmatchingKeypaths.push( childKeypath );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn matchingKeypaths;\n\t\t\t}\n\n\t\t\tfunction concatenate( key ) {\n\t\t\t\treturn function( keypath ) {\n\t\t\t\t\treturn keypath ? keypath + '.' + key : key;\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t}( isArray );\n\n\t/* Ractive/prototype/observe/getPattern.js */\n\tvar Ractive$observe_getPattern = function( getMatchingKeypaths ) {\n\n\t\treturn function getPattern( ractive, pattern ) {\n\t\t\tvar matchingKeypaths, values;\n\t\t\tmatchingKeypaths = getMatchingKeypaths( ractive, pattern );\n\t\t\tvalues = {};\n\t\t\tmatchingKeypaths.forEach( function( keypath ) {\n\t\t\t\tvalues[ keypath ] = ractive.get( keypath );\n\t\t\t} );\n\t\t\treturn values;\n\t\t};\n\t}( getMatchingKeypaths );\n\n\t/* Ractive/prototype/observe/PatternObserver.js */\n\tvar Ractive$observe_PatternObserver = function( runloop, isEqual, getPattern ) {\n\n\t\tvar PatternObserver, wildcard = /\\*/,\n\t\t\tslice = Array.prototype.slice;\n\t\tPatternObserver = function( ractive, keypath, callback, options ) {\n\t\t\tthis.root = ractive;\n\t\t\tthis.callback = callback;\n\t\t\tthis.defer = options.defer;\n\t\t\tthis.keypath = keypath;\n\t\t\tthis.regex = new RegExp( '^' + keypath.replace( /\\./g, '\\\\.' ).replace( /\\*/g, '([^\\\\.]+)' ) + '$' );\n\t\t\tthis.values = {};\n\t\t\tif ( this.defer ) {\n\t\t\t\tthis.proxies = [];\n\t\t\t}\n\t\t\t// default to root as context, but allow it to be overridden\n\t\t\tthis.context = options && options.context ? options.context : ractive;\n\t\t};\n\t\tPatternObserver.prototype = {\n\t\t\tinit: function( immediate ) {\n\t\t\t\tvar values, keypath;\n\t\t\t\tvalues = getPattern( this.root, this.keypath );\n\t\t\t\tif ( immediate !== false ) {\n\t\t\t\t\tfor ( keypath in values ) {\n\t\t\t\t\t\tif ( values.hasOwnProperty( keypath ) ) {\n\t\t\t\t\t\t\tthis.update( keypath );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.values = values;\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: function( keypath ) {\n\t\t\t\tvar this$0 = this;\n\t\t\t\tvar values;\n\t\t\t\tif ( wildcard.test( keypath ) ) {\n\t\t\t\t\tvalues = getPattern( this.root, keypath );\n\t\t\t\t\tfor ( keypath in values ) {\n\t\t\t\t\t\tif ( values.hasOwnProperty( keypath ) ) {\n\t\t\t\t\t\t\tthis.update( keypath );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// special case - array mutation should not trigger `array.*`\n\t\t\t\t// pattern observer with `array.length`\n\t\t\t\tif ( this.root.viewmodel.implicitChanges[ keypath ] ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif ( this.defer && this.ready ) {\n\t\t\t\t\trunloop.scheduleTask( function() {\n\t\t\t\t\t\treturn this$0.getProxy( keypath ).update();\n\t\t\t\t\t} );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.reallyUpdate( keypath );\n\t\t\t},\n\t\t\treallyUpdate: function( keypath ) {\n\t\t\t\tvar value, keys, args;\n\t\t\t\tvalue = this.root.viewmodel.get( keypath );\n\t\t\t\t// Prevent infinite loops\n\t\t\t\tif ( this.updating ) {\n\t\t\t\t\tthis.values[ keypath ] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.updating = true;\n\t\t\t\tif ( !isEqual( value, this.values[ keypath ] ) || !this.ready ) {\n\t\t\t\t\tkeys = slice.call( this.regex.exec( keypath ), 1 );\n\t\t\t\t\targs = [\n\t\t\t\t\t\tvalue,\n\t\t\t\t\t\tthis.values[ keypath ],\n\t\t\t\t\t\tkeypath\n\t\t\t\t\t].concat( keys );\n\t\t\t\t\tthis.callback.apply( this.context, args );\n\t\t\t\t\tthis.values[ keypath ] = value;\n\t\t\t\t}\n\t\t\t\tthis.updating = false;\n\t\t\t},\n\t\t\tgetProxy: function( keypath ) {\n\t\t\t\tvar self = this;\n\t\t\t\tif ( !this.proxies[ keypath ] ) {\n\t\t\t\t\tthis.proxies[ keypath ] = {\n\t\t\t\t\t\tupdate: function() {\n\t\t\t\t\t\t\tself.reallyUpdate( keypath );\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn this.proxies[ keypath ];\n\t\t\t}\n\t\t};\n\t\treturn PatternObserver;\n\t}( runloop, isEqual, Ractive$observe_getPattern );\n\n\t/* Ractive/prototype/observe/getObserverFacade.js */\n\tvar Ractive$observe_getObserverFacade = function( normaliseKeypath, Observer, PatternObserver ) {\n\n\t\tvar wildcard = /\\*/,\n\t\t\temptyObject = {};\n\t\treturn function getObserverFacade( ractive, keypath, callback, options ) {\n\t\t\tvar observer, isPatternObserver, cancelled;\n\t\t\tkeypath = normaliseKeypath( keypath );\n\t\t\toptions = options || emptyObject;\n\t\t\t// pattern observers are treated differently\n\t\t\tif ( wildcard.test( keypath ) ) {\n\t\t\t\tobserver = new PatternObserver( ractive, keypath, callback, options );\n\t\t\t\tractive.viewmodel.patternObservers.push( observer );\n\t\t\t\tisPatternObserver = true;\n\t\t\t} else {\n\t\t\t\tobserver = new Observer( ractive, keypath, callback, options );\n\t\t\t}\n\t\t\tractive.viewmodel.register( keypath, observer, isPatternObserver ? 'patternObservers' : 'observers' );\n\t\t\tobserver.init( options.init );\n\t\t\t// This flag allows observers to initialise even with undefined values\n\t\t\tobserver.ready = true;\n\t\t\treturn {\n\t\t\t\tcancel: function() {\n\t\t\t\t\tvar index;\n\t\t\t\t\tif ( cancelled ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif ( isPatternObserver ) {\n\t\t\t\t\t\tindex = ractive.viewmodel.patternObservers.indexOf( observer );\n\t\t\t\t\t\tractive.viewmodel.patternObservers.splice( index, 1 );\n\t\t\t\t\t\tractive.viewmodel.unregister( keypath, observer, 'patternObservers' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tractive.viewmodel.unregister( keypath, observer, 'observers' );\n\t\t\t\t\t}\n\t\t\t\t\tcancelled = true;\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t}( normaliseKeypath, Ractive$observe_Observer, Ractive$observe_PatternObserver );\n\n\t/* Ractive/prototype/observe.js */\n\tvar Ractive$observe = function( isObject, getObserverFacade ) {\n\n\t\treturn function Ractive$observe( keypath, callback, options ) {\n\t\t\tvar observers, map, keypaths, i;\n\t\t\t// Allow a map of keypaths to handlers\n\t\t\tif ( isObject( keypath ) ) {\n\t\t\t\toptions = callback;\n\t\t\t\tmap = keypath;\n\t\t\t\tobservers = [];\n\t\t\t\tfor ( keypath in map ) {\n\t\t\t\t\tif ( map.hasOwnProperty( keypath ) ) {\n\t\t\t\t\t\tcallback = map[ keypath ];\n\t\t\t\t\t\tobservers.push( this.observe( keypath, callback, options ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tcancel: function() {\n\t\t\t\t\t\twhile ( observers.length ) {\n\t\t\t\t\t\t\tobservers.pop().cancel();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\t// Allow `ractive.observe( callback )` - i.e. observe entire model\n\t\t\tif ( typeof keypath === 'function' ) {\n\t\t\t\toptions = callback;\n\t\t\t\tcallback = keypath;\n\t\t\t\tkeypath = '';\n\t\t\t\treturn getObserverFacade( this, keypath, callback, options );\n\t\t\t}\n\t\t\tkeypaths = keypath.split( ' ' );\n\t\t\t// Single keypath\n\t\t\tif ( keypaths.length === 1 ) {\n\t\t\t\treturn getObserverFacade( this, keypath, callback, options );\n\t\t\t}\n\t\t\t// Multiple space-separated keypaths\n\t\t\tobservers = [];\n\t\t\ti = keypaths.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tkeypath = keypaths[ i ];\n\t\t\t\tif ( keypath ) {\n\t\t\t\t\tobservers.push( getObserverFacade( this, keypath, callback, options ) );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tcancel: function() {\n\t\t\t\t\twhile ( observers.length ) {\n\t\t\t\t\t\tobservers.pop().cancel();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t}( isObject, Ractive$observe_getObserverFacade );\n\n\t/* Ractive/prototype/shared/trim.js */\n\tvar Ractive$shared_trim = function( str ) {\n\t\treturn str.trim();\n\t};\n\n\t/* Ractive/prototype/shared/notEmptyString.js */\n\tvar Ractive$shared_notEmptyString = function( str ) {\n\t\treturn str !== '';\n\t};\n\n\t/* Ractive/prototype/off.js */\n\tvar Ractive$off = function( trim, notEmptyString ) {\n\n\t\treturn function Ractive$off( eventName, callback ) {\n\t\t\tvar this$0 = this;\n\t\t\tvar eventNames;\n\t\t\t// if no arguments specified, remove all callbacks\n\t\t\tif ( !eventName ) {\n\t\t\t\t// TODO use this code instead, once the following issue has been resolved\n\t\t\t\t// in PhantomJS (tests are unpassable otherwise!)\n\t\t\t\t// https://github.com/ariya/phantomjs/issues/11856\n\t\t\t\t// defineProperty( this, '_subs', { value: create( null ), configurable: true });\n\t\t\t\tfor ( eventName in this._subs ) {\n\t\t\t\t\tdelete this._subs[ eventName ];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Handle multiple space-separated event names\n\t\t\t\teventNames = eventName.split( ' ' ).map( trim ).filter( notEmptyString );\n\t\t\t\teventNames.forEach( function( eventName ) {\n\t\t\t\t\tvar subscribers, index;\n\t\t\t\t\t// If we have subscribers for this event...\n\t\t\t\t\tif ( subscribers = this$0._subs[ eventName ] ) {\n\t\t\t\t\t\t// ...if a callback was specified, only remove that\n\t\t\t\t\t\tif ( callback ) {\n\t\t\t\t\t\t\tindex = subscribers.indexOf( callback );\n\t\t\t\t\t\t\tif ( index !== -1 ) {\n\t\t\t\t\t\t\t\tsubscribers.splice( index, 1 );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis$0._subs[ eventName ] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t\treturn this;\n\t\t};\n\t}( Ractive$shared_trim, Ractive$shared_notEmptyString );\n\n\t/* Ractive/prototype/on.js */\n\tvar Ractive$on = function( trim, notEmptyString ) {\n\n\t\treturn function Ractive$on( eventName, callback ) {\n\t\t\tvar this$0 = this;\n\t\t\tvar self = this,\n\t\t\t\tlisteners, n, eventNames;\n\t\t\t// allow mutliple listeners to be bound in one go\n\t\t\tif ( typeof eventName === 'object' ) {\n\t\t\t\tlisteners = [];\n\t\t\t\tfor ( n in eventName ) {\n\t\t\t\t\tif ( eventName.hasOwnProperty( n ) ) {\n\t\t\t\t\t\tlisteners.push( this.on( n, eventName[ n ] ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tcancel: function() {\n\t\t\t\t\t\tvar listener;\n\t\t\t\t\t\twhile ( listener = listeners.pop() ) {\n\t\t\t\t\t\t\tlistener.cancel();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\t// Handle multiple space-separated event names\n\t\t\teventNames = eventName.split( ' ' ).map( trim ).filter( notEmptyString );\n\t\t\teventNames.forEach( function( eventName ) {\n\t\t\t\t( this$0._subs[ eventName ] || ( this$0._subs[ eventName ] = [] ) ).push( callback );\n\t\t\t} );\n\t\t\treturn {\n\t\t\t\tcancel: function() {\n\t\t\t\t\tself.off( eventName, callback );\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t}( Ractive$shared_trim, Ractive$shared_notEmptyString );\n\n\t/* shared/getNewIndices.js */\n\tvar getNewIndices = function() {\n\n\t\tvar __export;\n\t\t// This function takes an array, the name of a mutator method, and the\n\t\t// arguments to call that mutator method with, and returns an array that\n\t\t// maps the old indices to their new indices.\n\t\t// So if you had something like this...\n\t\t//\n\t\t//     array = [ 'a', 'b', 'c', 'd' ];\n\t\t//     array.push( 'e' );\n\t\t//\n\t\t// ...you'd get `[ 0, 1, 2, 3 ]` - in other words, none of the old indices\n\t\t// have changed. If you then did this...\n\t\t//\n\t\t//     array.unshift( 'z' );\n\t\t//\n\t\t// ...the indices would be `[ 1, 2, 3, 4, 5 ]` - every item has been moved\n\t\t// one higher to make room for the 'z'. If you removed an item, the new index\n\t\t// would be -1...\n\t\t//\n\t\t//     array.splice( 2, 2 );\n\t\t//\n\t\t// ...this would result in [ 0, 1, -1, -1, 2, 3 ].\n\t\t//\n\t\t// This information is used to enable fast, non-destructive shuffling of list\n\t\t// sections when you do e.g. `ractive.splice( 'items', 2, 2 );\n\t\t__export = function getNewIndices( array, methodName, args ) {\n\t\t\tvar spliceArguments, len, newIndices = [],\n\t\t\t\tremoveStart, removeEnd, balance, i;\n\t\t\tspliceArguments = getSpliceEquivalent( array, methodName, args );\n\t\t\tif ( !spliceArguments ) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tlen = array.length;\n\t\t\tbalance = spliceArguments.length - 2 - spliceArguments[ 1 ];\n\t\t\tremoveStart = Math.min( len, spliceArguments[ 0 ] );\n\t\t\tremoveEnd = removeStart + spliceArguments[ 1 ];\n\t\t\tfor ( i = 0; i < removeStart; i += 1 ) {\n\t\t\t\tnewIndices.push( i );\n\t\t\t}\n\t\t\tfor ( ; i < removeEnd; i += 1 ) {\n\t\t\t\tnewIndices.push( -1 );\n\t\t\t}\n\t\t\tfor ( ; i < len; i += 1 ) {\n\t\t\t\tnewIndices.push( i + balance );\n\t\t\t}\n\t\t\treturn newIndices;\n\t\t};\n\t\t// The pop, push, shift an unshift methods can all be represented\n\t\t// as an equivalent splice\n\t\tfunction getSpliceEquivalent( array, methodName, args ) {\n\t\t\tswitch ( methodName ) {\n\t\t\t\tcase 'splice':\n\t\t\t\t\tif ( args[ 0 ] !== undefined && args[ 0 ] < 0 ) {\n\t\t\t\t\t\targs[ 0 ] = array.length + Math.max( args[ 0 ], -array.length );\n\t\t\t\t\t}\n\t\t\t\t\twhile ( args.length < 2 ) {\n\t\t\t\t\t\targs.push( 0 );\n\t\t\t\t\t}\n\t\t\t\t\t// ensure we only remove elements that exist\n\t\t\t\t\targs[ 1 ] = Math.min( args[ 1 ], array.length - args[ 0 ] );\n\t\t\t\t\treturn args;\n\t\t\t\tcase 'sort':\n\t\t\t\tcase 'reverse':\n\t\t\t\t\treturn null;\n\t\t\t\tcase 'pop':\n\t\t\t\t\tif ( array.length ) {\n\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\tarray.length - 1,\n\t\t\t\t\t\t\t1\n\t\t\t\t\t\t];\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\tcase 'push':\n\t\t\t\t\treturn [\n\t\t\t\t\t\tarray.length,\n\t\t\t\t\t\t0\n\t\t\t\t\t].concat( args );\n\t\t\t\tcase 'shift':\n\t\t\t\t\treturn [\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t1\n\t\t\t\t\t];\n\t\t\t\tcase 'unshift':\n\t\t\t\t\treturn [\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t0\n\t\t\t\t\t].concat( args );\n\t\t\t}\n\t\t}\n\t\treturn __export;\n\t}();\n\n\t/* Ractive/prototype/shared/makeArrayMethod.js */\n\tvar Ractive$shared_makeArrayMethod = function( isArray, runloop, getNewIndices ) {\n\n\t\tvar arrayProto = Array.prototype;\n\t\treturn function( methodName ) {\n\t\t\treturn function( keypath ) {\n\t\t\t\tvar SLICE$0 = Array.prototype.slice;\n\t\t\t\tvar args = SLICE$0.call( arguments, 1 );\n\t\t\t\tvar array, newIndices = [],\n\t\t\t\t\tlen, promise, result;\n\t\t\t\tarray = this.get( keypath );\n\t\t\t\tlen = array.length;\n\t\t\t\tif ( !isArray( array ) ) {\n\t\t\t\t\tthrow new Error( 'Called ractive.' + methodName + '(\\'' + keypath + '\\'), but \\'' + keypath + '\\' does not refer to an array' );\n\t\t\t\t}\n\t\t\t\tnewIndices = getNewIndices( array, methodName, args );\n\t\t\t\tresult = arrayProto[ methodName ].apply( array, args );\n\t\t\t\tpromise = runloop.start( this, true ).then( function() {\n\t\t\t\t\treturn result;\n\t\t\t\t} );\n\t\t\t\tif ( !!newIndices ) {\n\t\t\t\t\tthis.viewmodel.smartUpdate( keypath, array, newIndices );\n\t\t\t\t} else {\n\t\t\t\t\tthis.viewmodel.mark( keypath );\n\t\t\t\t}\n\t\t\t\trunloop.end();\n\t\t\t\treturn promise;\n\t\t\t};\n\t\t};\n\t}( isArray, runloop, getNewIndices );\n\n\t/* Ractive/prototype/pop.js */\n\tvar Ractive$pop = function( makeArrayMethod ) {\n\n\t\treturn makeArrayMethod( 'pop' );\n\t}( Ractive$shared_makeArrayMethod );\n\n\t/* Ractive/prototype/push.js */\n\tvar Ractive$push = function( makeArrayMethod ) {\n\n\t\treturn makeArrayMethod( 'push' );\n\t}( Ractive$shared_makeArrayMethod );\n\n\t/* global/css.js */\n\tvar global_css = function( circular, isClient, removeFromArray ) {\n\n\t\tvar css, update, runloop, styleElement, head, styleSheet, inDom, prefix = '/* Ractive.js component styles */\\n',\n\t\t\tcomponentsInPage = {},\n\t\t\tstyles = [];\n\t\tif ( !isClient ) {\n\t\t\tcss = null;\n\t\t} else {\n\t\t\tcircular.push( function() {\n\t\t\t\trunloop = circular.runloop;\n\t\t\t} );\n\t\t\tstyleElement = document.createElement( 'style' );\n\t\t\tstyleElement.type = 'text/css';\n\t\t\thead = document.getElementsByTagName( 'head' )[ 0 ];\n\t\t\tinDom = false;\n\t\t\t// Internet Exploder won't let you use styleSheet.innerHTML - we have to\n\t\t\t// use styleSheet.cssText instead\n\t\t\tstyleSheet = styleElement.styleSheet;\n\t\t\tupdate = function() {\n\t\t\t\tvar css;\n\t\t\t\tif ( styles.length ) {\n\t\t\t\t\tcss = prefix + styles.join( ' ' );\n\t\t\t\t\tif ( styleSheet ) {\n\t\t\t\t\t\tstyleSheet.cssText = css;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstyleElement.innerHTML = css;\n\t\t\t\t\t}\n\t\t\t\t\tif ( !inDom ) {\n\t\t\t\t\t\thead.appendChild( styleElement );\n\t\t\t\t\t\tinDom = true;\n\t\t\t\t\t}\n\t\t\t\t} else if ( inDom ) {\n\t\t\t\t\thead.removeChild( styleElement );\n\t\t\t\t\tinDom = false;\n\t\t\t\t}\n\t\t\t};\n\t\t\tcss = {\n\t\t\t\tadd: function( Component ) {\n\t\t\t\t\tif ( !Component.css ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif ( !componentsInPage[ Component._guid ] ) {\n\t\t\t\t\t\t// we create this counter so that we can in/decrement it as\n\t\t\t\t\t\t// instances are added and removed. When all components are\n\t\t\t\t\t\t// removed, the style is too\n\t\t\t\t\t\tcomponentsInPage[ Component._guid ] = 0;\n\t\t\t\t\t\tstyles.push( Component.css );\n\t\t\t\t\t\tupdate();\n\t\t\t\t\t}\n\t\t\t\t\tcomponentsInPage[ Component._guid ] += 1;\n\t\t\t\t},\n\t\t\t\tremove: function( Component ) {\n\t\t\t\t\tif ( !Component.css ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcomponentsInPage[ Component._guid ] -= 1;\n\t\t\t\t\tif ( !componentsInPage[ Component._guid ] ) {\n\t\t\t\t\t\tremoveFromArray( styles, Component.css );\n\t\t\t\t\t\trunloop.scheduleTask( update );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\treturn css;\n\t}( circular, isClient, removeFromArray );\n\n\t/* Ractive/prototype/render.js */\n\tvar Ractive$render = function( css, Hook, getElement, runloop ) {\n\n\t\tvar renderHook = new Hook( 'render' ),\n\t\t\tcompleteHook = new Hook( 'complete' );\n\t\treturn function Ractive$render( target, anchor ) {\n\t\t\tvar this$0 = this;\n\t\t\tvar promise, instances, transitionsEnabled;\n\t\t\t// if `noIntro` is `true`, temporarily disable transitions\n\t\t\ttransitionsEnabled = this.transitionsEnabled;\n\t\t\tif ( this.noIntro ) {\n\t\t\t\tthis.transitionsEnabled = false;\n\t\t\t}\n\t\t\tpromise = runloop.start( this, true );\n\t\t\trunloop.scheduleTask( function() {\n\t\t\t\treturn renderHook.fire( this$0 );\n\t\t\t}, true );\n\t\t\tif ( this.fragment.rendered ) {\n\t\t\t\tthrow new Error( 'You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first' );\n\t\t\t}\n\t\t\ttarget = getElement( target ) || this.el;\n\t\t\tanchor = getElement( anchor ) || this.anchor;\n\t\t\tthis.el = target;\n\t\t\tthis.anchor = anchor;\n\t\t\t// Add CSS, if applicable\n\t\t\tif ( this.constructor.css ) {\n\t\t\t\tcss.add( this.constructor );\n\t\t\t}\n\t\t\tif ( target ) {\n\t\t\t\tif ( !( instances = target.__ractive_instances__ ) ) {\n\t\t\t\t\ttarget.__ractive_instances__ = [ this ];\n\t\t\t\t} else {\n\t\t\t\t\tinstances.push( this );\n\t\t\t\t}\n\t\t\t\tif ( anchor ) {\n\t\t\t\t\ttarget.insertBefore( this.fragment.render(), anchor );\n\t\t\t\t} else {\n\t\t\t\t\ttarget.appendChild( this.fragment.render() );\n\t\t\t\t}\n\t\t\t}\n\t\t\trunloop.end();\n\t\t\tthis.transitionsEnabled = transitionsEnabled;\n\t\t\t// It is now more problematic to know if the complete hook\n\t\t\t// would fire. Method checking is straight-forward, but would\n\t\t\t// also require preflighting event subscriptions. Which seems\n\t\t\t// like more work then just letting the promise happen.\n\t\t\t// But perhaps I'm wrong about that...\n\t\t\tpromise.then( function() {\n\t\t\t\treturn completeHook.fire( this$0 );\n\t\t\t} );\n\t\t\treturn promise;\n\t\t};\n\t}( global_css, Ractive$shared_hooks_Hook, getElement, runloop );\n\n\t/* virtualdom/Fragment/prototype/bubble.js */\n\tvar virtualdom_Fragment$bubble = function Fragment$bubble() {\n\t\tthis.dirtyValue = this.dirtyArgs = true;\n\t\tif ( this.bound && typeof this.owner.bubble === 'function' ) {\n\t\t\tthis.owner.bubble();\n\t\t}\n\t};\n\n\t/* virtualdom/Fragment/prototype/detach.js */\n\tvar virtualdom_Fragment$detach = function Fragment$detach() {\n\t\tvar docFrag;\n\t\tif ( this.items.length === 1 ) {\n\t\t\treturn this.items[ 0 ].detach();\n\t\t}\n\t\tdocFrag = document.createDocumentFragment();\n\t\tthis.items.forEach( function( item ) {\n\t\t\tvar node = item.detach();\n\t\t\t// TODO The if {...} wasn't previously required - it is now, because we're\n\t\t\t// forcibly detaching everything to reorder sections after an update. That's\n\t\t\t// a non-ideal brute force approach, implemented to get all the tests to pass\n\t\t\t// - as soon as it's replaced with something more elegant, this should\n\t\t\t// revert to `docFrag.appendChild( item.detach() )`\n\t\t\tif ( node ) {\n\t\t\t\tdocFrag.appendChild( node );\n\t\t\t}\n\t\t} );\n\t\treturn docFrag;\n\t};\n\n\t/* virtualdom/Fragment/prototype/find.js */\n\tvar virtualdom_Fragment$find = function Fragment$find( selector ) {\n\t\tvar i, len, item, queryResult;\n\t\tif ( this.items ) {\n\t\t\tlen = this.items.length;\n\t\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\t\titem = this.items[ i ];\n\t\t\t\tif ( item.find && ( queryResult = item.find( selector ) ) ) {\n\t\t\t\t\treturn queryResult;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t};\n\n\t/* virtualdom/Fragment/prototype/findAll.js */\n\tvar virtualdom_Fragment$findAll = function Fragment$findAll( selector, query ) {\n\t\tvar i, len, item;\n\t\tif ( this.items ) {\n\t\t\tlen = this.items.length;\n\t\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\t\titem = this.items[ i ];\n\t\t\t\tif ( item.findAll ) {\n\t\t\t\t\titem.findAll( selector, query );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn query;\n\t};\n\n\t/* virtualdom/Fragment/prototype/findAllComponents.js */\n\tvar virtualdom_Fragment$findAllComponents = function Fragment$findAllComponents( selector, query ) {\n\t\tvar i, len, item;\n\t\tif ( this.items ) {\n\t\t\tlen = this.items.length;\n\t\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\t\titem = this.items[ i ];\n\t\t\t\tif ( item.findAllComponents ) {\n\t\t\t\t\titem.findAllComponents( selector, query );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn query;\n\t};\n\n\t/* virtualdom/Fragment/prototype/findComponent.js */\n\tvar virtualdom_Fragment$findComponent = function Fragment$findComponent( selector ) {\n\t\tvar len, i, item, queryResult;\n\t\tif ( this.items ) {\n\t\t\tlen = this.items.length;\n\t\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\t\titem = this.items[ i ];\n\t\t\t\tif ( item.findComponent && ( queryResult = item.findComponent( selector ) ) ) {\n\t\t\t\t\treturn queryResult;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t};\n\n\t/* virtualdom/Fragment/prototype/findNextNode.js */\n\tvar virtualdom_Fragment$findNextNode = function Fragment$findNextNode( item ) {\n\t\tvar index = item.index,\n\t\t\tnode;\n\t\tif ( this.items[ index + 1 ] ) {\n\t\t\tnode = this.items[ index + 1 ].firstNode();\n\t\t} else if ( this.owner === this.root ) {\n\t\t\tif ( !this.owner.component ) {\n\t\t\t\t// TODO but something else could have been appended to\n\t\t\t\t// this.root.el, no?\n\t\t\t\tnode = null;\n\t\t\t} else {\n\t\t\t\tnode = this.owner.component.findNextNode();\n\t\t\t}\n\t\t} else {\n\t\t\tnode = this.owner.findNextNode( this );\n\t\t}\n\t\treturn node;\n\t};\n\n\t/* virtualdom/Fragment/prototype/firstNode.js */\n\tvar virtualdom_Fragment$firstNode = function Fragment$firstNode() {\n\t\tif ( this.items && this.items[ 0 ] ) {\n\t\t\treturn this.items[ 0 ].firstNode();\n\t\t}\n\t\treturn null;\n\t};\n\n\t/* virtualdom/Fragment/prototype/getNode.js */\n\tvar virtualdom_Fragment$getNode = function Fragment$getNode() {\n\t\tvar fragment = this;\n\t\tdo {\n\t\t\tif ( fragment.pElement ) {\n\t\t\t\treturn fragment.pElement.node;\n\t\t\t}\n\t\t} while ( fragment = fragment.parent );\n\t\treturn this.root.detached || this.root.el;\n\t};\n\n\t/* virtualdom/Fragment/prototype/getValue.js */\n\tvar virtualdom_Fragment$getValue = function( parseJSON ) {\n\n\t\tvar __export;\n\t\tvar empty = {};\n\t\t__export = function Fragment$getValue() {\n\t\t\tvar options = arguments[ 0 ];\n\t\t\tif ( options === void 0 )\n\t\t\t\toptions = empty;\n\t\t\tvar asArgs, values, source, parsed, cachedResult, dirtyFlag, result;\n\t\t\tasArgs = options.args;\n\t\t\tcachedResult = asArgs ? 'argsList' : 'value';\n\t\t\tdirtyFlag = asArgs ? 'dirtyArgs' : 'dirtyValue';\n\t\t\tif ( this[ dirtyFlag ] ) {\n\t\t\t\tsource = processItems( this.items, values = {}, this.root._guid );\n\t\t\t\tparsed = parseJSON( asArgs ? '[' + source + ']' : source, values );\n\t\t\t\tif ( !parsed ) {\n\t\t\t\t\tresult = asArgs ? [ this.toString() ] : this.toString();\n\t\t\t\t} else {\n\t\t\t\t\tresult = parsed.value;\n\t\t\t\t}\n\t\t\t\tthis[ cachedResult ] = result;\n\t\t\t\tthis[ dirtyFlag ] = false;\n\t\t\t}\n\t\t\treturn this[ cachedResult ];\n\t\t};\n\n\t\tfunction processItems( items, values, guid, counter ) {\n\t\t\tcounter = counter || 0;\n\t\t\treturn items.map( function( item ) {\n\t\t\t\tvar placeholderId, wrapped, value;\n\t\t\t\tif ( item.text ) {\n\t\t\t\t\treturn item.text;\n\t\t\t\t}\n\t\t\t\tif ( item.fragments ) {\n\t\t\t\t\treturn item.fragments.map( function( fragment ) {\n\t\t\t\t\t\treturn processItems( fragment.items, values, guid, counter );\n\t\t\t\t\t} ).join( '' );\n\t\t\t\t}\n\t\t\t\tplaceholderId = guid + '-' + counter++;\n\t\t\t\tif ( wrapped = item.root.viewmodel.wrapped[ item.keypath ] ) {\n\t\t\t\t\tvalue = wrapped.value;\n\t\t\t\t} else {\n\t\t\t\t\tvalue = item.getValue();\n\t\t\t\t}\n\t\t\t\tvalues[ placeholderId ] = value;\n\t\t\t\treturn '${' + placeholderId + '}';\n\t\t\t} ).join( '' );\n\t\t}\n\t\treturn __export;\n\t}( parseJSON );\n\n\t/* utils/escapeHtml.js */\n\tvar escapeHtml = function() {\n\n\t\tvar lessThan = /</g;\n\t\tvar greaterThan = />/g;\n\t\tvar amp = /&/g;\n\t\treturn function escapeHtml( str ) {\n\t\t\treturn str.replace( amp, '&amp;' ).replace( lessThan, '&lt;' ).replace( greaterThan, '&gt;' );\n\t\t};\n\t}();\n\n\t/* utils/detachNode.js */\n\tvar detachNode = function detachNode( node ) {\n\t\tif ( node && node.parentNode ) {\n\t\t\tnode.parentNode.removeChild( node );\n\t\t}\n\t\treturn node;\n\t};\n\n\t/* virtualdom/items/shared/detach.js */\n\tvar detach = function( detachNode ) {\n\n\t\treturn function() {\n\t\t\treturn detachNode( this.node );\n\t\t};\n\t}( detachNode );\n\n\t/* virtualdom/items/Text.js */\n\tvar Text = function( types, escapeHtml, detach ) {\n\n\t\tvar Text = function( options ) {\n\t\t\tthis.type = types.TEXT;\n\t\t\tthis.text = options.template;\n\t\t};\n\t\tText.prototype = {\n\t\t\tdetach: detach,\n\t\t\tfirstNode: function() {\n\t\t\t\treturn this.node;\n\t\t\t},\n\t\t\trender: function() {\n\t\t\t\tif ( !this.node ) {\n\t\t\t\t\tthis.node = document.createTextNode( this.text );\n\t\t\t\t}\n\t\t\t\treturn this.node;\n\t\t\t},\n\t\t\ttoString: function( escape ) {\n\t\t\t\treturn escape ? escapeHtml( this.text ) : this.text;\n\t\t\t},\n\t\t\tunrender: function( shouldDestroy ) {\n\t\t\t\tif ( shouldDestroy ) {\n\t\t\t\t\treturn this.detach();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn Text;\n\t}( types, escapeHtml, detach );\n\n\t/* virtualdom/items/shared/unbind.js */\n\tvar unbind = function unbind() {\n\t\tif ( this.registered ) {\n\t\t\t// this was registered as a dependant\n\t\t\tthis.root.viewmodel.unregister( this.keypath, this );\n\t\t}\n\t\tif ( this.resolver ) {\n\t\t\tthis.resolver.unbind();\n\t\t}\n\t};\n\n\t/* virtualdom/items/shared/Mustache/getValue.js */\n\tvar getValue = function Mustache$getValue() {\n\t\treturn this.value;\n\t};\n\n\t/* virtualdom/items/shared/utils/startsWithKeypath.js */\n\tvar startsWithKeypath = function startsWithKeypath( target, keypath ) {\n\t\treturn target && keypath && target.substr( 0, keypath.length + 1 ) === keypath + '.';\n\t};\n\n\t/* virtualdom/items/shared/utils/getNewKeypath.js */\n\tvar getNewKeypath = function( startsWithKeypath ) {\n\n\t\treturn function getNewKeypath( targetKeypath, oldKeypath, newKeypath ) {\n\t\t\t// exact match\n\t\t\tif ( targetKeypath === oldKeypath ) {\n\t\t\t\treturn newKeypath !== undefined ? newKeypath : null;\n\t\t\t}\n\t\t\t// partial match based on leading keypath segments\n\t\t\tif ( startsWithKeypath( targetKeypath, oldKeypath ) ) {\n\t\t\t\treturn newKeypath === null ? newKeypath : targetKeypath.replace( oldKeypath + '.', newKeypath + '.' );\n\t\t\t}\n\t\t};\n\t}( startsWithKeypath );\n\n\t/* virtualdom/items/shared/Resolvers/ReferenceResolver.js */\n\tvar ReferenceResolver = function( runloop, resolveRef, getNewKeypath ) {\n\n\t\tvar ReferenceResolver = function( owner, ref, callback ) {\n\t\t\tvar keypath;\n\t\t\tthis.ref = ref;\n\t\t\tthis.resolved = false;\n\t\t\tthis.root = owner.root;\n\t\t\tthis.parentFragment = owner.parentFragment;\n\t\t\tthis.callback = callback;\n\t\t\tkeypath = resolveRef( owner.root, ref, owner.parentFragment );\n\t\t\tif ( keypath !== undefined ) {\n\t\t\t\tthis.resolve( keypath );\n\t\t\t} else {\n\t\t\t\trunloop.addUnresolved( this );\n\t\t\t}\n\t\t};\n\t\tReferenceResolver.prototype = {\n\t\t\tresolve: function( keypath ) {\n\t\t\t\tthis.resolved = true;\n\t\t\t\tthis.keypath = keypath;\n\t\t\t\tthis.callback( keypath );\n\t\t\t},\n\t\t\tforceResolution: function() {\n\t\t\t\tthis.resolve( this.ref );\n\t\t\t},\n\t\t\trebind: function( indexRef, newIndex, oldKeypath, newKeypath ) {\n\t\t\t\tvar keypath;\n\t\t\t\tif ( this.keypath !== undefined ) {\n\t\t\t\t\tkeypath = getNewKeypath( this.keypath, oldKeypath, newKeypath );\n\t\t\t\t\t// was a new keypath created?\n\t\t\t\t\tif ( keypath !== undefined ) {\n\t\t\t\t\t\t// resolve it\n\t\t\t\t\t\tthis.resolve( keypath );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tunbind: function() {\n\t\t\t\tif ( !this.resolved ) {\n\t\t\t\t\trunloop.removeUnresolved( this );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn ReferenceResolver;\n\t}( runloop, resolveRef, getNewKeypath );\n\n\t/* virtualdom/items/shared/Resolvers/SpecialResolver.js */\n\tvar SpecialResolver = function() {\n\n\t\tvar SpecialResolver = function( owner, ref, callback ) {\n\t\t\tthis.parentFragment = owner.parentFragment;\n\t\t\tthis.ref = ref;\n\t\t\tthis.callback = callback;\n\t\t\tthis.rebind();\n\t\t};\n\t\tSpecialResolver.prototype = {\n\t\t\trebind: function() {\n\t\t\t\tvar ref = this.ref,\n\t\t\t\t\tfragment = this.parentFragment;\n\t\t\t\tif ( ref === '@keypath' ) {\n\t\t\t\t\twhile ( fragment ) {\n\t\t\t\t\t\tif ( !!fragment.context ) {\n\t\t\t\t\t\t\treturn this.callback( '@' + fragment.context );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfragment = fragment.parent;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( ref === '@index' || ref === '@key' ) {\n\t\t\t\t\twhile ( fragment ) {\n\t\t\t\t\t\tif ( fragment.index !== undefined ) {\n\t\t\t\t\t\t\treturn this.callback( '@' + fragment.index );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfragment = fragment.parent;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthrow new Error( 'Unknown special reference \"' + ref + '\" - valid references are @index, @key and @keypath' );\n\t\t\t},\n\t\t\tunbind: function() {}\n\t\t};\n\t\treturn SpecialResolver;\n\t}();\n\n\t/* virtualdom/items/shared/Resolvers/IndexResolver.js */\n\tvar IndexResolver = function() {\n\n\t\tvar IndexResolver = function( owner, ref, callback ) {\n\t\t\tthis.parentFragment = owner.parentFragment;\n\t\t\tthis.ref = ref;\n\t\t\tthis.callback = callback;\n\t\t\tthis.rebind();\n\t\t};\n\t\tIndexResolver.prototype = {\n\t\t\trebind: function() {\n\t\t\t\tvar ref = this.ref,\n\t\t\t\t\tindexRefs = this.parentFragment.indexRefs,\n\t\t\t\t\tindex = indexRefs[ ref ];\n\t\t\t\tif ( index !== undefined ) {\n\t\t\t\t\tthis.callback( '@' + index );\n\t\t\t\t}\n\t\t\t},\n\t\t\tunbind: function() {}\n\t\t};\n\t\treturn IndexResolver;\n\t}();\n\n\t/* virtualdom/items/shared/Resolvers/createReferenceResolver.js */\n\tvar createReferenceResolver = function( ReferenceResolver, SpecialResolver, IndexResolver ) {\n\n\t\treturn function createReferenceResolver( owner, ref, callback ) {\n\t\t\tvar indexRefs, index;\n\t\t\tif ( ref.charAt( 0 ) === '@' ) {\n\t\t\t\treturn new SpecialResolver( owner, ref, callback );\n\t\t\t}\n\t\t\tindexRefs = owner.parentFragment.indexRefs;\n\t\t\tif ( indexRefs && ( index = indexRefs[ ref ] ) !== undefined ) {\n\t\t\t\treturn new IndexResolver( owner, ref, callback );\n\t\t\t}\n\t\t\treturn new ReferenceResolver( owner, ref, callback );\n\t\t};\n\t}( ReferenceResolver, SpecialResolver, IndexResolver );\n\n\t/* shared/getFunctionFromString.js */\n\tvar getFunctionFromString = function() {\n\n\t\tvar cache = {};\n\t\treturn function getFunctionFromString( str, i ) {\n\t\t\tvar fn, args;\n\t\t\tif ( cache[ str ] ) {\n\t\t\t\treturn cache[ str ];\n\t\t\t}\n\t\t\targs = [];\n\t\t\twhile ( i-- ) {\n\t\t\t\targs[ i ] = '_' + i;\n\t\t\t}\n\t\t\tfn = new Function( args.join( ',' ), 'return(' + str + ')' );\n\t\t\tcache[ str ] = fn;\n\t\t\treturn fn;\n\t\t};\n\t}();\n\n\t/* virtualdom/items/shared/Resolvers/ExpressionResolver.js */\n\tvar ExpressionResolver = function( defineProperty, isNumeric, createReferenceResolver, getFunctionFromString ) {\n\n\t\tvar __export;\n\t\tvar ExpressionResolver, bind = Function.prototype.bind;\n\t\tExpressionResolver = function( owner, parentFragment, expression, callback ) {\n\t\t\tvar resolver = this,\n\t\t\t\tractive, indexRefs;\n\t\t\tractive = owner.root;\n\t\t\tresolver.root = ractive;\n\t\t\tresolver.parentFragment = parentFragment;\n\t\t\tresolver.callback = callback;\n\t\t\tresolver.owner = owner;\n\t\t\tresolver.str = expression.s;\n\t\t\tresolver.keypaths = [];\n\t\t\tindexRefs = parentFragment.indexRefs;\n\t\t\t// Create resolvers for each reference\n\t\t\tresolver.pending = expression.r.length;\n\t\t\tresolver.refResolvers = expression.r.map( function( ref, i ) {\n\t\t\t\treturn createReferenceResolver( resolver, ref, function( keypath ) {\n\t\t\t\t\tresolver.resolve( i, keypath );\n\t\t\t\t} );\n\t\t\t} );\n\t\t\tresolver.ready = true;\n\t\t\tresolver.bubble();\n\t\t};\n\t\tExpressionResolver.prototype = {\n\t\t\tbubble: function() {\n\t\t\t\tif ( !this.ready ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.uniqueString = getUniqueString( this.str, this.keypaths );\n\t\t\t\tthis.keypath = getKeypath( this.uniqueString );\n\t\t\t\tthis.createEvaluator();\n\t\t\t\tthis.callback( this.keypath );\n\t\t\t},\n\t\t\tunbind: function() {\n\t\t\t\tvar resolver;\n\t\t\t\twhile ( resolver = this.refResolvers.pop() ) {\n\t\t\t\t\tresolver.unbind();\n\t\t\t\t}\n\t\t\t},\n\t\t\tresolve: function( index, keypath ) {\n\t\t\t\tthis.keypaths[ index ] = keypath;\n\t\t\t\tthis.bubble();\n\t\t\t},\n\t\t\tcreateEvaluator: function() {\n\t\t\t\tvar this$0 = this;\n\t\t\t\tvar self = this,\n\t\t\t\t\tcomputation, valueGetters, signature, keypath, fn;\n\t\t\t\tcomputation = this.root.viewmodel.computations[ this.keypath ];\n\t\t\t\t// only if it doesn't exist yet!\n\t\t\t\tif ( !computation ) {\n\t\t\t\t\tfn = getFunctionFromString( this.str, this.refResolvers.length );\n\t\t\t\t\tvalueGetters = this.keypaths.map( function( keypath ) {\n\t\t\t\t\t\tvar value;\n\t\t\t\t\t\tif ( keypath === 'undefined' ) {\n\t\t\t\t\t\t\treturn function() {\n\t\t\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// 'special' keypaths encode a value\n\t\t\t\t\t\tif ( keypath[ 0 ] === '@' ) {\n\t\t\t\t\t\t\tvalue = keypath.slice( 1 );\n\t\t\t\t\t\t\treturn isNumeric( value ) ? function() {\n\t\t\t\t\t\t\t\treturn +value;\n\t\t\t\t\t\t\t} : function() {\n\t\t\t\t\t\t\t\treturn value;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn function() {\n\t\t\t\t\t\t\tvar value = this$0.root.viewmodel.get( keypath );\n\t\t\t\t\t\t\tif ( typeof value === 'function' ) {\n\t\t\t\t\t\t\t\tvalue = wrapFunction( value, self.root );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn value;\n\t\t\t\t\t\t};\n\t\t\t\t\t} );\n\t\t\t\t\tsignature = {\n\t\t\t\t\t\tdeps: this.keypaths.filter( isValidDependency ),\n\t\t\t\t\t\tget: function() {\n\t\t\t\t\t\t\tvar args = valueGetters.map( call );\n\t\t\t\t\t\t\treturn fn.apply( null, args );\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tcomputation = this.root.viewmodel.compute( this.keypath, signature );\n\t\t\t\t} else {\n\t\t\t\t\tthis.root.viewmodel.mark( this.keypath );\n\t\t\t\t}\n\t\t\t},\n\t\t\trebind: function( indexRef, newIndex, oldKeypath, newKeypath ) {\n\t\t\t\t// TODO only bubble once, no matter how many references are affected by the rebind\n\t\t\t\tthis.refResolvers.forEach( function( r ) {\n\t\t\t\t\treturn r.rebind( indexRef, newIndex, oldKeypath, newKeypath );\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\t\t__export = ExpressionResolver;\n\n\t\tfunction call( value ) {\n\t\t\treturn value.call();\n\t\t}\n\n\t\tfunction getUniqueString( str, keypaths ) {\n\t\t\t// get string that is unique to this expression\n\t\t\treturn str.replace( /_([0-9]+)/g, function( match, $1 ) {\n\t\t\t\tvar keypath, value;\n\t\t\t\tkeypath = keypaths[ $1 ];\n\t\t\t\tif ( keypath === undefined ) {\n\t\t\t\t\treturn 'undefined';\n\t\t\t\t}\n\t\t\t\tif ( keypath[ 0 ] === '@' ) {\n\t\t\t\t\tvalue = keypath.slice( 1 );\n\t\t\t\t\treturn isNumeric( value ) ? value : '\"' + value + '\"';\n\t\t\t\t}\n\t\t\t\treturn keypath;\n\t\t\t} );\n\t\t}\n\n\t\tfunction getKeypath( uniqueString ) {\n\t\t\t// Sanitize by removing any periods or square brackets. Otherwise\n\t\t\t// we can't split the keypath into keys!\n\t\t\treturn '${' + uniqueString.replace( /[\\.\\[\\]]/g, '-' ) + '}';\n\t\t}\n\n\t\tfunction isValidDependency( keypath ) {\n\t\t\treturn keypath !== undefined && keypath[ 0 ] !== '@';\n\t\t}\n\n\t\tfunction wrapFunction( fn, ractive ) {\n\t\t\tvar wrapped, prop, key;\n\t\t\tif ( fn._noWrap ) {\n\t\t\t\treturn fn;\n\t\t\t}\n\t\t\tprop = '__ractive_' + ractive._guid;\n\t\t\twrapped = fn[ prop ];\n\t\t\tif ( wrapped ) {\n\t\t\t\treturn wrapped;\n\t\t\t} else if ( /this/.test( fn.toString() ) ) {\n\t\t\t\tdefineProperty( fn, prop, {\n\t\t\t\t\tvalue: bind.call( fn, ractive )\n\t\t\t\t} );\n\t\t\t\t// Add properties/methods to wrapped function\n\t\t\t\tfor ( key in fn ) {\n\t\t\t\t\tif ( fn.hasOwnProperty( key ) ) {\n\t\t\t\t\t\tfn[ prop ][ key ] = fn[ key ];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn fn[ prop ];\n\t\t\t}\n\t\t\tdefineProperty( fn, '__ractive_nowrap', {\n\t\t\t\tvalue: fn\n\t\t\t} );\n\t\t\treturn fn.__ractive_nowrap;\n\t\t}\n\t\treturn __export;\n\t}( defineProperty, isNumeric, createReferenceResolver, getFunctionFromString, legacy );\n\n\t/* virtualdom/items/shared/Resolvers/ReferenceExpressionResolver/MemberResolver.js */\n\tvar MemberResolver = function( types, createReferenceResolver, ExpressionResolver ) {\n\n\t\tvar MemberResolver = function( template, resolver, parentFragment ) {\n\t\t\tvar member = this,\n\t\t\t\tkeypath;\n\t\t\tmember.resolver = resolver;\n\t\t\tmember.root = resolver.root;\n\t\t\tmember.parentFragment = parentFragment;\n\t\t\tmember.viewmodel = resolver.root.viewmodel;\n\t\t\tif ( typeof template === 'string' ) {\n\t\t\t\tmember.value = template;\n\t\t\t} else if ( template.t === types.REFERENCE ) {\n\t\t\t\tmember.refResolver = createReferenceResolver( this, template.n, function( keypath ) {\n\t\t\t\t\tmember.resolve( keypath );\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tnew ExpressionResolver( resolver, parentFragment, template, function( keypath ) {\n\t\t\t\t\tmember.resolve( keypath );\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\t\tMemberResolver.prototype = {\n\t\t\tresolve: function( keypath ) {\n\t\t\t\tif ( this.keypath ) {\n\t\t\t\t\tthis.viewmodel.unregister( this.keypath, this );\n\t\t\t\t}\n\t\t\t\tthis.keypath = keypath;\n\t\t\t\tthis.value = this.viewmodel.get( keypath );\n\t\t\t\tthis.bind();\n\t\t\t\tthis.resolver.bubble();\n\t\t\t},\n\t\t\tbind: function() {\n\t\t\t\tthis.viewmodel.register( this.keypath, this );\n\t\t\t},\n\t\t\trebind: function( indexRef, newIndex, oldKeypath, newKeypath ) {\n\t\t\t\tif ( this.refResolver ) {\n\t\t\t\t\tthis.refResolver.rebind( indexRef, newIndex, oldKeypath, newKeypath );\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetValue: function( value ) {\n\t\t\t\tthis.value = value;\n\t\t\t\tthis.resolver.bubble();\n\t\t\t},\n\t\t\tunbind: function() {\n\t\t\t\tif ( this.keypath ) {\n\t\t\t\t\tthis.viewmodel.unregister( this.keypath, this );\n\t\t\t\t}\n\t\t\t\tif ( this.unresolved ) {\n\t\t\t\t\tthis.unresolved.unbind();\n\t\t\t\t}\n\t\t\t},\n\t\t\tforceResolution: function() {\n\t\t\t\tif ( this.refResolver ) {\n\t\t\t\t\tthis.refResolver.forceResolution();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn MemberResolver;\n\t}( types, createReferenceResolver, ExpressionResolver );\n\n\t/* virtualdom/items/shared/Resolvers/ReferenceExpressionResolver/ReferenceExpressionResolver.js */\n\tvar ReferenceExpressionResolver = function( resolveRef, ReferenceResolver, MemberResolver ) {\n\n\t\tvar ReferenceExpressionResolver = function( mustache, template, callback ) {\n\t\t\tvar this$0 = this;\n\t\t\tvar resolver = this,\n\t\t\t\tractive, ref, keypath, parentFragment;\n\t\t\tresolver.parentFragment = parentFragment = mustache.parentFragment;\n\t\t\tresolver.root = ractive = mustache.root;\n\t\t\tresolver.mustache = mustache;\n\t\t\tresolver.ref = ref = template.r;\n\t\t\tresolver.callback = callback;\n\t\t\tresolver.unresolved = [];\n\t\t\t// Find base keypath\n\t\t\tif ( keypath = resolveRef( ractive, ref, parentFragment ) ) {\n\t\t\t\tresolver.base = keypath;\n\t\t\t} else {\n\t\t\t\tresolver.baseResolver = new ReferenceResolver( this, ref, function( keypath ) {\n\t\t\t\t\tresolver.base = keypath;\n\t\t\t\t\tresolver.baseResolver = null;\n\t\t\t\t\tresolver.bubble();\n\t\t\t\t} );\n\t\t\t}\n\t\t\t// Find values for members, or mark them as unresolved\n\t\t\tresolver.members = template.m.map( function( template ) {\n\t\t\t\treturn new MemberResolver( template, this$0, parentFragment );\n\t\t\t} );\n\t\t\tresolver.ready = true;\n\t\t\tresolver.bubble();\n\t\t};\n\t\tReferenceExpressionResolver.prototype = {\n\t\t\tgetKeypath: function() {\n\t\t\t\tvar values = this.members.map( getValue );\n\t\t\t\tif ( !values.every( isDefined ) || this.baseResolver ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\treturn this.base + '.' + values.join( '.' );\n\t\t\t},\n\t\t\tbubble: function() {\n\t\t\t\tif ( !this.ready || this.baseResolver ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.callback( this.getKeypath() );\n\t\t\t},\n\t\t\tunbind: function() {\n\t\t\t\tthis.members.forEach( unbind );\n\t\t\t},\n\t\t\trebind: function( indexRef, newIndex, oldKeypath, newKeypath ) {\n\t\t\t\tvar changed;\n\t\t\t\tthis.members.forEach( function( members ) {\n\t\t\t\t\tif ( members.rebind( indexRef, newIndex, oldKeypath, newKeypath ) ) {\n\t\t\t\t\t\tchanged = true;\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\tif ( changed ) {\n\t\t\t\t\tthis.bubble();\n\t\t\t\t}\n\t\t\t},\n\t\t\tforceResolution: function() {\n\t\t\t\tif ( this.baseResolver ) {\n\t\t\t\t\tthis.base = this.ref;\n\t\t\t\t\tthis.baseResolver.unbind();\n\t\t\t\t\tthis.baseResolver = null;\n\t\t\t\t}\n\t\t\t\tthis.members.forEach( function( m ) {\n\t\t\t\t\treturn m.forceResolution();\n\t\t\t\t} );\n\t\t\t\tthis.bubble();\n\t\t\t}\n\t\t};\n\n\t\tfunction getValue( member ) {\n\t\t\treturn member.value;\n\t\t}\n\n\t\tfunction isDefined( value ) {\n\t\t\treturn value != undefined;\n\t\t}\n\n\t\tfunction unbind( member ) {\n\t\t\tmember.unbind();\n\t\t}\n\t\treturn ReferenceExpressionResolver;\n\t}( resolveRef, ReferenceResolver, MemberResolver );\n\n\t/* virtualdom/items/shared/Mustache/initialise.js */\n\tvar initialise = function( types, createReferenceResolver, ReferenceExpressionResolver, ExpressionResolver ) {\n\n\t\treturn function Mustache$init( mustache, options ) {\n\t\t\tvar ref, parentFragment, template;\n\t\t\tparentFragment = options.parentFragment;\n\t\t\ttemplate = options.template;\n\t\t\tmustache.root = parentFragment.root;\n\t\t\tmustache.parentFragment = parentFragment;\n\t\t\tmustache.pElement = parentFragment.pElement;\n\t\t\tmustache.template = options.template;\n\t\t\tmustache.index = options.index || 0;\n\t\t\tmustache.isStatic = options.template.s;\n\t\t\tmustache.type = options.template.t;\n\t\t\tmustache.registered = false;\n\t\t\t// if this is a simple mustache, with a reference, we just need to resolve\n\t\t\t// the reference to a keypath\n\t\t\tif ( ref = template.r ) {\n\t\t\t\tmustache.resolver = new createReferenceResolver( mustache, ref, resolve );\n\t\t\t}\n\t\t\t// if it's an expression, we have a bit more work to do\n\t\t\tif ( options.template.x ) {\n\t\t\t\tmustache.resolver = new ExpressionResolver( mustache, parentFragment, options.template.x, resolveAndRebindChildren );\n\t\t\t}\n\t\t\tif ( options.template.rx ) {\n\t\t\t\tmustache.resolver = new ReferenceExpressionResolver( mustache, options.template.rx, resolveAndRebindChildren );\n\t\t\t}\n\t\t\t// Special case - inverted sections\n\t\t\tif ( mustache.template.n === types.SECTION_UNLESS && !mustache.hasOwnProperty( 'value' ) ) {\n\t\t\t\tmustache.setValue( undefined );\n\t\t\t}\n\n\t\t\tfunction resolve( keypath ) {\n\t\t\t\tmustache.resolve( keypath );\n\t\t\t}\n\n\t\t\tfunction resolveAndRebindChildren( newKeypath ) {\n\t\t\t\tvar oldKeypath = mustache.keypath;\n\t\t\t\tif ( newKeypath !== oldKeypath ) {\n\t\t\t\t\tmustache.resolve( newKeypath );\n\t\t\t\t\tif ( oldKeypath !== undefined ) {\n\t\t\t\t\t\tmustache.fragments && mustache.fragments.forEach( function( f ) {\n\t\t\t\t\t\t\tf.rebind( null, null, oldKeypath, newKeypath );\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}( types, createReferenceResolver, ReferenceExpressionResolver, ExpressionResolver );\n\n\t/* virtualdom/items/shared/Mustache/resolve.js */\n\tvar resolve = function( isNumeric ) {\n\n\t\treturn function Mustache$resolve( keypath ) {\n\t\t\tvar wasResolved, value, twowayBinding;\n\t\t\t// 'Special' keypaths, e.g. @foo or @7, encode a value\n\t\t\tif ( keypath && keypath[ 0 ] === '@' ) {\n\t\t\t\tvalue = keypath.slice( 1 );\n\t\t\t\tif ( isNumeric( value ) ) {\n\t\t\t\t\tvalue = +value;\n\t\t\t\t}\n\t\t\t\tthis.keypath = keypath;\n\t\t\t\tthis.setValue( value );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// If we resolved previously, we need to unregister\n\t\t\tif ( this.registered ) {\n\t\t\t\t// undefined or null\n\t\t\t\tthis.root.viewmodel.unregister( this.keypath, this );\n\t\t\t\tthis.registered = false;\n\t\t\t\twasResolved = true;\n\t\t\t}\n\t\t\tthis.keypath = keypath;\n\t\t\t// If the new keypath exists, we need to register\n\t\t\t// with the viewmodel\n\t\t\tif ( keypath != undefined ) {\n\t\t\t\t// undefined or null\n\t\t\t\tvalue = this.root.viewmodel.get( keypath );\n\t\t\t\tthis.root.viewmodel.register( keypath, this );\n\t\t\t\tthis.registered = true;\n\t\t\t}\n\t\t\t// Either way we need to queue up a render (`value`\n\t\t\t// will be `undefined` if there's no keypath)\n\t\t\tthis.setValue( value );\n\t\t\t// Two-way bindings need to point to their new target keypath\n\t\t\tif ( wasResolved && ( twowayBinding = this.twowayBinding ) ) {\n\t\t\t\ttwowayBinding.rebound();\n\t\t\t}\n\t\t};\n\t}( isNumeric );\n\n\t/* virtualdom/items/shared/Mustache/rebind.js */\n\tvar rebind = function Mustache$rebind( indexRef, newIndex, oldKeypath, newKeypath ) {\n\t\t// Children first\n\t\tif ( this.fragments ) {\n\t\t\tthis.fragments.forEach( function( f ) {\n\t\t\t\treturn f.rebind( indexRef, newIndex, oldKeypath, newKeypath );\n\t\t\t} );\n\t\t}\n\t\t// Expression mustache?\n\t\tif ( this.resolver ) {\n\t\t\tthis.resolver.rebind( indexRef, newIndex, oldKeypath, newKeypath );\n\t\t}\n\t};\n\n\t/* virtualdom/items/shared/Mustache/_Mustache.js */\n\tvar Mustache = function( getValue, init, resolve, rebind ) {\n\n\t\treturn {\n\t\t\tgetValue: getValue,\n\t\t\tinit: init,\n\t\t\tresolve: resolve,\n\t\t\trebind: rebind\n\t\t};\n\t}( getValue, initialise, resolve, rebind );\n\n\t/* virtualdom/items/Interpolator.js */\n\tvar Interpolator = function( types, runloop, escapeHtml, detachNode, isEqual, unbind, Mustache, detach ) {\n\n\t\tvar Interpolator = function( options ) {\n\t\t\tthis.type = types.INTERPOLATOR;\n\t\t\tMustache.init( this, options );\n\t\t};\n\t\tInterpolator.prototype = {\n\t\t\tupdate: function() {\n\t\t\t\tthis.node.data = this.value == undefined ? '' : this.value;\n\t\t\t},\n\t\t\tresolve: Mustache.resolve,\n\t\t\trebind: Mustache.rebind,\n\t\t\tdetach: detach,\n\t\t\tunbind: unbind,\n\t\t\trender: function() {\n\t\t\t\tif ( !this.node ) {\n\t\t\t\t\tthis.node = document.createTextNode( this.value != undefined ? this.value : '' );\n\t\t\t\t}\n\t\t\t\treturn this.node;\n\t\t\t},\n\t\t\tunrender: function( shouldDestroy ) {\n\t\t\t\tif ( shouldDestroy ) {\n\t\t\t\t\tdetachNode( this.node );\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetValue: Mustache.getValue,\n\t\t\t// TEMP\n\t\t\tsetValue: function( value ) {\n\t\t\t\tvar wrapper;\n\t\t\t\t// TODO is there a better way to approach this?\n\t\t\t\tif ( wrapper = this.root.viewmodel.wrapped[ this.keypath ] ) {\n\t\t\t\t\tvalue = wrapper.get();\n\t\t\t\t}\n\t\t\t\tif ( !isEqual( value, this.value ) ) {\n\t\t\t\t\tthis.value = value;\n\t\t\t\t\tthis.parentFragment.bubble();\n\t\t\t\t\tif ( this.node ) {\n\t\t\t\t\t\trunloop.addView( this );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tfirstNode: function() {\n\t\t\t\treturn this.node;\n\t\t\t},\n\t\t\ttoString: function( escape ) {\n\t\t\t\tvar string = this.value != undefined ? '' + this.value : '';\n\t\t\t\treturn escape ? escapeHtml( string ) : string;\n\t\t\t}\n\t\t};\n\t\treturn Interpolator;\n\t}( types, runloop, escapeHtml, detachNode, isEqual, unbind, Mustache, detach );\n\n\t/* virtualdom/items/Section/prototype/bubble.js */\n\tvar virtualdom_items_Section$bubble = function Section$bubble() {\n\t\tthis.parentFragment.bubble();\n\t};\n\n\t/* virtualdom/items/Section/prototype/detach.js */\n\tvar virtualdom_items_Section$detach = function Section$detach() {\n\t\tvar docFrag;\n\t\tif ( this.fragments.length === 1 ) {\n\t\t\treturn this.fragments[ 0 ].detach();\n\t\t}\n\t\tdocFrag = document.createDocumentFragment();\n\t\tthis.fragments.forEach( function( item ) {\n\t\t\tdocFrag.appendChild( item.detach() );\n\t\t} );\n\t\treturn docFrag;\n\t};\n\n\t/* virtualdom/items/Section/prototype/find.js */\n\tvar virtualdom_items_Section$find = function Section$find( selector ) {\n\t\tvar i, len, queryResult;\n\t\tlen = this.fragments.length;\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tif ( queryResult = this.fragments[ i ].find( selector ) ) {\n\t\t\t\treturn queryResult;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\t/* virtualdom/items/Section/prototype/findAll.js */\n\tvar virtualdom_items_Section$findAll = function Section$findAll( selector, query ) {\n\t\tvar i, len;\n\t\tlen = this.fragments.length;\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tthis.fragments[ i ].findAll( selector, query );\n\t\t}\n\t};\n\n\t/* virtualdom/items/Section/prototype/findAllComponents.js */\n\tvar virtualdom_items_Section$findAllComponents = function Section$findAllComponents( selector, query ) {\n\t\tvar i, len;\n\t\tlen = this.fragments.length;\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tthis.fragments[ i ].findAllComponents( selector, query );\n\t\t}\n\t};\n\n\t/* virtualdom/items/Section/prototype/findComponent.js */\n\tvar virtualdom_items_Section$findComponent = function Section$findComponent( selector ) {\n\t\tvar i, len, queryResult;\n\t\tlen = this.fragments.length;\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tif ( queryResult = this.fragments[ i ].findComponent( selector ) ) {\n\t\t\t\treturn queryResult;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\t/* virtualdom/items/Section/prototype/findNextNode.js */\n\tvar virtualdom_items_Section$findNextNode = function Section$findNextNode( fragment ) {\n\t\tif ( this.fragments[ fragment.index + 1 ] ) {\n\t\t\treturn this.fragments[ fragment.index + 1 ].firstNode();\n\t\t}\n\t\treturn this.parentFragment.findNextNode( this );\n\t};\n\n\t/* virtualdom/items/Section/prototype/firstNode.js */\n\tvar virtualdom_items_Section$firstNode = function Section$firstNode() {\n\t\tvar len, i, node;\n\t\tif ( len = this.fragments.length ) {\n\t\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\t\tif ( node = this.fragments[ i ].firstNode() ) {\n\t\t\t\t\treturn node;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this.parentFragment.findNextNode( this );\n\t};\n\n\t/* virtualdom/items/Section/prototype/shuffle.js */\n\tvar virtualdom_items_Section$shuffle = function( types, runloop, circular ) {\n\n\t\tvar Fragment;\n\t\tcircular.push( function() {\n\t\t\tFragment = circular.Fragment;\n\t\t} );\n\t\treturn function Section$shuffle( newIndices ) {\n\t\t\tvar this$0 = this;\n\t\t\tvar section = this,\n\t\t\t\tparentFragment, firstChange, i, newLength, reboundFragments, fragmentOptions, fragment;\n\t\t\t// short circuit any double-updates, and ensure that this isn't applied to\n\t\t\t// non-list sections\n\t\t\tif ( this.shuffling || this.unbound || this.subtype && this.subtype !== types.SECTION_EACH ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.shuffling = true;\n\t\t\trunloop.scheduleTask( function() {\n\t\t\t\treturn this$0.shuffling = false;\n\t\t\t} );\n\t\t\tparentFragment = this.parentFragment;\n\t\t\treboundFragments = [];\n\t\t\t// first, rebind existing fragments\n\t\t\tnewIndices.forEach( function rebindIfNecessary( newIndex, oldIndex ) {\n\t\t\t\tvar fragment, by, oldKeypath, newKeypath;\n\t\t\t\tif ( newIndex === oldIndex ) {\n\t\t\t\t\treboundFragments[ newIndex ] = section.fragments[ oldIndex ];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tfragment = section.fragments[ oldIndex ];\n\t\t\t\tif ( firstChange === undefined ) {\n\t\t\t\t\tfirstChange = oldIndex;\n\t\t\t\t}\n\t\t\t\t// does this fragment need to be torn down?\n\t\t\t\tif ( newIndex === -1 ) {\n\t\t\t\t\tsection.fragmentsToUnrender.push( fragment );\n\t\t\t\t\tfragment.unbind();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// Otherwise, it needs to be rebound to a new index\n\t\t\t\tby = newIndex - oldIndex;\n\t\t\t\toldKeypath = section.keypath + '.' + oldIndex;\n\t\t\t\tnewKeypath = section.keypath + '.' + newIndex;\n\t\t\t\tfragment.rebind( section.template.i, newIndex, oldKeypath, newKeypath );\n\t\t\t\tfragment.index = newIndex;\n\t\t\t\treboundFragments[ newIndex ] = fragment;\n\t\t\t} );\n\t\t\tnewLength = this.root.get( this.keypath ).length;\n\t\t\t// If nothing changed with the existing fragments, then we start adding\n\t\t\t// new fragments at the end...\n\t\t\tif ( firstChange === undefined ) {\n\t\t\t\t// ...unless there are no new fragments to add\n\t\t\t\tif ( this.length === newLength ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tfirstChange = this.length;\n\t\t\t}\n\t\t\tthis.length = this.fragments.length = newLength;\n\t\t\tif ( this.rendered ) {\n\t\t\t\trunloop.addView( this );\n\t\t\t}\n\t\t\t// Prepare new fragment options\n\t\t\tfragmentOptions = {\n\t\t\t\ttemplate: this.template.f,\n\t\t\t\troot: this.root,\n\t\t\t\towner: this\n\t\t\t};\n\t\t\tif ( this.template.i ) {\n\t\t\t\tfragmentOptions.indexRef = this.template.i;\n\t\t\t}\n\t\t\t// Add as many new fragments as we need to, or add back existing\n\t\t\t// (detached) fragments\n\t\t\tfor ( i = firstChange; i < newLength; i += 1 ) {\n\t\t\t\tfragment = reboundFragments[ i ];\n\t\t\t\tif ( !fragment ) {\n\t\t\t\t\tthis.fragmentsToCreate.push( i );\n\t\t\t\t}\n\t\t\t\tthis.fragments[ i ] = fragment;\n\t\t\t}\n\t\t};\n\t}( types, runloop, circular );\n\n\t/* virtualdom/items/Section/prototype/render.js */\n\tvar virtualdom_items_Section$render = function Section$render() {\n\t\tvar docFrag;\n\t\tdocFrag = this.docFrag = document.createDocumentFragment();\n\t\tthis.update();\n\t\tthis.rendered = true;\n\t\treturn docFrag;\n\t};\n\n\t/* utils/isArrayLike.js */\n\tvar isArrayLike = function() {\n\n\t\tvar pattern = /^\\[object (?:Array|FileList)\\]$/,\n\t\t\ttoString = Object.prototype.toString;\n\t\treturn function isArrayLike( obj ) {\n\t\t\treturn pattern.test( toString.call( obj ) );\n\t\t};\n\t}();\n\n\t/* virtualdom/items/Section/prototype/setValue.js */\n\tvar virtualdom_items_Section$setValue = function( types, isArrayLike, isObject, runloop, circular ) {\n\n\t\tvar __export;\n\t\tvar Fragment;\n\t\tcircular.push( function() {\n\t\t\tFragment = circular.Fragment;\n\t\t} );\n\t\t__export = function Section$setValue( value ) {\n\t\t\tvar this$0 = this;\n\t\t\tvar wrapper, fragmentOptions;\n\t\t\tif ( this.updating ) {\n\t\t\t\t// If a child of this section causes a re-evaluation - for example, an\n\t\t\t\t// expression refers to a function that mutates the array that this\n\t\t\t\t// section depends on - we'll end up with a double rendering bug (see\n\t\t\t\t// https://github.com/ractivejs/ractive/issues/748). This prevents it.\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.updating = true;\n\t\t\t// with sections, we need to get the fake value if we have a wrapped object\n\t\t\tif ( wrapper = this.root.viewmodel.wrapped[ this.keypath ] ) {\n\t\t\t\tvalue = wrapper.get();\n\t\t\t}\n\t\t\t// If any fragments are awaiting creation after a splice,\n\t\t\t// this is the place to do it\n\t\t\tif ( this.fragmentsToCreate.length ) {\n\t\t\t\tfragmentOptions = {\n\t\t\t\t\ttemplate: this.template.f,\n\t\t\t\t\troot: this.root,\n\t\t\t\t\tpElement: this.pElement,\n\t\t\t\t\towner: this,\n\t\t\t\t\tindexRef: this.template.i\n\t\t\t\t};\n\t\t\t\tthis.fragmentsToCreate.forEach( function( index ) {\n\t\t\t\t\tvar fragment;\n\t\t\t\t\tfragmentOptions.context = this$0.keypath + '.' + index;\n\t\t\t\t\tfragmentOptions.index = index;\n\t\t\t\t\tfragment = new Fragment( fragmentOptions );\n\t\t\t\t\tthis$0.fragmentsToRender.push( this$0.fragments[ index ] = fragment );\n\t\t\t\t} );\n\t\t\t\tthis.fragmentsToCreate.length = 0;\n\t\t\t} else if ( reevaluateSection( this, value ) ) {\n\t\t\t\tthis.bubble();\n\t\t\t\tif ( this.rendered ) {\n\t\t\t\t\trunloop.addView( this );\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.value = value;\n\t\t\tthis.updating = false;\n\t\t};\n\n\t\tfunction reevaluateSection( section, value ) {\n\t\t\tvar fragmentOptions = {\n\t\t\t\ttemplate: section.template.f,\n\t\t\t\troot: section.root,\n\t\t\t\tpElement: section.parentFragment.pElement,\n\t\t\t\towner: section\n\t\t\t};\n\t\t\t// If we already know the section type, great\n\t\t\t// TODO can this be optimised? i.e. pick an reevaluateSection function during init\n\t\t\t// and avoid doing this each time?\n\t\t\tif ( section.subtype ) {\n\t\t\t\tswitch ( section.subtype ) {\n\t\t\t\t\tcase types.SECTION_IF:\n\t\t\t\t\t\treturn reevaluateConditionalSection( section, value, false, fragmentOptions );\n\t\t\t\t\tcase types.SECTION_UNLESS:\n\t\t\t\t\t\treturn reevaluateConditionalSection( section, value, true, fragmentOptions );\n\t\t\t\t\tcase types.SECTION_WITH:\n\t\t\t\t\t\treturn reevaluateContextSection( section, fragmentOptions );\n\t\t\t\t\tcase types.SECTION_IF_WITH:\n\t\t\t\t\t\treturn reevaluateConditionalContextSection( section, value, fragmentOptions );\n\t\t\t\t\tcase types.SECTION_EACH:\n\t\t\t\t\t\tif ( isObject( value ) ) {\n\t\t\t\t\t\t\treturn reevaluateListObjectSection( section, value, fragmentOptions );\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Otherwise we need to work out what sort of section we're dealing with\n\t\t\tsection.ordered = !!isArrayLike( value );\n\t\t\t// Ordered list section\n\t\t\tif ( section.ordered ) {\n\t\t\t\treturn reevaluateListSection( section, value, fragmentOptions );\n\t\t\t}\n\t\t\t// Unordered list, or context\n\t\t\tif ( isObject( value ) || typeof value === 'function' ) {\n\t\t\t\t// Index reference indicates section should be treated as a list\n\t\t\t\tif ( section.template.i ) {\n\t\t\t\t\treturn reevaluateListObjectSection( section, value, fragmentOptions );\n\t\t\t\t}\n\t\t\t\t// Otherwise, object provides context for contents\n\t\t\t\treturn reevaluateContextSection( section, fragmentOptions );\n\t\t\t}\n\t\t\t// Conditional section\n\t\t\treturn reevaluateConditionalSection( section, value, false, fragmentOptions );\n\t\t}\n\n\t\tfunction reevaluateListSection( section, value, fragmentOptions ) {\n\t\t\tvar i, length, fragment;\n\t\t\tlength = value.length;\n\t\t\tif ( length === section.length ) {\n\t\t\t\t// Nothing to do\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// if the array is shorter than it was previously, remove items\n\t\t\tif ( length < section.length ) {\n\t\t\t\tsection.fragmentsToUnrender = section.fragments.splice( length, section.length - length );\n\t\t\t\tsection.fragmentsToUnrender.forEach( unbind );\n\t\t\t} else {\n\t\t\t\tif ( length > section.length ) {\n\t\t\t\t\t// add any new ones\n\t\t\t\t\tfor ( i = section.length; i < length; i += 1 ) {\n\t\t\t\t\t\t// append list item to context stack\n\t\t\t\t\t\tfragmentOptions.context = section.keypath + '.' + i;\n\t\t\t\t\t\tfragmentOptions.index = i;\n\t\t\t\t\t\tif ( section.template.i ) {\n\t\t\t\t\t\t\tfragmentOptions.indexRef = section.template.i;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfragment = new Fragment( fragmentOptions );\n\t\t\t\t\t\tsection.fragmentsToRender.push( section.fragments[ i ] = fragment );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tsection.length = length;\n\t\t\treturn true;\n\t\t}\n\n\t\tfunction reevaluateListObjectSection( section, value, fragmentOptions ) {\n\t\t\tvar id, i, hasKey, fragment, changed;\n\t\t\thasKey = section.hasKey || ( section.hasKey = {} );\n\t\t\t// remove any fragments that should no longer exist\n\t\t\ti = section.fragments.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tfragment = section.fragments[ i ];\n\t\t\t\tif ( !( fragment.index in value ) ) {\n\t\t\t\t\tchanged = true;\n\t\t\t\t\tfragment.unbind();\n\t\t\t\t\tsection.fragmentsToUnrender.push( fragment );\n\t\t\t\t\tsection.fragments.splice( i, 1 );\n\t\t\t\t\thasKey[ fragment.index ] = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// add any that haven't been created yet\n\t\t\tfor ( id in value ) {\n\t\t\t\tif ( !hasKey[ id ] ) {\n\t\t\t\t\tchanged = true;\n\t\t\t\t\tfragmentOptions.context = section.keypath + '.' + id;\n\t\t\t\t\tfragmentOptions.index = id;\n\t\t\t\t\tif ( section.template.i ) {\n\t\t\t\t\t\tfragmentOptions.indexRef = section.template.i;\n\t\t\t\t\t}\n\t\t\t\t\tfragment = new Fragment( fragmentOptions );\n\t\t\t\t\tsection.fragmentsToRender.push( fragment );\n\t\t\t\t\tsection.fragments.push( fragment );\n\t\t\t\t\thasKey[ id ] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tsection.length = section.fragments.length;\n\t\t\treturn changed;\n\t\t}\n\n\t\tfunction reevaluateConditionalContextSection( section, value, fragmentOptions ) {\n\t\t\tif ( value ) {\n\t\t\t\treturn reevaluateContextSection( section, fragmentOptions );\n\t\t\t} else {\n\t\t\t\treturn removeSectionFragments( section );\n\t\t\t}\n\t\t}\n\n\t\tfunction reevaluateContextSection( section, fragmentOptions ) {\n\t\t\tvar fragment;\n\t\t\t// ...then if it isn't rendered, render it, adding section.keypath to the context stack\n\t\t\t// (if it is already rendered, then any children dependent on the context stack\n\t\t\t// will update themselves without any prompting)\n\t\t\tif ( !section.length ) {\n\t\t\t\t// append this section to the context stack\n\t\t\t\tfragmentOptions.context = section.keypath;\n\t\t\t\tfragmentOptions.index = 0;\n\t\t\t\tfragment = new Fragment( fragmentOptions );\n\t\t\t\tsection.fragmentsToRender.push( section.fragments[ 0 ] = fragment );\n\t\t\t\tsection.length = 1;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tfunction reevaluateConditionalSection( section, value, inverted, fragmentOptions ) {\n\t\t\tvar doRender, emptyArray, emptyObject, fragment, name;\n\t\t\temptyArray = isArrayLike( value ) && value.length === 0;\n\t\t\temptyObject = false;\n\t\t\tif ( !isArrayLike( value ) && isObject( value ) ) {\n\t\t\t\temptyObject = true;\n\t\t\t\tfor ( name in value ) {\n\t\t\t\t\temptyObject = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( inverted ) {\n\t\t\t\tdoRender = emptyArray || emptyObject || !value;\n\t\t\t} else {\n\t\t\t\tdoRender = value && !emptyArray && !emptyObject;\n\t\t\t}\n\t\t\tif ( doRender ) {\n\t\t\t\tif ( !section.length ) {\n\t\t\t\t\t// no change to context stack\n\t\t\t\t\tfragmentOptions.index = 0;\n\t\t\t\t\tfragment = new Fragment( fragmentOptions );\n\t\t\t\t\tsection.fragmentsToRender.push( section.fragments[ 0 ] = fragment );\n\t\t\t\t\tsection.length = 1;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tif ( section.length > 1 ) {\n\t\t\t\t\tsection.fragmentsToUnrender = section.fragments.splice( 1 );\n\t\t\t\t\tsection.fragmentsToUnrender.forEach( unbind );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn removeSectionFragments( section );\n\t\t\t}\n\t\t}\n\n\t\tfunction removeSectionFragments( section ) {\n\t\t\tif ( section.length ) {\n\t\t\t\tsection.fragmentsToUnrender = section.fragments.splice( 0, section.fragments.length ).filter( isRendered );\n\t\t\t\tsection.fragmentsToUnrender.forEach( unbind );\n\t\t\t\tsection.length = section.fragmentsToRender.length = 0;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tfunction unbind( fragment ) {\n\t\t\tfragment.unbind();\n\t\t}\n\n\t\tfunction isRendered( fragment ) {\n\t\t\treturn fragment.rendered;\n\t\t}\n\t\treturn __export;\n\t}( types, isArrayLike, isObject, runloop, circular );\n\n\t/* virtualdom/items/Section/prototype/toString.js */\n\tvar virtualdom_items_Section$toString = function Section$toString( escape ) {\n\t\tvar str, i, len;\n\t\tstr = '';\n\t\ti = 0;\n\t\tlen = this.length;\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tstr += this.fragments[ i ].toString( escape );\n\t\t}\n\t\treturn str;\n\t};\n\n\t/* virtualdom/items/Section/prototype/unbind.js */\n\tvar virtualdom_items_Section$unbind = function( unbind ) {\n\n\t\tvar __export;\n\t\t__export = function Section$unbind() {\n\t\t\tthis.fragments.forEach( unbindFragment );\n\t\t\tunbind.call( this );\n\t\t\tthis.length = 0;\n\t\t\tthis.unbound = true;\n\t\t};\n\n\t\tfunction unbindFragment( fragment ) {\n\t\t\tfragment.unbind();\n\t\t}\n\t\treturn __export;\n\t}( unbind );\n\n\t/* virtualdom/items/Section/prototype/unrender.js */\n\tvar virtualdom_items_Section$unrender = function() {\n\n\t\tvar __export;\n\t\t__export = function Section$unrender( shouldDestroy ) {\n\t\t\tthis.fragments.forEach( shouldDestroy ? unrenderAndDestroy : unrender );\n\t\t};\n\n\t\tfunction unrenderAndDestroy( fragment ) {\n\t\t\tfragment.unrender( true );\n\t\t}\n\n\t\tfunction unrender( fragment ) {\n\t\t\tfragment.unrender( false );\n\t\t}\n\t\treturn __export;\n\t}();\n\n\t/* virtualdom/items/Section/prototype/update.js */\n\tvar virtualdom_items_Section$update = function Section$update() {\n\t\tvar fragment, renderIndex, renderedFragments, anchor, target, i, len;\n\t\t// `this.renderedFragments` is in the order of the previous render.\n\t\t// If fragments have shuffled about, this allows us to quickly\n\t\t// reinsert them in the correct place\n\t\trenderedFragments = this.renderedFragments;\n\t\t// Remove fragments that have been marked for destruction\n\t\twhile ( fragment = this.fragmentsToUnrender.pop() ) {\n\t\t\tfragment.unrender( true );\n\t\t\trenderedFragments.splice( renderedFragments.indexOf( fragment ), 1 );\n\t\t}\n\t\t// Render new fragments (but don't insert them yet)\n\t\twhile ( fragment = this.fragmentsToRender.shift() ) {\n\t\t\tfragment.render();\n\t\t}\n\t\tif ( this.rendered ) {\n\t\t\ttarget = this.parentFragment.getNode();\n\t\t}\n\t\tlen = this.fragments.length;\n\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\tfragment = this.fragments[ i ];\n\t\t\trenderIndex = renderedFragments.indexOf( fragment, i );\n\t\t\t// search from current index - it's guaranteed to be the same or higher\n\t\t\tif ( renderIndex === i ) {\n\t\t\t\t// already in the right place. insert accumulated nodes (if any) and carry on\n\t\t\t\tif ( this.docFrag.childNodes.length ) {\n\t\t\t\t\tanchor = fragment.firstNode();\n\t\t\t\t\ttarget.insertBefore( this.docFrag, anchor );\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tthis.docFrag.appendChild( fragment.detach() );\n\t\t\t// update renderedFragments\n\t\t\tif ( renderIndex !== -1 ) {\n\t\t\t\trenderedFragments.splice( renderIndex, 1 );\n\t\t\t}\n\t\t\trenderedFragments.splice( i, 0, fragment );\n\t\t}\n\t\tif ( this.rendered && this.docFrag.childNodes.length ) {\n\t\t\tanchor = this.parentFragment.findNextNode( this );\n\t\t\ttarget.insertBefore( this.docFrag, anchor );\n\t\t}\n\t\t// Save the rendering order for next time\n\t\tthis.renderedFragments = this.fragments.slice();\n\t};\n\n\t/* virtualdom/items/Section/_Section.js */\n\tvar Section = function( types, Mustache, bubble, detach, find, findAll, findAllComponents, findComponent, findNextNode, firstNode, shuffle, render, setValue, toString, unbind, unrender, update ) {\n\n\t\tvar Section = function( options ) {\n\t\t\tthis.type = types.SECTION;\n\t\t\tthis.subtype = options.template.n;\n\t\t\tthis.inverted = this.subtype === types.SECTION_UNLESS;\n\t\t\tthis.pElement = options.pElement;\n\t\t\tthis.fragments = [];\n\t\t\tthis.fragmentsToCreate = [];\n\t\t\tthis.fragmentsToRender = [];\n\t\t\tthis.fragmentsToUnrender = [];\n\t\t\tthis.renderedFragments = [];\n\t\t\tthis.length = 0;\n\t\t\t// number of times this section is rendered\n\t\t\tMustache.init( this, options );\n\t\t};\n\t\tSection.prototype = {\n\t\t\tbubble: bubble,\n\t\t\tdetach: detach,\n\t\t\tfind: find,\n\t\t\tfindAll: findAll,\n\t\t\tfindAllComponents: findAllComponents,\n\t\t\tfindComponent: findComponent,\n\t\t\tfindNextNode: findNextNode,\n\t\t\tfirstNode: firstNode,\n\t\t\tgetValue: Mustache.getValue,\n\t\t\tshuffle: shuffle,\n\t\t\trebind: Mustache.rebind,\n\t\t\trender: render,\n\t\t\tresolve: Mustache.resolve,\n\t\t\tsetValue: setValue,\n\t\t\ttoString: toString,\n\t\t\tunbind: unbind,\n\t\t\tunrender: unrender,\n\t\t\tupdate: update\n\t\t};\n\t\treturn Section;\n\t}( types, Mustache, virtualdom_items_Section$bubble, virtualdom_items_Section$detach, virtualdom_items_Section$find, virtualdom_items_Section$findAll, virtualdom_items_Section$findAllComponents, virtualdom_items_Section$findComponent, virtualdom_items_Section$findNextNode, virtualdom_items_Section$firstNode, virtualdom_items_Section$shuffle, virtualdom_items_Section$render, virtualdom_items_Section$setValue, virtualdom_items_Section$toString, virtualdom_items_Section$unbind, virtualdom_items_Section$unrender, virtualdom_items_Section$update );\n\n\t/* virtualdom/items/Triple/prototype/detach.js */\n\tvar virtualdom_items_Triple$detach = function Triple$detach() {\n\t\tvar len, i;\n\t\tif ( this.docFrag ) {\n\t\t\tlen = this.nodes.length;\n\t\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\t\tthis.docFrag.appendChild( this.nodes[ i ] );\n\t\t\t}\n\t\t\treturn this.docFrag;\n\t\t}\n\t};\n\n\t/* virtualdom/items/Triple/prototype/find.js */\n\tvar virtualdom_items_Triple$find = function( matches ) {\n\n\t\treturn function Triple$find( selector ) {\n\t\t\tvar i, len, node, queryResult;\n\t\t\tlen = this.nodes.length;\n\t\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\t\tnode = this.nodes[ i ];\n\t\t\t\tif ( node.nodeType !== 1 ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif ( matches( node, selector ) ) {\n\t\t\t\t\treturn node;\n\t\t\t\t}\n\t\t\t\tif ( queryResult = node.querySelector( selector ) ) {\n\t\t\t\t\treturn queryResult;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\t}( matches );\n\n\t/* virtualdom/items/Triple/prototype/findAll.js */\n\tvar virtualdom_items_Triple$findAll = function( matches ) {\n\n\t\treturn function Triple$findAll( selector, queryResult ) {\n\t\t\tvar i, len, node, queryAllResult, numNodes, j;\n\t\t\tlen = this.nodes.length;\n\t\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\t\tnode = this.nodes[ i ];\n\t\t\t\tif ( node.nodeType !== 1 ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif ( matches( node, selector ) ) {\n\t\t\t\t\tqueryResult.push( node );\n\t\t\t\t}\n\t\t\t\tif ( queryAllResult = node.querySelectorAll( selector ) ) {\n\t\t\t\t\tnumNodes = queryAllResult.length;\n\t\t\t\t\tfor ( j = 0; j < numNodes; j += 1 ) {\n\t\t\t\t\t\tqueryResult.push( queryAllResult[ j ] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}( matches );\n\n\t/* virtualdom/items/Triple/prototype/firstNode.js */\n\tvar virtualdom_items_Triple$firstNode = function Triple$firstNode() {\n\t\tif ( this.rendered && this.nodes[ 0 ] ) {\n\t\t\treturn this.nodes[ 0 ];\n\t\t}\n\t\treturn this.parentFragment.findNextNode( this );\n\t};\n\n\t/* virtualdom/items/Triple/helpers/insertHtml.js */\n\tvar insertHtml = function( namespaces, createElement ) {\n\n\t\tvar __export;\n\t\tvar elementCache = {},\n\t\t\tieBug, ieBlacklist;\n\t\ttry {\n\t\t\tcreateElement( 'table' ).innerHTML = 'foo';\n\t\t} catch ( err ) {\n\t\t\tieBug = true;\n\t\t\tieBlacklist = {\n\t\t\t\tTABLE: [\n\t\t\t\t\t'<table class=\"x\">',\n\t\t\t\t\t'</table>'\n\t\t\t\t],\n\t\t\t\tTHEAD: [\n\t\t\t\t\t'<table><thead class=\"x\">',\n\t\t\t\t\t'</thead></table>'\n\t\t\t\t],\n\t\t\t\tTBODY: [\n\t\t\t\t\t'<table><tbody class=\"x\">',\n\t\t\t\t\t'</tbody></table>'\n\t\t\t\t],\n\t\t\t\tTR: [\n\t\t\t\t\t'<table><tr class=\"x\">',\n\t\t\t\t\t'</tr></table>'\n\t\t\t\t],\n\t\t\t\tSELECT: [\n\t\t\t\t\t'<select class=\"x\">',\n\t\t\t\t\t'</select>'\n\t\t\t\t]\n\t\t\t};\n\t\t}\n\t\t__export = function( html, node, docFrag ) {\n\t\t\tvar container, nodes = [],\n\t\t\t\twrapper, selectedOption, child, i;\n\t\t\t// render 0 and false\n\t\t\tif ( html != null && html !== '' ) {\n\t\t\t\tif ( ieBug && ( wrapper = ieBlacklist[ node.tagName ] ) ) {\n\t\t\t\t\tcontainer = element( 'DIV' );\n\t\t\t\t\tcontainer.innerHTML = wrapper[ 0 ] + html + wrapper[ 1 ];\n\t\t\t\t\tcontainer = container.querySelector( '.x' );\n\t\t\t\t\tif ( container.tagName === 'SELECT' ) {\n\t\t\t\t\t\tselectedOption = container.options[ container.selectedIndex ];\n\t\t\t\t\t}\n\t\t\t\t} else if ( node.namespaceURI === namespaces.svg ) {\n\t\t\t\t\tcontainer = element( 'DIV' );\n\t\t\t\t\tcontainer.innerHTML = '<svg class=\"x\">' + html + '</svg>';\n\t\t\t\t\tcontainer = container.querySelector( '.x' );\n\t\t\t\t} else {\n\t\t\t\t\tcontainer = element( node.tagName );\n\t\t\t\t\tcontainer.innerHTML = html;\n\t\t\t\t\tif ( container.tagName === 'SELECT' ) {\n\t\t\t\t\t\tselectedOption = container.options[ container.selectedIndex ];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\twhile ( child = container.firstChild ) {\n\t\t\t\t\tnodes.push( child );\n\t\t\t\t\tdocFrag.appendChild( child );\n\t\t\t\t}\n\t\t\t\t// This is really annoying. Extracting <option> nodes from the\n\t\t\t\t// temporary container <select> causes the remaining ones to\n\t\t\t\t// become selected. So now we have to deselect them. IE8, you\n\t\t\t\t// amaze me. You really do\n\t\t\t\t// ...and now Chrome too\n\t\t\t\tif ( node.tagName === 'SELECT' ) {\n\t\t\t\t\ti = nodes.length;\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tif ( nodes[ i ] !== selectedOption ) {\n\t\t\t\t\t\t\tnodes[ i ].selected = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn nodes;\n\t\t};\n\n\t\tfunction element( tagName ) {\n\t\t\treturn elementCache[ tagName ] || ( elementCache[ tagName ] = createElement( tagName ) );\n\t\t}\n\t\treturn __export;\n\t}( namespaces, createElement );\n\n\t/* utils/toArray.js */\n\tvar toArray = function toArray( arrayLike ) {\n\t\tvar array = [],\n\t\t\ti = arrayLike.length;\n\t\twhile ( i-- ) {\n\t\t\tarray[ i ] = arrayLike[ i ];\n\t\t}\n\t\treturn array;\n\t};\n\n\t/* virtualdom/items/Triple/helpers/updateSelect.js */\n\tvar updateSelect = function( toArray ) {\n\n\t\tvar __export;\n\t\t__export = function updateSelect( parentElement ) {\n\t\t\tvar selectedOptions, option, value;\n\t\t\tif ( !parentElement || parentElement.name !== 'select' || !parentElement.binding ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tselectedOptions = toArray( parentElement.node.options ).filter( isSelected );\n\t\t\t// If one of them had a `selected` attribute, we need to sync\n\t\t\t// the model to the view\n\t\t\tif ( parentElement.getAttribute( 'multiple' ) ) {\n\t\t\t\tvalue = selectedOptions.map( function( o ) {\n\t\t\t\t\treturn o.value;\n\t\t\t\t} );\n\t\t\t} else if ( option = selectedOptions[ 0 ] ) {\n\t\t\t\tvalue = option.value;\n\t\t\t}\n\t\t\tif ( value !== undefined ) {\n\t\t\t\tparentElement.binding.setValue( value );\n\t\t\t}\n\t\t\tparentElement.bubble();\n\t\t};\n\n\t\tfunction isSelected( option ) {\n\t\t\treturn option.selected;\n\t\t}\n\t\treturn __export;\n\t}( toArray );\n\n\t/* virtualdom/items/Triple/prototype/render.js */\n\tvar virtualdom_items_Triple$render = function( insertHtml, updateSelect ) {\n\n\t\treturn function Triple$render() {\n\t\t\tif ( this.rendered ) {\n\t\t\t\tthrow new Error( 'Attempted to render an item that was already rendered' );\n\t\t\t}\n\t\t\tthis.docFrag = document.createDocumentFragment();\n\t\t\tthis.nodes = insertHtml( this.value, this.parentFragment.getNode(), this.docFrag );\n\t\t\t// Special case - we're inserting the contents of a <select>\n\t\t\tupdateSelect( this.pElement );\n\t\t\tthis.rendered = true;\n\t\t\treturn this.docFrag;\n\t\t};\n\t}( insertHtml, updateSelect );\n\n\t/* virtualdom/items/Triple/prototype/setValue.js */\n\tvar virtualdom_items_Triple$setValue = function( runloop ) {\n\n\t\treturn function Triple$setValue( value ) {\n\t\t\tvar wrapper;\n\t\t\t// TODO is there a better way to approach this?\n\t\t\tif ( wrapper = this.root.viewmodel.wrapped[ this.keypath ] ) {\n\t\t\t\tvalue = wrapper.get();\n\t\t\t}\n\t\t\tif ( value !== this.value ) {\n\t\t\t\tthis.value = value;\n\t\t\t\tthis.parentFragment.bubble();\n\t\t\t\tif ( this.rendered ) {\n\t\t\t\t\trunloop.addView( this );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}( runloop );\n\n\t/* virtualdom/items/Triple/prototype/toString.js */\n\tvar virtualdom_items_Triple$toString = function( decodeCharacterReferences ) {\n\n\t\treturn function Triple$toString() {\n\t\t\treturn this.value != undefined ? decodeCharacterReferences( '' + this.value ) : '';\n\t\t};\n\t}( decodeCharacterReferences );\n\n\t/* virtualdom/items/Triple/prototype/unrender.js */\n\tvar virtualdom_items_Triple$unrender = function( detachNode ) {\n\n\t\treturn function Triple$unrender( shouldDestroy ) {\n\t\t\tif ( this.rendered && shouldDestroy ) {\n\t\t\t\tthis.nodes.forEach( detachNode );\n\t\t\t\tthis.rendered = false;\n\t\t\t}\n\t\t};\n\t}( detachNode );\n\n\t/* virtualdom/items/Triple/prototype/update.js */\n\tvar virtualdom_items_Triple$update = function( insertHtml, updateSelect ) {\n\n\t\treturn function Triple$update() {\n\t\t\tvar node, parentNode;\n\t\t\tif ( !this.rendered ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// Remove existing nodes\n\t\t\twhile ( this.nodes && this.nodes.length ) {\n\t\t\t\tnode = this.nodes.pop();\n\t\t\t\tnode.parentNode.removeChild( node );\n\t\t\t}\n\t\t\t// Insert new nodes\n\t\t\tparentNode = this.parentFragment.getNode();\n\t\t\tthis.nodes = insertHtml( this.value, parentNode, this.docFrag );\n\t\t\tparentNode.insertBefore( this.docFrag, this.parentFragment.findNextNode( this ) );\n\t\t\t// Special case - we're inserting the contents of a <select>\n\t\t\tupdateSelect( this.pElement );\n\t\t};\n\t}( insertHtml, updateSelect );\n\n\t/* virtualdom/items/Triple/_Triple.js */\n\tvar Triple = function( types, Mustache, detach, find, findAll, firstNode, render, setValue, toString, unrender, update, unbind ) {\n\n\t\tvar Triple = function( options ) {\n\t\t\tthis.type = types.TRIPLE;\n\t\t\tMustache.init( this, options );\n\t\t};\n\t\tTriple.prototype = {\n\t\t\tdetach: detach,\n\t\t\tfind: find,\n\t\t\tfindAll: findAll,\n\t\t\tfirstNode: firstNode,\n\t\t\tgetValue: Mustache.getValue,\n\t\t\trebind: Mustache.rebind,\n\t\t\trender: render,\n\t\t\tresolve: Mustache.resolve,\n\t\t\tsetValue: setValue,\n\t\t\ttoString: toString,\n\t\t\tunbind: unbind,\n\t\t\tunrender: unrender,\n\t\t\tupdate: update\n\t\t};\n\t\treturn Triple;\n\t}( types, Mustache, virtualdom_items_Triple$detach, virtualdom_items_Triple$find, virtualdom_items_Triple$findAll, virtualdom_items_Triple$firstNode, virtualdom_items_Triple$render, virtualdom_items_Triple$setValue, virtualdom_items_Triple$toString, virtualdom_items_Triple$unrender, virtualdom_items_Triple$update, unbind );\n\n\t/* virtualdom/items/Element/prototype/bubble.js */\n\tvar virtualdom_items_Element$bubble = function() {\n\t\tthis.parentFragment.bubble();\n\t};\n\n\t/* virtualdom/items/Element/prototype/detach.js */\n\tvar virtualdom_items_Element$detach = function Element$detach() {\n\t\tvar node = this.node,\n\t\t\tparentNode;\n\t\tif ( node ) {\n\t\t\t// need to check for parent node - DOM may have been altered\n\t\t\t// by something other than Ractive! e.g. jQuery UI...\n\t\t\tif ( parentNode = node.parentNode ) {\n\t\t\t\tparentNode.removeChild( node );\n\t\t\t}\n\t\t\treturn node;\n\t\t}\n\t};\n\n\t/* virtualdom/items/Element/prototype/find.js */\n\tvar virtualdom_items_Element$find = function( matches ) {\n\n\t\treturn function( selector ) {\n\t\t\tif ( matches( this.node, selector ) ) {\n\t\t\t\treturn this.node;\n\t\t\t}\n\t\t\tif ( this.fragment && this.fragment.find ) {\n\t\t\t\treturn this.fragment.find( selector );\n\t\t\t}\n\t\t};\n\t}( matches );\n\n\t/* virtualdom/items/Element/prototype/findAll.js */\n\tvar virtualdom_items_Element$findAll = function( selector, query ) {\n\t\t// Add this node to the query, if applicable, and register the\n\t\t// query on this element\n\t\tif ( query._test( this, true ) && query.live ) {\n\t\t\t( this.liveQueries || ( this.liveQueries = [] ) ).push( query );\n\t\t}\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAll( selector, query );\n\t\t}\n\t};\n\n\t/* virtualdom/items/Element/prototype/findAllComponents.js */\n\tvar virtualdom_items_Element$findAllComponents = function( selector, query ) {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.findAllComponents( selector, query );\n\t\t}\n\t};\n\n\t/* virtualdom/items/Element/prototype/findComponent.js */\n\tvar virtualdom_items_Element$findComponent = function( selector ) {\n\t\tif ( this.fragment ) {\n\t\t\treturn this.fragment.findComponent( selector );\n\t\t}\n\t};\n\n\t/* virtualdom/items/Element/prototype/findNextNode.js */\n\tvar virtualdom_items_Element$findNextNode = function Element$findNextNode() {\n\t\treturn null;\n\t};\n\n\t/* virtualdom/items/Element/prototype/firstNode.js */\n\tvar virtualdom_items_Element$firstNode = function Element$firstNode() {\n\t\treturn this.node;\n\t};\n\n\t/* virtualdom/items/Element/prototype/getAttribute.js */\n\tvar virtualdom_items_Element$getAttribute = function Element$getAttribute( name ) {\n\t\tif ( !this.attributes || !this.attributes[ name ] ) {\n\t\t\treturn;\n\t\t}\n\t\treturn this.attributes[ name ].value;\n\t};\n\n\t/* virtualdom/items/Element/shared/enforceCase.js */\n\tvar enforceCase = function() {\n\n\t\tvar svgCamelCaseElements, svgCamelCaseAttributes, createMap, map;\n\t\tsvgCamelCaseElements = 'altGlyph altGlyphDef altGlyphItem animateColor animateMotion animateTransform clipPath feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence foreignObject glyphRef linearGradient radialGradient textPath vkern'.split( ' ' );\n\t\tsvgCamelCaseAttributes = 'attributeName attributeType baseFrequency baseProfile calcMode clipPathUnits contentScriptType contentStyleType diffuseConstant edgeMode externalResourcesRequired filterRes filterUnits glyphRef gradientTransform gradientUnits kernelMatrix kernelUnitLength keyPoints keySplines keyTimes lengthAdjust limitingConeAngle markerHeight markerUnits markerWidth maskContentUnits maskUnits numOctaves pathLength patternContentUnits patternTransform patternUnits pointsAtX pointsAtY pointsAtZ preserveAlpha preserveAspectRatio primitiveUnits refX refY repeatCount repeatDur requiredExtensions requiredFeatures specularConstant specularExponent spreadMethod startOffset stdDeviation stitchTiles surfaceScale systemLanguage tableValues targetX targetY textLength viewBox viewTarget xChannelSelector yChannelSelector zoomAndPan'.split( ' ' );\n\t\tcreateMap = function( items ) {\n\t\t\tvar map = {},\n\t\t\t\ti = items.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tmap[ items[ i ].toLowerCase() ] = items[ i ];\n\t\t\t}\n\t\t\treturn map;\n\t\t};\n\t\tmap = createMap( svgCamelCaseElements.concat( svgCamelCaseAttributes ) );\n\t\treturn function( elementName ) {\n\t\t\tvar lowerCaseElementName = elementName.toLowerCase();\n\t\t\treturn map[ lowerCaseElementName ] || lowerCaseElementName;\n\t\t};\n\t}();\n\n\t/* virtualdom/items/Element/Attribute/prototype/bubble.js */\n\tvar virtualdom_items_Element_Attribute$bubble = function( runloop, isEqual ) {\n\n\t\treturn function Attribute$bubble() {\n\t\t\tvar value = this.fragment.getValue();\n\t\t\t// TODO this can register the attribute multiple times (see render test\n\t\t\t// 'Attribute with nested mustaches')\n\t\t\tif ( !isEqual( value, this.value ) ) {\n\t\t\t\t// Need to clear old id from ractive.nodes\n\t\t\t\tif ( this.name === 'id' && this.value ) {\n\t\t\t\t\tdelete this.root.nodes[ this.value ];\n\t\t\t\t}\n\t\t\t\tthis.value = value;\n\t\t\t\tif ( this.name === 'value' && this.node ) {\n\t\t\t\t\t// We need to store the value on the DOM like this so we\n\t\t\t\t\t// can retrieve it later without it being coerced to a string\n\t\t\t\t\tthis.node._ractive.value = value;\n\t\t\t\t}\n\t\t\t\tif ( this.rendered ) {\n\t\t\t\t\trunloop.addView( this );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}( runloop, isEqual );\n\n\t/* config/booleanAttributes.js */\n\tvar booleanAttributes = function() {\n\n\t\t// https://github.com/kangax/html-minifier/issues/63#issuecomment-37763316\n\t\tvar booleanAttributes = /^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|draggable|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i;\n\t\treturn booleanAttributes;\n\t}();\n\n\t/* virtualdom/items/Element/Attribute/helpers/determineNameAndNamespace.js */\n\tvar determineNameAndNamespace = function( namespaces, enforceCase ) {\n\n\t\treturn function( attribute, name ) {\n\t\t\tvar colonIndex, namespacePrefix;\n\t\t\t// are we dealing with a namespaced attribute, e.g. xlink:href?\n\t\t\tcolonIndex = name.indexOf( ':' );\n\t\t\tif ( colonIndex !== -1 ) {\n\t\t\t\t// looks like we are, yes...\n\t\t\t\tnamespacePrefix = name.substr( 0, colonIndex );\n\t\t\t\t// ...unless it's a namespace *declaration*, which we ignore (on the assumption\n\t\t\t\t// that only valid namespaces will be used)\n\t\t\t\tif ( namespacePrefix !== 'xmlns' ) {\n\t\t\t\t\tname = name.substring( colonIndex + 1 );\n\t\t\t\t\tattribute.name = enforceCase( name );\n\t\t\t\t\tattribute.namespace = namespaces[ namespacePrefix.toLowerCase() ];\n\t\t\t\t\tattribute.namespacePrefix = namespacePrefix;\n\t\t\t\t\tif ( !attribute.namespace ) {\n\t\t\t\t\t\tthrow 'Unknown namespace (\"' + namespacePrefix + '\")';\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// SVG attribute names are case sensitive\n\t\t\tattribute.name = attribute.element.namespace !== namespaces.html ? enforceCase( name ) : name;\n\t\t};\n\t}( namespaces, enforceCase );\n\n\t/* virtualdom/items/Element/Attribute/helpers/getInterpolator.js */\n\tvar getInterpolator = function( types ) {\n\n\t\treturn function getInterpolator( attribute ) {\n\t\t\tvar items = attribute.fragment.items;\n\t\t\tif ( items.length !== 1 ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif ( items[ 0 ].type === types.INTERPOLATOR ) {\n\t\t\t\treturn items[ 0 ];\n\t\t\t}\n\t\t};\n\t}( types );\n\n\t/* virtualdom/items/Element/Attribute/helpers/determinePropertyName.js */\n\tvar determinePropertyName = function( namespaces, booleanAttributes ) {\n\n\t\tvar propertyNames = {\n\t\t\t'accept-charset': 'acceptCharset',\n\t\t\taccesskey: 'accessKey',\n\t\t\tbgcolor: 'bgColor',\n\t\t\t'class': 'className',\n\t\t\tcodebase: 'codeBase',\n\t\t\tcolspan: 'colSpan',\n\t\t\tcontenteditable: 'contentEditable',\n\t\t\tdatetime: 'dateTime',\n\t\t\tdirname: 'dirName',\n\t\t\t'for': 'htmlFor',\n\t\t\t'http-equiv': 'httpEquiv',\n\t\t\tismap: 'isMap',\n\t\t\tmaxlength: 'maxLength',\n\t\t\tnovalidate: 'noValidate',\n\t\t\tpubdate: 'pubDate',\n\t\t\treadonly: 'readOnly',\n\t\t\trowspan: 'rowSpan',\n\t\t\ttabindex: 'tabIndex',\n\t\t\tusemap: 'useMap'\n\t\t};\n\t\treturn function( attribute, options ) {\n\t\t\tvar propertyName;\n\t\t\tif ( attribute.pNode && !attribute.namespace && ( !options.pNode.namespaceURI || options.pNode.namespaceURI === namespaces.html ) ) {\n\t\t\t\tpropertyName = propertyNames[ attribute.name ] || attribute.name;\n\t\t\t\tif ( options.pNode[ propertyName ] !== undefined ) {\n\t\t\t\t\tattribute.propertyName = propertyName;\n\t\t\t\t}\n\t\t\t\t// is attribute a boolean attribute or 'value'? If so we're better off doing e.g.\n\t\t\t\t// node.selected = true rather than node.setAttribute( 'selected', '' )\n\t\t\t\tif ( booleanAttributes.test( propertyName ) || propertyName === 'value' ) {\n\t\t\t\t\tattribute.useProperty = true;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}( namespaces, booleanAttributes );\n\n\t/* virtualdom/items/Element/Attribute/prototype/init.js */\n\tvar virtualdom_items_Element_Attribute$init = function( types, booleanAttributes, determineNameAndNamespace, getInterpolator, determinePropertyName, circular ) {\n\n\t\tvar Fragment;\n\t\tcircular.push( function() {\n\t\t\tFragment = circular.Fragment;\n\t\t} );\n\t\treturn function Attribute$init( options ) {\n\t\t\tthis.type = types.ATTRIBUTE;\n\t\t\tthis.element = options.element;\n\t\t\tthis.root = options.root;\n\t\t\tdetermineNameAndNamespace( this, options.name );\n\t\t\t// if it's an empty attribute, or just a straight key-value pair, with no\n\t\t\t// mustache shenanigans, set the attribute accordingly and go home\n\t\t\tif ( !options.value || typeof options.value === 'string' ) {\n\t\t\t\tthis.value = booleanAttributes.test( this.name ) ? true : options.value || '';\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// otherwise we need to do some work\n\t\t\t// share parentFragment with parent element\n\t\t\tthis.parentFragment = this.element.parentFragment;\n\t\t\tthis.fragment = new Fragment( {\n\t\t\t\ttemplate: options.value,\n\t\t\t\troot: this.root,\n\t\t\t\towner: this\n\t\t\t} );\n\t\t\tthis.value = this.fragment.getValue();\n\t\t\t// Store a reference to this attribute's interpolator, if its fragment\n\t\t\t// takes the form `{{foo}}`. This is necessary for two-way binding and\n\t\t\t// for correctly rendering HTML later\n\t\t\tthis.interpolator = getInterpolator( this );\n\t\t\tthis.isBindable = !!this.interpolator && !this.interpolator.isStatic;\n\t\t\t// can we establish this attribute's property name equivalent?\n\t\t\tdeterminePropertyName( this, options );\n\t\t\t// mark as ready\n\t\t\tthis.ready = true;\n\t\t};\n\t}( types, booleanAttributes, determineNameAndNamespace, getInterpolator, determinePropertyName, circular );\n\n\t/* virtualdom/items/Element/Attribute/prototype/rebind.js */\n\tvar virtualdom_items_Element_Attribute$rebind = function Attribute$rebind( indexRef, newIndex, oldKeypath, newKeypath ) {\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.rebind( indexRef, newIndex, oldKeypath, newKeypath );\n\t\t}\n\t};\n\n\t/* virtualdom/items/Element/Attribute/prototype/render.js */\n\tvar virtualdom_items_Element_Attribute$render = function( namespaces, booleanAttributes ) {\n\n\t\tvar propertyNames = {\n\t\t\t'accept-charset': 'acceptCharset',\n\t\t\t'accesskey': 'accessKey',\n\t\t\t'bgcolor': 'bgColor',\n\t\t\t'class': 'className',\n\t\t\t'codebase': 'codeBase',\n\t\t\t'colspan': 'colSpan',\n\t\t\t'contenteditable': 'contentEditable',\n\t\t\t'datetime': 'dateTime',\n\t\t\t'dirname': 'dirName',\n\t\t\t'for': 'htmlFor',\n\t\t\t'http-equiv': 'httpEquiv',\n\t\t\t'ismap': 'isMap',\n\t\t\t'maxlength': 'maxLength',\n\t\t\t'novalidate': 'noValidate',\n\t\t\t'pubdate': 'pubDate',\n\t\t\t'readonly': 'readOnly',\n\t\t\t'rowspan': 'rowSpan',\n\t\t\t'tabindex': 'tabIndex',\n\t\t\t'usemap': 'useMap'\n\t\t};\n\t\treturn function Attribute$render( node ) {\n\t\t\tvar propertyName;\n\t\t\tthis.node = node;\n\t\t\t// should we use direct property access, or setAttribute?\n\t\t\tif ( !node.namespaceURI || node.namespaceURI === namespaces.html ) {\n\t\t\t\tpropertyName = propertyNames[ this.name ] || this.name;\n\t\t\t\tif ( node[ propertyName ] !== undefined ) {\n\t\t\t\t\tthis.propertyName = propertyName;\n\t\t\t\t}\n\t\t\t\t// is attribute a boolean attribute or 'value'? If so we're better off doing e.g.\n\t\t\t\t// node.selected = true rather than node.setAttribute( 'selected', '' )\n\t\t\t\tif ( booleanAttributes.test( propertyName ) || propertyName === 'value' ) {\n\t\t\t\t\tthis.useProperty = true;\n\t\t\t\t}\n\t\t\t\tif ( propertyName === 'value' ) {\n\t\t\t\t\tthis.useProperty = true;\n\t\t\t\t\tnode._ractive.value = this.value;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.rendered = true;\n\t\t\tthis.update();\n\t\t};\n\t}( namespaces, booleanAttributes );\n\n\t/* virtualdom/items/Element/Attribute/prototype/toString.js */\n\tvar virtualdom_items_Element_Attribute$toString = function( booleanAttributes ) {\n\n\t\tvar __export;\n\t\t__export = function Attribute$toString() {\n\t\t\tvar name = ( fragment = this ).name,\n\t\t\t\tnamespacePrefix = fragment.namespacePrefix,\n\t\t\t\tvalue = fragment.value,\n\t\t\t\tinterpolator = fragment.interpolator,\n\t\t\t\tfragment = fragment.fragment;\n\t\t\t// Special case - select and textarea values (should not be stringified)\n\t\t\tif ( name === 'value' && ( this.element.name === 'select' || this.element.name === 'textarea' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// Special case - content editable\n\t\t\tif ( name === 'value' && this.element.getAttribute( 'contenteditable' ) !== undefined ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// Special case - radio names\n\t\t\tif ( name === 'name' && this.element.name === 'input' && interpolator ) {\n\t\t\t\treturn 'name={{' + ( interpolator.keypath || interpolator.ref ) + '}}';\n\t\t\t}\n\t\t\t// Boolean attributes\n\t\t\tif ( booleanAttributes.test( name ) ) {\n\t\t\t\treturn value ? name : '';\n\t\t\t}\n\t\t\tif ( fragment ) {\n\t\t\t\tvalue = fragment.toString();\n\t\t\t}\n\t\t\tif ( namespacePrefix ) {\n\t\t\t\tname = namespacePrefix + ':' + name;\n\t\t\t}\n\t\t\treturn value ? name + '=\"' + escape( value ) + '\"' : name;\n\t\t};\n\n\t\tfunction escape( value ) {\n\t\t\treturn value.replace( /&/g, '&amp;' ).replace( /\"/g, '&quot;' ).replace( /'/g, '&#39;' );\n\t\t}\n\t\treturn __export;\n\t}( booleanAttributes );\n\n\t/* virtualdom/items/Element/Attribute/prototype/unbind.js */\n\tvar virtualdom_items_Element_Attribute$unbind = function Attribute$unbind() {\n\t\t// ignore non-dynamic attributes\n\t\tif ( this.fragment ) {\n\t\t\tthis.fragment.unbind();\n\t\t}\n\t\tif ( this.name === 'id' ) {\n\t\t\tdelete this.root.nodes[ this.value ];\n\t\t}\n\t};\n\n\t/* virtualdom/items/Element/Attribute/prototype/update/updateSelectValue.js */\n\tvar virtualdom_items_Element_Attribute$update_updateSelectValue = function Attribute$updateSelect() {\n\t\tvar value = this.value,\n\t\t\toptions, option, optionValue, i;\n\t\tif ( !this.locked ) {\n\t\t\tthis.node._ractive.value = value;\n\t\t\toptions = this.node.options;\n\t\t\ti = options.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\toption = options[ i ];\n\t\t\t\toptionValue = option._ractive ? option._ractive.value : option.value;\n\t\t\t\t// options inserted via a triple don't have _ractive\n\t\t\t\tif ( optionValue == value ) {\n\t\t\t\t\t// double equals as we may be comparing numbers with strings\n\t\t\t\t\toption.selected = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\t/* utils/arrayContains.js */\n\tvar arrayContains = function arrayContains( array, value ) {\n\t\tfor ( var i = 0, c = array.length; i < c; i++ ) {\n\t\t\tif ( array[ i ] == value ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t};\n\n\t/* virtualdom/items/Element/Attribute/prototype/update/updateMultipleSelectValue.js */\n\tvar virtualdom_items_Element_Attribute$update_updateMultipleSelectValue = function( arrayContains, isArray ) {\n\n\t\treturn function Attribute$updateMultipleSelect() {\n\t\t\tvar value = this.value,\n\t\t\t\toptions, i, option, optionValue;\n\t\t\tif ( !isArray( value ) ) {\n\t\t\t\tvalue = [ value ];\n\t\t\t}\n\t\t\toptions = this.node.options;\n\t\t\ti = options.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\toption = options[ i ];\n\t\t\t\toptionValue = option._ractive ? option._ractive.value : option.value;\n\t\t\t\t// options inserted via a triple don't have _ractive\n\t\t\t\toption.selected = arrayContains( value, optionValue );\n\t\t\t}\n\t\t};\n\t}( arrayContains, isArray );\n\n\t/* virtualdom/items/Element/Attribute/prototype/update/updateRadioName.js */\n\tvar virtualdom_items_Element_Attribute$update_updateRadioName = function Attribute$updateRadioName() {\n\t\tvar node = ( value = this ).node,\n\t\t\tvalue = value.value;\n\t\tnode.checked = value == node._ractive.value;\n\t};\n\n\t/* virtualdom/items/Element/Attribute/prototype/update/updateRadioValue.js */\n\tvar virtualdom_items_Element_Attribute$update_updateRadioValue = function( runloop ) {\n\n\t\treturn function Attribute$updateRadioValue() {\n\t\t\tvar wasChecked, node = this.node,\n\t\t\t\tbinding, bindings, i;\n\t\t\twasChecked = node.checked;\n\t\t\tnode.value = this.element.getAttribute( 'value' );\n\t\t\tnode.checked = this.element.getAttribute( 'value' ) === this.element.getAttribute( 'name' );\n\t\t\t// This is a special case - if the input was checked, and the value\n\t\t\t// changed so that it's no longer checked, the twoway binding is\n\t\t\t// most likely out of date. To fix it we have to jump through some\n\t\t\t// hoops... this is a little kludgy but it works\n\t\t\tif ( wasChecked && !node.checked && this.element.binding ) {\n\t\t\t\tbindings = this.element.binding.siblings;\n\t\t\t\tif ( i = bindings.length ) {\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tbinding = bindings[ i ];\n\t\t\t\t\t\tif ( !binding.element.node ) {\n\t\t\t\t\t\t\t// this is the initial render, siblings are still rendering!\n\t\t\t\t\t\t\t// we'll come back later...\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( binding.element.node.checked ) {\n\t\t\t\t\t\t\trunloop.addViewmodel( binding.root.viewmodel );\n\t\t\t\t\t\t\treturn binding.handleChange();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trunloop.addViewmodel( binding.root.viewmodel );\n\t\t\t\t\tthis.root.viewmodel.set( binding.keypath, undefined );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}( runloop );\n\n\t/* virtualdom/items/Element/Attribute/prototype/update/updateCheckboxName.js */\n\tvar virtualdom_items_Element_Attribute$update_updateCheckboxName = function( isArray ) {\n\n\t\treturn function Attribute$updateCheckboxName() {\n\t\t\tvar element = ( value = this ).element,\n\t\t\t\tnode = value.node,\n\t\t\t\tvalue = value.value,\n\t\t\t\tvalueAttribute, i;\n\t\t\tvalueAttribute = element.getAttribute( 'value' );\n\t\t\tif ( !isArray( value ) ) {\n\t\t\t\tnode.checked = value == valueAttribute;\n\t\t\t} else {\n\t\t\t\ti = value.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tif ( valueAttribute == value[ i ] ) {\n\t\t\t\t\t\tnode.checked = true;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnode.checked = false;\n\t\t\t}\n\t\t};\n\t}( isArray );\n\n\t/* virtualdom/items/Element/Attribute/prototype/update/updateClassName.js */\n\tvar virtualdom_items_Element_Attribute$update_updateClassName = function Attribute$updateClassName() {\n\t\tvar node, value;\n\t\tnode = this.node;\n\t\tvalue = this.value;\n\t\tif ( value === undefined ) {\n\t\t\tvalue = '';\n\t\t}\n\t\tnode.className = value;\n\t};\n\n\t/* virtualdom/items/Element/Attribute/prototype/update/updateIdAttribute.js */\n\tvar virtualdom_items_Element_Attribute$update_updateIdAttribute = function Attribute$updateIdAttribute() {\n\t\tvar node = ( value = this ).node,\n\t\t\tvalue = value.value;\n\t\tthis.root.nodes[ value ] = node;\n\t\tnode.id = value;\n\t};\n\n\t/* virtualdom/items/Element/Attribute/prototype/update/updateIEStyleAttribute.js */\n\tvar virtualdom_items_Element_Attribute$update_updateIEStyleAttribute = function Attribute$updateIEStyleAttribute() {\n\t\tvar node, value;\n\t\tnode = this.node;\n\t\tvalue = this.value;\n\t\tif ( value === undefined ) {\n\t\t\tvalue = '';\n\t\t}\n\t\tnode.style.setAttribute( 'cssText', value );\n\t};\n\n\t/* virtualdom/items/Element/Attribute/prototype/update/updateContentEditableValue.js */\n\tvar virtualdom_items_Element_Attribute$update_updateContentEditableValue = function Attribute$updateContentEditableValue() {\n\t\tvar value = this.value;\n\t\tif ( value === undefined ) {\n\t\t\tvalue = '';\n\t\t}\n\t\tif ( !this.locked ) {\n\t\t\tthis.node.innerHTML = value;\n\t\t}\n\t};\n\n\t/* virtualdom/items/Element/Attribute/prototype/update/updateValue.js */\n\tvar virtualdom_items_Element_Attribute$update_updateValue = function Attribute$updateValue() {\n\t\tvar node = ( value = this ).node,\n\t\t\tvalue = value.value;\n\t\t// store actual value, so it doesn't get coerced to a string\n\t\tnode._ractive.value = value;\n\t\t// with two-way binding, only update if the change wasn't initiated by the user\n\t\t// otherwise the cursor will often be sent to the wrong place\n\t\tif ( !this.locked ) {\n\t\t\tnode.value = value == undefined ? '' : value;\n\t\t}\n\t};\n\n\t/* virtualdom/items/Element/Attribute/prototype/update/updateBoolean.js */\n\tvar virtualdom_items_Element_Attribute$update_updateBoolean = function Attribute$updateBooleanAttribute() {\n\t\t// with two-way binding, only update if the change wasn't initiated by the user\n\t\t// otherwise the cursor will often be sent to the wrong place\n\t\tif ( !this.locked ) {\n\t\t\tthis.node[ this.propertyName ] = this.value;\n\t\t}\n\t};\n\n\t/* virtualdom/items/Element/Attribute/prototype/update/updateEverythingElse.js */\n\tvar virtualdom_items_Element_Attribute$update_updateEverythingElse = function( booleanAttributes ) {\n\n\t\treturn function Attribute$updateEverythingElse() {\n\t\t\tvar node = ( fragment = this ).node,\n\t\t\t\tnamespace = fragment.namespace,\n\t\t\t\tname = fragment.name,\n\t\t\t\tvalue = fragment.value,\n\t\t\t\tfragment = fragment.fragment;\n\t\t\tif ( namespace ) {\n\t\t\t\tnode.setAttributeNS( namespace, name, ( fragment || value ).toString() );\n\t\t\t} else if ( !booleanAttributes.test( name ) ) {\n\t\t\t\tnode.setAttribute( name, ( fragment || value ).toString() );\n\t\t\t} else {\n\t\t\t\tif ( value ) {\n\t\t\t\t\tnode.setAttribute( name, '' );\n\t\t\t\t} else {\n\t\t\t\t\tnode.removeAttribute( name );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}( booleanAttributes );\n\n\t/* virtualdom/items/Element/Attribute/prototype/update.js */\n\tvar virtualdom_items_Element_Attribute$update = function( namespaces, noop, updateSelectValue, updateMultipleSelectValue, updateRadioName, updateRadioValue, updateCheckboxName, updateClassName, updateIdAttribute, updateIEStyleAttribute, updateContentEditableValue, updateValue, updateBoolean, updateEverythingElse ) {\n\n\t\treturn function Attribute$update() {\n\t\t\tvar name = ( node = this ).name,\n\t\t\t\telement = node.element,\n\t\t\t\tnode = node.node,\n\t\t\t\ttype, updateMethod;\n\t\t\tif ( name === 'id' ) {\n\t\t\t\tupdateMethod = updateIdAttribute;\n\t\t\t} else if ( name === 'value' ) {\n\t\t\t\t// special case - selects\n\t\t\t\tif ( element.name === 'select' && name === 'value' ) {\n\t\t\t\t\tupdateMethod = element.getAttribute( 'multiple' ) ? updateMultipleSelectValue : updateSelectValue;\n\t\t\t\t} else if ( element.name === 'textarea' ) {\n\t\t\t\t\tupdateMethod = updateValue;\n\t\t\t\t} else if ( element.getAttribute( 'contenteditable' ) != null ) {\n\t\t\t\t\tupdateMethod = updateContentEditableValue;\n\t\t\t\t} else if ( element.name === 'input' ) {\n\t\t\t\t\ttype = element.getAttribute( 'type' );\n\t\t\t\t\t// type='file' value='{{fileList}}'>\n\t\t\t\t\tif ( type === 'file' ) {\n\t\t\t\t\t\tupdateMethod = noop;\n\t\t\t\t\t} else if ( type === 'radio' && element.binding && element.binding.name === 'name' ) {\n\t\t\t\t\t\tupdateMethod = updateRadioValue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tupdateMethod = updateValue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if ( this.twoway && name === 'name' ) {\n\t\t\t\tif ( node.type === 'radio' ) {\n\t\t\t\t\tupdateMethod = updateRadioName;\n\t\t\t\t} else if ( node.type === 'checkbox' ) {\n\t\t\t\t\tupdateMethod = updateCheckboxName;\n\t\t\t\t}\n\t\t\t} else if ( name === 'style' && node.style.setAttribute ) {\n\t\t\t\tupdateMethod = updateIEStyleAttribute;\n\t\t\t} else if ( name === 'class' && ( !node.namespaceURI || node.namespaceURI === namespaces.html ) ) {\n\t\t\t\tupdateMethod = updateClassName;\n\t\t\t} else if ( this.useProperty ) {\n\t\t\t\tupdateMethod = updateBoolean;\n\t\t\t}\n\t\t\tif ( !updateMethod ) {\n\t\t\t\tupdateMethod = updateEverythingElse;\n\t\t\t}\n\t\t\tthis.update = updateMethod;\n\t\t\tthis.update();\n\t\t};\n\t}( namespaces, noop, virtualdom_items_Element_Attribute$update_updateSelectValue, virtualdom_items_Element_Attribute$update_updateMultipleSelectValue, virtualdom_items_Element_Attribute$update_updateRadioName, virtualdom_items_Element_Attribute$update_updateRadioValue, virtualdom_items_Element_Attribute$update_updateCheckboxName, virtualdom_items_Element_Attribute$update_updateClassName, virtualdom_items_Element_Attribute$update_updateIdAttribute, virtualdom_items_Element_Attribute$update_updateIEStyleAttribute, virtualdom_items_Element_Attribute$update_updateContentEditableValue, virtualdom_items_Element_Attribute$update_updateValue, virtualdom_items_Element_Attribute$update_updateBoolean, virtualdom_items_Element_Attribute$update_updateEverythingElse );\n\n\t/* virtualdom/items/Element/Attribute/_Attribute.js */\n\tvar Attribute = function( bubble, init, rebind, render, toString, unbind, update ) {\n\n\t\tvar Attribute = function( options ) {\n\t\t\tthis.init( options );\n\t\t};\n\t\tAttribute.prototype = {\n\t\t\tbubble: bubble,\n\t\t\tinit: init,\n\t\t\trebind: rebind,\n\t\t\trender: render,\n\t\t\ttoString: toString,\n\t\t\tunbind: unbind,\n\t\t\tupdate: update\n\t\t};\n\t\treturn Attribute;\n\t}( virtualdom_items_Element_Attribute$bubble, virtualdom_items_Element_Attribute$init, virtualdom_items_Element_Attribute$rebind, virtualdom_items_Element_Attribute$render, virtualdom_items_Element_Attribute$toString, virtualdom_items_Element_Attribute$unbind, virtualdom_items_Element_Attribute$update );\n\n\t/* virtualdom/items/Element/prototype/init/createAttributes.js */\n\tvar virtualdom_items_Element$init_createAttributes = function( Attribute ) {\n\n\t\treturn function( element, attributes ) {\n\t\t\tvar name, attribute, result = [];\n\t\t\tfor ( name in attributes ) {\n\t\t\t\tif ( attributes.hasOwnProperty( name ) ) {\n\t\t\t\t\tattribute = new Attribute( {\n\t\t\t\t\t\telement: element,\n\t\t\t\t\t\tname: name,\n\t\t\t\t\t\tvalue: attributes[ name ],\n\t\t\t\t\t\troot: element.root\n\t\t\t\t\t} );\n\t\t\t\t\tresult.push( result[ name ] = attribute );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t};\n\t}( Attribute );\n\n\t/* virtualdom/items/Element/ConditionalAttribute/_ConditionalAttribute.js */\n\tvar ConditionalAttribute = function( circular, namespaces, createElement, toArray ) {\n\n\t\tvar __export;\n\t\tvar Fragment, div;\n\t\tif ( typeof document !== 'undefined' ) {\n\t\t\tdiv = createElement( 'div' );\n\t\t}\n\t\tcircular.push( function() {\n\t\t\tFragment = circular.Fragment;\n\t\t} );\n\t\tvar ConditionalAttribute = function( element, template ) {\n\t\t\tthis.element = element;\n\t\t\tthis.root = element.root;\n\t\t\tthis.parentFragment = element.parentFragment;\n\t\t\tthis.attributes = [];\n\t\t\tthis.fragment = new Fragment( {\n\t\t\t\troot: element.root,\n\t\t\t\towner: this,\n\t\t\t\ttemplate: [ template ]\n\t\t\t} );\n\t\t};\n\t\tConditionalAttribute.prototype = {\n\t\t\tbubble: function() {\n\t\t\t\tif ( this.node ) {\n\t\t\t\t\tthis.update();\n\t\t\t\t}\n\t\t\t\tthis.element.bubble();\n\t\t\t},\n\t\t\trebind: function( indexRef, newIndex, oldKeypath, newKeypath ) {\n\t\t\t\tthis.fragment.rebind( indexRef, newIndex, oldKeypath, newKeypath );\n\t\t\t},\n\t\t\trender: function( node ) {\n\t\t\t\tthis.node = node;\n\t\t\t\tthis.isSvg = node.namespaceURI === namespaces.svg;\n\t\t\t\tthis.update();\n\t\t\t},\n\t\t\tunbind: function() {\n\t\t\t\tthis.fragment.unbind();\n\t\t\t},\n\t\t\tupdate: function() {\n\t\t\t\tvar this$0 = this;\n\t\t\t\tvar str, attrs;\n\t\t\t\tstr = this.fragment.toString();\n\t\t\t\tattrs = parseAttributes( str, this.isSvg );\n\t\t\t\t// any attributes that previously existed but no longer do\n\t\t\t\t// must be removed\n\t\t\t\tthis.attributes.filter( function( a ) {\n\t\t\t\t\treturn notIn( attrs, a );\n\t\t\t\t} ).forEach( function( a ) {\n\t\t\t\t\tthis$0.node.removeAttribute( a.name );\n\t\t\t\t} );\n\t\t\t\tattrs.forEach( function( a ) {\n\t\t\t\t\tthis$0.node.setAttribute( a.name, a.value );\n\t\t\t\t} );\n\t\t\t\tthis.attributes = attrs;\n\t\t\t},\n\t\t\ttoString: function() {\n\t\t\t\treturn this.fragment.toString();\n\t\t\t}\n\t\t};\n\t\t__export = ConditionalAttribute;\n\n\t\tfunction parseAttributes( str, isSvg ) {\n\t\t\tvar tag = isSvg ? 'svg' : 'div';\n\t\t\tdiv.innerHTML = '<' + tag + ' ' + str + '></' + tag + '>';\n\t\t\treturn toArray( div.childNodes[ 0 ].attributes );\n\t\t}\n\n\t\tfunction notIn( haystack, needle ) {\n\t\t\tvar i = haystack.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( haystack[ i ].name === needle.name ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn __export;\n\t}( circular, namespaces, createElement, toArray );\n\n\t/* virtualdom/items/Element/prototype/init/createConditionalAttributes.js */\n\tvar virtualdom_items_Element$init_createConditionalAttributes = function( ConditionalAttribute ) {\n\n\t\treturn function( element, attributes ) {\n\t\t\tif ( !attributes ) {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t\treturn attributes.map( function( a ) {\n\t\t\t\treturn new ConditionalAttribute( element, a );\n\t\t\t} );\n\t\t};\n\t}( ConditionalAttribute );\n\n\t/* utils/extend.js */\n\tvar extend = function( target ) {\n\t\tvar SLICE$0 = Array.prototype.slice;\n\t\tvar sources = SLICE$0.call( arguments, 1 );\n\t\tvar prop, source;\n\t\twhile ( source = sources.shift() ) {\n\t\t\tfor ( prop in source ) {\n\t\t\t\tif ( source.hasOwnProperty( prop ) ) {\n\t\t\t\t\ttarget[ prop ] = source[ prop ];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn target;\n\t};\n\n\t/* virtualdom/items/Element/Binding/Binding.js */\n\tvar Binding = function( runloop, warn, create, extend, removeFromArray ) {\n\n\t\tvar Binding = function( element ) {\n\t\t\tvar interpolator, keypath, value;\n\t\t\tthis.element = element;\n\t\t\tthis.root = element.root;\n\t\t\tthis.attribute = element.attributes[ this.name || 'value' ];\n\t\t\tinterpolator = this.attribute.interpolator;\n\t\t\tinterpolator.twowayBinding = this;\n\t\t\tif ( interpolator.keypath && interpolator.keypath.substr( 0, 2 ) === '${' ) {\n\t\t\t\twarn( 'Two-way binding does not work with expressions (`' + interpolator.keypath.slice( 2, -1 ) + '`)' );\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// A mustache may be *ambiguous*. Let's say we were given\n\t\t\t// `value=\"{{bar}}\"`. If the context was `foo`, and `foo.bar`\n\t\t\t// *wasn't* `undefined`, the keypath would be `foo.bar`.\n\t\t\t// Then, any user input would result in `foo.bar` being updated.\n\t\t\t//\n\t\t\t// If, however, `foo.bar` *was* undefined, and so was `bar`, we would be\n\t\t\t// left with an unresolved partial keypath - so we are forced to make an\n\t\t\t// assumption. That assumption is that the input in question should\n\t\t\t// be forced to resolve to `bar`, and any user input would affect `bar`\n\t\t\t// and not `foo.bar`.\n\t\t\t//\n\t\t\t// Did that make any sense? No? Oh. Sorry. Well the moral of the story is\n\t\t\t// be explicit when using two-way data-binding about what keypath you're\n\t\t\t// updating. Using it in lists is probably a recipe for confusion...\n\t\t\tif ( !interpolator.keypath ) {\n\t\t\t\tinterpolator.resolver.forceResolution();\n\t\t\t}\n\t\t\tthis.keypath = keypath = interpolator.keypath;\n\t\t\t// initialise value, if it's undefined\n\t\t\tif ( this.root.viewmodel.get( keypath ) === undefined && this.getInitialValue ) {\n\t\t\t\tvalue = this.getInitialValue();\n\t\t\t\tif ( value !== undefined ) {\n\t\t\t\t\tthis.root.viewmodel.set( keypath, value );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tBinding.prototype = {\n\t\t\thandleChange: function() {\n\t\t\t\tvar this$0 = this;\n\t\t\t\trunloop.start( this.root );\n\t\t\t\tthis.attribute.locked = true;\n\t\t\t\tthis.root.viewmodel.set( this.keypath, this.getValue() );\n\t\t\t\trunloop.scheduleTask( function() {\n\t\t\t\t\treturn this$0.attribute.locked = false;\n\t\t\t\t} );\n\t\t\t\trunloop.end();\n\t\t\t},\n\t\t\trebound: function() {\n\t\t\t\tvar bindings, oldKeypath, newKeypath;\n\t\t\t\toldKeypath = this.keypath;\n\t\t\t\tnewKeypath = this.attribute.interpolator.keypath;\n\t\t\t\t// The attribute this binding is linked to has already done the work\n\t\t\t\tif ( oldKeypath === newKeypath ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tremoveFromArray( this.root._twowayBindings[ oldKeypath ], this );\n\t\t\t\tthis.keypath = newKeypath;\n\t\t\t\tbindings = this.root._twowayBindings[ newKeypath ] || ( this.root._twowayBindings[ newKeypath ] = [] );\n\t\t\t\tbindings.push( this );\n\t\t\t},\n\t\t\tunbind: function() {}\n\t\t};\n\t\tBinding.extend = function( properties ) {\n\t\t\tvar Parent = this,\n\t\t\t\tSpecialisedBinding;\n\t\t\tSpecialisedBinding = function( element ) {\n\t\t\t\tBinding.call( this, element );\n\t\t\t\tif ( this.init ) {\n\t\t\t\t\tthis.init();\n\t\t\t\t}\n\t\t\t};\n\t\t\tSpecialisedBinding.prototype = create( Parent.prototype );\n\t\t\textend( SpecialisedBinding.prototype, properties );\n\t\t\tSpecialisedBinding.extend = Binding.extend;\n\t\t\treturn SpecialisedBinding;\n\t\t};\n\t\treturn Binding;\n\t}( runloop, warn, create, extend, removeFromArray );\n\n\t/* virtualdom/items/Element/Binding/shared/handleDomEvent.js */\n\tvar handleDomEvent = function handleChange() {\n\t\tthis._ractive.binding.handleChange();\n\t};\n\n\t/* virtualdom/items/Element/Binding/ContentEditableBinding.js */\n\tvar ContentEditableBinding = function( Binding, handleDomEvent ) {\n\n\t\tvar ContentEditableBinding = Binding.extend( {\n\t\t\tgetInitialValue: function() {\n\t\t\t\treturn this.element.fragment ? this.element.fragment.toString() : '';\n\t\t\t},\n\t\t\trender: function() {\n\t\t\t\tvar node = this.element.node;\n\t\t\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\t\t\t\tif ( !this.root.lazy ) {\n\t\t\t\t\tnode.addEventListener( 'input', handleDomEvent, false );\n\t\t\t\t\tif ( node.attachEvent ) {\n\t\t\t\t\t\tnode.addEventListener( 'keyup', handleDomEvent, false );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tunrender: function() {\n\t\t\t\tvar node = this.element.node;\n\t\t\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\t\t\tnode.removeEventListener( 'input', handleDomEvent, false );\n\t\t\t\tnode.removeEventListener( 'keyup', handleDomEvent, false );\n\t\t\t},\n\t\t\tgetValue: function() {\n\t\t\t\treturn this.element.node.innerHTML;\n\t\t\t}\n\t\t} );\n\t\treturn ContentEditableBinding;\n\t}( Binding, handleDomEvent );\n\n\t/* virtualdom/items/Element/Binding/shared/getSiblings.js */\n\tvar getSiblings = function() {\n\n\t\tvar sets = {};\n\t\treturn function getSiblings( id, group, keypath ) {\n\t\t\tvar hash = id + group + keypath;\n\t\t\treturn sets[ hash ] || ( sets[ hash ] = [] );\n\t\t};\n\t}();\n\n\t/* virtualdom/items/Element/Binding/RadioBinding.js */\n\tvar RadioBinding = function( runloop, removeFromArray, Binding, getSiblings, handleDomEvent ) {\n\n\t\tvar RadioBinding = Binding.extend( {\n\t\t\tname: 'checked',\n\t\t\tinit: function() {\n\t\t\t\tthis.siblings = getSiblings( this.root._guid, 'radio', this.element.getAttribute( 'name' ) );\n\t\t\t\tthis.siblings.push( this );\n\t\t\t},\n\t\t\trender: function() {\n\t\t\t\tvar node = this.element.node;\n\t\t\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\t\t\t\tif ( node.attachEvent ) {\n\t\t\t\t\tnode.addEventListener( 'click', handleDomEvent, false );\n\t\t\t\t}\n\t\t\t},\n\t\t\tunrender: function() {\n\t\t\t\tvar node = this.element.node;\n\t\t\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\t\t\tnode.removeEventListener( 'click', handleDomEvent, false );\n\t\t\t},\n\t\t\thandleChange: function() {\n\t\t\t\trunloop.start( this.root );\n\t\t\t\tthis.siblings.forEach( function( binding ) {\n\t\t\t\t\tbinding.root.viewmodel.set( binding.keypath, binding.getValue() );\n\t\t\t\t} );\n\t\t\t\trunloop.end();\n\t\t\t},\n\t\t\tgetValue: function() {\n\t\t\t\treturn this.element.node.checked;\n\t\t\t},\n\t\t\tunbind: function() {\n\t\t\t\tremoveFromArray( this.siblings, this );\n\t\t\t}\n\t\t} );\n\t\treturn RadioBinding;\n\t}( runloop, removeFromArray, Binding, getSiblings, handleDomEvent );\n\n\t/* virtualdom/items/Element/Binding/RadioNameBinding.js */\n\tvar RadioNameBinding = function( removeFromArray, Binding, handleDomEvent, getSiblings ) {\n\n\t\tvar RadioNameBinding = Binding.extend( {\n\t\t\tname: 'name',\n\t\t\tinit: function() {\n\t\t\t\tthis.siblings = getSiblings( this.root._guid, 'radioname', this.keypath );\n\t\t\t\tthis.siblings.push( this );\n\t\t\t\tthis.radioName = true;\n\t\t\t\t// so that ractive.updateModel() knows what to do with this\n\t\t\t\tthis.attribute.twoway = true;\n\t\t\t},\n\t\t\tgetInitialValue: function() {\n\t\t\t\tif ( this.element.getAttribute( 'checked' ) ) {\n\t\t\t\t\treturn this.element.getAttribute( 'value' );\n\t\t\t\t}\n\t\t\t},\n\t\t\trender: function() {\n\t\t\t\tvar node = this.element.node;\n\t\t\t\tnode.name = '{{' + this.keypath + '}}';\n\t\t\t\tnode.checked = this.root.viewmodel.get( this.keypath ) == this.element.getAttribute( 'value' );\n\t\t\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\t\t\t\tif ( node.attachEvent ) {\n\t\t\t\t\tnode.addEventListener( 'click', handleDomEvent, false );\n\t\t\t\t}\n\t\t\t},\n\t\t\tunrender: function() {\n\t\t\t\tvar node = this.element.node;\n\t\t\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\t\t\tnode.removeEventListener( 'click', handleDomEvent, false );\n\t\t\t},\n\t\t\tgetValue: function() {\n\t\t\t\tvar node = this.element.node;\n\t\t\t\treturn node._ractive ? node._ractive.value : node.value;\n\t\t\t},\n\t\t\thandleChange: function() {\n\t\t\t\t// If this <input> is the one that's checked, then the value of its\n\t\t\t\t// `name` keypath gets set to its value\n\t\t\t\tif ( this.element.node.checked ) {\n\t\t\t\t\tBinding.prototype.handleChange.call( this );\n\t\t\t\t}\n\t\t\t},\n\t\t\trebound: function( indexRef, newIndex, oldKeypath, newKeypath ) {\n\t\t\t\tvar node;\n\t\t\t\tBinding.prototype.rebound.call( this, indexRef, newIndex, oldKeypath, newKeypath );\n\t\t\t\tif ( node = this.element.node ) {\n\t\t\t\t\tnode.name = '{{' + this.keypath + '}}';\n\t\t\t\t}\n\t\t\t},\n\t\t\tunbind: function() {\n\t\t\t\tremoveFromArray( this.siblings, this );\n\t\t\t}\n\t\t} );\n\t\treturn RadioNameBinding;\n\t}( removeFromArray, Binding, handleDomEvent, getSiblings );\n\n\t/* virtualdom/items/Element/Binding/CheckboxNameBinding.js */\n\tvar CheckboxNameBinding = function( isArray, arrayContains, removeFromArray, Binding, getSiblings, handleDomEvent ) {\n\n\t\tvar CheckboxNameBinding = Binding.extend( {\n\t\t\tname: 'name',\n\t\t\tgetInitialValue: function() {\n\t\t\t\t// This only gets called once per group (of inputs that\n\t\t\t\t// share a name), because it only gets called if there\n\t\t\t\t// isn't an initial value. By the same token, we can make\n\t\t\t\t// a note of that fact that there was no initial value,\n\t\t\t\t// and populate it using any `checked` attributes that\n\t\t\t\t// exist (which users should avoid, but which we should\n\t\t\t\t// support anyway to avoid breaking expectations)\n\t\t\t\tthis.noInitialValue = true;\n\t\t\t\treturn [];\n\t\t\t},\n\t\t\tinit: function() {\n\t\t\t\tvar existingValue, bindingValue;\n\t\t\t\tthis.checkboxName = true;\n\t\t\t\t// so that ractive.updateModel() knows what to do with this\n\t\t\t\tthis.attribute.twoway = true;\n\t\t\t\t// we set this property so that the attribute gets the correct update method\n\t\t\t\t// Each input has a reference to an array containing it and its\n\t\t\t\t// siblings, as two-way binding depends on being able to ascertain\n\t\t\t\t// the status of all inputs within the group\n\t\t\t\tthis.siblings = getSiblings( this.root._guid, 'checkboxes', this.keypath );\n\t\t\t\tthis.siblings.push( this );\n\t\t\t\tif ( this.noInitialValue ) {\n\t\t\t\t\tthis.siblings.noInitialValue = true;\n\t\t\t\t}\n\t\t\t\t// If no initial value was set, and this input is checked, we\n\t\t\t\t// update the model\n\t\t\t\tif ( this.siblings.noInitialValue && this.element.getAttribute( 'checked' ) ) {\n\t\t\t\t\texistingValue = this.root.viewmodel.get( this.keypath );\n\t\t\t\t\tbindingValue = this.element.getAttribute( 'value' );\n\t\t\t\t\texistingValue.push( bindingValue );\n\t\t\t\t}\n\t\t\t},\n\t\t\tunbind: function() {\n\t\t\t\tremoveFromArray( this.siblings, this );\n\t\t\t},\n\t\t\trender: function() {\n\t\t\t\tvar node = this.element.node,\n\t\t\t\t\texistingValue, bindingValue;\n\t\t\t\texistingValue = this.root.viewmodel.get( this.keypath );\n\t\t\t\tbindingValue = this.element.getAttribute( 'value' );\n\t\t\t\tif ( isArray( existingValue ) ) {\n\t\t\t\t\tthis.isChecked = arrayContains( existingValue, bindingValue );\n\t\t\t\t} else {\n\t\t\t\t\tthis.isChecked = existingValue == bindingValue;\n\t\t\t\t}\n\t\t\t\tnode.name = '{{' + this.keypath + '}}';\n\t\t\t\tnode.checked = this.isChecked;\n\t\t\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\t\t\t\t// in case of IE emergency, bind to click event as well\n\t\t\t\tif ( node.attachEvent ) {\n\t\t\t\t\tnode.addEventListener( 'click', handleDomEvent, false );\n\t\t\t\t}\n\t\t\t},\n\t\t\tunrender: function() {\n\t\t\t\tvar node = this.element.node;\n\t\t\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\t\t\tnode.removeEventListener( 'click', handleDomEvent, false );\n\t\t\t},\n\t\t\tchanged: function() {\n\t\t\t\tvar wasChecked = !!this.isChecked;\n\t\t\t\tthis.isChecked = this.element.node.checked;\n\t\t\t\treturn this.isChecked === wasChecked;\n\t\t\t},\n\t\t\thandleChange: function() {\n\t\t\t\tthis.isChecked = this.element.node.checked;\n\t\t\t\tBinding.prototype.handleChange.call( this );\n\t\t\t},\n\t\t\tgetValue: function() {\n\t\t\t\treturn this.siblings.filter( isChecked ).map( getValue );\n\t\t\t}\n\t\t} );\n\n\t\tfunction isChecked( binding ) {\n\t\t\treturn binding.isChecked;\n\t\t}\n\n\t\tfunction getValue( binding ) {\n\t\t\treturn binding.element.getAttribute( 'value' );\n\t\t}\n\t\treturn CheckboxNameBinding;\n\t}( isArray, arrayContains, removeFromArray, Binding, getSiblings, handleDomEvent );\n\n\t/* virtualdom/items/Element/Binding/CheckboxBinding.js */\n\tvar CheckboxBinding = function( Binding, handleDomEvent ) {\n\n\t\tvar CheckboxBinding = Binding.extend( {\n\t\t\tname: 'checked',\n\t\t\trender: function() {\n\t\t\t\tvar node = this.element.node;\n\t\t\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\t\t\t\tif ( node.attachEvent ) {\n\t\t\t\t\tnode.addEventListener( 'click', handleDomEvent, false );\n\t\t\t\t}\n\t\t\t},\n\t\t\tunrender: function() {\n\t\t\t\tvar node = this.element.node;\n\t\t\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\t\t\tnode.removeEventListener( 'click', handleDomEvent, false );\n\t\t\t},\n\t\t\tgetValue: function() {\n\t\t\t\treturn this.element.node.checked;\n\t\t\t}\n\t\t} );\n\t\treturn CheckboxBinding;\n\t}( Binding, handleDomEvent );\n\n\t/* virtualdom/items/Element/Binding/SelectBinding.js */\n\tvar SelectBinding = function( runloop, Binding, handleDomEvent ) {\n\n\t\tvar SelectBinding = Binding.extend( {\n\t\t\tgetInitialValue: function() {\n\t\t\t\tvar options = this.element.options,\n\t\t\t\t\tlen, i, value, optionWasSelected;\n\t\t\t\tif ( this.element.getAttribute( 'value' ) !== undefined ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\ti = len = options.length;\n\t\t\t\tif ( !len ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// take the final selected option...\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tif ( options[ i ].getAttribute( 'selected' ) ) {\n\t\t\t\t\t\tvalue = options[ i ].getAttribute( 'value' );\n\t\t\t\t\t\toptionWasSelected = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// or the first non-disabled option, if none are selected\n\t\t\t\tif ( !optionWasSelected ) {\n\t\t\t\t\twhile ( ++i < len ) {\n\t\t\t\t\t\tif ( !options[ i ].getAttribute( 'disabled' ) ) {\n\t\t\t\t\t\t\tvalue = options[ i ].getAttribute( 'value' );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// This is an optimisation (aka hack) that allows us to forgo some\n\t\t\t\t// other more expensive work\n\t\t\t\tif ( value !== undefined ) {\n\t\t\t\t\tthis.element.attributes.value.value = value;\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\trender: function() {\n\t\t\t\tthis.element.node.addEventListener( 'change', handleDomEvent, false );\n\t\t\t},\n\t\t\tunrender: function() {\n\t\t\t\tthis.element.node.removeEventListener( 'change', handleDomEvent, false );\n\t\t\t},\n\t\t\t// TODO this method is an anomaly... is it necessary?\n\t\t\tsetValue: function( value ) {\n\t\t\t\trunloop.addViewmodel( this.root.viewmodel );\n\t\t\t\tthis.root.viewmodel.set( this.keypath, value );\n\t\t\t},\n\t\t\tgetValue: function() {\n\t\t\t\tvar options, i, len, option, optionValue;\n\t\t\t\toptions = this.element.node.options;\n\t\t\t\tlen = options.length;\n\t\t\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\t\t\toption = options[ i ];\n\t\t\t\t\tif ( options[ i ].selected ) {\n\t\t\t\t\t\toptionValue = option._ractive ? option._ractive.value : option.value;\n\t\t\t\t\t\treturn optionValue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tforceUpdate: function() {\n\t\t\t\tvar this$0 = this;\n\t\t\t\tvar value = this.getValue();\n\t\t\t\tif ( value !== undefined ) {\n\t\t\t\t\tthis.attribute.locked = true;\n\t\t\t\t\trunloop.addViewmodel( this.root.viewmodel );\n\t\t\t\t\trunloop.scheduleTask( function() {\n\t\t\t\t\t\treturn this$0.attribute.locked = false;\n\t\t\t\t\t} );\n\t\t\t\t\tthis.root.viewmodel.set( this.keypath, value );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t\treturn SelectBinding;\n\t}( runloop, Binding, handleDomEvent );\n\n\t/* utils/arrayContentsMatch.js */\n\tvar arrayContentsMatch = function( isArray ) {\n\n\t\treturn function( a, b ) {\n\t\t\tvar i;\n\t\t\tif ( !isArray( a ) || !isArray( b ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif ( a.length !== b.length ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\ti = a.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( a[ i ] !== b[ i ] ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t};\n\t}( isArray );\n\n\t/* virtualdom/items/Element/Binding/MultipleSelectBinding.js */\n\tvar MultipleSelectBinding = function( runloop, arrayContentsMatch, SelectBinding, handleDomEvent ) {\n\n\t\tvar MultipleSelectBinding = SelectBinding.extend( {\n\t\t\tgetInitialValue: function() {\n\t\t\t\treturn this.element.options.filter( function( option ) {\n\t\t\t\t\treturn option.getAttribute( 'selected' );\n\t\t\t\t} ).map( function( option ) {\n\t\t\t\t\treturn option.getAttribute( 'value' );\n\t\t\t\t} );\n\t\t\t},\n\t\t\trender: function() {\n\t\t\t\tvar valueFromModel;\n\t\t\t\tthis.element.node.addEventListener( 'change', handleDomEvent, false );\n\t\t\t\tvalueFromModel = this.root.viewmodel.get( this.keypath );\n\t\t\t\tif ( valueFromModel === undefined ) {\n\t\t\t\t\t// get value from DOM, if possible\n\t\t\t\t\tthis.handleChange();\n\t\t\t\t}\n\t\t\t},\n\t\t\tunrender: function() {\n\t\t\t\tthis.element.node.removeEventListener( 'change', handleDomEvent, false );\n\t\t\t},\n\t\t\tsetValue: function() {\n\t\t\t\tthrow new Error( 'TODO not implemented yet' );\n\t\t\t},\n\t\t\tgetValue: function() {\n\t\t\t\tvar selectedValues, options, i, len, option, optionValue;\n\t\t\t\tselectedValues = [];\n\t\t\t\toptions = this.element.node.options;\n\t\t\t\tlen = options.length;\n\t\t\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\t\t\toption = options[ i ];\n\t\t\t\t\tif ( option.selected ) {\n\t\t\t\t\t\toptionValue = option._ractive ? option._ractive.value : option.value;\n\t\t\t\t\t\tselectedValues.push( optionValue );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn selectedValues;\n\t\t\t},\n\t\t\thandleChange: function() {\n\t\t\t\tvar attribute, previousValue, value;\n\t\t\t\tattribute = this.attribute;\n\t\t\t\tpreviousValue = attribute.value;\n\t\t\t\tvalue = this.getValue();\n\t\t\t\tif ( previousValue === undefined || !arrayContentsMatch( value, previousValue ) ) {\n\t\t\t\t\tSelectBinding.prototype.handleChange.call( this );\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tforceUpdate: function() {\n\t\t\t\tvar this$0 = this;\n\t\t\t\tvar value = this.getValue();\n\t\t\t\tif ( value !== undefined ) {\n\t\t\t\t\tthis.attribute.locked = true;\n\t\t\t\t\trunloop.addViewmodel( this.root.viewmodel );\n\t\t\t\t\trunloop.scheduleTask( function() {\n\t\t\t\t\t\treturn this$0.attribute.locked = false;\n\t\t\t\t\t} );\n\t\t\t\t\tthis.root.viewmodel.set( this.keypath, value );\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdateModel: function() {\n\t\t\t\tif ( this.attribute.value === undefined || !this.attribute.value.length ) {\n\t\t\t\t\tthis.root.viewmodel.set( this.keypath, this.initialValue );\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t\treturn MultipleSelectBinding;\n\t}( runloop, arrayContentsMatch, SelectBinding, handleDomEvent );\n\n\t/* virtualdom/items/Element/Binding/FileListBinding.js */\n\tvar FileListBinding = function( Binding, handleDomEvent ) {\n\n\t\tvar FileListBinding = Binding.extend( {\n\t\t\trender: function() {\n\t\t\t\tthis.element.node.addEventListener( 'change', handleDomEvent, false );\n\t\t\t},\n\t\t\tunrender: function() {\n\t\t\t\tthis.element.node.removeEventListener( 'change', handleDomEvent, false );\n\t\t\t},\n\t\t\tgetValue: function() {\n\t\t\t\treturn this.element.node.files;\n\t\t\t}\n\t\t} );\n\t\treturn FileListBinding;\n\t}( Binding, handleDomEvent );\n\n\t/* virtualdom/items/Element/Binding/GenericBinding.js */\n\tvar GenericBinding = function( Binding, handleDomEvent ) {\n\n\t\tvar __export;\n\t\tvar GenericBinding, getOptions;\n\t\tgetOptions = {\n\t\t\tevaluateWrapped: true\n\t\t};\n\t\tGenericBinding = Binding.extend( {\n\t\t\tgetInitialValue: function() {\n\t\t\t\treturn '';\n\t\t\t},\n\t\t\tgetValue: function() {\n\t\t\t\treturn this.element.node.value;\n\t\t\t},\n\t\t\trender: function() {\n\t\t\t\tvar node = this.element.node;\n\t\t\t\tnode.addEventListener( 'change', handleDomEvent, false );\n\t\t\t\tif ( !this.root.lazy ) {\n\t\t\t\t\tnode.addEventListener( 'input', handleDomEvent, false );\n\t\t\t\t\tif ( node.attachEvent ) {\n\t\t\t\t\t\tnode.addEventListener( 'keyup', handleDomEvent, false );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnode.addEventListener( 'blur', handleBlur, false );\n\t\t\t},\n\t\t\tunrender: function() {\n\t\t\t\tvar node = this.element.node;\n\t\t\t\tnode.removeEventListener( 'change', handleDomEvent, false );\n\t\t\t\tnode.removeEventListener( 'input', handleDomEvent, false );\n\t\t\t\tnode.removeEventListener( 'keyup', handleDomEvent, false );\n\t\t\t\tnode.removeEventListener( 'blur', handleBlur, false );\n\t\t\t}\n\t\t} );\n\t\t__export = GenericBinding;\n\n\t\tfunction handleBlur() {\n\t\t\tvar value;\n\t\t\thandleDomEvent.call( this );\n\t\t\tvalue = this._ractive.root.viewmodel.get( this._ractive.binding.keypath, getOptions );\n\t\t\tthis.value = value == undefined ? '' : value;\n\t\t}\n\t\treturn __export;\n\t}( Binding, handleDomEvent );\n\n\t/* virtualdom/items/Element/Binding/NumericBinding.js */\n\tvar NumericBinding = function( GenericBinding ) {\n\n\t\treturn GenericBinding.extend( {\n\t\t\tgetInitialValue: function() {\n\t\t\t\treturn undefined;\n\t\t\t},\n\t\t\tgetValue: function() {\n\t\t\t\tvar value = parseFloat( this.element.node.value );\n\t\t\t\treturn isNaN( value ) ? undefined : value;\n\t\t\t}\n\t\t} );\n\t}( GenericBinding );\n\n\t/* virtualdom/items/Element/prototype/init/createTwowayBinding.js */\n\tvar virtualdom_items_Element$init_createTwowayBinding = function( log, ContentEditableBinding, RadioBinding, RadioNameBinding, CheckboxNameBinding, CheckboxBinding, SelectBinding, MultipleSelectBinding, FileListBinding, NumericBinding, GenericBinding ) {\n\n\t\tvar __export;\n\t\t__export = function createTwowayBinding( element ) {\n\t\t\tvar attributes = element.attributes,\n\t\t\t\ttype, Binding, bindName, bindChecked;\n\t\t\t// if this is a late binding, and there's already one, it\n\t\t\t// needs to be torn down\n\t\t\tif ( element.binding ) {\n\t\t\t\telement.binding.teardown();\n\t\t\t\telement.binding = null;\n\t\t\t}\n\t\t\t// contenteditable\n\t\t\tif ( // if the contenteditable attribute is true or is bindable and may thus become true\n\t\t\t\t( element.getAttribute( 'contenteditable' ) || !!attributes.contenteditable && isBindable( attributes.contenteditable ) ) && isBindable( attributes.value ) ) {\n\t\t\t\tBinding = ContentEditableBinding;\n\t\t\t} else if ( element.name === 'input' ) {\n\t\t\t\ttype = element.getAttribute( 'type' );\n\t\t\t\tif ( type === 'radio' || type === 'checkbox' ) {\n\t\t\t\t\tbindName = isBindable( attributes.name );\n\t\t\t\t\tbindChecked = isBindable( attributes.checked );\n\t\t\t\t\t// we can either bind the name attribute, or the checked attribute - not both\n\t\t\t\t\tif ( bindName && bindChecked ) {\n\t\t\t\t\t\tlog.error( {\n\t\t\t\t\t\t\tmessage: 'badRadioInputBinding'\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t\tif ( bindName ) {\n\t\t\t\t\t\tBinding = type === 'radio' ? RadioNameBinding : CheckboxNameBinding;\n\t\t\t\t\t} else if ( bindChecked ) {\n\t\t\t\t\t\tBinding = type === 'radio' ? RadioBinding : CheckboxBinding;\n\t\t\t\t\t}\n\t\t\t\t} else if ( type === 'file' && isBindable( attributes.value ) ) {\n\t\t\t\t\tBinding = FileListBinding;\n\t\t\t\t} else if ( isBindable( attributes.value ) ) {\n\t\t\t\t\tBinding = type === 'number' || type === 'range' ? NumericBinding : GenericBinding;\n\t\t\t\t}\n\t\t\t} else if ( element.name === 'select' && isBindable( attributes.value ) ) {\n\t\t\t\tBinding = element.getAttribute( 'multiple' ) ? MultipleSelectBinding : SelectBinding;\n\t\t\t} else if ( element.name === 'textarea' && isBindable( attributes.value ) ) {\n\t\t\t\tBinding = GenericBinding;\n\t\t\t}\n\t\t\tif ( Binding ) {\n\t\t\t\treturn new Binding( element );\n\t\t\t}\n\t\t};\n\n\t\tfunction isBindable( attribute ) {\n\t\t\treturn attribute && attribute.isBindable;\n\t\t}\n\t\treturn __export;\n\t}( log, ContentEditableBinding, RadioBinding, RadioNameBinding, CheckboxNameBinding, CheckboxBinding, SelectBinding, MultipleSelectBinding, FileListBinding, NumericBinding, GenericBinding );\n\n\t/* virtualdom/items/Element/EventHandler/prototype/bubble.js */\n\tvar virtualdom_items_Element_EventHandler$bubble = function EventHandler$bubble() {\n\t\tvar hasAction = this.getAction();\n\t\tif ( hasAction && !this.hasListener ) {\n\t\t\tthis.listen();\n\t\t} else if ( !hasAction && this.hasListener ) {\n\t\t\tthis.unrender();\n\t\t}\n\t};\n\n\t/* virtualdom/items/Element/EventHandler/prototype/fire.js */\n\tvar virtualdom_items_Element_EventHandler$fire = function( fireEvent ) {\n\n\t\treturn function EventHandler$fire( event ) {\n\t\t\tfireEvent( this.root, this.getAction(), {\n\t\t\t\tevent: event\n\t\t\t} );\n\t\t};\n\t}( Ractive$shared_fireEvent );\n\n\t/* virtualdom/items/Element/EventHandler/prototype/getAction.js */\n\tvar virtualdom_items_Element_EventHandler$getAction = function EventHandler$getAction() {\n\t\treturn this.action.toString().trim();\n\t};\n\n\t/* virtualdom/items/Element/EventHandler/prototype/init.js */\n\tvar virtualdom_items_Element_EventHandler$init = function( getFunctionFromString, createReferenceResolver, circular, fireEvent, log ) {\n\n\t\tvar __export;\n\t\tvar Fragment, getValueOptions = {\n\t\t\t\targs: true\n\t\t\t},\n\t\t\teventPattern = /^event(?:\\.(.+))?/;\n\t\tcircular.push( function() {\n\t\t\tFragment = circular.Fragment;\n\t\t} );\n\t\t__export = function EventHandler$init( element, name, template ) {\n\t\t\tvar handler = this,\n\t\t\t\taction, refs, ractive;\n\t\t\thandler.element = element;\n\t\t\thandler.root = element.root;\n\t\t\thandler.name = name;\n\t\t\tif ( name.indexOf( '*' ) !== -1 ) {\n\t\t\t\tlog.error( {\n\t\t\t\t\tdebug: this.root.debug,\n\t\t\t\t\tmessage: 'noElementProxyEventWildcards',\n\t\t\t\t\targs: {\n\t\t\t\t\t\telement: element.tagName,\n\t\t\t\t\t\tevent: name\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\tthis.invalid = true;\n\t\t\t}\n\t\t\tif ( template.m ) {\n\t\t\t\trefs = template.a.r;\n\t\t\t\t// This is a method call\n\t\t\t\thandler.method = template.m;\n\t\t\t\thandler.keypaths = [];\n\t\t\t\thandler.fn = getFunctionFromString( template.a.s, refs.length );\n\t\t\t\thandler.parentFragment = element.parentFragment;\n\t\t\t\tractive = handler.root;\n\t\t\t\t// Create resolvers for each reference\n\t\t\t\thandler.refResolvers = refs.map( function( ref, i ) {\n\t\t\t\t\tvar match;\n\t\t\t\t\t// special case - the `event` object\n\t\t\t\t\tif ( match = eventPattern.exec( ref ) ) {\n\t\t\t\t\t\thandler.keypaths[ i ] = {\n\t\t\t\t\t\t\teventObject: true,\n\t\t\t\t\t\t\trefinements: match[ 1 ] ? match[ 1 ].split( '.' ) : []\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\treturn createReferenceResolver( handler, ref, function( keypath ) {\n\t\t\t\t\t\thandler.resolve( i, keypath );\n\t\t\t\t\t} );\n\t\t\t\t} );\n\t\t\t\tthis.fire = fireMethodCall;\n\t\t\t} else {\n\t\t\t\t// Get action ('foo' in 'on-click='foo')\n\t\t\t\taction = template.n || template;\n\t\t\t\tif ( typeof action !== 'string' ) {\n\t\t\t\t\taction = new Fragment( {\n\t\t\t\t\t\ttemplate: action,\n\t\t\t\t\t\troot: this.root,\n\t\t\t\t\t\towner: this\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tthis.action = action;\n\t\t\t\t// Get parameters\n\t\t\t\tif ( template.d ) {\n\t\t\t\t\tthis.dynamicParams = new Fragment( {\n\t\t\t\t\t\ttemplate: template.d,\n\t\t\t\t\t\troot: this.root,\n\t\t\t\t\t\towner: this.element\n\t\t\t\t\t} );\n\t\t\t\t\tthis.fire = fireEventWithDynamicParams;\n\t\t\t\t} else if ( template.a ) {\n\t\t\t\t\tthis.params = template.a;\n\t\t\t\t\tthis.fire = fireEventWithParams;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tfunction fireMethodCall( event ) {\n\t\t\tvar ractive, values, args;\n\t\t\tractive = this.root;\n\t\t\tif ( typeof ractive[ this.method ] !== 'function' ) {\n\t\t\t\tthrow new Error( 'Attempted to call a non-existent method (\"' + this.method + '\")' );\n\t\t\t}\n\t\t\tvalues = this.keypaths.map( function( keypath ) {\n\t\t\t\tvar value, len, i;\n\t\t\t\tif ( keypath === undefined ) {\n\t\t\t\t\t// not yet resolved\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\t// TODO the refinements stuff would be better handled at parse time\n\t\t\t\tif ( keypath.eventObject ) {\n\t\t\t\t\tvalue = event;\n\t\t\t\t\tif ( len = keypath.refinements.length ) {\n\t\t\t\t\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\t\t\t\t\tvalue = value[ keypath.refinements[ i ] ];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvalue = ractive.viewmodel.get( keypath );\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t} );\n\t\t\tractive.event = event;\n\t\t\targs = this.fn.apply( null, values );\n\t\t\tractive[ this.method ].apply( ractive, args );\n\t\t\tdelete ractive.event;\n\t\t}\n\n\t\tfunction fireEventWithParams( event ) {\n\t\t\tfireEvent( this.root, this.getAction(), {\n\t\t\t\tevent: event,\n\t\t\t\targs: this.params\n\t\t\t} );\n\t\t}\n\n\t\tfunction fireEventWithDynamicParams( event ) {\n\t\t\tvar args = this.dynamicParams.getValue( getValueOptions );\n\t\t\t// need to strip [] from ends if a string!\n\t\t\tif ( typeof args === 'string' ) {\n\t\t\t\targs = args.substr( 1, args.length - 2 );\n\t\t\t}\n\t\t\tfireEvent( this.root, this.getAction(), {\n\t\t\t\tevent: event,\n\t\t\t\targs: args\n\t\t\t} );\n\t\t}\n\t\treturn __export;\n\t}( getFunctionFromString, createReferenceResolver, circular, Ractive$shared_fireEvent, log );\n\n\t/* virtualdom/items/Element/EventHandler/shared/genericHandler.js */\n\tvar genericHandler = function genericHandler( event ) {\n\t\tvar storage, handler;\n\t\tstorage = this._ractive;\n\t\thandler = storage.events[ event.type ];\n\t\thandler.fire( {\n\t\t\tnode: this,\n\t\t\toriginal: event,\n\t\t\tindex: storage.index,\n\t\t\tkeypath: storage.keypath,\n\t\t\tcontext: storage.root.get( storage.keypath )\n\t\t} );\n\t};\n\n\t/* virtualdom/items/Element/EventHandler/prototype/listen.js */\n\tvar virtualdom_items_Element_EventHandler$listen = function( config, genericHandler, log ) {\n\n\t\tvar __export;\n\t\tvar customHandlers = {},\n\t\t\ttouchEvents = {\n\t\t\t\ttouchstart: true,\n\t\t\t\ttouchmove: true,\n\t\t\t\ttouchend: true,\n\t\t\t\ttouchcancel: true,\n\t\t\t\t//not w3c, but supported in some browsers\n\t\t\t\ttouchleave: true\n\t\t\t};\n\t\t__export = function EventHandler$listen() {\n\t\t\tvar definition, name = this.name;\n\t\t\tif ( this.invalid ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif ( definition = config.registries.events.find( this.root, name ) ) {\n\t\t\t\tthis.custom = definition( this.node, getCustomHandler( name ) );\n\t\t\t} else {\n\t\t\t\t// Looks like we're dealing with a standard DOM event... but let's check\n\t\t\t\tif ( !( 'on' + name in this.node ) && !( window && 'on' + name in window ) ) {\n\t\t\t\t\t// okay to use touch events if this browser doesn't support them\n\t\t\t\t\tif ( !touchEvents[ name ] ) {\n\t\t\t\t\t\tlog.error( {\n\t\t\t\t\t\t\tdebug: this.root.debug,\n\t\t\t\t\t\t\tmessage: 'missingPlugin',\n\t\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\t\tplugin: 'event',\n\t\t\t\t\t\t\t\tname: name\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.node.addEventListener( name, genericHandler, false );\n\t\t\t}\n\t\t\tthis.hasListener = true;\n\t\t};\n\n\t\tfunction getCustomHandler( name ) {\n\t\t\tif ( !customHandlers[ name ] ) {\n\t\t\t\tcustomHandlers[ name ] = function( event ) {\n\t\t\t\t\tvar storage = event.node._ractive;\n\t\t\t\t\tevent.index = storage.index;\n\t\t\t\t\tevent.keypath = storage.keypath;\n\t\t\t\t\tevent.context = storage.root.get( storage.keypath );\n\t\t\t\t\tstorage.events[ name ].fire( event );\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn customHandlers[ name ];\n\t\t}\n\t\treturn __export;\n\t}( config, genericHandler, log );\n\n\t/* virtualdom/items/Element/EventHandler/prototype/rebind.js */\n\tvar virtualdom_items_Element_EventHandler$rebind = function EventHandler$rebind( indexRef, newIndex, oldKeypath, newKeypath ) {\n\t\tvar fragment;\n\t\tif ( this.method ) {\n\t\t\tfragment = this.element.parentFragment;\n\t\t\tthis.refResolvers.forEach( rebind );\n\t\t\treturn;\n\t\t}\n\t\tif ( typeof this.action !== 'string' ) {\n\t\t\trebind( this.action );\n\t\t}\n\t\tif ( this.dynamicParams ) {\n\t\t\trebind( this.dynamicParams );\n\t\t}\n\n\t\tfunction rebind( thing ) {\n\t\t\tthing && thing.rebind( indexRef, newIndex, oldKeypath, newKeypath );\n\t\t}\n\t};\n\n\t/* virtualdom/items/Element/EventHandler/prototype/render.js */\n\tvar virtualdom_items_Element_EventHandler$render = function EventHandler$render() {\n\t\tthis.node = this.element.node;\n\t\t// store this on the node itself, so it can be retrieved by a\n\t\t// universal handler\n\t\tthis.node._ractive.events[ this.name ] = this;\n\t\tif ( this.method || this.getAction() ) {\n\t\t\tthis.listen();\n\t\t}\n\t};\n\n\t/* virtualdom/items/Element/EventHandler/prototype/resolve.js */\n\tvar virtualdom_items_Element_EventHandler$resolve = function EventHandler$resolve( index, keypath ) {\n\t\tthis.keypaths[ index ] = keypath;\n\t};\n\n\t/* virtualdom/items/Element/EventHandler/prototype/unbind.js */\n\tvar virtualdom_items_Element_EventHandler$unbind = function() {\n\n\t\tvar __export;\n\t\t__export = function EventHandler$unbind() {\n\t\t\tif ( this.method ) {\n\t\t\t\tthis.refResolvers.forEach( unbind );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// Tear down dynamic name\n\t\t\tif ( typeof this.action !== 'string' ) {\n\t\t\t\tthis.action.unbind();\n\t\t\t}\n\t\t\t// Tear down dynamic parameters\n\t\t\tif ( this.dynamicParams ) {\n\t\t\t\tthis.dynamicParams.unbind();\n\t\t\t}\n\t\t};\n\n\t\tfunction unbind( x ) {\n\t\t\tx.unbind();\n\t\t}\n\t\treturn __export;\n\t}();\n\n\t/* virtualdom/items/Element/EventHandler/prototype/unrender.js */\n\tvar virtualdom_items_Element_EventHandler$unrender = function( genericHandler ) {\n\n\t\treturn function EventHandler$unrender() {\n\t\t\tif ( this.custom ) {\n\t\t\t\tthis.custom.teardown();\n\t\t\t} else {\n\t\t\t\tthis.node.removeEventListener( this.name, genericHandler, false );\n\t\t\t}\n\t\t\tthis.hasListener = false;\n\t\t};\n\t}( genericHandler );\n\n\t/* virtualdom/items/Element/EventHandler/_EventHandler.js */\n\tvar EventHandler = function( bubble, fire, getAction, init, listen, rebind, render, resolve, unbind, unrender ) {\n\n\t\tvar EventHandler = function( element, name, template ) {\n\t\t\tthis.init( element, name, template );\n\t\t};\n\t\tEventHandler.prototype = {\n\t\t\tbubble: bubble,\n\t\t\tfire: fire,\n\t\t\tgetAction: getAction,\n\t\t\tinit: init,\n\t\t\tlisten: listen,\n\t\t\trebind: rebind,\n\t\t\trender: render,\n\t\t\tresolve: resolve,\n\t\t\tunbind: unbind,\n\t\t\tunrender: unrender\n\t\t};\n\t\treturn EventHandler;\n\t}( virtualdom_items_Element_EventHandler$bubble, virtualdom_items_Element_EventHandler$fire, virtualdom_items_Element_EventHandler$getAction, virtualdom_items_Element_EventHandler$init, virtualdom_items_Element_EventHandler$listen, virtualdom_items_Element_EventHandler$rebind, virtualdom_items_Element_EventHandler$render, virtualdom_items_Element_EventHandler$resolve, virtualdom_items_Element_EventHandler$unbind, virtualdom_items_Element_EventHandler$unrender );\n\n\t/* virtualdom/items/Element/prototype/init/createEventHandlers.js */\n\tvar virtualdom_items_Element$init_createEventHandlers = function( EventHandler ) {\n\n\t\treturn function( element, template ) {\n\t\t\tvar i, name, names, handler, result = [];\n\t\t\tfor ( name in template ) {\n\t\t\t\tif ( template.hasOwnProperty( name ) ) {\n\t\t\t\t\tnames = name.split( '-' );\n\t\t\t\t\ti = names.length;\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\thandler = new EventHandler( element, names[ i ], template[ name ] );\n\t\t\t\t\t\tresult.push( handler );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t};\n\t}( EventHandler );\n\n\t/* virtualdom/items/Element/Decorator/_Decorator.js */\n\tvar Decorator = function( log, circular, config ) {\n\n\t\tvar Fragment, getValueOptions, Decorator;\n\t\tcircular.push( function() {\n\t\t\tFragment = circular.Fragment;\n\t\t} );\n\t\tgetValueOptions = {\n\t\t\targs: true\n\t\t};\n\t\tDecorator = function( element, template ) {\n\t\t\tvar decorator = this,\n\t\t\t\tractive, name, fragment;\n\t\t\tdecorator.element = element;\n\t\t\tdecorator.root = ractive = element.root;\n\t\t\tname = template.n || template;\n\t\t\tif ( typeof name !== 'string' ) {\n\t\t\t\tfragment = new Fragment( {\n\t\t\t\t\ttemplate: name,\n\t\t\t\t\troot: ractive,\n\t\t\t\t\towner: element\n\t\t\t\t} );\n\t\t\t\tname = fragment.toString();\n\t\t\t\tfragment.unbind();\n\t\t\t}\n\t\t\tif ( template.a ) {\n\t\t\t\tdecorator.params = template.a;\n\t\t\t} else if ( template.d ) {\n\t\t\t\tdecorator.fragment = new Fragment( {\n\t\t\t\t\ttemplate: template.d,\n\t\t\t\t\troot: ractive,\n\t\t\t\t\towner: element\n\t\t\t\t} );\n\t\t\t\tdecorator.params = decorator.fragment.getValue( getValueOptions );\n\t\t\t\tdecorator.fragment.bubble = function() {\n\t\t\t\t\tthis.dirtyArgs = this.dirtyValue = true;\n\t\t\t\t\tdecorator.params = this.getValue( getValueOptions );\n\t\t\t\t\tif ( decorator.ready ) {\n\t\t\t\t\t\tdecorator.update();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\tdecorator.fn = config.registries.decorators.find( ractive, name );\n\t\t\tif ( !decorator.fn ) {\n\t\t\t\tlog.error( {\n\t\t\t\t\tdebug: ractive.debug,\n\t\t\t\t\tmessage: 'missingPlugin',\n\t\t\t\t\targs: {\n\t\t\t\t\t\tplugin: 'decorator',\n\t\t\t\t\t\tname: name\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\t\tDecorator.prototype = {\n\t\t\tinit: function() {\n\t\t\t\tvar decorator = this,\n\t\t\t\t\tnode, result, args;\n\t\t\t\tnode = decorator.element.node;\n\t\t\t\tif ( decorator.params ) {\n\t\t\t\t\targs = [ node ].concat( decorator.params );\n\t\t\t\t\tresult = decorator.fn.apply( decorator.root, args );\n\t\t\t\t} else {\n\t\t\t\t\tresult = decorator.fn.call( decorator.root, node );\n\t\t\t\t}\n\t\t\t\tif ( !result || !result.teardown ) {\n\t\t\t\t\tthrow new Error( 'Decorator definition must return an object with a teardown method' );\n\t\t\t\t}\n\t\t\t\t// TODO does this make sense?\n\t\t\t\tdecorator.actual = result;\n\t\t\t\tdecorator.ready = true;\n\t\t\t},\n\t\t\tupdate: function() {\n\t\t\t\tif ( this.actual.update ) {\n\t\t\t\t\tthis.actual.update.apply( this.root, this.params );\n\t\t\t\t} else {\n\t\t\t\t\tthis.actual.teardown( true );\n\t\t\t\t\tthis.init();\n\t\t\t\t}\n\t\t\t},\n\t\t\trebind: function( indexRef, newIndex, oldKeypath, newKeypath ) {\n\t\t\t\tif ( this.fragment ) {\n\t\t\t\t\tthis.fragment.rebind( indexRef, newIndex, oldKeypath, newKeypath );\n\t\t\t\t}\n\t\t\t},\n\t\t\tteardown: function( updating ) {\n\t\t\t\tthis.actual.teardown();\n\t\t\t\tif ( !updating && this.fragment ) {\n\t\t\t\t\tthis.fragment.unbind();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn Decorator;\n\t}( log, circular, config );\n\n\t/* virtualdom/items/Element/special/select/sync.js */\n\tvar sync = function( toArray ) {\n\n\t\tvar __export;\n\t\t__export = function syncSelect( selectElement ) {\n\t\t\tvar selectNode, selectValue, isMultiple, options, optionWasSelected;\n\t\t\tselectNode = selectElement.node;\n\t\t\tif ( !selectNode ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\toptions = toArray( selectNode.options );\n\t\t\tselectValue = selectElement.getAttribute( 'value' );\n\t\t\tisMultiple = selectElement.getAttribute( 'multiple' );\n\t\t\t// If the <select> has a specified value, that should override\n\t\t\t// these options\n\t\t\tif ( selectValue !== undefined ) {\n\t\t\t\toptions.forEach( function( o ) {\n\t\t\t\t\tvar optionValue, shouldSelect;\n\t\t\t\t\toptionValue = o._ractive ? o._ractive.value : o.value;\n\t\t\t\t\tshouldSelect = isMultiple ? valueContains( selectValue, optionValue ) : selectValue == optionValue;\n\t\t\t\t\tif ( shouldSelect ) {\n\t\t\t\t\t\toptionWasSelected = true;\n\t\t\t\t\t}\n\t\t\t\t\to.selected = shouldSelect;\n\t\t\t\t} );\n\t\t\t\tif ( !optionWasSelected ) {\n\t\t\t\t\tif ( options[ 0 ] ) {\n\t\t\t\t\t\toptions[ 0 ].selected = true;\n\t\t\t\t\t}\n\t\t\t\t\tif ( selectElement.binding ) {\n\t\t\t\t\t\tselectElement.binding.forceUpdate();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if ( selectElement.binding ) {\n\t\t\t\tselectElement.binding.forceUpdate();\n\t\t\t}\n\t\t};\n\n\t\tfunction valueContains( selectValue, optionValue ) {\n\t\t\tvar i = selectValue.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( selectValue[ i ] == optionValue ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn __export;\n\t}( toArray );\n\n\t/* virtualdom/items/Element/special/select/bubble.js */\n\tvar bubble = function( runloop, syncSelect ) {\n\n\t\treturn function bubbleSelect() {\n\t\t\tvar this$0 = this;\n\t\t\tif ( !this.dirty ) {\n\t\t\t\tthis.dirty = true;\n\t\t\t\trunloop.scheduleTask( function() {\n\t\t\t\t\tsyncSelect( this$0 );\n\t\t\t\t\tthis$0.dirty = false;\n\t\t\t\t} );\n\t\t\t}\n\t\t\tthis.parentFragment.bubble();\n\t\t};\n\t}( runloop, sync );\n\n\t/* virtualdom/items/Element/special/option/findParentSelect.js */\n\tvar findParentSelect = function findParentSelect( element ) {\n\t\tdo {\n\t\t\tif ( element.name === 'select' ) {\n\t\t\t\treturn element;\n\t\t\t}\n\t\t} while ( element = element.parent );\n\t};\n\n\t/* virtualdom/items/Element/special/option/init.js */\n\tvar init = function( findParentSelect ) {\n\n\t\treturn function initOption( option, template ) {\n\t\t\toption.select = findParentSelect( option.parent );\n\t\t\t// we might be inside a <datalist> element\n\t\t\tif ( !option.select ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\toption.select.options.push( option );\n\t\t\t// If the value attribute is missing, use the element's content\n\t\t\tif ( !template.a ) {\n\t\t\t\ttemplate.a = {};\n\t\t\t}\n\t\t\t// ...as long as it isn't disabled\n\t\t\tif ( template.a.value === undefined && !template.a.hasOwnProperty( 'disabled' ) ) {\n\t\t\t\ttemplate.a.value = template.f;\n\t\t\t}\n\t\t\t// If there is a `selected` attribute, but the <select>\n\t\t\t// already has a value, delete it\n\t\t\tif ( 'selected' in template.a && option.select.getAttribute( 'value' ) !== undefined ) {\n\t\t\t\tdelete template.a.selected;\n\t\t\t}\n\t\t};\n\t}( findParentSelect );\n\n\t/* virtualdom/items/Element/prototype/init.js */\n\tvar virtualdom_items_Element$init = function( types, enforceCase, createAttributes, createConditionalAttributes, createTwowayBinding, createEventHandlers, Decorator, bubbleSelect, initOption, circular ) {\n\n\t\tvar Fragment;\n\t\tcircular.push( function() {\n\t\t\tFragment = circular.Fragment;\n\t\t} );\n\t\treturn function Element$init( options ) {\n\t\t\tvar parentFragment, template, ractive, binding, bindings;\n\t\t\tthis.type = types.ELEMENT;\n\t\t\t// stuff we'll need later\n\t\t\tparentFragment = this.parentFragment = options.parentFragment;\n\t\t\ttemplate = this.template = options.template;\n\t\t\tthis.parent = options.pElement || parentFragment.pElement;\n\t\t\tthis.root = ractive = parentFragment.root;\n\t\t\tthis.index = options.index;\n\t\t\tthis.name = enforceCase( template.e );\n\t\t\t// Special case - <option> elements\n\t\t\tif ( this.name === 'option' ) {\n\t\t\t\tinitOption( this, template );\n\t\t\t}\n\t\t\t// Special case - <select> elements\n\t\t\tif ( this.name === 'select' ) {\n\t\t\t\tthis.options = [];\n\t\t\t\tthis.bubble = bubbleSelect;\n\t\t\t}\n\t\t\t// create attributes\n\t\t\tthis.attributes = createAttributes( this, template.a );\n\t\t\tthis.conditionalAttributes = createConditionalAttributes( this, template.m );\n\t\t\t// append children, if there are any\n\t\t\tif ( template.f ) {\n\t\t\t\tthis.fragment = new Fragment( {\n\t\t\t\t\ttemplate: template.f,\n\t\t\t\t\troot: ractive,\n\t\t\t\t\towner: this,\n\t\t\t\t\tpElement: this\n\t\t\t\t} );\n\t\t\t}\n\t\t\t// create twoway binding\n\t\t\tif ( ractive.twoway && ( binding = createTwowayBinding( this, template.a ) ) ) {\n\t\t\t\tthis.binding = binding;\n\t\t\t\t// register this with the root, so that we can do ractive.updateModel()\n\t\t\t\tbindings = this.root._twowayBindings[ binding.keypath ] || ( this.root._twowayBindings[ binding.keypath ] = [] );\n\t\t\t\tbindings.push( binding );\n\t\t\t}\n\t\t\t// create event proxies\n\t\t\tif ( template.v ) {\n\t\t\t\tthis.eventHandlers = createEventHandlers( this, template.v );\n\t\t\t}\n\t\t\t// create decorator\n\t\t\tif ( template.o ) {\n\t\t\t\tthis.decorator = new Decorator( this, template.o );\n\t\t\t}\n\t\t\t// create transitions\n\t\t\tthis.intro = template.t0 || template.t1;\n\t\t\tthis.outro = template.t0 || template.t2;\n\t\t};\n\t}( types, enforceCase, virtualdom_items_Element$init_createAttributes, virtualdom_items_Element$init_createConditionalAttributes, virtualdom_items_Element$init_createTwowayBinding, virtualdom_items_Element$init_createEventHandlers, Decorator, bubble, init, circular );\n\n\t/* virtualdom/items/shared/utils/startsWith.js */\n\tvar startsWith = function( startsWithKeypath ) {\n\n\t\treturn function startsWith( target, keypath ) {\n\t\t\treturn target === keypath || startsWithKeypath( target, keypath );\n\t\t};\n\t}( startsWithKeypath );\n\n\t/* virtualdom/items/shared/utils/assignNewKeypath.js */\n\tvar assignNewKeypath = function( startsWith, getNewKeypath ) {\n\n\t\treturn function assignNewKeypath( target, property, oldKeypath, newKeypath ) {\n\t\t\tvar existingKeypath = target[ property ];\n\t\t\tif ( !existingKeypath || startsWith( existingKeypath, newKeypath ) || !startsWith( existingKeypath, oldKeypath ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttarget[ property ] = getNewKeypath( existingKeypath, oldKeypath, newKeypath );\n\t\t};\n\t}( startsWith, getNewKeypath );\n\n\t/* virtualdom/items/Element/prototype/rebind.js */\n\tvar virtualdom_items_Element$rebind = function( assignNewKeypath ) {\n\n\t\treturn function Element$rebind( indexRef, newIndex, oldKeypath, newKeypath ) {\n\t\t\tvar i, storage, liveQueries, ractive;\n\t\t\tif ( this.attributes ) {\n\t\t\t\tthis.attributes.forEach( rebind );\n\t\t\t}\n\t\t\tif ( this.conditionalAttributes ) {\n\t\t\t\tthis.conditionalAttributes.forEach( rebind );\n\t\t\t}\n\t\t\tif ( this.eventHandlers ) {\n\t\t\t\tthis.eventHandlers.forEach( rebind );\n\t\t\t}\n\t\t\tif ( this.decorator ) {\n\t\t\t\trebind( this.decorator );\n\t\t\t}\n\t\t\t// rebind children\n\t\t\tif ( this.fragment ) {\n\t\t\t\trebind( this.fragment );\n\t\t\t}\n\t\t\t// Update live queries, if necessary\n\t\t\tif ( liveQueries = this.liveQueries ) {\n\t\t\t\tractive = this.root;\n\t\t\t\ti = liveQueries.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tliveQueries[ i ]._makeDirty();\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( this.node && ( storage = this.node._ractive ) ) {\n\t\t\t\t// adjust keypath if needed\n\t\t\t\tassignNewKeypath( storage, 'keypath', oldKeypath, newKeypath );\n\t\t\t\tif ( indexRef != undefined ) {\n\t\t\t\t\tstorage.index[ indexRef ] = newIndex;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction rebind( thing ) {\n\t\t\t\tthing.rebind( indexRef, newIndex, oldKeypath, newKeypath );\n\t\t\t}\n\t\t};\n\t}( assignNewKeypath );\n\n\t/* virtualdom/items/Element/special/img/render.js */\n\tvar render = function renderImage( img ) {\n\t\tvar loadHandler;\n\t\t// if this is an <img>, and we're in a crap browser, we may need to prevent it\n\t\t// from overriding width and height when it loads the src\n\t\tif ( img.attributes.width || img.attributes.height ) {\n\t\t\timg.node.addEventListener( 'load', loadHandler = function() {\n\t\t\t\tvar width = img.getAttribute( 'width' ),\n\t\t\t\t\theight = img.getAttribute( 'height' );\n\t\t\t\tif ( width !== undefined ) {\n\t\t\t\t\timg.node.setAttribute( 'width', width );\n\t\t\t\t}\n\t\t\t\tif ( height !== undefined ) {\n\t\t\t\t\timg.node.setAttribute( 'height', height );\n\t\t\t\t}\n\t\t\t\timg.node.removeEventListener( 'load', loadHandler, false );\n\t\t\t}, false );\n\t\t}\n\t};\n\n\t/* virtualdom/items/Element/Transition/prototype/init.js */\n\tvar virtualdom_items_Element_Transition$init = function( log, config, circular ) {\n\n\t\tvar Fragment, getValueOptions = {};\n\t\t// TODO what are the options?\n\t\tcircular.push( function() {\n\t\t\tFragment = circular.Fragment;\n\t\t} );\n\t\treturn function Transition$init( element, template, isIntro ) {\n\t\t\tvar t = this,\n\t\t\t\tractive, name, fragment;\n\t\t\tt.element = element;\n\t\t\tt.root = ractive = element.root;\n\t\t\tt.isIntro = isIntro;\n\t\t\tname = template.n || template;\n\t\t\tif ( typeof name !== 'string' ) {\n\t\t\t\tfragment = new Fragment( {\n\t\t\t\t\ttemplate: name,\n\t\t\t\t\troot: ractive,\n\t\t\t\t\towner: element\n\t\t\t\t} );\n\t\t\t\tname = fragment.toString();\n\t\t\t\tfragment.unbind();\n\t\t\t}\n\t\t\tt.name = name;\n\t\t\tif ( template.a ) {\n\t\t\t\tt.params = template.a;\n\t\t\t} else if ( template.d ) {\n\t\t\t\t// TODO is there a way to interpret dynamic arguments without all the\n\t\t\t\t// 'dependency thrashing'?\n\t\t\t\tfragment = new Fragment( {\n\t\t\t\t\ttemplate: template.d,\n\t\t\t\t\troot: ractive,\n\t\t\t\t\towner: element\n\t\t\t\t} );\n\t\t\t\tt.params = fragment.getValue( getValueOptions );\n\t\t\t\tfragment.unbind();\n\t\t\t}\n\t\t\tt._fn = config.registries.transitions.find( ractive, name );\n\t\t\tif ( !t._fn ) {\n\t\t\t\tlog.error( {\n\t\t\t\t\tdebug: ractive.debug,\n\t\t\t\t\tmessage: 'missingPlugin',\n\t\t\t\t\targs: {\n\t\t\t\t\t\tplugin: 'transition',\n\t\t\t\t\t\tname: name\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\treturn;\n\t\t\t}\n\t\t};\n\t}( log, config, circular );\n\n\t/* utils/camelCase.js */\n\tvar camelCase = function( hyphenatedStr ) {\n\t\treturn hyphenatedStr.replace( /-([a-zA-Z])/g, function( match, $1 ) {\n\t\t\treturn $1.toUpperCase();\n\t\t} );\n\t};\n\n\t/* virtualdom/items/Element/Transition/helpers/prefix.js */\n\tvar prefix = function( isClient, vendors, createElement, camelCase ) {\n\n\t\tvar prefix, prefixCache, testStyle;\n\t\tif ( !isClient ) {\n\t\t\tprefix = null;\n\t\t} else {\n\t\t\tprefixCache = {};\n\t\t\ttestStyle = createElement( 'div' ).style;\n\t\t\tprefix = function( prop ) {\n\t\t\t\tvar i, vendor, capped;\n\t\t\t\tprop = camelCase( prop );\n\t\t\t\tif ( !prefixCache[ prop ] ) {\n\t\t\t\t\tif ( testStyle[ prop ] !== undefined ) {\n\t\t\t\t\t\tprefixCache[ prop ] = prop;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// test vendors...\n\t\t\t\t\t\tcapped = prop.charAt( 0 ).toUpperCase() + prop.substring( 1 );\n\t\t\t\t\t\ti = vendors.length;\n\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\tvendor = vendors[ i ];\n\t\t\t\t\t\t\tif ( testStyle[ vendor + capped ] !== undefined ) {\n\t\t\t\t\t\t\t\tprefixCache[ prop ] = vendor + capped;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn prefixCache[ prop ];\n\t\t\t};\n\t\t}\n\t\treturn prefix;\n\t}( isClient, vendors, createElement, camelCase );\n\n\t/* virtualdom/items/Element/Transition/prototype/getStyle.js */\n\tvar virtualdom_items_Element_Transition$getStyle = function( legacy, isClient, isArray, prefix ) {\n\n\t\tvar getStyle, getComputedStyle;\n\t\tif ( !isClient ) {\n\t\t\tgetStyle = null;\n\t\t} else {\n\t\t\tgetComputedStyle = window.getComputedStyle || legacy.getComputedStyle;\n\t\t\tgetStyle = function( props ) {\n\t\t\t\tvar computedStyle, styles, i, prop, value;\n\t\t\t\tcomputedStyle = getComputedStyle( this.node );\n\t\t\t\tif ( typeof props === 'string' ) {\n\t\t\t\t\tvalue = computedStyle[ prefix( props ) ];\n\t\t\t\t\tif ( value === '0px' ) {\n\t\t\t\t\t\tvalue = 0;\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t\tif ( !isArray( props ) ) {\n\t\t\t\t\tthrow new Error( 'Transition$getStyle must be passed a string, or an array of strings representing CSS properties' );\n\t\t\t\t}\n\t\t\t\tstyles = {};\n\t\t\t\ti = props.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tprop = props[ i ];\n\t\t\t\t\tvalue = computedStyle[ prefix( prop ) ];\n\t\t\t\t\tif ( value === '0px' ) {\n\t\t\t\t\t\tvalue = 0;\n\t\t\t\t\t}\n\t\t\t\t\tstyles[ prop ] = value;\n\t\t\t\t}\n\t\t\t\treturn styles;\n\t\t\t};\n\t\t}\n\t\treturn getStyle;\n\t}( legacy, isClient, isArray, prefix );\n\n\t/* virtualdom/items/Element/Transition/prototype/setStyle.js */\n\tvar virtualdom_items_Element_Transition$setStyle = function( prefix ) {\n\n\t\treturn function( style, value ) {\n\t\t\tvar prop;\n\t\t\tif ( typeof style === 'string' ) {\n\t\t\t\tthis.node.style[ prefix( style ) ] = value;\n\t\t\t} else {\n\t\t\t\tfor ( prop in style ) {\n\t\t\t\t\tif ( style.hasOwnProperty( prop ) ) {\n\t\t\t\t\t\tthis.node.style[ prefix( prop ) ] = style[ prop ];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t};\n\t}( prefix );\n\n\t/* shared/Ticker.js */\n\tvar Ticker = function( warn, getTime, animations ) {\n\n\t\tvar __export;\n\t\tvar Ticker = function( options ) {\n\t\t\tvar easing;\n\t\t\tthis.duration = options.duration;\n\t\t\tthis.step = options.step;\n\t\t\tthis.complete = options.complete;\n\t\t\t// easing\n\t\t\tif ( typeof options.easing === 'string' ) {\n\t\t\t\teasing = options.root.easing[ options.easing ];\n\t\t\t\tif ( !easing ) {\n\t\t\t\t\twarn( 'Missing easing function (\"' + options.easing + '\"). You may need to download a plugin from [TODO]' );\n\t\t\t\t\teasing = linear;\n\t\t\t\t}\n\t\t\t} else if ( typeof options.easing === 'function' ) {\n\t\t\t\teasing = options.easing;\n\t\t\t} else {\n\t\t\t\teasing = linear;\n\t\t\t}\n\t\t\tthis.easing = easing;\n\t\t\tthis.start = getTime();\n\t\t\tthis.end = this.start + this.duration;\n\t\t\tthis.running = true;\n\t\t\tanimations.add( this );\n\t\t};\n\t\tTicker.prototype = {\n\t\t\ttick: function( now ) {\n\t\t\t\tvar elapsed, eased;\n\t\t\t\tif ( !this.running ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif ( now > this.end ) {\n\t\t\t\t\tif ( this.step ) {\n\t\t\t\t\t\tthis.step( 1 );\n\t\t\t\t\t}\n\t\t\t\t\tif ( this.complete ) {\n\t\t\t\t\t\tthis.complete( 1 );\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\telapsed = now - this.start;\n\t\t\t\teased = this.easing( elapsed / this.duration );\n\t\t\t\tif ( this.step ) {\n\t\t\t\t\tthis.step( eased );\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tstop: function() {\n\t\t\t\tif ( this.abort ) {\n\t\t\t\t\tthis.abort();\n\t\t\t\t}\n\t\t\t\tthis.running = false;\n\t\t\t}\n\t\t};\n\t\t__export = Ticker;\n\n\t\tfunction linear( t ) {\n\t\t\treturn t;\n\t\t}\n\t\treturn __export;\n\t}( warn, getTime, animations );\n\n\t/* virtualdom/items/Element/Transition/helpers/unprefix.js */\n\tvar unprefix = function( vendors ) {\n\n\t\tvar unprefixPattern = new RegExp( '^-(?:' + vendors.join( '|' ) + ')-' );\n\t\treturn function( prop ) {\n\t\t\treturn prop.replace( unprefixPattern, '' );\n\t\t};\n\t}( vendors );\n\n\t/* virtualdom/items/Element/Transition/helpers/hyphenate.js */\n\tvar hyphenate = function( vendors ) {\n\n\t\tvar vendorPattern = new RegExp( '^(?:' + vendors.join( '|' ) + ')([A-Z])' );\n\t\treturn function( str ) {\n\t\t\tvar hyphenated;\n\t\t\tif ( !str ) {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\tif ( vendorPattern.test( str ) ) {\n\t\t\t\tstr = '-' + str;\n\t\t\t}\n\t\t\thyphenated = str.replace( /[A-Z]/g, function( match ) {\n\t\t\t\treturn '-' + match.toLowerCase();\n\t\t\t} );\n\t\t\treturn hyphenated;\n\t\t};\n\t}( vendors );\n\n\t/* virtualdom/items/Element/Transition/prototype/animateStyle/createTransitions.js */\n\tvar virtualdom_items_Element_Transition$animateStyle_createTransitions = function( isClient, warn, createElement, camelCase, interpolate, Ticker, prefix, unprefix, hyphenate ) {\n\n\t\tvar createTransitions, testStyle, TRANSITION, TRANSITIONEND, CSS_TRANSITIONS_ENABLED, TRANSITION_DURATION, TRANSITION_PROPERTY, TRANSITION_TIMING_FUNCTION, canUseCssTransitions = {},\n\t\t\tcannotUseCssTransitions = {};\n\t\tif ( !isClient ) {\n\t\t\tcreateTransitions = null;\n\t\t} else {\n\t\t\ttestStyle = createElement( 'div' ).style;\n\t\t\t// determine some facts about our environment\n\t\t\t( function() {\n\t\t\t\tif ( testStyle.transition !== undefined ) {\n\t\t\t\t\tTRANSITION = 'transition';\n\t\t\t\t\tTRANSITIONEND = 'transitionend';\n\t\t\t\t\tCSS_TRANSITIONS_ENABLED = true;\n\t\t\t\t} else if ( testStyle.webkitTransition !== undefined ) {\n\t\t\t\t\tTRANSITION = 'webkitTransition';\n\t\t\t\t\tTRANSITIONEND = 'webkitTransitionEnd';\n\t\t\t\t\tCSS_TRANSITIONS_ENABLED = true;\n\t\t\t\t} else {\n\t\t\t\t\tCSS_TRANSITIONS_ENABLED = false;\n\t\t\t\t}\n\t\t\t}() );\n\t\t\tif ( TRANSITION ) {\n\t\t\t\tTRANSITION_DURATION = TRANSITION + 'Duration';\n\t\t\t\tTRANSITION_PROPERTY = TRANSITION + 'Property';\n\t\t\t\tTRANSITION_TIMING_FUNCTION = TRANSITION + 'TimingFunction';\n\t\t\t}\n\t\t\tcreateTransitions = function( t, to, options, changedProperties, resolve ) {\n\t\t\t\t// Wait a beat (otherwise the target styles will be applied immediately)\n\t\t\t\t// TODO use a fastdom-style mechanism?\n\t\t\t\tsetTimeout( function() {\n\t\t\t\t\tvar hashPrefix, jsTransitionsComplete, cssTransitionsComplete, checkComplete, transitionEndHandler;\n\t\t\t\t\tcheckComplete = function() {\n\t\t\t\t\t\tif ( jsTransitionsComplete && cssTransitionsComplete ) {\n\t\t\t\t\t\t\t// will changes to events and fire have an unexpected consequence here?\n\t\t\t\t\t\t\tt.root.fire( t.name + ':end', t.node, t.isIntro );\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t// this is used to keep track of which elements can use CSS to animate\n\t\t\t\t\t// which properties\n\t\t\t\t\thashPrefix = ( t.node.namespaceURI || '' ) + t.node.tagName;\n\t\t\t\t\tt.node.style[ TRANSITION_PROPERTY ] = changedProperties.map( prefix ).map( hyphenate ).join( ',' );\n\t\t\t\t\tt.node.style[ TRANSITION_TIMING_FUNCTION ] = hyphenate( options.easing || 'linear' );\n\t\t\t\t\tt.node.style[ TRANSITION_DURATION ] = options.duration / 1000 + 's';\n\t\t\t\t\ttransitionEndHandler = function( event ) {\n\t\t\t\t\t\tvar index;\n\t\t\t\t\t\tindex = changedProperties.indexOf( camelCase( unprefix( event.propertyName ) ) );\n\t\t\t\t\t\tif ( index !== -1 ) {\n\t\t\t\t\t\t\tchangedProperties.splice( index, 1 );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( changedProperties.length ) {\n\t\t\t\t\t\t\t// still transitioning...\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tt.node.removeEventListener( TRANSITIONEND, transitionEndHandler, false );\n\t\t\t\t\t\tcssTransitionsComplete = true;\n\t\t\t\t\t\tcheckComplete();\n\t\t\t\t\t};\n\t\t\t\t\tt.node.addEventListener( TRANSITIONEND, transitionEndHandler, false );\n\t\t\t\t\tsetTimeout( function() {\n\t\t\t\t\t\tvar i = changedProperties.length,\n\t\t\t\t\t\t\thash, originalValue, index, propertiesToTransitionInJs = [],\n\t\t\t\t\t\t\tprop, suffix;\n\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\tprop = changedProperties[ i ];\n\t\t\t\t\t\t\thash = hashPrefix + prop;\n\t\t\t\t\t\t\tif ( CSS_TRANSITIONS_ENABLED && !cannotUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\t\t\tt.node.style[ prefix( prop ) ] = to[ prop ];\n\t\t\t\t\t\t\t\t// If we're not sure if CSS transitions are supported for\n\t\t\t\t\t\t\t\t// this tag/property combo, find out now\n\t\t\t\t\t\t\t\tif ( !canUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\t\t\t\toriginalValue = t.getStyle( prop );\n\t\t\t\t\t\t\t\t\t// if this property is transitionable in this browser,\n\t\t\t\t\t\t\t\t\t// the current style will be different from the target style\n\t\t\t\t\t\t\t\t\tcanUseCssTransitions[ hash ] = t.getStyle( prop ) != to[ prop ];\n\t\t\t\t\t\t\t\t\tcannotUseCssTransitions[ hash ] = !canUseCssTransitions[ hash ];\n\t\t\t\t\t\t\t\t\t// Reset, if we're going to use timers after all\n\t\t\t\t\t\t\t\t\tif ( cannotUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\t\t\t\t\tt.node.style[ prefix( prop ) ] = originalValue;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif ( !CSS_TRANSITIONS_ENABLED || cannotUseCssTransitions[ hash ] ) {\n\t\t\t\t\t\t\t\t// we need to fall back to timer-based stuff\n\t\t\t\t\t\t\t\tif ( originalValue === undefined ) {\n\t\t\t\t\t\t\t\t\toriginalValue = t.getStyle( prop );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// need to remove this from changedProperties, otherwise transitionEndHandler\n\t\t\t\t\t\t\t\t// will get confused\n\t\t\t\t\t\t\t\tindex = changedProperties.indexOf( prop );\n\t\t\t\t\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\t\t\t\t\twarn( 'Something very strange happened with transitions. If you see this message, please let @RactiveJS know. Thanks!' );\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tchangedProperties.splice( index, 1 );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// TODO Determine whether this property is animatable at all\n\t\t\t\t\t\t\t\tsuffix = /[^\\d]*$/.exec( to[ prop ] )[ 0 ];\n\t\t\t\t\t\t\t\t// ...then kick off a timer-based transition\n\t\t\t\t\t\t\t\tpropertiesToTransitionInJs.push( {\n\t\t\t\t\t\t\t\t\tname: prefix( prop ),\n\t\t\t\t\t\t\t\t\tinterpolator: interpolate( parseFloat( originalValue ), parseFloat( to[ prop ] ) ),\n\t\t\t\t\t\t\t\t\tsuffix: suffix\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// javascript transitions\n\t\t\t\t\t\tif ( propertiesToTransitionInJs.length ) {\n\t\t\t\t\t\t\tnew Ticker( {\n\t\t\t\t\t\t\t\troot: t.root,\n\t\t\t\t\t\t\t\tduration: options.duration,\n\t\t\t\t\t\t\t\teasing: camelCase( options.easing || '' ),\n\t\t\t\t\t\t\t\tstep: function( pos ) {\n\t\t\t\t\t\t\t\t\tvar prop, i;\n\t\t\t\t\t\t\t\t\ti = propertiesToTransitionInJs.length;\n\t\t\t\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\t\t\t\tprop = propertiesToTransitionInJs[ i ];\n\t\t\t\t\t\t\t\t\t\tt.node.style[ prop.name ] = prop.interpolator( pos ) + prop.suffix;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tcomplete: function() {\n\t\t\t\t\t\t\t\t\tjsTransitionsComplete = true;\n\t\t\t\t\t\t\t\t\tcheckComplete();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tjsTransitionsComplete = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( !changedProperties.length ) {\n\t\t\t\t\t\t\t// We need to cancel the transitionEndHandler, and deal with\n\t\t\t\t\t\t\t// the fact that it will never fire\n\t\t\t\t\t\t\tt.node.removeEventListener( TRANSITIONEND, transitionEndHandler, false );\n\t\t\t\t\t\t\tcssTransitionsComplete = true;\n\t\t\t\t\t\t\tcheckComplete();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 0 );\n\t\t\t\t}, options.delay || 0 );\n\t\t\t};\n\t\t}\n\t\treturn createTransitions;\n\t}( isClient, warn, createElement, camelCase, interpolate, Ticker, prefix, unprefix, hyphenate );\n\n\t/* virtualdom/items/Element/Transition/prototype/animateStyle/visibility.js */\n\tvar virtualdom_items_Element_Transition$animateStyle_visibility = function( vendors ) {\n\n\t\tvar hidden, vendor, prefix, i, visibility;\n\t\tif ( typeof document !== 'undefined' ) {\n\t\t\thidden = 'hidden';\n\t\t\tvisibility = {};\n\t\t\tif ( hidden in document ) {\n\t\t\t\tprefix = '';\n\t\t\t} else {\n\t\t\t\ti = vendors.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tvendor = vendors[ i ];\n\t\t\t\t\thidden = vendor + 'Hidden';\n\t\t\t\t\tif ( hidden in document ) {\n\t\t\t\t\t\tprefix = vendor;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( prefix !== undefined ) {\n\t\t\t\tdocument.addEventListener( prefix + 'visibilitychange', onChange );\n\t\t\t\t// initialise\n\t\t\t\tonChange();\n\t\t\t} else {\n\t\t\t\t// gah, we're in an old browser\n\t\t\t\tif ( 'onfocusout' in document ) {\n\t\t\t\t\tdocument.addEventListener( 'focusout', onHide );\n\t\t\t\t\tdocument.addEventListener( 'focusin', onShow );\n\t\t\t\t} else {\n\t\t\t\t\twindow.addEventListener( 'pagehide', onHide );\n\t\t\t\t\twindow.addEventListener( 'blur', onHide );\n\t\t\t\t\twindow.addEventListener( 'pageshow', onShow );\n\t\t\t\t\twindow.addEventListener( 'focus', onShow );\n\t\t\t\t}\n\t\t\t\tvisibility.hidden = false;\n\t\t\t}\n\t\t}\n\n\t\tfunction onChange() {\n\t\t\tvisibility.hidden = document[ hidden ];\n\t\t}\n\n\t\tfunction onHide() {\n\t\t\tvisibility.hidden = true;\n\t\t}\n\n\t\tfunction onShow() {\n\t\t\tvisibility.hidden = false;\n\t\t}\n\t\treturn visibility;\n\t}( vendors );\n\n\t/* virtualdom/items/Element/Transition/prototype/animateStyle/_animateStyle.js */\n\tvar virtualdom_items_Element_Transition$animateStyle__animateStyle = function( legacy, isClient, warn, Promise, prefix, createTransitions, visibility ) {\n\n\t\tvar animateStyle, getComputedStyle, resolved;\n\t\tif ( !isClient ) {\n\t\t\tanimateStyle = null;\n\t\t} else {\n\t\t\tgetComputedStyle = window.getComputedStyle || legacy.getComputedStyle;\n\t\t\tanimateStyle = function( style, value, options, complete ) {\n\t\t\t\tvar t = this,\n\t\t\t\t\tto;\n\t\t\t\t// Special case - page isn't visible. Don't animate anything, because\n\t\t\t\t// that way you'll never get CSS transitionend events\n\t\t\t\tif ( visibility.hidden ) {\n\t\t\t\t\tthis.setStyle( style, value );\n\t\t\t\t\treturn resolved || ( resolved = Promise.resolve() );\n\t\t\t\t}\n\t\t\t\tif ( typeof style === 'string' ) {\n\t\t\t\t\tto = {};\n\t\t\t\t\tto[ style ] = value;\n\t\t\t\t} else {\n\t\t\t\t\tto = style;\n\t\t\t\t\t// shuffle arguments\n\t\t\t\t\tcomplete = options;\n\t\t\t\t\toptions = value;\n\t\t\t\t}\n\t\t\t\t// As of 0.3.9, transition authors should supply an `option` object with\n\t\t\t\t// `duration` and `easing` properties (and optional `delay`), plus a\n\t\t\t\t// callback function that gets called after the animation completes\n\t\t\t\t// TODO remove this check in a future version\n\t\t\t\tif ( !options ) {\n\t\t\t\t\twarn( 'The \"' + t.name + '\" transition does not supply an options object to `t.animateStyle()`. This will break in a future version of Ractive. For more info see https://github.com/RactiveJS/Ractive/issues/340' );\n\t\t\t\t\toptions = t;\n\t\t\t\t\tcomplete = t.complete;\n\t\t\t\t}\n\t\t\t\tvar promise = new Promise( function( resolve ) {\n\t\t\t\t\tvar propertyNames, changedProperties, computedStyle, current, from, i, prop;\n\t\t\t\t\t// Edge case - if duration is zero, set style synchronously and complete\n\t\t\t\t\tif ( !options.duration ) {\n\t\t\t\t\t\tt.setStyle( to );\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// Get a list of the properties we're animating\n\t\t\t\t\tpropertyNames = Object.keys( to );\n\t\t\t\t\tchangedProperties = [];\n\t\t\t\t\t// Store the current styles\n\t\t\t\t\tcomputedStyle = getComputedStyle( t.node );\n\t\t\t\t\tfrom = {};\n\t\t\t\t\ti = propertyNames.length;\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tprop = propertyNames[ i ];\n\t\t\t\t\t\tcurrent = computedStyle[ prefix( prop ) ];\n\t\t\t\t\t\tif ( current === '0px' ) {\n\t\t\t\t\t\t\tcurrent = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// we need to know if we're actually changing anything\n\t\t\t\t\t\tif ( current != to[ prop ] ) {\n\t\t\t\t\t\t\t// use != instead of !==, so we can compare strings with numbers\n\t\t\t\t\t\t\tchangedProperties.push( prop );\n\t\t\t\t\t\t\t// make the computed style explicit, so we can animate where\n\t\t\t\t\t\t\t// e.g. height='auto'\n\t\t\t\t\t\t\tt.node.style[ prefix( prop ) ] = current;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// If we're not actually changing anything, the transitionend event\n\t\t\t\t\t// will never fire! So we complete early\n\t\t\t\t\tif ( !changedProperties.length ) {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcreateTransitions( t, to, options, changedProperties, resolve );\n\t\t\t\t} );\n\t\t\t\t// If a callback was supplied, do the honours\n\t\t\t\t// TODO remove this check in future\n\t\t\t\tif ( complete ) {\n\t\t\t\t\twarn( 't.animateStyle returns a Promise as of 0.4.0. Transition authors should do t.animateStyle(...).then(callback)' );\n\t\t\t\t\tpromise.then( complete );\n\t\t\t\t}\n\t\t\t\treturn promise;\n\t\t\t};\n\t\t}\n\t\treturn animateStyle;\n\t}( legacy, isClient, warn, Promise, prefix, virtualdom_items_Element_Transition$animateStyle_createTransitions, virtualdom_items_Element_Transition$animateStyle_visibility );\n\n\t/* utils/fillGaps.js */\n\tvar fillGaps = function( target ) {\n\t\tvar SLICE$0 = Array.prototype.slice;\n\t\tvar sources = SLICE$0.call( arguments, 1 );\n\t\tsources.forEach( function( s ) {\n\t\t\tfor ( var key in s ) {\n\t\t\t\tif ( s.hasOwnProperty( key ) && !( key in target ) ) {\n\t\t\t\t\ttarget[ key ] = s[ key ];\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t\treturn target;\n\t};\n\n\t/* virtualdom/items/Element/Transition/prototype/processParams.js */\n\tvar virtualdom_items_Element_Transition$processParams = function( fillGaps ) {\n\n\t\treturn function( params, defaults ) {\n\t\t\tif ( typeof params === 'number' ) {\n\t\t\t\tparams = {\n\t\t\t\t\tduration: params\n\t\t\t\t};\n\t\t\t} else if ( typeof params === 'string' ) {\n\t\t\t\tif ( params === 'slow' ) {\n\t\t\t\t\tparams = {\n\t\t\t\t\t\tduration: 600\n\t\t\t\t\t};\n\t\t\t\t} else if ( params === 'fast' ) {\n\t\t\t\t\tparams = {\n\t\t\t\t\t\tduration: 200\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tparams = {\n\t\t\t\t\t\tduration: 400\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t} else if ( !params ) {\n\t\t\t\tparams = {};\n\t\t\t}\n\t\t\treturn fillGaps( {}, params, defaults );\n\t\t};\n\t}( fillGaps );\n\n\t/* virtualdom/items/Element/Transition/prototype/start.js */\n\tvar virtualdom_items_Element_Transition$start = function() {\n\n\t\tvar __export;\n\t\t__export = function Transition$start() {\n\t\t\tvar t = this,\n\t\t\t\tnode, originalStyle, completed;\n\t\t\tnode = t.node = t.element.node;\n\t\t\toriginalStyle = node.getAttribute( 'style' );\n\t\t\t// create t.complete() - we don't want this on the prototype,\n\t\t\t// because we don't want `this` silliness when passing it as\n\t\t\t// an argument\n\t\t\tt.complete = function( noReset ) {\n\t\t\t\tif ( completed ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif ( !noReset && t.isIntro ) {\n\t\t\t\t\tresetStyle( node, originalStyle );\n\t\t\t\t}\n\t\t\t\tnode._ractive.transition = null;\n\t\t\t\tt._manager.remove( t );\n\t\t\t\tcompleted = true;\n\t\t\t};\n\t\t\t// If the transition function doesn't exist, abort\n\t\t\tif ( !t._fn ) {\n\t\t\t\tt.complete();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tt._fn.apply( t.root, [ t ].concat( t.params ) );\n\t\t};\n\n\t\tfunction resetStyle( node, style ) {\n\t\t\tif ( style ) {\n\t\t\t\tnode.setAttribute( 'style', style );\n\t\t\t} else {\n\t\t\t\t// Next line is necessary, to remove empty style attribute!\n\t\t\t\t// See http://stackoverflow.com/a/7167553\n\t\t\t\tnode.getAttribute( 'style' );\n\t\t\t\tnode.removeAttribute( 'style' );\n\t\t\t}\n\t\t}\n\t\treturn __export;\n\t}();\n\n\t/* virtualdom/items/Element/Transition/_Transition.js */\n\tvar Transition = function( init, getStyle, setStyle, animateStyle, processParams, start, circular ) {\n\n\t\tvar Fragment, Transition;\n\t\tcircular.push( function() {\n\t\t\tFragment = circular.Fragment;\n\t\t} );\n\t\tTransition = function( owner, template, isIntro ) {\n\t\t\tthis.init( owner, template, isIntro );\n\t\t};\n\t\tTransition.prototype = {\n\t\t\tinit: init,\n\t\t\tstart: start,\n\t\t\tgetStyle: getStyle,\n\t\t\tsetStyle: setStyle,\n\t\t\tanimateStyle: animateStyle,\n\t\t\tprocessParams: processParams\n\t\t};\n\t\treturn Transition;\n\t}( virtualdom_items_Element_Transition$init, virtualdom_items_Element_Transition$getStyle, virtualdom_items_Element_Transition$setStyle, virtualdom_items_Element_Transition$animateStyle__animateStyle, virtualdom_items_Element_Transition$processParams, virtualdom_items_Element_Transition$start, circular );\n\n\t/* virtualdom/items/Element/prototype/render.js */\n\tvar virtualdom_items_Element$render = function( namespaces, isArray, warn, create, createElement, defineProperty, noop, runloop, getInnerContext, renderImage, Transition ) {\n\n\t\tvar __export;\n\t\tvar updateCss, updateScript;\n\t\tupdateCss = function() {\n\t\t\tvar node = this.node,\n\t\t\t\tcontent = this.fragment.toString( false );\n\t\t\t// IE8 has no styleSheet unless there's a type text/css\n\t\t\tif ( window && window.appearsToBeIELessEqual8 ) {\n\t\t\t\tnode.type = 'text/css';\n\t\t\t}\n\t\t\tif ( node.styleSheet ) {\n\t\t\t\tnode.styleSheet.cssText = content;\n\t\t\t} else {\n\t\t\t\twhile ( node.hasChildNodes() ) {\n\t\t\t\t\tnode.removeChild( node.firstChild );\n\t\t\t\t}\n\t\t\t\tnode.appendChild( document.createTextNode( content ) );\n\t\t\t}\n\t\t};\n\t\tupdateScript = function() {\n\t\t\tif ( !this.node.type || this.node.type === 'text/javascript' ) {\n\t\t\t\twarn( 'Script tag was updated. This does not cause the code to be re-evaluated!' );\n\t\t\t}\n\t\t\tthis.node.text = this.fragment.toString( false );\n\t\t};\n\t\t__export = function Element$render() {\n\t\t\tvar this$0 = this;\n\t\t\tvar root = this.root,\n\t\t\t\tnamespace, node;\n\t\t\tnamespace = getNamespace( this );\n\t\t\tnode = this.node = createElement( this.name, namespace );\n\t\t\t// Is this a top-level node of a component? If so, we may need to add\n\t\t\t// a data-rvcguid attribute, for CSS encapsulation\n\t\t\t// NOTE: css no longer copied to instance, so we check constructor.css -\n\t\t\t// we can enhance to handle instance, but this is more \"correct\" with current\n\t\t\t// functionality\n\t\t\tif ( root.constructor.css && this.parentFragment.getNode() === root.el ) {\n\t\t\t\tthis.node.setAttribute( 'data-rvcguid', root.constructor._guid );\n\t\t\t}\n\t\t\t// Add _ractive property to the node - we use this object to store stuff\n\t\t\t// related to proxy events, two-way bindings etc\n\t\t\tdefineProperty( this.node, '_ractive', {\n\t\t\t\tvalue: {\n\t\t\t\t\tproxy: this,\n\t\t\t\t\tkeypath: getInnerContext( this.parentFragment ),\n\t\t\t\t\tindex: this.parentFragment.indexRefs,\n\t\t\t\t\tevents: create( null ),\n\t\t\t\t\troot: root\n\t\t\t\t}\n\t\t\t} );\n\t\t\t// Render attributes\n\t\t\tthis.attributes.forEach( function( a ) {\n\t\t\t\treturn a.render( node );\n\t\t\t} );\n\t\t\tthis.conditionalAttributes.forEach( function( a ) {\n\t\t\t\treturn a.render( node );\n\t\t\t} );\n\t\t\t// Render children\n\t\t\tif ( this.fragment ) {\n\t\t\t\t// Special case - <script> element\n\t\t\t\tif ( this.name === 'script' ) {\n\t\t\t\t\tthis.bubble = updateScript;\n\t\t\t\t\tthis.node.text = this.fragment.toString( false );\n\t\t\t\t\t// bypass warning initially\n\t\t\t\t\tthis.fragment.unrender = noop;\n\t\t\t\t} else if ( this.name === 'style' ) {\n\t\t\t\t\tthis.bubble = updateCss;\n\t\t\t\t\tthis.bubble();\n\t\t\t\t\tthis.fragment.unrender = noop;\n\t\t\t\t} else if ( this.binding && this.getAttribute( 'contenteditable' ) ) {\n\t\t\t\t\tthis.fragment.unrender = noop;\n\t\t\t\t} else {\n\t\t\t\t\tthis.node.appendChild( this.fragment.render() );\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Add proxy event handlers\n\t\t\tif ( this.eventHandlers ) {\n\t\t\t\tthis.eventHandlers.forEach( function( h ) {\n\t\t\t\t\treturn h.render();\n\t\t\t\t} );\n\t\t\t}\n\t\t\t// deal with two-way bindings\n\t\t\tif ( this.binding ) {\n\t\t\t\tthis.binding.render();\n\t\t\t\tthis.node._ractive.binding = this.binding;\n\t\t\t}\n\t\t\t// Special case: if this is an <img>, and we're in a crap browser, we may\n\t\t\t// need to prevent it from overriding width and height when it loads the src\n\t\t\tif ( this.name === 'img' ) {\n\t\t\t\trenderImage( this );\n\t\t\t}\n\t\t\t// apply decorator(s)\n\t\t\tif ( this.decorator && this.decorator.fn ) {\n\t\t\t\trunloop.scheduleTask( function() {\n\t\t\t\t\treturn this$0.decorator.init();\n\t\t\t\t}, true );\n\t\t\t}\n\t\t\t// trigger intro transition\n\t\t\tif ( root.transitionsEnabled && this.intro ) {\n\t\t\t\tvar transition = new Transition( this, this.intro, true );\n\t\t\t\trunloop.registerTransition( transition );\n\t\t\t\trunloop.scheduleTask( function() {\n\t\t\t\t\treturn transition.start();\n\t\t\t\t}, true );\n\t\t\t\tthis.transition = transition;\n\t\t\t}\n\t\t\tif ( this.name === 'option' ) {\n\t\t\t\tprocessOption( this );\n\t\t\t}\n\t\t\tif ( this.node.autofocus ) {\n\t\t\t\t// Special case. Some browsers (*cough* Firefix *cough*) have a problem\n\t\t\t\t// with dynamically-generated elements having autofocus, and they won't\n\t\t\t\t// allow you to programmatically focus the element until it's in the DOM\n\t\t\t\trunloop.scheduleTask( function() {\n\t\t\t\t\treturn this$0.node.focus();\n\t\t\t\t}, true );\n\t\t\t}\n\t\t\tupdateLiveQueries( this );\n\t\t\treturn this.node;\n\t\t};\n\n\t\tfunction getNamespace( element ) {\n\t\t\tvar namespace, xmlns, parent;\n\t\t\t// Use specified namespace...\n\t\t\tif ( xmlns = element.getAttribute( 'xmlns' ) ) {\n\t\t\t\tnamespace = xmlns;\n\t\t\t} else if ( element.name === 'svg' ) {\n\t\t\t\tnamespace = namespaces.svg;\n\t\t\t} else if ( parent = element.parent ) {\n\t\t\t\t// ...or HTML, if the parent is a <foreignObject>\n\t\t\t\tif ( parent.name === 'foreignObject' ) {\n\t\t\t\t\tnamespace = namespaces.html;\n\t\t\t\t} else {\n\t\t\t\t\tnamespace = parent.node.namespaceURI;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnamespace = element.root.el.namespaceURI;\n\t\t\t}\n\t\t\treturn namespace;\n\t\t}\n\n\t\tfunction processOption( option ) {\n\t\t\tvar optionValue, selectValue, i;\n\t\t\tif ( !option.select ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tselectValue = option.select.getAttribute( 'value' );\n\t\t\tif ( selectValue === undefined ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\toptionValue = option.getAttribute( 'value' );\n\t\t\tif ( option.select.node.multiple && isArray( selectValue ) ) {\n\t\t\t\ti = selectValue.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tif ( optionValue == selectValue[ i ] ) {\n\t\t\t\t\t\toption.node.selected = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toption.node.selected = optionValue == selectValue;\n\t\t\t}\n\t\t}\n\n\t\tfunction updateLiveQueries( element ) {\n\t\t\tvar instance, liveQueries, i, selector, query;\n\t\t\t// Does this need to be added to any live queries?\n\t\t\tinstance = element.root;\n\t\t\tdo {\n\t\t\t\tliveQueries = instance._liveQueries;\n\t\t\t\ti = liveQueries.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tselector = liveQueries[ i ];\n\t\t\t\t\tquery = liveQueries[ '_' + selector ];\n\t\t\t\t\tif ( query._test( element ) ) {\n\t\t\t\t\t\t// keep register of applicable selectors, for when we teardown\n\t\t\t\t\t\t( element.liveQueries || ( element.liveQueries = [] ) ).push( query );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} while ( instance = instance._parent );\n\t\t}\n\t\treturn __export;\n\t}( namespaces, isArray, warn, create, createElement, defineProperty, noop, runloop, getInnerContext, render, Transition );\n\n\t/* virtualdom/items/Element/prototype/toString.js */\n\tvar virtualdom_items_Element$toString = function( voidElementNames, isArray, escapeHtml ) {\n\n\t\tvar __export;\n\t\t__export = function() {\n\t\t\tvar str, escape;\n\t\t\tstr = '<' + ( this.template.y ? '!DOCTYPE' : this.template.e );\n\t\t\tstr += this.attributes.map( stringifyAttribute ).join( '' ) + this.conditionalAttributes.map( stringifyAttribute ).join( '' );\n\t\t\t// Special case - selected options\n\t\t\tif ( this.name === 'option' && optionIsSelected( this ) ) {\n\t\t\t\tstr += ' selected';\n\t\t\t}\n\t\t\t// Special case - two-way radio name bindings\n\t\t\tif ( this.name === 'input' && inputIsCheckedRadio( this ) ) {\n\t\t\t\tstr += ' checked';\n\t\t\t}\n\t\t\tstr += '>';\n\t\t\t// Special case - textarea\n\t\t\tif ( this.name === 'textarea' && this.getAttribute( 'value' ) !== undefined ) {\n\t\t\t\tstr += escapeHtml( this.getAttribute( 'value' ) );\n\t\t\t} else if ( this.getAttribute( 'contenteditable' ) !== undefined ) {\n\t\t\t\tstr += this.getAttribute( 'value' );\n\t\t\t}\n\t\t\tif ( this.fragment ) {\n\t\t\t\tescape = this.name !== 'script' && this.name !== 'style';\n\t\t\t\tstr += this.fragment.toString( escape );\n\t\t\t}\n\t\t\t// add a closing tag if this isn't a void element\n\t\t\tif ( !voidElementNames.test( this.template.e ) ) {\n\t\t\t\tstr += '</' + this.template.e + '>';\n\t\t\t}\n\t\t\treturn str;\n\t\t};\n\n\t\tfunction optionIsSelected( element ) {\n\t\t\tvar optionValue, selectValue, i;\n\t\t\toptionValue = element.getAttribute( 'value' );\n\t\t\tif ( optionValue === undefined || !element.select ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tselectValue = element.select.getAttribute( 'value' );\n\t\t\tif ( selectValue == optionValue ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif ( element.select.getAttribute( 'multiple' ) && isArray( selectValue ) ) {\n\t\t\t\ti = selectValue.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tif ( selectValue[ i ] == optionValue ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction inputIsCheckedRadio( element ) {\n\t\t\tvar attributes, typeAttribute, valueAttribute, nameAttribute;\n\t\t\tattributes = element.attributes;\n\t\t\ttypeAttribute = attributes.type;\n\t\t\tvalueAttribute = attributes.value;\n\t\t\tnameAttribute = attributes.name;\n\t\t\tif ( !typeAttribute || typeAttribute.value !== 'radio' || !valueAttribute || !nameAttribute.interpolator ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif ( valueAttribute.value === nameAttribute.interpolator.value ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tfunction stringifyAttribute( attribute ) {\n\t\t\tvar str = attribute.toString();\n\t\t\treturn str ? ' ' + str : '';\n\t\t}\n\t\treturn __export;\n\t}( voidElementNames, isArray, escapeHtml );\n\n\t/* virtualdom/items/Element/special/option/unbind.js */\n\tvar virtualdom_items_Element_special_option_unbind = function( removeFromArray ) {\n\n\t\treturn function unbindOption( option ) {\n\t\t\tif ( option.select ) {\n\t\t\t\tremoveFromArray( option.select.options, option );\n\t\t\t}\n\t\t};\n\t}( removeFromArray );\n\n\t/* virtualdom/items/Element/prototype/unbind.js */\n\tvar virtualdom_items_Element$unbind = function( unbindOption ) {\n\n\t\tvar __export;\n\t\t__export = function Element$unbind() {\n\t\t\tif ( this.fragment ) {\n\t\t\t\tthis.fragment.unbind();\n\t\t\t}\n\t\t\tif ( this.binding ) {\n\t\t\t\tthis.binding.unbind();\n\t\t\t}\n\t\t\tif ( this.eventHandlers ) {\n\t\t\t\tthis.eventHandlers.forEach( unbind );\n\t\t\t}\n\t\t\t// Special case - <option>\n\t\t\tif ( this.name === 'option' ) {\n\t\t\t\tunbindOption( this );\n\t\t\t}\n\t\t\tthis.attributes.forEach( unbind );\n\t\t\tthis.conditionalAttributes.forEach( unbind );\n\t\t};\n\n\t\tfunction unbind( x ) {\n\t\t\tx.unbind();\n\t\t}\n\t\treturn __export;\n\t}( virtualdom_items_Element_special_option_unbind );\n\n\t/* virtualdom/items/Element/prototype/unrender.js */\n\tvar virtualdom_items_Element$unrender = function( runloop, Transition ) {\n\n\t\tvar __export;\n\t\t__export = function Element$unrender( shouldDestroy ) {\n\t\t\tvar binding, bindings;\n\t\t\tif ( this.transition ) {\n\t\t\t\tthis.transition.complete();\n\t\t\t}\n\t\t\t// Detach as soon as we can\n\t\t\tif ( this.name === 'option' ) {\n\t\t\t\t// <option> elements detach immediately, so that\n\t\t\t\t// their parent <select> element syncs correctly, and\n\t\t\t\t// since option elements can't have transitions anyway\n\t\t\t\tthis.detach();\n\t\t\t} else if ( shouldDestroy ) {\n\t\t\t\trunloop.detachWhenReady( this );\n\t\t\t}\n\t\t\t// Children first. that way, any transitions on child elements will be\n\t\t\t// handled by the current transitionManager\n\t\t\tif ( this.fragment ) {\n\t\t\t\tthis.fragment.unrender( false );\n\t\t\t}\n\t\t\tif ( binding = this.binding ) {\n\t\t\t\tthis.binding.unrender();\n\t\t\t\tthis.node._ractive.binding = null;\n\t\t\t\tbindings = this.root._twowayBindings[ binding.keypath ];\n\t\t\t\tbindings.splice( bindings.indexOf( binding ), 1 );\n\t\t\t}\n\t\t\t// Remove event handlers\n\t\t\tif ( this.eventHandlers ) {\n\t\t\t\tthis.eventHandlers.forEach( function( h ) {\n\t\t\t\t\treturn h.unrender();\n\t\t\t\t} );\n\t\t\t}\n\t\t\tif ( this.decorator ) {\n\t\t\t\tthis.decorator.teardown();\n\t\t\t}\n\t\t\t// trigger outro transition if necessary\n\t\t\tif ( this.root.transitionsEnabled && this.outro ) {\n\t\t\t\tvar transition = new Transition( this, this.outro, false );\n\t\t\t\trunloop.registerTransition( transition );\n\t\t\t\trunloop.scheduleTask( function() {\n\t\t\t\t\treturn transition.start();\n\t\t\t\t} );\n\t\t\t}\n\t\t\t// Remove this node from any live queries\n\t\t\tif ( this.liveQueries ) {\n\t\t\t\tremoveFromLiveQueries( this );\n\t\t\t}\n\t\t};\n\n\t\tfunction removeFromLiveQueries( element ) {\n\t\t\tvar query, selector, i;\n\t\t\ti = element.liveQueries.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tquery = element.liveQueries[ i ];\n\t\t\t\tselector = query.selector;\n\t\t\t\tquery._remove( element.node );\n\t\t\t}\n\t\t}\n\t\treturn __export;\n\t}( runloop, Transition );\n\n\t/* virtualdom/items/Element/_Element.js */\n\tvar Element = function( bubble, detach, find, findAll, findAllComponents, findComponent, findNextNode, firstNode, getAttribute, init, rebind, render, toString, unbind, unrender ) {\n\n\t\tvar Element = function( options ) {\n\t\t\tthis.init( options );\n\t\t};\n\t\tElement.prototype = {\n\t\t\tbubble: bubble,\n\t\t\tdetach: detach,\n\t\t\tfind: find,\n\t\t\tfindAll: findAll,\n\t\t\tfindAllComponents: findAllComponents,\n\t\t\tfindComponent: findComponent,\n\t\t\tfindNextNode: findNextNode,\n\t\t\tfirstNode: firstNode,\n\t\t\tgetAttribute: getAttribute,\n\t\t\tinit: init,\n\t\t\trebind: rebind,\n\t\t\trender: render,\n\t\t\ttoString: toString,\n\t\t\tunbind: unbind,\n\t\t\tunrender: unrender\n\t\t};\n\t\treturn Element;\n\t}( virtualdom_items_Element$bubble, virtualdom_items_Element$detach, virtualdom_items_Element$find, virtualdom_items_Element$findAll, virtualdom_items_Element$findAllComponents, virtualdom_items_Element$findComponent, virtualdom_items_Element$findNextNode, virtualdom_items_Element$firstNode, virtualdom_items_Element$getAttribute, virtualdom_items_Element$init, virtualdom_items_Element$rebind, virtualdom_items_Element$render, virtualdom_items_Element$toString, virtualdom_items_Element$unbind, virtualdom_items_Element$unrender );\n\n\t/* virtualdom/items/Partial/deIndent.js */\n\tvar deIndent = function() {\n\n\t\tvar __export;\n\t\tvar empty = /^\\s*$/,\n\t\t\tleadingWhitespace = /^\\s*/;\n\t\t__export = function( str ) {\n\t\t\tvar lines, firstLine, lastLine, minIndent;\n\t\t\tlines = str.split( '\\n' );\n\t\t\t// remove first and last line, if they only contain whitespace\n\t\t\tfirstLine = lines[ 0 ];\n\t\t\tif ( firstLine !== undefined && empty.test( firstLine ) ) {\n\t\t\t\tlines.shift();\n\t\t\t}\n\t\t\tlastLine = lines[ lines.length - 1 ];\n\t\t\tif ( lastLine !== undefined && empty.test( lastLine ) ) {\n\t\t\t\tlines.pop();\n\t\t\t}\n\t\t\tminIndent = lines.reduce( reducer, null );\n\t\t\tif ( minIndent ) {\n\t\t\t\tstr = lines.map( function( line ) {\n\t\t\t\t\treturn line.replace( minIndent, '' );\n\t\t\t\t} ).join( '\\n' );\n\t\t\t}\n\t\t\treturn str;\n\t\t};\n\n\t\tfunction reducer( previous, line ) {\n\t\t\tvar lineIndent = leadingWhitespace.exec( line )[ 0 ];\n\t\t\tif ( previous === null || lineIndent.length < previous.length ) {\n\t\t\t\treturn lineIndent;\n\t\t\t}\n\t\t\treturn previous;\n\t\t}\n\t\treturn __export;\n\t}();\n\n\t/* virtualdom/items/Partial/getPartialTemplate.js */\n\tvar getPartialTemplate = function( log, config, parser, deIndent ) {\n\n\t\tvar __export;\n\t\t__export = function getPartialTemplate( ractive, name ) {\n\t\t\tvar partial;\n\t\t\t// If the partial in instance or view heirarchy instances, great\n\t\t\tif ( partial = getPartialFromRegistry( ractive, name ) ) {\n\t\t\t\treturn partial;\n\t\t\t}\n\t\t\t// Does it exist on the page as a script tag?\n\t\t\tpartial = parser.fromId( name, {\n\t\t\t\tnoThrow: true\n\t\t\t} );\n\t\t\tif ( partial ) {\n\t\t\t\t// is this necessary?\n\t\t\t\tpartial = deIndent( partial );\n\t\t\t\t// parse and register to this ractive instance\n\t\t\t\tvar parsed = parser.parse( partial, parser.getParseOptions( ractive ) );\n\t\t\t\t// register (and return main partial if there are others in the template)\n\t\t\t\treturn ractive.partials[ name ] = parsed.t;\n\t\t\t}\n\t\t};\n\n\t\tfunction getPartialFromRegistry( ractive, name ) {\n\t\t\tvar partials = config.registries.partials;\n\t\t\t// find first instance in the ractive or view hierarchy that has this partial\n\t\t\tvar instance = partials.findInstance( ractive, name );\n\t\t\tif ( !instance ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar partial = instance.partials[ name ],\n\t\t\t\tfn;\n\t\t\t// partial is a function?\n\t\t\tif ( typeof partial === 'function' ) {\n\t\t\t\tfn = partial.bind( instance );\n\t\t\t\tfn.isOwner = instance.partials.hasOwnProperty( name );\n\t\t\t\tpartial = fn( instance.data, parser );\n\t\t\t}\n\t\t\tif ( !partial ) {\n\t\t\t\tlog.warn( {\n\t\t\t\t\tdebug: ractive.debug,\n\t\t\t\t\tmessage: 'noRegistryFunctionReturn',\n\t\t\t\t\targs: {\n\t\t\t\t\t\tregistry: 'partial',\n\t\t\t\t\t\tname: name\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// If this was added manually to the registry,\n\t\t\t// but hasn't been parsed, parse it now\n\t\t\tif ( !parser.isParsed( partial ) ) {\n\t\t\t\t// use the parseOptions of the ractive instance on which it was found\n\t\t\t\tvar parsed = parser.parse( partial, parser.getParseOptions( instance ) );\n\t\t\t\t// Partials cannot contain nested partials!\n\t\t\t\t// TODO add a test for this\n\t\t\t\tif ( parsed.p ) {\n\t\t\t\t\tlog.warn( {\n\t\t\t\t\t\tdebug: ractive.debug,\n\t\t\t\t\t\tmessage: 'noNestedPartials',\n\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\trname: name\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\t// if fn, use instance to store result, otherwise needs to go\n\t\t\t\t// in the correct point in prototype chain on instance or constructor\n\t\t\t\tvar target = fn ? instance : partials.findOwner( instance, name );\n\t\t\t\t// may be a template with partials, which need to be registered and main template extracted\n\t\t\t\ttarget.partials[ name ] = partial = parsed.t;\n\t\t\t}\n\t\t\t// store for reset\n\t\t\tif ( fn ) {\n\t\t\t\tpartial._fn = fn;\n\t\t\t}\n\t\t\treturn partial.v ? partial.t : partial;\n\t\t}\n\t\treturn __export;\n\t}( log, config, parser, deIndent );\n\n\t/* virtualdom/items/Partial/applyIndent.js */\n\tvar applyIndent = function( string, indent ) {\n\t\tvar indented;\n\t\tif ( !indent ) {\n\t\t\treturn string;\n\t\t}\n\t\tindented = string.split( '\\n' ).map( function( line, notFirstLine ) {\n\t\t\treturn notFirstLine ? indent + line : line;\n\t\t} ).join( '\\n' );\n\t\treturn indented;\n\t};\n\n\t/* virtualdom/items/Partial/_Partial.js */\n\tvar Partial = function( log, types, getPartialTemplate, applyIndent, circular, runloop, Mustache, rebind, unbind ) {\n\n\t\tvar Partial, Fragment;\n\t\tcircular.push( function() {\n\t\t\tFragment = circular.Fragment;\n\t\t} );\n\t\tPartial = function( options ) {\n\t\t\tvar parentFragment, template;\n\t\t\tparentFragment = this.parentFragment = options.parentFragment;\n\t\t\tthis.root = parentFragment.root;\n\t\t\tthis.type = types.PARTIAL;\n\t\t\tthis.index = options.index;\n\t\t\tthis.name = options.template.r;\n\t\t\tthis.fragment = this.fragmentToRender = this.fragmentToUnrender = null;\n\t\t\tMustache.init( this, options );\n\t\t\t// If this didn't resolve, it most likely means we have a named partial\n\t\t\t// (i.e. `{{>foo}}` means 'use the foo partial', not 'use the partial\n\t\t\t// whose name is the value of `foo`')\n\t\t\tif ( !this.keypath && ( template = getPartialTemplate( this.root, this.name ) ) ) {\n\t\t\t\tunbind.call( this );\n\t\t\t\t// prevent any further changes\n\t\t\t\tthis.isNamed = true;\n\t\t\t\tthis.setTemplate( template );\n\t\t\t}\n\t\t};\n\t\tPartial.prototype = {\n\t\t\tbubble: function() {\n\t\t\t\tthis.parentFragment.bubble();\n\t\t\t},\n\t\t\tdetach: function() {\n\t\t\t\treturn this.fragment.detach();\n\t\t\t},\n\t\t\tfind: function( selector ) {\n\t\t\t\treturn this.fragment.find( selector );\n\t\t\t},\n\t\t\tfindAll: function( selector, query ) {\n\t\t\t\treturn this.fragment.findAll( selector, query );\n\t\t\t},\n\t\t\tfindComponent: function( selector ) {\n\t\t\t\treturn this.fragment.findComponent( selector );\n\t\t\t},\n\t\t\tfindAllComponents: function( selector, query ) {\n\t\t\t\treturn this.fragment.findAllComponents( selector, query );\n\t\t\t},\n\t\t\tfirstNode: function() {\n\t\t\t\treturn this.fragment.firstNode();\n\t\t\t},\n\t\t\tfindNextNode: function() {\n\t\t\t\treturn this.parentFragment.findNextNode( this );\n\t\t\t},\n\t\t\tgetValue: function() {\n\t\t\t\treturn this.fragment.getValue();\n\t\t\t},\n\t\t\trebind: function( indexRef, newIndex, oldKeypath, newKeypath ) {\n\t\t\t\trebind.call( this, indexRef, newIndex, oldKeypath, newKeypath );\n\t\t\t\tthis.fragment.rebind( indexRef, newIndex, oldKeypath, newKeypath );\n\t\t\t},\n\t\t\trender: function() {\n\t\t\t\tthis.docFrag = document.createDocumentFragment();\n\t\t\t\tthis.update();\n\t\t\t\tthis.rendered = true;\n\t\t\t\treturn this.docFrag;\n\t\t\t},\n\t\t\tresolve: Mustache.resolve,\n\t\t\tsetValue: function( value ) {\n\t\t\t\tvar template;\n\t\t\t\tif ( value !== undefined && value === this.value ) {\n\t\t\t\t\t// nothing has changed, so no work to be done\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\ttemplate = getPartialTemplate( this.root, '' + value );\n\t\t\t\t// we may be here if we have a partial like `{{>foo}}` and `foo` is the\n\t\t\t\t// name of both a data property (whose value ISN'T the name of a partial)\n\t\t\t\t// and a partial. In those cases, this becomes a named partial\n\t\t\t\tif ( !template && this.name && ( template = getPartialTemplate( this.root, this.name ) ) ) {\n\t\t\t\t\tunbind.call( this );\n\t\t\t\t\tthis.isNamed = true;\n\t\t\t\t}\n\t\t\t\tif ( !template ) {\n\t\t\t\t\tlog.error( {\n\t\t\t\t\t\tdebug: this.root.debug,\n\t\t\t\t\t\tmessage: 'noTemplateForPartial',\n\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\tname: this.name\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tthis.setTemplate( template || [] );\n\t\t\t\tthis.value = value;\n\t\t\t\tthis.bubble();\n\t\t\t\tif ( this.rendered ) {\n\t\t\t\t\trunloop.addView( this );\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetTemplate: function( template ) {\n\t\t\t\tif ( this.fragment ) {\n\t\t\t\t\tthis.fragment.unbind();\n\t\t\t\t\tthis.fragmentToUnrender = this.fragment;\n\t\t\t\t}\n\t\t\t\tthis.fragment = new Fragment( {\n\t\t\t\t\ttemplate: template,\n\t\t\t\t\troot: this.root,\n\t\t\t\t\towner: this,\n\t\t\t\t\tpElement: this.parentFragment.pElement\n\t\t\t\t} );\n\t\t\t\tthis.fragmentToRender = this.fragment;\n\t\t\t},\n\t\t\ttoString: function( toString ) {\n\t\t\t\tvar string, previousItem, lastLine, match;\n\t\t\t\tstring = this.fragment.toString( toString );\n\t\t\t\tpreviousItem = this.parentFragment.items[ this.index - 1 ];\n\t\t\t\tif ( !previousItem || previousItem.type !== types.TEXT ) {\n\t\t\t\t\treturn string;\n\t\t\t\t}\n\t\t\t\tlastLine = previousItem.text.split( '\\n' ).pop();\n\t\t\t\tif ( match = /^\\s+$/.exec( lastLine ) ) {\n\t\t\t\t\treturn applyIndent( string, match[ 0 ] );\n\t\t\t\t}\n\t\t\t\treturn string;\n\t\t\t},\n\t\t\tunbind: function() {\n\t\t\t\tif ( !this.isNamed ) {\n\t\t\t\t\t// dynamic partial - need to unbind self\n\t\t\t\t\tunbind.call( this );\n\t\t\t\t}\n\t\t\t\tif ( this.fragment ) {\n\t\t\t\t\tthis.fragment.unbind();\n\t\t\t\t}\n\t\t\t},\n\t\t\tunrender: function( shouldDestroy ) {\n\t\t\t\tif ( this.rendered ) {\n\t\t\t\t\tif ( this.fragment ) {\n\t\t\t\t\t\tthis.fragment.unrender( shouldDestroy );\n\t\t\t\t\t}\n\t\t\t\t\tthis.rendered = false;\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: function() {\n\t\t\t\tvar target, anchor;\n\t\t\t\tif ( this.fragmentToUnrender ) {\n\t\t\t\t\tthis.fragmentToUnrender.unrender( true );\n\t\t\t\t\tthis.fragmentToUnrender = null;\n\t\t\t\t}\n\t\t\t\tif ( this.fragmentToRender ) {\n\t\t\t\t\tthis.docFrag.appendChild( this.fragmentToRender.render() );\n\t\t\t\t\tthis.fragmentToRender = null;\n\t\t\t\t}\n\t\t\t\tif ( this.rendered ) {\n\t\t\t\t\ttarget = this.parentFragment.getNode();\n\t\t\t\t\tanchor = this.parentFragment.findNextNode( this );\n\t\t\t\t\ttarget.insertBefore( this.docFrag, anchor );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn Partial;\n\t}( log, types, getPartialTemplate, applyIndent, circular, runloop, Mustache, rebind, unbind );\n\n\t/* virtualdom/items/Component/getComponent.js */\n\tvar getComponent = function( config, log, circular ) {\n\n\t\tvar Ractive;\n\t\tcircular.push( function() {\n\t\t\tRactive = circular.Ractive;\n\t\t} );\n\t\t// finds the component constructor in the registry or view hierarchy registries\n\t\treturn function getComponent( ractive, name ) {\n\t\t\tvar component, instance = config.registries.components.findInstance( ractive, name );\n\t\t\tif ( instance ) {\n\t\t\t\tcomponent = instance.components[ name ];\n\t\t\t\t// best test we have for not Ractive.extend\n\t\t\t\tif ( !component._parent ) {\n\t\t\t\t\t// function option, execute and store for reset\n\t\t\t\t\tvar fn = component.bind( instance );\n\t\t\t\t\tfn.isOwner = instance.components.hasOwnProperty( name );\n\t\t\t\t\tcomponent = fn( instance.data );\n\t\t\t\t\tif ( !component ) {\n\t\t\t\t\t\tlog.warn( {\n\t\t\t\t\t\t\tdebug: ractive.debug,\n\t\t\t\t\t\t\tmessage: 'noRegistryFunctionReturn',\n\t\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\t\tregistry: 'component',\n\t\t\t\t\t\t\t\tname: name\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif ( typeof component === 'string' ) {\n\t\t\t\t\t\t//allow string lookup\n\t\t\t\t\t\tcomponent = getComponent( ractive, component );\n\t\t\t\t\t}\n\t\t\t\t\tcomponent._fn = fn;\n\t\t\t\t\tinstance.components[ name ] = component;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn component;\n\t\t};\n\t}( config, log, circular );\n\n\t/* virtualdom/items/Component/prototype/detach.js */\n\tvar virtualdom_items_Component$detach = function( Hook ) {\n\n\t\tvar detachHook = new Hook( 'detach' );\n\t\treturn function Component$detach() {\n\t\t\tvar detached = this.instance.fragment.detach();\n\t\t\tdetachHook.fire( this.instance );\n\t\t\treturn detached;\n\t\t};\n\t}( Ractive$shared_hooks_Hook );\n\n\t/* virtualdom/items/Component/prototype/find.js */\n\tvar virtualdom_items_Component$find = function Component$find( selector ) {\n\t\treturn this.instance.fragment.find( selector );\n\t};\n\n\t/* virtualdom/items/Component/prototype/findAll.js */\n\tvar virtualdom_items_Component$findAll = function Component$findAll( selector, query ) {\n\t\treturn this.instance.fragment.findAll( selector, query );\n\t};\n\n\t/* virtualdom/items/Component/prototype/findAllComponents.js */\n\tvar virtualdom_items_Component$findAllComponents = function Component$findAllComponents( selector, query ) {\n\t\tquery._test( this, true );\n\t\tif ( this.instance.fragment ) {\n\t\t\tthis.instance.fragment.findAllComponents( selector, query );\n\t\t}\n\t};\n\n\t/* virtualdom/items/Component/prototype/findComponent.js */\n\tvar virtualdom_items_Component$findComponent = function Component$findComponent( selector ) {\n\t\tif ( !selector || selector === this.name ) {\n\t\t\treturn this.instance;\n\t\t}\n\t\tif ( this.instance.fragment ) {\n\t\t\treturn this.instance.fragment.findComponent( selector );\n\t\t}\n\t\treturn null;\n\t};\n\n\t/* virtualdom/items/Component/prototype/findNextNode.js */\n\tvar virtualdom_items_Component$findNextNode = function Component$findNextNode() {\n\t\treturn this.parentFragment.findNextNode( this );\n\t};\n\n\t/* virtualdom/items/Component/prototype/firstNode.js */\n\tvar virtualdom_items_Component$firstNode = function Component$firstNode() {\n\t\tif ( this.rendered ) {\n\t\t\treturn this.instance.fragment.firstNode();\n\t\t}\n\t\treturn null;\n\t};\n\n\t/* virtualdom/items/Component/initialise/createModel/ComponentParameter.js */\n\tvar ComponentParameter = function( runloop, circular ) {\n\n\t\tvar Fragment, ComponentParameter;\n\t\tcircular.push( function() {\n\t\t\tFragment = circular.Fragment;\n\t\t} );\n\t\tComponentParameter = function( component, key, value ) {\n\t\t\tthis.parentFragment = component.parentFragment;\n\t\t\tthis.component = component;\n\t\t\tthis.key = key;\n\t\t\tthis.fragment = new Fragment( {\n\t\t\t\ttemplate: value,\n\t\t\t\troot: component.root,\n\t\t\t\towner: this\n\t\t\t} );\n\t\t\tthis.value = this.fragment.getValue();\n\t\t};\n\t\tComponentParameter.prototype = {\n\t\t\tbubble: function() {\n\t\t\t\tif ( !this.dirty ) {\n\t\t\t\t\tthis.dirty = true;\n\t\t\t\t\trunloop.addView( this );\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: function() {\n\t\t\t\tvar value = this.fragment.getValue();\n\t\t\t\tthis.component.instance.viewmodel.set( this.key, value );\n\t\t\t\trunloop.addViewmodel( this.component.instance.viewmodel );\n\t\t\t\tthis.value = value;\n\t\t\t\tthis.dirty = false;\n\t\t\t},\n\t\t\trebind: function( indexRef, newIndex, oldKeypath, newKeypath ) {\n\t\t\t\tthis.fragment.rebind( indexRef, newIndex, oldKeypath, newKeypath );\n\t\t\t},\n\t\t\tunbind: function() {\n\t\t\t\tthis.fragment.unbind();\n\t\t\t}\n\t\t};\n\t\treturn ComponentParameter;\n\t}( runloop, circular );\n\n\t/* virtualdom/items/Component/initialise/createModel/ReferenceExpressionParameter.js */\n\tvar ReferenceExpressionParameter = function( ReferenceExpressionResolver, createComponentBinding ) {\n\n\t\tvar ReferenceExpressionParameter = function( component, childKeypath, template, toBind ) {\n\t\t\tvar this$0 = this;\n\t\t\tthis.root = component.root;\n\t\t\tthis.parentFragment = component.parentFragment;\n\t\t\tthis.ready = false;\n\t\t\tthis.hash = null;\n\t\t\tthis.resolver = new ReferenceExpressionResolver( this, template, function( keypath ) {\n\t\t\t\t// Are we updating an existing binding?\n\t\t\t\tif ( this$0.binding || ( this$0.binding = component.bindings[ this$0.hash ] ) ) {\n\t\t\t\t\tcomponent.bindings[ this$0.hash ] = null;\n\t\t\t\t\tthis$0.binding.rebind( keypath );\n\t\t\t\t\tthis$0.hash = keypath + '=' + childKeypath;\n\t\t\t\t\tcomponent.bindings[ this$0.hash ];\n\t\t\t\t} else {\n\t\t\t\t\tif ( !this$0.ready ) {\n\t\t\t\t\t\t// The child instance isn't created yet, we need to create the binding later\n\t\t\t\t\t\ttoBind.push( {\n\t\t\t\t\t\t\tchildKeypath: childKeypath,\n\t\t\t\t\t\t\tparentKeypath: keypath\n\t\t\t\t\t\t} );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcreateComponentBinding( component, component.root, keypath, childKeypath );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis$0.value = component.root.viewmodel.get( keypath );\n\t\t\t} );\n\t\t};\n\t\tReferenceExpressionParameter.prototype = {\n\t\t\trebind: function( indexRef, newIndex, oldKeypath, newKeypath ) {\n\t\t\t\tthis.resolver.rebind( indexRef, newIndex, oldKeypath, newKeypath );\n\t\t\t},\n\t\t\tunbind: function() {\n\t\t\t\tthis.resolver.unbind();\n\t\t\t}\n\t\t};\n\t\treturn ReferenceExpressionParameter;\n\t}( ReferenceExpressionResolver, createComponentBinding );\n\n\t/* virtualdom/items/Component/initialise/createModel/_createModel.js */\n\tvar createModel = function( types, parseJSON, resolveRef, ComponentParameter, ReferenceExpressionParameter ) {\n\n\t\tvar __export;\n\t\t__export = function( component, defaultData, attributes, toBind ) {\n\t\t\tvar data = {},\n\t\t\t\tkey, value;\n\t\t\t// some parameters, e.g. foo=\"The value is {{bar}}\", are 'complex' - in\n\t\t\t// other words, we need to construct a string fragment to watch\n\t\t\t// when they change. We store these so they can be torn down later\n\t\t\tcomponent.complexParameters = [];\n\t\t\tfor ( key in attributes ) {\n\t\t\t\tif ( attributes.hasOwnProperty( key ) ) {\n\t\t\t\t\tvalue = getValue( component, key, attributes[ key ], toBind );\n\t\t\t\t\tif ( value !== undefined || defaultData[ key ] === undefined ) {\n\t\t\t\t\t\tdata[ key ] = value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn data;\n\t\t};\n\n\t\tfunction getValue( component, key, template, toBind ) {\n\t\t\tvar parameter, parsed, parentInstance, parentFragment, keypath, indexRef;\n\t\t\tparentInstance = component.root;\n\t\t\tparentFragment = component.parentFragment;\n\t\t\t// If this is a static value, great\n\t\t\tif ( typeof template === 'string' ) {\n\t\t\t\tparsed = parseJSON( template );\n\t\t\t\tif ( !parsed ) {\n\t\t\t\t\treturn template;\n\t\t\t\t}\n\t\t\t\treturn parsed.value;\n\t\t\t}\n\t\t\t// If null, we treat it as a boolean attribute (i.e. true)\n\t\t\tif ( template === null ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\t// Single interpolator?\n\t\t\tif ( template.length === 1 && template[ 0 ].t === types.INTERPOLATOR ) {\n\t\t\t\t// If it's a regular interpolator, we bind to it\n\t\t\t\tif ( template[ 0 ].r ) {\n\t\t\t\t\t// Is it an index reference?\n\t\t\t\t\tif ( parentFragment.indexRefs && parentFragment.indexRefs[ indexRef = template[ 0 ].r ] !== undefined ) {\n\t\t\t\t\t\tcomponent.indexRefBindings[ indexRef ] = key;\n\t\t\t\t\t\treturn parentFragment.indexRefs[ indexRef ];\n\t\t\t\t\t}\n\t\t\t\t\t// TODO what about references that resolve late? Should these be considered?\n\t\t\t\t\tkeypath = resolveRef( parentInstance, template[ 0 ].r, parentFragment ) || template[ 0 ].r;\n\t\t\t\t\t// We need to set up bindings between parent and child, but\n\t\t\t\t\t// we can't do it yet because the child instance doesn't exist\n\t\t\t\t\t// yet - so we make a note instead\n\t\t\t\t\ttoBind.push( {\n\t\t\t\t\t\tchildKeypath: key,\n\t\t\t\t\t\tparentKeypath: keypath\n\t\t\t\t\t} );\n\t\t\t\t\treturn parentInstance.viewmodel.get( keypath );\n\t\t\t\t}\n\t\t\t\t// If it's a reference expression (e.g. `{{foo[bar]}}`), we need\n\t\t\t\t// to watch the keypath and create/destroy bindings\n\t\t\t\tif ( template[ 0 ].rx ) {\n\t\t\t\t\tparameter = new ReferenceExpressionParameter( component, key, template[ 0 ].rx, toBind );\n\t\t\t\t\tcomponent.complexParameters.push( parameter );\n\t\t\t\t\tparameter.ready = true;\n\t\t\t\t\treturn parameter.value;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// We have a 'complex parameter' - we need to create a full-blown string\n\t\t\t// fragment in order to evaluate and observe its value\n\t\t\tparameter = new ComponentParameter( component, key, template );\n\t\t\tcomponent.complexParameters.push( parameter );\n\t\t\treturn parameter.value;\n\t\t}\n\t\treturn __export;\n\t}( types, parseJSON, resolveRef, ComponentParameter, ReferenceExpressionParameter );\n\n\t/* virtualdom/items/Component/initialise/createInstance.js */\n\tvar createInstance = function( log ) {\n\n\t\treturn function( component, Component, data, contentDescriptor ) {\n\t\t\tvar instance, parentFragment, partials, ractive;\n\t\t\tparentFragment = component.parentFragment;\n\t\t\tractive = component.root;\n\t\t\t// Make contents available as a {{>content}} partial\n\t\t\tpartials = {\n\t\t\t\tcontent: contentDescriptor || []\n\t\t\t};\n\t\t\tif ( Component.defaults.el ) {\n\t\t\t\tlog.warn( {\n\t\t\t\t\tdebug: ractive.debug,\n\t\t\t\t\tmessage: 'defaultElSpecified',\n\t\t\t\t\targs: {\n\t\t\t\t\t\tname: component.name\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t\tinstance = new Component( {\n\t\t\t\tel: null,\n\t\t\t\tappend: true,\n\t\t\t\tdata: data,\n\t\t\t\tpartials: partials,\n\t\t\t\tmagic: ractive.magic || Component.defaults.magic,\n\t\t\t\tmodifyArrays: ractive.modifyArrays,\n\t\t\t\t_parent: ractive,\n\t\t\t\t_component: component,\n\t\t\t\t// need to inherit runtime parent adaptors\n\t\t\t\tadapt: ractive.adapt,\n\t\t\t\tyield: {\n\t\t\t\t\ttemplate: contentDescriptor,\n\t\t\t\t\tinstance: ractive\n\t\t\t\t}\n\t\t\t} );\n\t\t\treturn instance;\n\t\t};\n\t}( log );\n\n\t/* virtualdom/items/Component/initialise/createBindings.js */\n\tvar createBindings = function( createComponentBinding ) {\n\n\t\treturn function createInitialComponentBindings( component, toBind ) {\n\t\t\ttoBind.forEach( function createInitialComponentBinding( pair ) {\n\t\t\t\tvar childValue, parentValue;\n\t\t\t\tcreateComponentBinding( component, component.root, pair.parentKeypath, pair.childKeypath );\n\t\t\t\tchildValue = component.instance.viewmodel.get( pair.childKeypath );\n\t\t\t\tparentValue = component.root.viewmodel.get( pair.parentKeypath );\n\t\t\t\tif ( childValue !== undefined && parentValue === undefined ) {\n\t\t\t\t\tcomponent.root.viewmodel.set( pair.parentKeypath, childValue );\n\t\t\t\t}\n\t\t\t} );\n\t\t};\n\t}( createComponentBinding );\n\n\t/* virtualdom/items/Component/initialise/propagateEvents.js */\n\tvar propagateEvents = function( circular, fireEvent, log ) {\n\n\t\tvar __export;\n\t\tvar Fragment;\n\t\tcircular.push( function() {\n\t\t\tFragment = circular.Fragment;\n\t\t} );\n\t\t__export = function propagateEvents( component, eventsDescriptor ) {\n\t\t\tvar eventName;\n\t\t\tfor ( eventName in eventsDescriptor ) {\n\t\t\t\tif ( eventsDescriptor.hasOwnProperty( eventName ) ) {\n\t\t\t\t\tpropagateEvent( component.instance, component.root, eventName, eventsDescriptor[ eventName ] );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tfunction propagateEvent( childInstance, parentInstance, eventName, proxyEventName ) {\n\t\t\tif ( typeof proxyEventName !== 'string' ) {\n\t\t\t\tlog.error( {\n\t\t\t\t\tdebug: parentInstance.debug,\n\t\t\t\t\tmessage: 'noComponentEventArguments'\n\t\t\t\t} );\n\t\t\t}\n\t\t\tchildInstance.on( eventName, function() {\n\t\t\t\tvar event, args;\n\t\t\t\t// semi-weak test, but what else? tag the event obj ._isEvent ?\n\t\t\t\tif ( arguments.length && arguments[ 0 ] && arguments[ 0 ].node ) {\n\t\t\t\t\tevent = Array.prototype.shift.call( arguments );\n\t\t\t\t}\n\t\t\t\targs = Array.prototype.slice.call( arguments );\n\t\t\t\tfireEvent( parentInstance, proxyEventName, {\n\t\t\t\t\tevent: event,\n\t\t\t\t\targs: args\n\t\t\t\t} );\n\t\t\t\t// cancel bubbling\n\t\t\t\treturn false;\n\t\t\t} );\n\t\t}\n\t\treturn __export;\n\t}( circular, Ractive$shared_fireEvent, log );\n\n\t/* virtualdom/items/Component/initialise/updateLiveQueries.js */\n\tvar updateLiveQueries = function( component ) {\n\t\tvar ancestor, query;\n\t\t// If there's a live query for this component type, add it\n\t\tancestor = component.root;\n\t\twhile ( ancestor ) {\n\t\t\tif ( query = ancestor._liveComponentQueries[ '_' + component.name ] ) {\n\t\t\t\tquery.push( component.instance );\n\t\t\t}\n\t\t\tancestor = ancestor._parent;\n\t\t}\n\t};\n\n\t/* virtualdom/items/Component/prototype/init.js */\n\tvar virtualdom_items_Component$init = function( types, warn, createModel, createInstance, createBindings, propagateEvents, updateLiveQueries ) {\n\n\t\treturn function Component$init( options, Component ) {\n\t\t\tvar parentFragment, root, data, toBind;\n\t\t\tparentFragment = this.parentFragment = options.parentFragment;\n\t\t\troot = parentFragment.root;\n\t\t\tthis.root = root;\n\t\t\tthis.type = types.COMPONENT;\n\t\t\tthis.name = options.template.e;\n\t\t\tthis.index = options.index;\n\t\t\tthis.indexRefBindings = {};\n\t\t\tthis.bindings = [];\n\t\t\t// even though only one yielder is allowed, we need to have an array of them\n\t\t\t// as it's possible to cause a yielder to be created before the last one\n\t\t\t// was destroyed in the same turn of the runloop\n\t\t\tthis.yielders = [];\n\t\t\tif ( !Component ) {\n\t\t\t\tthrow new Error( 'Component \"' + this.name + '\" not found' );\n\t\t\t}\n\t\t\t// First, we need to create a model for the component - e.g. if we\n\t\t\t// encounter <widget foo='bar'/> then we need to create a widget\n\t\t\t// with `data: { foo: 'bar' }`.\n\t\t\t//\n\t\t\t// This may involve setting up some bindings, but we can't do it\n\t\t\t// yet so we take some notes instead\n\t\t\ttoBind = [];\n\t\t\tdata = createModel( this, Component.defaults.data || {}, options.template.a, toBind );\n\t\t\tcreateInstance( this, Component, data, options.template.f );\n\t\t\tcreateBindings( this, toBind );\n\t\t\tpropagateEvents( this, options.template.v );\n\t\t\t// intro, outro and decorator directives have no effect\n\t\t\tif ( options.template.t1 || options.template.t2 || options.template.o ) {\n\t\t\t\twarn( 'The \"intro\", \"outro\" and \"decorator\" directives have no effect on components' );\n\t\t\t}\n\t\t\tupdateLiveQueries( this );\n\t\t};\n\t}( types, warn, createModel, createInstance, createBindings, propagateEvents, updateLiveQueries );\n\n\t/* virtualdom/items/Component/prototype/rebind.js */\n\tvar virtualdom_items_Component$rebind = function( runloop, getNewKeypath ) {\n\n\t\treturn function Component$rebind( indexRef, newIndex, oldKeypath, newKeypath ) {\n\t\t\tvar childInstance = this.instance,\n\t\t\t\tparentInstance = childInstance._parent,\n\t\t\t\tindexRefAlias, query;\n\t\t\tthis.bindings.forEach( function( binding ) {\n\t\t\t\tvar updated;\n\t\t\t\tif ( binding.root !== parentInstance ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif ( updated = getNewKeypath( binding.keypath, oldKeypath, newKeypath ) ) {\n\t\t\t\t\tbinding.rebind( updated );\n\t\t\t\t}\n\t\t\t} );\n\t\t\tthis.complexParameters.forEach( rebind );\n\t\t\tif ( this.yielders[ 0 ] ) {\n\t\t\t\trebind( this.yielders[ 0 ] );\n\t\t\t}\n\t\t\tif ( indexRefAlias = this.indexRefBindings[ indexRef ] ) {\n\t\t\t\trunloop.addViewmodel( childInstance.viewmodel );\n\t\t\t\tchildInstance.viewmodel.set( indexRefAlias, newIndex );\n\t\t\t}\n\t\t\tif ( query = this.root._liveComponentQueries[ '_' + this.name ] ) {\n\t\t\t\tquery._makeDirty();\n\t\t\t}\n\n\t\t\tfunction rebind( x ) {\n\t\t\t\tx.rebind( indexRef, newIndex, oldKeypath, newKeypath );\n\t\t\t}\n\t\t};\n\t}( runloop, getNewKeypath );\n\n\t/* virtualdom/items/Component/prototype/render.js */\n\tvar virtualdom_items_Component$render = function Component$render() {\n\t\tvar instance = this.instance;\n\t\tinstance.render( this.parentFragment.getNode() );\n\t\tthis.rendered = true;\n\t\treturn instance.fragment.detach();\n\t};\n\n\t/* virtualdom/items/Component/prototype/toString.js */\n\tvar virtualdom_items_Component$toString = function Component$toString() {\n\t\treturn this.instance.fragment.toString();\n\t};\n\n\t/* virtualdom/items/Component/prototype/unbind.js */\n\tvar virtualdom_items_Component$unbind = function( Hook, removeFromArray ) {\n\n\t\tvar __export;\n\t\tvar teardownHook = new Hook( 'teardown' );\n\t\t__export = function Component$unbind() {\n\t\t\tvar instance = this.instance;\n\t\t\tthis.complexParameters.forEach( unbind );\n\t\t\tthis.bindings.forEach( unbind );\n\t\t\tremoveFromLiveComponentQueries( this );\n\t\t\t// teardown the instance\n\t\t\tinstance.fragment.unbind();\n\t\t\tinstance.viewmodel.teardown();\n\t\t\tif ( instance.fragment.rendered && instance.el.__ractive_instances__ ) {\n\t\t\t\tremoveFromArray( instance.el.__ractive_instances__, instance );\n\t\t\t}\n\t\t\tteardownHook.fire( instance );\n\t\t};\n\n\t\tfunction unbind( thing ) {\n\t\t\tthing.unbind();\n\t\t}\n\n\t\tfunction removeFromLiveComponentQueries( component ) {\n\t\t\tvar instance, query;\n\t\t\tinstance = component.root;\n\t\t\tdo {\n\t\t\t\tif ( query = instance._liveComponentQueries[ '_' + component.name ] ) {\n\t\t\t\t\tquery._remove( component );\n\t\t\t\t}\n\t\t\t} while ( instance = instance._parent );\n\t\t}\n\t\treturn __export;\n\t}( Ractive$shared_hooks_Hook, removeFromArray );\n\n\t/* virtualdom/items/Component/prototype/unrender.js */\n\tvar virtualdom_items_Component$unrender = function Component$unrender( shouldDestroy ) {\n\t\tthis.shouldDestroy = shouldDestroy;\n\t\tthis.instance.unrender();\n\t};\n\n\t/* virtualdom/items/Component/_Component.js */\n\tvar Component = function( detach, find, findAll, findAllComponents, findComponent, findNextNode, firstNode, init, rebind, render, toString, unbind, unrender ) {\n\n\t\tvar Component = function( options, Constructor ) {\n\t\t\tthis.init( options, Constructor );\n\t\t};\n\t\tComponent.prototype = {\n\t\t\tdetach: detach,\n\t\t\tfind: find,\n\t\t\tfindAll: findAll,\n\t\t\tfindAllComponents: findAllComponents,\n\t\t\tfindComponent: findComponent,\n\t\t\tfindNextNode: findNextNode,\n\t\t\tfirstNode: firstNode,\n\t\t\tinit: init,\n\t\t\trebind: rebind,\n\t\t\trender: render,\n\t\t\ttoString: toString,\n\t\t\tunbind: unbind,\n\t\t\tunrender: unrender\n\t\t};\n\t\treturn Component;\n\t}( virtualdom_items_Component$detach, virtualdom_items_Component$find, virtualdom_items_Component$findAll, virtualdom_items_Component$findAllComponents, virtualdom_items_Component$findComponent, virtualdom_items_Component$findNextNode, virtualdom_items_Component$firstNode, virtualdom_items_Component$init, virtualdom_items_Component$rebind, virtualdom_items_Component$render, virtualdom_items_Component$toString, virtualdom_items_Component$unbind, virtualdom_items_Component$unrender );\n\n\t/* virtualdom/items/Comment.js */\n\tvar Comment = function( types, detach ) {\n\n\t\tvar Comment = function( options ) {\n\t\t\tthis.type = types.COMMENT;\n\t\t\tthis.value = options.template.c;\n\t\t};\n\t\tComment.prototype = {\n\t\t\tdetach: detach,\n\t\t\tfirstNode: function() {\n\t\t\t\treturn this.node;\n\t\t\t},\n\t\t\trender: function() {\n\t\t\t\tif ( !this.node ) {\n\t\t\t\t\tthis.node = document.createComment( this.value );\n\t\t\t\t}\n\t\t\t\treturn this.node;\n\t\t\t},\n\t\t\ttoString: function() {\n\t\t\t\treturn '<!--' + this.value + '-->';\n\t\t\t},\n\t\t\tunrender: function( shouldDestroy ) {\n\t\t\t\tif ( shouldDestroy ) {\n\t\t\t\t\tthis.node.parentNode.removeChild( this.node );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn Comment;\n\t}( types, detach );\n\n\t/* virtualdom/items/Yielder.js */\n\tvar Yielder = function( runloop, removeFromArray, circular ) {\n\n\t\tvar Fragment;\n\t\tcircular.push( function() {\n\t\t\tFragment = circular.Fragment;\n\t\t} );\n\t\tvar Yielder = function( options ) {\n\t\t\tvar componentInstance, component;\n\t\t\tcomponentInstance = options.parentFragment.root;\n\t\t\tthis.component = component = componentInstance.component;\n\t\t\tthis.surrogateParent = options.parentFragment;\n\t\t\tthis.parentFragment = component.parentFragment;\n\t\t\tthis.fragment = new Fragment( {\n\t\t\t\towner: this,\n\t\t\t\troot: componentInstance.yield.instance,\n\t\t\t\ttemplate: componentInstance.yield.template,\n\t\t\t\tpElement: this.surrogateParent.pElement\n\t\t\t} );\n\t\t\tcomponent.yielders.push( this );\n\t\t\trunloop.scheduleTask( function() {\n\t\t\t\tif ( component.yielders.length > 1 ) {\n\t\t\t\t\tthrow new Error( 'A component template can only have one {{yield}} declaration at a time' );\n\t\t\t\t}\n\t\t\t} );\n\t\t};\n\t\tYielder.prototype = {\n\t\t\tdetach: function() {\n\t\t\t\treturn this.fragment.detach();\n\t\t\t},\n\t\t\tfind: function( selector ) {\n\t\t\t\treturn this.fragment.find( selector );\n\t\t\t},\n\t\t\tfindAll: function( selector, query ) {\n\t\t\t\treturn this.fragment.findAll( selector, query );\n\t\t\t},\n\t\t\tfindComponent: function( selector ) {\n\t\t\t\treturn this.fragment.findComponent( selector );\n\t\t\t},\n\t\t\tfindAllComponents: function( selector, query ) {\n\t\t\t\treturn this.fragment.findAllComponents( selector, query );\n\t\t\t},\n\t\t\tfindNextNode: function() {\n\t\t\t\treturn this.surrogateParent.findNextNode( this );\n\t\t\t},\n\t\t\tfirstNode: function() {\n\t\t\t\treturn this.fragment.firstNode();\n\t\t\t},\n\t\t\tgetValue: function( options ) {\n\t\t\t\treturn this.fragment.getValue( options );\n\t\t\t},\n\t\t\trender: function() {\n\t\t\t\treturn this.fragment.render();\n\t\t\t},\n\t\t\tunbind: function() {\n\t\t\t\tthis.fragment.unbind();\n\t\t\t},\n\t\t\tunrender: function( shouldDestroy ) {\n\t\t\t\tthis.fragment.unrender( shouldDestroy );\n\t\t\t\tremoveFromArray( this.component.yielders, this );\n\t\t\t},\n\t\t\trebind: function( indexRef, newIndex, oldKeypath, newKeypath ) {\n\t\t\t\tthis.fragment.rebind( indexRef, newIndex, oldKeypath, newKeypath );\n\t\t\t},\n\t\t\ttoString: function() {\n\t\t\t\treturn this.fragment.toString();\n\t\t\t}\n\t\t};\n\t\treturn Yielder;\n\t}( runloop, removeFromArray, circular );\n\n\t/* virtualdom/Fragment/prototype/init/createItem.js */\n\tvar virtualdom_Fragment$init_createItem = function( types, Text, Interpolator, Section, Triple, Element, Partial, getComponent, Component, Comment, Yielder ) {\n\n\t\treturn function createItem( options ) {\n\t\t\tif ( typeof options.template === 'string' ) {\n\t\t\t\treturn new Text( options );\n\t\t\t}\n\t\t\tswitch ( options.template.t ) {\n\t\t\t\tcase types.INTERPOLATOR:\n\t\t\t\t\tif ( options.template.r === 'yield' ) {\n\t\t\t\t\t\treturn new Yielder( options );\n\t\t\t\t\t}\n\t\t\t\t\treturn new Interpolator( options );\n\t\t\t\tcase types.SECTION:\n\t\t\t\t\treturn new Section( options );\n\t\t\t\tcase types.TRIPLE:\n\t\t\t\t\treturn new Triple( options );\n\t\t\t\tcase types.ELEMENT:\n\t\t\t\t\tvar constructor;\n\t\t\t\t\tif ( constructor = getComponent( options.parentFragment.root, options.template.e ) ) {\n\t\t\t\t\t\treturn new Component( options, constructor );\n\t\t\t\t\t}\n\t\t\t\t\treturn new Element( options );\n\t\t\t\tcase types.PARTIAL:\n\t\t\t\t\treturn new Partial( options );\n\t\t\t\tcase types.COMMENT:\n\t\t\t\t\treturn new Comment( options );\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error( 'Something very strange happened. Please file an issue at https://github.com/ractivejs/ractive/issues. Thanks!' );\n\t\t\t}\n\t\t};\n\t}( types, Text, Interpolator, Section, Triple, Element, Partial, getComponent, Component, Comment, Yielder );\n\n\t/* virtualdom/Fragment/prototype/init.js */\n\tvar virtualdom_Fragment$init = function( types, create, createItem ) {\n\n\t\treturn function Fragment$init( options ) {\n\t\t\tvar this$0 = this;\n\t\t\tvar parentFragment, parentRefs, ref;\n\t\t\t// The item that owns this fragment - an element, section, partial, or attribute\n\t\t\tthis.owner = options.owner;\n\t\t\tparentFragment = this.parent = this.owner.parentFragment;\n\t\t\t// inherited properties\n\t\t\tthis.root = options.root;\n\t\t\tthis.pElement = options.pElement;\n\t\t\tthis.context = options.context;\n\t\t\t// If parent item is a section, this may not be the only fragment\n\t\t\t// that belongs to it - we need to make a note of the index\n\t\t\tif ( this.owner.type === types.SECTION ) {\n\t\t\t\tthis.index = options.index;\n\t\t\t}\n\t\t\t// index references (the 'i' in {{#section:i}}...{{/section}}) need to cascade\n\t\t\t// down the tree\n\t\t\tif ( parentFragment ) {\n\t\t\t\tparentRefs = parentFragment.indexRefs;\n\t\t\t\tif ( parentRefs ) {\n\t\t\t\t\tthis.indexRefs = create( null );\n\t\t\t\t\t// avoids need for hasOwnProperty\n\t\t\t\t\tfor ( ref in parentRefs ) {\n\t\t\t\t\t\tthis.indexRefs[ ref ] = parentRefs[ ref ];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( options.indexRef ) {\n\t\t\t\tif ( !this.indexRefs ) {\n\t\t\t\t\tthis.indexRefs = {};\n\t\t\t\t}\n\t\t\t\tthis.indexRefs[ options.indexRef ] = options.index;\n\t\t\t}\n\t\t\t// Time to create this fragment's child items\n\t\t\t// TEMP should this be happening?\n\t\t\tif ( typeof options.template === 'string' ) {\n\t\t\t\toptions.template = [ options.template ];\n\t\t\t} else if ( !options.template ) {\n\t\t\t\toptions.template = [];\n\t\t\t}\n\t\t\tthis.items = options.template.map( function( template, i ) {\n\t\t\t\treturn createItem( {\n\t\t\t\t\tparentFragment: this$0,\n\t\t\t\t\tpElement: options.pElement,\n\t\t\t\t\ttemplate: template,\n\t\t\t\t\tindex: i\n\t\t\t\t} );\n\t\t\t} );\n\t\t\tthis.value = this.argsList = null;\n\t\t\tthis.dirtyArgs = this.dirtyValue = true;\n\t\t\tthis.bound = true;\n\t\t};\n\t}( types, create, virtualdom_Fragment$init_createItem );\n\n\t/* virtualdom/Fragment/prototype/rebind.js */\n\tvar virtualdom_Fragment$rebind = function( assignNewKeypath ) {\n\n\t\treturn function Fragment$rebind( indexRef, newIndex, oldKeypath, newKeypath ) {\n\t\t\tthis.index = newIndex;\n\t\t\t// assign new context keypath if needed\n\t\t\tassignNewKeypath( this, 'context', oldKeypath, newKeypath );\n\t\t\tif ( this.indexRefs && this.indexRefs[ indexRef ] !== undefined ) {\n\t\t\t\tthis.indexRefs[ indexRef ] = newIndex;\n\t\t\t}\n\t\t\tthis.items.forEach( function( item ) {\n\t\t\t\tif ( item.rebind ) {\n\t\t\t\t\titem.rebind( indexRef, newIndex, oldKeypath, newKeypath );\n\t\t\t\t}\n\t\t\t} );\n\t\t};\n\t}( assignNewKeypath );\n\n\t/* virtualdom/Fragment/prototype/render.js */\n\tvar virtualdom_Fragment$render = function Fragment$render() {\n\t\tvar result;\n\t\tif ( this.items.length === 1 ) {\n\t\t\tresult = this.items[ 0 ].render();\n\t\t} else {\n\t\t\tresult = document.createDocumentFragment();\n\t\t\tthis.items.forEach( function( item ) {\n\t\t\t\tresult.appendChild( item.render() );\n\t\t\t} );\n\t\t}\n\t\tthis.rendered = true;\n\t\treturn result;\n\t};\n\n\t/* virtualdom/Fragment/prototype/toString.js */\n\tvar virtualdom_Fragment$toString = function Fragment$toString( escape ) {\n\t\tif ( !this.items ) {\n\t\t\treturn '';\n\t\t}\n\t\treturn this.items.map( function( item ) {\n\t\t\treturn item.toString( escape );\n\t\t} ).join( '' );\n\t};\n\n\t/* virtualdom/Fragment/prototype/unbind.js */\n\tvar virtualdom_Fragment$unbind = function() {\n\n\t\tvar __export;\n\t\t__export = function Fragment$unbind() {\n\t\t\tif ( !this.bound ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.items.forEach( unbindItem );\n\t\t\tthis.bound = false;\n\t\t};\n\n\t\tfunction unbindItem( item ) {\n\t\t\tif ( item.unbind ) {\n\t\t\t\titem.unbind();\n\t\t\t}\n\t\t}\n\t\treturn __export;\n\t}();\n\n\t/* virtualdom/Fragment/prototype/unrender.js */\n\tvar virtualdom_Fragment$unrender = function Fragment$unrender( shouldDestroy ) {\n\t\tif ( !this.rendered ) {\n\t\t\tthrow new Error( 'Attempted to unrender a fragment that was not rendered' );\n\t\t}\n\t\tthis.items.forEach( function( i ) {\n\t\t\treturn i.unrender( shouldDestroy );\n\t\t} );\n\t\tthis.rendered = false;\n\t};\n\n\t/* virtualdom/Fragment.js */\n\tvar Fragment = function( bubble, detach, find, findAll, findAllComponents, findComponent, findNextNode, firstNode, getNode, getValue, init, rebind, render, toString, unbind, unrender, circular ) {\n\n\t\tvar Fragment = function( options ) {\n\t\t\tthis.init( options );\n\t\t};\n\t\tFragment.prototype = {\n\t\t\tbubble: bubble,\n\t\t\tdetach: detach,\n\t\t\tfind: find,\n\t\t\tfindAll: findAll,\n\t\t\tfindAllComponents: findAllComponents,\n\t\t\tfindComponent: findComponent,\n\t\t\tfindNextNode: findNextNode,\n\t\t\tfirstNode: firstNode,\n\t\t\tgetNode: getNode,\n\t\t\tgetValue: getValue,\n\t\t\tinit: init,\n\t\t\trebind: rebind,\n\t\t\trender: render,\n\t\t\ttoString: toString,\n\t\t\tunbind: unbind,\n\t\t\tunrender: unrender\n\t\t};\n\t\tcircular.Fragment = Fragment;\n\t\treturn Fragment;\n\t}( virtualdom_Fragment$bubble, virtualdom_Fragment$detach, virtualdom_Fragment$find, virtualdom_Fragment$findAll, virtualdom_Fragment$findAllComponents, virtualdom_Fragment$findComponent, virtualdom_Fragment$findNextNode, virtualdom_Fragment$firstNode, virtualdom_Fragment$getNode, virtualdom_Fragment$getValue, virtualdom_Fragment$init, virtualdom_Fragment$rebind, virtualdom_Fragment$render, virtualdom_Fragment$toString, virtualdom_Fragment$unbind, virtualdom_Fragment$unrender, circular );\n\n\t/* Ractive/prototype/reset.js */\n\tvar Ractive$reset = function( Hook, runloop, Fragment, config ) {\n\n\t\tvar shouldRerender = [\n\t\t\t\t'template',\n\t\t\t\t'partials',\n\t\t\t\t'components',\n\t\t\t\t'decorators',\n\t\t\t\t'events'\n\t\t\t],\n\t\t\tresetHook = new Hook( 'reset' );\n\t\treturn function Ractive$reset( data, callback ) {\n\t\t\tvar promise, wrapper, changes, i, rerender;\n\t\t\tif ( typeof data === 'function' && !callback ) {\n\t\t\t\tcallback = data;\n\t\t\t\tdata = {};\n\t\t\t} else {\n\t\t\t\tdata = data || {};\n\t\t\t}\n\t\t\tif ( typeof data !== 'object' ) {\n\t\t\t\tthrow new Error( 'The reset method takes either no arguments, or an object containing new data' );\n\t\t\t}\n\t\t\t// If the root object is wrapped, try and use the wrapper's reset value\n\t\t\tif ( ( wrapper = this.viewmodel.wrapped[ '' ] ) && wrapper.reset ) {\n\t\t\t\tif ( wrapper.reset( data ) === false ) {\n\t\t\t\t\t// reset was rejected, we need to replace the object\n\t\t\t\t\tthis.data = data;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.data = data;\n\t\t\t}\n\t\t\t// reset config items and track if need to rerender\n\t\t\tchanges = config.reset( this );\n\t\t\ti = changes.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( shouldRerender.indexOf( changes[ i ] ) > -1 ) {\n\t\t\t\t\trerender = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( rerender ) {\n\t\t\t\tvar component;\n\t\t\t\tthis.viewmodel.mark( '' );\n\t\t\t\t// Is this is a component, we need to set the `shouldDestroy`\n\t\t\t\t// flag, otherwise it will assume by default that a parent node\n\t\t\t\t// will be detached, and therefore it doesn't need to bother\n\t\t\t\t// detaching its own nodes\n\t\t\t\tif ( component = this.component ) {\n\t\t\t\t\tcomponent.shouldDestroy = true;\n\t\t\t\t}\n\t\t\t\tthis.unrender();\n\t\t\t\tif ( component ) {\n\t\t\t\t\tcomponent.shouldDestroy = false;\n\t\t\t\t}\n\t\t\t\t// If the template changed, we need to destroy the parallel DOM\n\t\t\t\t// TODO if we're here, presumably it did?\n\t\t\t\tif ( this.fragment.template !== this.template ) {\n\t\t\t\t\tthis.fragment.unbind();\n\t\t\t\t\tthis.fragment = new Fragment( {\n\t\t\t\t\t\ttemplate: this.template,\n\t\t\t\t\t\troot: this,\n\t\t\t\t\t\towner: this\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\tpromise = this.render( this.el, this.anchor );\n\t\t\t} else {\n\t\t\t\tpromise = runloop.start( this, true );\n\t\t\t\tthis.viewmodel.mark( '' );\n\t\t\t\trunloop.end();\n\t\t\t}\n\t\t\tresetHook.fire( this, data );\n\t\t\tif ( callback ) {\n\t\t\t\tpromise.then( callback );\n\t\t\t}\n\t\t\treturn promise;\n\t\t};\n\t}( Ractive$shared_hooks_Hook, runloop, Fragment, config );\n\n\t/* Ractive/prototype/resetTemplate.js */\n\tvar Ractive$resetTemplate = function( config, Fragment ) {\n\n\t\treturn function Ractive$resetTemplate( template ) {\n\t\t\tvar transitionsEnabled, component;\n\t\t\tconfig.template.init( null, this, {\n\t\t\t\ttemplate: template\n\t\t\t} );\n\t\t\ttransitionsEnabled = this.transitionsEnabled;\n\t\t\tthis.transitionsEnabled = false;\n\t\t\t// Is this is a component, we need to set the `shouldDestroy`\n\t\t\t// flag, otherwise it will assume by default that a parent node\n\t\t\t// will be detached, and therefore it doesn't need to bother\n\t\t\t// detaching its own nodes\n\t\t\tif ( component = this.component ) {\n\t\t\t\tcomponent.shouldDestroy = true;\n\t\t\t}\n\t\t\tthis.unrender();\n\t\t\tif ( component ) {\n\t\t\t\tcomponent.shouldDestroy = false;\n\t\t\t}\n\t\t\t// remove existing fragment and create new one\n\t\t\tthis.fragment.unbind();\n\t\t\tthis.fragment = new Fragment( {\n\t\t\t\ttemplate: this.template,\n\t\t\t\troot: this,\n\t\t\t\towner: this\n\t\t\t} );\n\t\t\tthis.render( this.el, this.anchor );\n\t\t\tthis.transitionsEnabled = transitionsEnabled;\n\t\t};\n\t}( config, Fragment );\n\n\t/* Ractive/prototype/reverse.js */\n\tvar Ractive$reverse = function( makeArrayMethod ) {\n\n\t\treturn makeArrayMethod( 'reverse' );\n\t}( Ractive$shared_makeArrayMethod );\n\n\t/* Ractive/prototype/set.js */\n\tvar Ractive$set = function( runloop, isObject, normaliseKeypath, getMatchingKeypaths ) {\n\n\t\tvar wildcard = /\\*/;\n\t\treturn function Ractive$set( keypath, value, callback ) {\n\t\t\tvar this$0 = this;\n\t\t\tvar map, promise;\n\t\t\tpromise = runloop.start( this, true );\n\t\t\t// Set multiple keypaths in one go\n\t\t\tif ( isObject( keypath ) ) {\n\t\t\t\tmap = keypath;\n\t\t\t\tcallback = value;\n\t\t\t\tfor ( keypath in map ) {\n\t\t\t\t\tif ( map.hasOwnProperty( keypath ) ) {\n\t\t\t\t\t\tvalue = map[ keypath ];\n\t\t\t\t\t\tkeypath = normaliseKeypath( keypath );\n\t\t\t\t\t\tthis.viewmodel.set( keypath, value );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tkeypath = normaliseKeypath( keypath );\n\t\t\t\tif ( wildcard.test( keypath ) ) {\n\t\t\t\t\tgetMatchingKeypaths( this, keypath ).forEach( function( keypath ) {\n\t\t\t\t\t\tthis$0.viewmodel.set( keypath, value );\n\t\t\t\t\t} );\n\t\t\t\t} else {\n\t\t\t\t\tthis.viewmodel.set( keypath, value );\n\t\t\t\t}\n\t\t\t}\n\t\t\trunloop.end();\n\t\t\tif ( callback ) {\n\t\t\t\tpromise.then( callback.bind( this ) );\n\t\t\t}\n\t\t\treturn promise;\n\t\t};\n\t}( runloop, isObject, normaliseKeypath, getMatchingKeypaths );\n\n\t/* Ractive/prototype/shift.js */\n\tvar Ractive$shift = function( makeArrayMethod ) {\n\n\t\treturn makeArrayMethod( 'shift' );\n\t}( Ractive$shared_makeArrayMethod );\n\n\t/* Ractive/prototype/sort.js */\n\tvar Ractive$sort = function( makeArrayMethod ) {\n\n\t\treturn makeArrayMethod( 'sort' );\n\t}( Ractive$shared_makeArrayMethod );\n\n\t/* Ractive/prototype/splice.js */\n\tvar Ractive$splice = function( makeArrayMethod ) {\n\n\t\treturn makeArrayMethod( 'splice' );\n\t}( Ractive$shared_makeArrayMethod );\n\n\t/* Ractive/prototype/subtract.js */\n\tvar Ractive$subtract = function( add ) {\n\n\t\treturn function Ractive$subtract( keypath, d ) {\n\t\t\treturn add( this, keypath, d === undefined ? -1 : -d );\n\t\t};\n\t}( Ractive$shared_add );\n\n\t/* Ractive/prototype/teardown.js */\n\tvar Ractive$teardown = function( Hook, Promise, removeFromArray ) {\n\n\t\tvar teardownHook = new Hook( 'teardown' );\n\t\t// Teardown. This goes through the root fragment and all its children, removing observers\n\t\t// and generally cleaning up after itself\n\t\treturn function Ractive$teardown( callback ) {\n\t\t\tvar promise;\n\t\t\tthis.fragment.unbind();\n\t\t\tthis.viewmodel.teardown();\n\t\t\tif ( this.fragment.rendered && this.el.__ractive_instances__ ) {\n\t\t\t\tremoveFromArray( this.el.__ractive_instances__, this );\n\t\t\t}\n\t\t\tthis.shouldDestroy = true;\n\t\t\tpromise = this.fragment.rendered ? this.unrender() : Promise.resolve();\n\t\t\tteardownHook.fire( this );\n\t\t\tif ( callback ) {\n\t\t\t\t// TODO deprecate this?\n\t\t\t\tpromise.then( callback.bind( this ) );\n\t\t\t}\n\t\t\treturn promise;\n\t\t};\n\t}( Ractive$shared_hooks_Hook, Promise, removeFromArray );\n\n\t/* Ractive/prototype/toggle.js */\n\tvar Ractive$toggle = function( log ) {\n\n\t\treturn function Ractive$toggle( keypath, callback ) {\n\t\t\tvar value;\n\t\t\tif ( typeof keypath !== 'string' ) {\n\t\t\t\tlog.errorOnly( {\n\t\t\t\t\tdebug: this.debug,\n\t\t\t\t\tmesssage: 'badArguments',\n\t\t\t\t\targ: {\n\t\t\t\t\t\targuments: keypath\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t\tvalue = this.get( keypath );\n\t\t\treturn this.set( keypath, !value, callback );\n\t\t};\n\t}( log );\n\n\t/* Ractive/prototype/toHTML.js */\n\tvar Ractive$toHTML = function Ractive$toHTML() {\n\t\treturn this.fragment.toString( true );\n\t};\n\n\t/* Ractive/prototype/unrender.js */\n\tvar Ractive$unrender = function( css, Hook, log, Promise, removeFromArray, runloop ) {\n\n\t\tvar unrenderHook = new Hook( 'unrender' );\n\t\treturn function Ractive$unrender() {\n\t\t\tvar this$0 = this;\n\t\t\tvar promise, shouldDestroy;\n\t\t\tif ( !this.fragment.rendered ) {\n\t\t\t\tlog.warn( {\n\t\t\t\t\tdebug: this.debug,\n\t\t\t\t\tmessage: 'ractive.unrender() was called on a Ractive instance that was not rendered'\n\t\t\t\t} );\n\t\t\t\treturn Promise.resolve();\n\t\t\t}\n\t\t\tpromise = runloop.start( this, true );\n\t\t\t// If this is a component, and the component isn't marked for destruction,\n\t\t\t// don't detach nodes from the DOM unnecessarily\n\t\t\tshouldDestroy = !this.component || this.component.shouldDestroy || this.shouldDestroy;\n\t\t\tif ( this.constructor.css ) {\n\t\t\t\tpromise.then( function() {\n\t\t\t\t\tcss.remove( this$0.constructor );\n\t\t\t\t} );\n\t\t\t}\n\t\t\t// Cancel any animations in progress\n\t\t\twhile ( this._animations[ 0 ] ) {\n\t\t\t\tthis._animations[ 0 ].stop();\n\t\t\t}\n\t\t\tthis.fragment.unrender( shouldDestroy );\n\t\t\tremoveFromArray( this.el.__ractive_instances__, this );\n\t\t\tunrenderHook.fire( this );\n\t\t\trunloop.end();\n\t\t\treturn promise;\n\t\t};\n\t}( global_css, Ractive$shared_hooks_Hook, log, Promise, removeFromArray, runloop );\n\n\t/* Ractive/prototype/unshift.js */\n\tvar Ractive$unshift = function( makeArrayMethod ) {\n\n\t\treturn makeArrayMethod( 'unshift' );\n\t}( Ractive$shared_makeArrayMethod );\n\n\t/* Ractive/prototype/update.js */\n\tvar Ractive$update = function( Hook, runloop ) {\n\n\t\tvar updateHook = new Hook( 'update' );\n\t\treturn function Ractive$update( keypath, callback ) {\n\t\t\tvar promise;\n\t\t\tif ( typeof keypath === 'function' ) {\n\t\t\t\tcallback = keypath;\n\t\t\t\tkeypath = '';\n\t\t\t} else {\n\t\t\t\tkeypath = keypath || '';\n\t\t\t}\n\t\t\tpromise = runloop.start( this, true );\n\t\t\tthis.viewmodel.mark( keypath );\n\t\t\trunloop.end();\n\t\t\tupdateHook.fire( this, keypath );\n\t\t\tif ( callback ) {\n\t\t\t\tpromise.then( callback.bind( this ) );\n\t\t\t}\n\t\t\treturn promise;\n\t\t};\n\t}( Ractive$shared_hooks_Hook, runloop );\n\n\t/* Ractive/prototype/updateModel.js */\n\tvar Ractive$updateModel = function( arrayContentsMatch, isEqual ) {\n\n\t\tvar __export;\n\t\t__export = function Ractive$updateModel( keypath, cascade ) {\n\t\t\tvar values;\n\t\t\tif ( typeof keypath !== 'string' ) {\n\t\t\t\tkeypath = '';\n\t\t\t\tcascade = true;\n\t\t\t}\n\t\t\tconsolidateChangedValues( this, keypath, values = {}, cascade );\n\t\t\treturn this.set( values );\n\t\t};\n\n\t\tfunction consolidateChangedValues( ractive, keypath, values, cascade ) {\n\t\t\tvar bindings, childDeps, i, binding, oldValue, newValue, checkboxGroups = [];\n\t\t\tbindings = ractive._twowayBindings[ keypath ];\n\t\t\tif ( bindings && ( i = bindings.length ) ) {\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tbinding = bindings[ i ];\n\t\t\t\t\t// special case - radio name bindings\n\t\t\t\t\tif ( binding.radioName && !binding.element.node.checked ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t// special case - checkbox name bindings come in groups, so\n\t\t\t\t\t// we want to get the value once at most\n\t\t\t\t\tif ( binding.checkboxName ) {\n\t\t\t\t\t\tif ( !checkboxGroups[ binding.keypath ] && !binding.changed() ) {\n\t\t\t\t\t\t\tcheckboxGroups.push( binding.keypath );\n\t\t\t\t\t\t\tcheckboxGroups[ binding.keypath ] = binding;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\toldValue = binding.attribute.value;\n\t\t\t\t\tnewValue = binding.getValue();\n\t\t\t\t\tif ( arrayContentsMatch( oldValue, newValue ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif ( !isEqual( oldValue, newValue ) ) {\n\t\t\t\t\t\tvalues[ keypath ] = newValue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Handle groups of `<input type='checkbox' name='{{foo}}' ...>`\n\t\t\tif ( checkboxGroups.length ) {\n\t\t\t\tcheckboxGroups.forEach( function( keypath ) {\n\t\t\t\t\tvar binding, oldValue, newValue;\n\t\t\t\t\tbinding = checkboxGroups[ keypath ];\n\t\t\t\t\t// one to represent the entire group\n\t\t\t\t\toldValue = binding.attribute.value;\n\t\t\t\t\tnewValue = binding.getValue();\n\t\t\t\t\tif ( !arrayContentsMatch( oldValue, newValue ) ) {\n\t\t\t\t\t\tvalues[ keypath ] = newValue;\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t\tif ( !cascade ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// cascade\n\t\t\tchildDeps = ractive.viewmodel.depsMap[ 'default' ][ keypath ];\n\t\t\tif ( childDeps ) {\n\t\t\t\ti = childDeps.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tconsolidateChangedValues( ractive, childDeps[ i ], values, cascade );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn __export;\n\t}( arrayContentsMatch, isEqual );\n\n\t/* Ractive/prototype.js */\n\tvar prototype = function( add, animate, detach, find, findAll, findAllComponents, findComponent, fire, get, insert, merge, observe, off, on, pop, push, render, reset, resetTemplate, reverse, set, shift, sort, splice, subtract, teardown, toggle, toHTML, unrender, unshift, update, updateModel ) {\n\n\t\treturn {\n\t\t\tadd: add,\n\t\t\tanimate: animate,\n\t\t\tdetach: detach,\n\t\t\tfind: find,\n\t\t\tfindAll: findAll,\n\t\t\tfindAllComponents: findAllComponents,\n\t\t\tfindComponent: findComponent,\n\t\t\tfire: fire,\n\t\t\tget: get,\n\t\t\tinsert: insert,\n\t\t\tmerge: merge,\n\t\t\tobserve: observe,\n\t\t\toff: off,\n\t\t\ton: on,\n\t\t\tpop: pop,\n\t\t\tpush: push,\n\t\t\trender: render,\n\t\t\treset: reset,\n\t\t\tresetTemplate: resetTemplate,\n\t\t\treverse: reverse,\n\t\t\tset: set,\n\t\t\tshift: shift,\n\t\t\tsort: sort,\n\t\t\tsplice: splice,\n\t\t\tsubtract: subtract,\n\t\t\tteardown: teardown,\n\t\t\ttoggle: toggle,\n\t\t\ttoHTML: toHTML,\n\t\t\tunrender: unrender,\n\t\t\tunshift: unshift,\n\t\t\tupdate: update,\n\t\t\tupdateModel: updateModel\n\t\t};\n\t}( Ractive$add, Ractive$animate, Ractive$detach, Ractive$find, Ractive$findAll, Ractive$findAllComponents, Ractive$findComponent, Ractive$fire, Ractive$get, Ractive$insert, Ractive$merge, Ractive$observe, Ractive$off, Ractive$on, Ractive$pop, Ractive$push, Ractive$render, Ractive$reset, Ractive$resetTemplate, Ractive$reverse, Ractive$set, Ractive$shift, Ractive$sort, Ractive$splice, Ractive$subtract, Ractive$teardown, Ractive$toggle, Ractive$toHTML, Ractive$unrender, Ractive$unshift, Ractive$update, Ractive$updateModel );\n\n\t/* utils/getGuid.js */\n\tvar getGuid = function() {\n\t\treturn 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace( /[xy]/g, function( c ) {\n\t\t\tvar r, v;\n\t\t\tr = Math.random() * 16 | 0;\n\t\t\tv = c == 'x' ? r : r & 3 | 8;\n\t\t\treturn v.toString( 16 );\n\t\t} );\n\t};\n\n\t/* utils/getNextNumber.js */\n\tvar getNextNumber = function() {\n\n\t\tvar i = 0;\n\t\treturn function() {\n\t\t\treturn 'r-' + i++;\n\t\t};\n\t}();\n\n\t/* Ractive/prototype/shared/hooks/HookQueue.js */\n\tvar Ractive$shared_hooks_HookQueue = function( Hook ) {\n\n\t\tfunction HookQueue( event ) {\n\t\t\tthis.hook = new Hook( event );\n\t\t\tthis.inProcess = {};\n\t\t\tthis.queue = {};\n\t\t}\n\t\tHookQueue.prototype = {\n\t\t\tconstructor: HookQueue,\n\t\t\tbegin: function( ractive ) {\n\t\t\t\tthis.inProcess[ ractive._guid ] = true;\n\t\t\t},\n\t\t\tend: function( ractive ) {\n\t\t\t\tvar parent = ractive._parent;\n\t\t\t\t// If this is *isn't* a child of a component that's in process,\n\t\t\t\t// it should call methods or fire at this point\n\t\t\t\tif ( !parent || !this.inProcess[ parent._guid ] ) {\n\t\t\t\t\tfire( this, ractive );\n\t\t\t\t} else {\n\t\t\t\t\tgetChildQueue( this.queue, parent ).push( ractive );\n\t\t\t\t}\n\t\t\t\tdelete this.inProcess[ ractive._guid ];\n\t\t\t}\n\t\t};\n\n\t\tfunction getChildQueue( queue, ractive ) {\n\t\t\treturn queue[ ractive._guid ] || ( queue[ ractive._guid ] = [] );\n\t\t}\n\n\t\tfunction fire( hookQueue, ractive ) {\n\t\t\tvar childQueue = getChildQueue( hookQueue.queue, ractive );\n\t\t\thookQueue.hook.fire( ractive );\n\t\t\t// queue is \"live\" because components can end up being\n\t\t\t// added while hooks fire on parents that modify data values.\n\t\t\twhile ( childQueue.length ) {\n\t\t\t\tfire( hookQueue, childQueue.shift() );\n\t\t\t}\n\t\t\tdelete hookQueue.queue[ ractive._guid ];\n\t\t}\n\t\treturn HookQueue;\n\t}( Ractive$shared_hooks_Hook );\n\n\t/* viewmodel/prototype/get/arrayAdaptor/processWrapper.js */\n\tvar viewmodel$get_arrayAdaptor_processWrapper = function( wrapper, array, methodName, newIndices ) {\n\t\tvar root = wrapper.root,\n\t\t\tkeypath = wrapper.keypath;\n\t\t// If this is a sort or reverse, we just do root.set()...\n\t\t// TODO use merge logic?\n\t\tif ( methodName === 'sort' || methodName === 'reverse' ) {\n\t\t\troot.viewmodel.set( keypath, array );\n\t\t\treturn;\n\t\t}\n\t\troot.viewmodel.smartUpdate( keypath, array, newIndices );\n\t};\n\n\t/* viewmodel/prototype/get/arrayAdaptor/patch.js */\n\tvar viewmodel$get_arrayAdaptor_patch = function( runloop, defineProperty, getNewIndices, processWrapper ) {\n\n\t\tvar patchedArrayProto = [],\n\t\t\tmutatorMethods = [\n\t\t\t\t'pop',\n\t\t\t\t'push',\n\t\t\t\t'reverse',\n\t\t\t\t'shift',\n\t\t\t\t'sort',\n\t\t\t\t'splice',\n\t\t\t\t'unshift'\n\t\t\t],\n\t\t\ttestObj, patchArrayMethods, unpatchArrayMethods;\n\t\tmutatorMethods.forEach( function( methodName ) {\n\t\t\tvar method = function() {\n\t\t\t\tvar SLICE$0 = Array.prototype.slice;\n\t\t\t\tvar args = SLICE$0.call( arguments, 0 );\n\t\t\t\tvar newIndices, result, wrapper, i;\n\t\t\t\tnewIndices = getNewIndices( this, methodName, args );\n\t\t\t\t// apply the underlying method\n\t\t\t\tresult = Array.prototype[ methodName ].apply( this, arguments );\n\t\t\t\t// trigger changes\n\t\t\t\trunloop.start();\n\t\t\t\tthis._ractive.setting = true;\n\t\t\t\ti = this._ractive.wrappers.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\twrapper = this._ractive.wrappers[ i ];\n\t\t\t\t\trunloop.addViewmodel( wrapper.root.viewmodel );\n\t\t\t\t\tprocessWrapper( wrapper, this, methodName, newIndices );\n\t\t\t\t}\n\t\t\t\trunloop.end();\n\t\t\t\tthis._ractive.setting = false;\n\t\t\t\treturn result;\n\t\t\t};\n\t\t\tdefineProperty( patchedArrayProto, methodName, {\n\t\t\t\tvalue: method\n\t\t\t} );\n\t\t} );\n\t\t// can we use prototype chain injection?\n\t\t// http://perfectionkills.com/how-ecmascript-5-still-does-not-allow-to-subclass-an-array/#wrappers_prototype_chain_injection\n\t\ttestObj = {};\n\t\tif ( testObj.__proto__ ) {\n\t\t\t// yes, we can\n\t\t\tpatchArrayMethods = function( array ) {\n\t\t\t\tarray.__proto__ = patchedArrayProto;\n\t\t\t};\n\t\t\tunpatchArrayMethods = function( array ) {\n\t\t\t\tarray.__proto__ = Array.prototype;\n\t\t\t};\n\t\t} else {\n\t\t\t// no, we can't\n\t\t\tpatchArrayMethods = function( array ) {\n\t\t\t\tvar i, methodName;\n\t\t\t\ti = mutatorMethods.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tmethodName = mutatorMethods[ i ];\n\t\t\t\t\tdefineProperty( array, methodName, {\n\t\t\t\t\t\tvalue: patchedArrayProto[ methodName ],\n\t\t\t\t\t\tconfigurable: true\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t};\n\t\t\tunpatchArrayMethods = function( array ) {\n\t\t\t\tvar i;\n\t\t\t\ti = mutatorMethods.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tdelete array[ mutatorMethods[ i ] ];\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\tpatchArrayMethods.unpatch = unpatchArrayMethods;\n\t\treturn patchArrayMethods;\n\t}( runloop, defineProperty, getNewIndices, viewmodel$get_arrayAdaptor_processWrapper );\n\n\t/* viewmodel/prototype/get/arrayAdaptor.js */\n\tvar viewmodel$get_arrayAdaptor = function( defineProperty, isArray, patch ) {\n\n\t\tvar arrayAdaptor,\n\t\t\t// helpers\n\t\t\tArrayWrapper, errorMessage;\n\t\tarrayAdaptor = {\n\t\t\tfilter: function( object ) {\n\t\t\t\t// wrap the array if a) b) it's an array, and b) either it hasn't been wrapped already,\n\t\t\t\t// or the array didn't trigger the get() itself\n\t\t\t\treturn isArray( object ) && ( !object._ractive || !object._ractive.setting );\n\t\t\t},\n\t\t\twrap: function( ractive, array, keypath ) {\n\t\t\t\treturn new ArrayWrapper( ractive, array, keypath );\n\t\t\t}\n\t\t};\n\t\tArrayWrapper = function( ractive, array, keypath ) {\n\t\t\tthis.root = ractive;\n\t\t\tthis.value = array;\n\t\t\tthis.keypath = keypath;\n\t\t\t// if this array hasn't already been ractified, ractify it\n\t\t\tif ( !array._ractive ) {\n\t\t\t\t// define a non-enumerable _ractive property to store the wrappers\n\t\t\t\tdefineProperty( array, '_ractive', {\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\twrappers: [],\n\t\t\t\t\t\tinstances: [],\n\t\t\t\t\t\tsetting: false\n\t\t\t\t\t},\n\t\t\t\t\tconfigurable: true\n\t\t\t\t} );\n\t\t\t\tpatch( array );\n\t\t\t}\n\t\t\t// store the ractive instance, so we can handle transitions later\n\t\t\tif ( !array._ractive.instances[ ractive._guid ] ) {\n\t\t\t\tarray._ractive.instances[ ractive._guid ] = 0;\n\t\t\t\tarray._ractive.instances.push( ractive );\n\t\t\t}\n\t\t\tarray._ractive.instances[ ractive._guid ] += 1;\n\t\t\tarray._ractive.wrappers.push( this );\n\t\t};\n\t\tArrayWrapper.prototype = {\n\t\t\tget: function() {\n\t\t\t\treturn this.value;\n\t\t\t},\n\t\t\tteardown: function() {\n\t\t\t\tvar array, storage, wrappers, instances, index;\n\t\t\t\tarray = this.value;\n\t\t\t\tstorage = array._ractive;\n\t\t\t\twrappers = storage.wrappers;\n\t\t\t\tinstances = storage.instances;\n\t\t\t\t// if teardown() was invoked because we're clearing the cache as a result of\n\t\t\t\t// a change that the array itself triggered, we can save ourselves the teardown\n\t\t\t\t// and immediate setup\n\t\t\t\tif ( storage.setting ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tindex = wrappers.indexOf( this );\n\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\tthrow new Error( errorMessage );\n\t\t\t\t}\n\t\t\t\twrappers.splice( index, 1 );\n\t\t\t\t// if nothing else depends on this array, we can revert it to its\n\t\t\t\t// natural state\n\t\t\t\tif ( !wrappers.length ) {\n\t\t\t\t\tdelete array._ractive;\n\t\t\t\t\tpatch.unpatch( this.value );\n\t\t\t\t} else {\n\t\t\t\t\t// remove ractive instance if possible\n\t\t\t\t\tinstances[ this.root._guid ] -= 1;\n\t\t\t\t\tif ( !instances[ this.root._guid ] ) {\n\t\t\t\t\t\tindex = instances.indexOf( this.root );\n\t\t\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\t\t\tthrow new Error( errorMessage );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tinstances.splice( index, 1 );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\terrorMessage = 'Something went wrong in a rather interesting way';\n\t\treturn arrayAdaptor;\n\t}( defineProperty, isArray, viewmodel$get_arrayAdaptor_patch );\n\n\t/* viewmodel/prototype/get/magicArrayAdaptor.js */\n\tvar viewmodel$get_magicArrayAdaptor = function( magicAdaptor, arrayAdaptor ) {\n\n\t\tvar magicArrayAdaptor, MagicArrayWrapper;\n\t\tif ( magicAdaptor ) {\n\t\t\tmagicArrayAdaptor = {\n\t\t\t\tfilter: function( object, keypath, ractive ) {\n\t\t\t\t\treturn magicAdaptor.filter( object, keypath, ractive ) && arrayAdaptor.filter( object );\n\t\t\t\t},\n\t\t\t\twrap: function( ractive, array, keypath ) {\n\t\t\t\t\treturn new MagicArrayWrapper( ractive, array, keypath );\n\t\t\t\t}\n\t\t\t};\n\t\t\tMagicArrayWrapper = function( ractive, array, keypath ) {\n\t\t\t\tthis.value = array;\n\t\t\t\tthis.magic = true;\n\t\t\t\tthis.magicWrapper = magicAdaptor.wrap( ractive, array, keypath );\n\t\t\t\tthis.arrayWrapper = arrayAdaptor.wrap( ractive, array, keypath );\n\t\t\t};\n\t\t\tMagicArrayWrapper.prototype = {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn this.value;\n\t\t\t\t},\n\t\t\t\tteardown: function() {\n\t\t\t\t\tthis.arrayWrapper.teardown();\n\t\t\t\t\tthis.magicWrapper.teardown();\n\t\t\t\t},\n\t\t\t\treset: function( value ) {\n\t\t\t\t\treturn this.magicWrapper.reset( value );\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\treturn magicArrayAdaptor;\n\t}( viewmodel$get_magicAdaptor, viewmodel$get_arrayAdaptor );\n\n\t/* viewmodel/prototype/adapt.js */\n\tvar viewmodel$adapt = function( config, arrayAdaptor, log, magicAdaptor, magicArrayAdaptor ) {\n\n\t\tvar __export;\n\t\tvar prefixers = {};\n\t\t__export = function Viewmodel$adapt( keypath, value ) {\n\t\t\tvar ractive = this.ractive,\n\t\t\t\tlen, i, adaptor, wrapped;\n\t\t\t// Do we have an adaptor for this value?\n\t\t\tlen = ractive.adapt.length;\n\t\t\tfor ( i = 0; i < len; i += 1 ) {\n\t\t\t\tadaptor = ractive.adapt[ i ];\n\t\t\t\t// Adaptors can be specified as e.g. [ 'Backbone.Model', 'Backbone.Collection' ] -\n\t\t\t\t// we need to get the actual adaptor if that's the case\n\t\t\t\tif ( typeof adaptor === 'string' ) {\n\t\t\t\t\tvar found = config.registries.adaptors.find( ractive, adaptor );\n\t\t\t\t\tif ( !found ) {\n\t\t\t\t\t\t// will throw. \"return\" for safety, if we downgrade :)\n\t\t\t\t\t\treturn log.critical( {\n\t\t\t\t\t\t\tdebug: ractive.debug,\n\t\t\t\t\t\t\tmessage: 'missingPlugin',\n\t\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\t\tplugin: 'adaptor',\n\t\t\t\t\t\t\t\tname: adaptor\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t\tadaptor = ractive.adapt[ i ] = found;\n\t\t\t\t}\n\t\t\t\tif ( adaptor.filter( value, keypath, ractive ) ) {\n\t\t\t\t\twrapped = this.wrapped[ keypath ] = adaptor.wrap( ractive, value, keypath, getPrefixer( keypath ) );\n\t\t\t\t\twrapped.value = value;\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( ractive.magic ) {\n\t\t\t\tif ( magicArrayAdaptor.filter( value, keypath, ractive ) ) {\n\t\t\t\t\tthis.wrapped[ keypath ] = magicArrayAdaptor.wrap( ractive, value, keypath );\n\t\t\t\t} else if ( magicAdaptor.filter( value, keypath, ractive ) ) {\n\t\t\t\t\tthis.wrapped[ keypath ] = magicAdaptor.wrap( ractive, value, keypath );\n\t\t\t\t}\n\t\t\t} else if ( ractive.modifyArrays && arrayAdaptor.filter( value, keypath, ractive ) ) {\n\t\t\t\tthis.wrapped[ keypath ] = arrayAdaptor.wrap( ractive, value, keypath );\n\t\t\t}\n\t\t\treturn value;\n\t\t};\n\n\t\tfunction prefixKeypath( obj, prefix ) {\n\t\t\tvar prefixed = {},\n\t\t\t\tkey;\n\t\t\tif ( !prefix ) {\n\t\t\t\treturn obj;\n\t\t\t}\n\t\t\tprefix += '.';\n\t\t\tfor ( key in obj ) {\n\t\t\t\tif ( obj.hasOwnProperty( key ) ) {\n\t\t\t\t\tprefixed[ prefix + key ] = obj[ key ];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn prefixed;\n\t\t}\n\n\t\tfunction getPrefixer( rootKeypath ) {\n\t\t\tvar rootDot;\n\t\t\tif ( !prefixers[ rootKeypath ] ) {\n\t\t\t\trootDot = rootKeypath ? rootKeypath + '.' : '';\n\t\t\t\tprefixers[ rootKeypath ] = function( relativeKeypath, value ) {\n\t\t\t\t\tvar obj;\n\t\t\t\t\tif ( typeof relativeKeypath === 'string' ) {\n\t\t\t\t\t\tobj = {};\n\t\t\t\t\t\tobj[ rootDot + relativeKeypath ] = value;\n\t\t\t\t\t\treturn obj;\n\t\t\t\t\t}\n\t\t\t\t\tif ( typeof relativeKeypath === 'object' ) {\n\t\t\t\t\t\t// 'relativeKeypath' is in fact a hash, not a keypath\n\t\t\t\t\t\treturn rootDot ? prefixKeypath( relativeKeypath, rootKeypath ) : relativeKeypath;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn prefixers[ rootKeypath ];\n\t\t}\n\t\treturn __export;\n\t}( config, viewmodel$get_arrayAdaptor, log, viewmodel$get_magicAdaptor, viewmodel$get_magicArrayAdaptor );\n\n\t/* viewmodel/helpers/getUpstreamChanges.js */\n\tvar getUpstreamChanges = function getUpstreamChanges( changes ) {\n\t\tvar upstreamChanges = [ '' ],\n\t\t\ti, keypath, keys, upstreamKeypath;\n\t\ti = changes.length;\n\t\twhile ( i-- ) {\n\t\t\tkeypath = changes[ i ];\n\t\t\tkeys = keypath.split( '.' );\n\t\t\twhile ( keys.length > 1 ) {\n\t\t\t\tkeys.pop();\n\t\t\t\tupstreamKeypath = keys.join( '.' );\n\t\t\t\tif ( upstreamChanges.indexOf( upstreamKeypath ) === -1 ) {\n\t\t\t\t\tupstreamChanges.push( upstreamKeypath );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn upstreamChanges;\n\t};\n\n\t/* viewmodel/prototype/applyChanges/getPotentialWildcardMatches.js */\n\tvar viewmodel$applyChanges_getPotentialWildcardMatches = function() {\n\n\t\tvar __export;\n\t\tvar starMaps = {};\n\t\t// This function takes a keypath such as 'foo.bar.baz', and returns\n\t\t// all the variants of that keypath that include a wildcard in place\n\t\t// of a key, such as 'foo.bar.*', 'foo.*.baz', 'foo.*.*' and so on.\n\t\t// These are then checked against the dependants map (ractive.viewmodel.depsMap)\n\t\t// to see if any pattern observers are downstream of one or more of\n\t\t// these wildcard keypaths (e.g. 'foo.bar.*.status')\n\t\t__export = function getPotentialWildcardMatches( keypath ) {\n\t\t\tvar keys, starMap, mapper, result;\n\t\t\tkeys = keypath.split( '.' );\n\t\t\tstarMap = getStarMap( keys.length );\n\t\t\tmapper = function( star, i ) {\n\t\t\t\treturn star ? '*' : keys[ i ];\n\t\t\t};\n\t\t\tresult = starMap.map( function( mask ) {\n\t\t\t\treturn mask.map( mapper ).join( '.' );\n\t\t\t} );\n\t\t\treturn result;\n\t\t};\n\t\t// This function returns all the possible true/false combinations for\n\t\t// a given number - e.g. for two, the possible combinations are\n\t\t// [ true, true ], [ true, false ], [ false, true ], [ false, false ].\n\t\t// It does so by getting all the binary values between 0 and e.g. 11\n\t\tfunction getStarMap( length ) {\n\t\t\tvar ones = '',\n\t\t\t\tmax, binary, starMap, mapper, i;\n\t\t\tif ( !starMaps[ length ] ) {\n\t\t\t\tstarMap = [];\n\t\t\t\twhile ( ones.length < length ) {\n\t\t\t\t\tones += 1;\n\t\t\t\t}\n\t\t\t\tmax = parseInt( ones, 2 );\n\t\t\t\tmapper = function( digit ) {\n\t\t\t\t\treturn digit === '1';\n\t\t\t\t};\n\t\t\t\tfor ( i = 0; i <= max; i += 1 ) {\n\t\t\t\t\tbinary = i.toString( 2 );\n\t\t\t\t\twhile ( binary.length < length ) {\n\t\t\t\t\t\tbinary = '0' + binary;\n\t\t\t\t\t}\n\t\t\t\t\tstarMap[ i ] = Array.prototype.map.call( binary, mapper );\n\t\t\t\t}\n\t\t\t\tstarMaps[ length ] = starMap;\n\t\t\t}\n\t\t\treturn starMaps[ length ];\n\t\t}\n\t\treturn __export;\n\t}();\n\n\t/* viewmodel/prototype/applyChanges/notifyPatternObservers.js */\n\tvar viewmodel$applyChanges_notifyPatternObservers = function( getPotentialWildcardMatches ) {\n\n\t\tvar __export;\n\t\tvar lastKey = /[^\\.]+$/;\n\t\t__export = notifyPatternObservers;\n\n\t\tfunction notifyPatternObservers( viewmodel, keypath, onlyDirect ) {\n\t\t\tvar potentialWildcardMatches;\n\t\t\tupdateMatchingPatternObservers( viewmodel, keypath );\n\t\t\tif ( onlyDirect ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpotentialWildcardMatches = getPotentialWildcardMatches( keypath );\n\t\t\tpotentialWildcardMatches.forEach( function( upstreamPattern ) {\n\t\t\t\tcascade( viewmodel, upstreamPattern, keypath );\n\t\t\t} );\n\t\t}\n\n\t\tfunction cascade( viewmodel, upstreamPattern, keypath ) {\n\t\t\tvar group, map, actualChildKeypath;\n\t\t\tgroup = viewmodel.depsMap.patternObservers;\n\t\t\tmap = group[ upstreamPattern ];\n\t\t\tif ( map ) {\n\t\t\t\tmap.forEach( function( childKeypath ) {\n\t\t\t\t\tvar key = lastKey.exec( childKeypath )[ 0 ];\n\t\t\t\t\t// 'baz'\n\t\t\t\t\tactualChildKeypath = keypath ? keypath + '.' + key : key;\n\t\t\t\t\t// 'foo.bar.baz'\n\t\t\t\t\tupdateMatchingPatternObservers( viewmodel, actualChildKeypath );\n\t\t\t\t\tcascade( viewmodel, childKeypath, actualChildKeypath );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t\tfunction updateMatchingPatternObservers( viewmodel, keypath ) {\n\t\t\tviewmodel.patternObservers.forEach( function( observer ) {\n\t\t\t\tif ( observer.regex.test( keypath ) ) {\n\t\t\t\t\tobserver.update( keypath );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t\treturn __export;\n\t}( viewmodel$applyChanges_getPotentialWildcardMatches );\n\n\t/* viewmodel/prototype/applyChanges.js */\n\tvar viewmodel$applyChanges = function( getUpstreamChanges, notifyPatternObservers ) {\n\n\t\tvar __export;\n\t\t__export = function Viewmodel$applyChanges() {\n\t\t\tvar this$0 = this;\n\t\t\tvar self = this,\n\t\t\t\tchanges, upstreamChanges, hash = {};\n\t\t\tchanges = this.changes;\n\t\t\tif ( !changes.length ) {\n\t\t\t\t// TODO we end up here on initial render. Perhaps we shouldn't?\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfunction cascade( keypath ) {\n\t\t\t\tvar map, dependants, keys;\n\t\t\t\tif ( self.noCascade.hasOwnProperty( keypath ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif ( dependants = self.deps.computed[ keypath ] ) {\n\t\t\t\t\tdependants.forEach( invalidate );\n\t\t\t\t\tkeys = dependants.map( getKey );\n\t\t\t\t\tkeys.forEach( mark );\n\t\t\t\t\tkeys.forEach( cascade );\n\t\t\t\t}\n\t\t\t\tif ( map = self.depsMap.computed[ keypath ] ) {\n\t\t\t\t\tmap.forEach( cascade );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction mark( keypath ) {\n\t\t\t\tself.mark( keypath );\n\t\t\t}\n\t\t\tchanges.forEach( cascade );\n\t\t\tupstreamChanges = getUpstreamChanges( changes );\n\t\t\tupstreamChanges.forEach( function( keypath ) {\n\t\t\t\tvar dependants, keys;\n\t\t\t\tif ( dependants = self.deps.computed[ keypath ] ) {\n\t\t\t\t\tdependants.forEach( invalidate );\n\t\t\t\t\tkeys = dependants.map( getKey );\n\t\t\t\t\tkeys.forEach( mark );\n\t\t\t\t\tkeys.forEach( cascade );\n\t\t\t\t}\n\t\t\t} );\n\t\t\tthis.changes = [];\n\t\t\t// Pattern observers are a weird special case\n\t\t\tif ( this.patternObservers.length ) {\n\t\t\t\tupstreamChanges.forEach( function( keypath ) {\n\t\t\t\t\treturn notifyPatternObservers( this$0, keypath, true );\n\t\t\t\t} );\n\t\t\t\tchanges.forEach( function( keypath ) {\n\t\t\t\t\treturn notifyPatternObservers( this$0, keypath );\n\t\t\t\t} );\n\t\t\t}\n\t\t\tif ( this.deps.observers ) {\n\t\t\t\tupstreamChanges.forEach( function( keypath ) {\n\t\t\t\t\treturn notifyUpstreamDependants( this$0, null, keypath, 'observers' );\n\t\t\t\t} );\n\t\t\t\tnotifyAllDependants( this, changes, 'observers' );\n\t\t\t}\n\t\t\tif ( this.deps[ 'default' ] ) {\n\t\t\t\tvar bindings = [];\n\t\t\t\tupstreamChanges.forEach( function( keypath ) {\n\t\t\t\t\treturn notifyUpstreamDependants( this$0, bindings, keypath, 'default' );\n\t\t\t\t} );\n\t\t\t\tif ( bindings.length ) {\n\t\t\t\t\tnotifyBindings( this, bindings, changes );\n\t\t\t\t}\n\t\t\t\tnotifyAllDependants( this, changes, 'default' );\n\t\t\t}\n\t\t\t// Return a hash of keypaths to updated values\n\t\t\tchanges.forEach( function( keypath ) {\n\t\t\t\thash[ keypath ] = this$0.get( keypath );\n\t\t\t} );\n\t\t\tthis.implicitChanges = {};\n\t\t\tthis.noCascade = {};\n\t\t\treturn hash;\n\t\t};\n\n\t\tfunction invalidate( computation ) {\n\t\t\tcomputation.invalidate();\n\t\t}\n\n\t\tfunction getKey( computation ) {\n\t\t\treturn computation.key;\n\t\t}\n\n\t\tfunction notifyUpstreamDependants( viewmodel, bindings, keypath, groupName ) {\n\t\t\tvar dependants, value;\n\t\t\tif ( dependants = findDependants( viewmodel, keypath, groupName ) ) {\n\t\t\t\tvalue = viewmodel.get( keypath );\n\t\t\t\tdependants.forEach( function( d ) {\n\t\t\t\t\t// don't \"set\" the parent value, refine it\n\t\t\t\t\t// i.e. not data = value, but data[foo] = fooValue\n\t\t\t\t\tif ( bindings && d.refineValue ) {\n\t\t\t\t\t\tbindings.push( d );\n\t\t\t\t\t} else {\n\t\t\t\t\t\td.setValue( value );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t\tfunction notifyBindings( viewmodel, bindings, changes ) {\n\t\t\tbindings.forEach( function( binding ) {\n\t\t\t\tvar useSet = false,\n\t\t\t\t\ti = 0,\n\t\t\t\t\tlength = changes.length,\n\t\t\t\t\trefinements = [];\n\t\t\t\twhile ( i < length ) {\n\t\t\t\t\tvar keypath = changes[ i ];\n\t\t\t\t\tif ( keypath === binding.keypath ) {\n\t\t\t\t\t\tuseSet = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif ( keypath.slice( 0, binding.keypath.length ) === binding.keypath ) {\n\t\t\t\t\t\trefinements.push( keypath );\n\t\t\t\t\t}\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t\tif ( useSet ) {\n\t\t\t\t\tbinding.setValue( viewmodel.get( binding.keypath ) );\n\t\t\t\t}\n\t\t\t\tif ( refinements.length ) {\n\t\t\t\t\tbinding.refineValue( refinements );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\tfunction notifyAllDependants( viewmodel, keypaths, groupName ) {\n\t\t\tvar queue = [];\n\t\t\taddKeypaths( keypaths );\n\t\t\tqueue.forEach( dispatch );\n\n\t\t\tfunction addKeypaths( keypaths ) {\n\t\t\t\tkeypaths.forEach( addKeypath );\n\t\t\t\tkeypaths.forEach( cascade );\n\t\t\t}\n\n\t\t\tfunction addKeypath( keypath ) {\n\t\t\t\tvar deps = findDependants( viewmodel, keypath, groupName );\n\t\t\t\tif ( deps ) {\n\t\t\t\t\tqueue.push( {\n\t\t\t\t\t\tkeypath: keypath,\n\t\t\t\t\t\tdeps: deps\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction cascade( keypath ) {\n\t\t\t\tvar childDeps;\n\t\t\t\tif ( childDeps = viewmodel.depsMap[ groupName ][ keypath ] ) {\n\t\t\t\t\taddKeypaths( childDeps );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction dispatch( set ) {\n\t\t\t\tvar value = viewmodel.get( set.keypath );\n\t\t\t\tset.deps.forEach( function( d ) {\n\t\t\t\t\treturn d.setValue( value );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t\tfunction findDependants( viewmodel, keypath, groupName ) {\n\t\t\tvar group = viewmodel.deps[ groupName ];\n\t\t\treturn group ? group[ keypath ] : null;\n\t\t}\n\t\treturn __export;\n\t}( getUpstreamChanges, viewmodel$applyChanges_notifyPatternObservers );\n\n\t/* viewmodel/prototype/capture.js */\n\tvar viewmodel$capture = function Viewmodel$capture() {\n\t\tthis.captureGroups.push( [] );\n\t};\n\n\t/* viewmodel/prototype/clearCache.js */\n\tvar viewmodel$clearCache = function Viewmodel$clearCache( keypath, dontTeardownWrapper ) {\n\t\tvar cacheMap, wrapper;\n\t\tif ( !dontTeardownWrapper ) {\n\t\t\t// Is there a wrapped property at this keypath?\n\t\t\tif ( wrapper = this.wrapped[ keypath ] ) {\n\t\t\t\t// Did we unwrap it?\n\t\t\t\tif ( wrapper.teardown() !== false ) {\n\t\t\t\t\t// Is this right?\n\t\t\t\t\t// What's the meaning of returning false from teardown?\n\t\t\t\t\t// Could there be a GC ramification if this is a \"real\" ractive.teardown()?\n\t\t\t\t\tthis.wrapped[ keypath ] = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.cache[ keypath ] = undefined;\n\t\tif ( cacheMap = this.cacheMap[ keypath ] ) {\n\t\t\twhile ( cacheMap.length ) {\n\t\t\t\tthis.clearCache( cacheMap.pop() );\n\t\t\t}\n\t\t}\n\t};\n\n\t/* viewmodel/Computation/getComputationSignature.js */\n\tvar getComputationSignature = function() {\n\n\t\tvar __export;\n\t\tvar pattern = /\\$\\{([^\\}]+)\\}/g;\n\t\t__export = function( signature ) {\n\t\t\tif ( typeof signature === 'function' ) {\n\t\t\t\treturn {\n\t\t\t\t\tget: signature\n\t\t\t\t};\n\t\t\t}\n\t\t\tif ( typeof signature === 'string' ) {\n\t\t\t\treturn {\n\t\t\t\t\tget: createFunctionFromString( signature )\n\t\t\t\t};\n\t\t\t}\n\t\t\tif ( typeof signature === 'object' && typeof signature.get === 'string' ) {\n\t\t\t\tsignature = {\n\t\t\t\t\tget: createFunctionFromString( signature.get ),\n\t\t\t\t\tset: signature.set\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn signature;\n\t\t};\n\n\t\tfunction createFunctionFromString( signature ) {\n\t\t\tvar functionBody = 'var __ractive=this;return(' + signature.replace( pattern, function( match, keypath ) {\n\t\t\t\treturn '__ractive.get(\"' + keypath + '\")';\n\t\t\t} ) + ')';\n\t\t\treturn new Function( functionBody );\n\t\t}\n\t\treturn __export;\n\t}();\n\n\t/* viewmodel/Computation/Computation.js */\n\tvar Computation = function( log, isEqual ) {\n\n\t\tvar Computation = function( ractive, key, signature ) {\n\t\t\tvar this$0 = this;\n\t\t\tthis.ractive = ractive;\n\t\t\tthis.viewmodel = ractive.viewmodel;\n\t\t\tthis.key = key;\n\t\t\tthis.getter = signature.get;\n\t\t\tthis.setter = signature.set;\n\t\t\tthis.hardDeps = signature.deps || [];\n\t\t\tthis.softDeps = [];\n\t\t\tthis.depValues = {};\n\t\t\tif ( this.hardDeps ) {\n\t\t\t\tthis.hardDeps.forEach( function( d ) {\n\t\t\t\t\treturn ractive.viewmodel.register( d, this$0, 'computed' );\n\t\t\t\t} );\n\t\t\t}\n\t\t\tthis._dirty = this._firstRun = true;\n\t\t};\n\t\tComputation.prototype = {\n\t\t\tconstructor: Computation,\n\t\t\tinit: function() {\n\t\t\t\tvar initial;\n\t\t\t\tthis.bypass = true;\n\t\t\t\tinitial = this.ractive.viewmodel.get( this.key );\n\t\t\t\tthis.ractive.viewmodel.clearCache( this.key );\n\t\t\t\tthis.bypass = false;\n\t\t\t\tif ( this.setter && initial !== undefined ) {\n\t\t\t\t\tthis.set( initial );\n\t\t\t\t}\n\t\t\t},\n\t\t\tinvalidate: function() {\n\t\t\t\tthis._dirty = true;\n\t\t\t},\n\t\t\tget: function() {\n\t\t\t\tvar this$0 = this;\n\t\t\t\tvar ractive, newDeps, dependenciesChanged, dependencyValuesChanged = false;\n\t\t\t\tif ( this.getting ) {\n\t\t\t\t\t// prevent double-computation (e.g. caused by array mutation inside computation)\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.getting = true;\n\t\t\t\tif ( this._dirty ) {\n\t\t\t\t\tractive = this.ractive;\n\t\t\t\t\t// determine whether the inputs have changed, in case this depends on\n\t\t\t\t\t// other computed values\n\t\t\t\t\tif ( this._firstRun || !this.hardDeps.length && !this.softDeps.length ) {\n\t\t\t\t\t\tdependencyValuesChanged = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis.hardDeps,\n\t\t\t\t\t\t\tthis.softDeps\n\t\t\t\t\t\t].forEach( function( deps ) {\n\t\t\t\t\t\t\tvar keypath, value, i;\n\t\t\t\t\t\t\tif ( dependencyValuesChanged ) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ti = deps.length;\n\t\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\t\tkeypath = deps[ i ];\n\t\t\t\t\t\t\t\tvalue = ractive.viewmodel.get( keypath );\n\t\t\t\t\t\t\t\tif ( !isEqual( value, this$0.depValues[ keypath ] ) ) {\n\t\t\t\t\t\t\t\t\tthis$0.depValues[ keypath ] = value;\n\t\t\t\t\t\t\t\t\tdependencyValuesChanged = true;\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t\tif ( dependencyValuesChanged ) {\n\t\t\t\t\t\tractive.viewmodel.capture();\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tthis.value = this.getter.call( ractive );\n\t\t\t\t\t\t} catch ( err ) {\n\t\t\t\t\t\t\tlog.warn( {\n\t\t\t\t\t\t\t\tdebug: ractive.debug,\n\t\t\t\t\t\t\t\tmessage: 'failedComputation',\n\t\t\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\t\t\tkey: this.key,\n\t\t\t\t\t\t\t\t\terr: err.message || err\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\tthis.value = void 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnewDeps = ractive.viewmodel.release();\n\t\t\t\t\t\tdependenciesChanged = this.updateDependencies( newDeps );\n\t\t\t\t\t\tif ( dependenciesChanged ) {\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tthis.hardDeps,\n\t\t\t\t\t\t\t\tthis.softDeps\n\t\t\t\t\t\t\t].forEach( function( deps ) {\n\t\t\t\t\t\t\t\tdeps.forEach( function( keypath ) {\n\t\t\t\t\t\t\t\t\tthis$0.depValues[ keypath ] = ractive.viewmodel.get( keypath );\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis._dirty = false;\n\t\t\t\t}\n\t\t\t\tthis.getting = this._firstRun = false;\n\t\t\t\treturn this.value;\n\t\t\t},\n\t\t\tset: function( value ) {\n\t\t\t\tif ( this.setting ) {\n\t\t\t\t\tthis.value = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif ( !this.setter ) {\n\t\t\t\t\tthrow new Error( 'Computed properties without setters are read-only. (This may change in a future version of Ractive!)' );\n\t\t\t\t}\n\t\t\t\tthis.setter.call( this.ractive, value );\n\t\t\t},\n\t\t\tupdateDependencies: function( newDeps ) {\n\t\t\t\tvar i, oldDeps, keypath, dependenciesChanged;\n\t\t\t\toldDeps = this.softDeps;\n\t\t\t\t// remove dependencies that are no longer used\n\t\t\t\ti = oldDeps.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tkeypath = oldDeps[ i ];\n\t\t\t\t\tif ( newDeps.indexOf( keypath ) === -1 ) {\n\t\t\t\t\t\tdependenciesChanged = true;\n\t\t\t\t\t\tthis.viewmodel.unregister( keypath, this, 'computed' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// create references for any new dependencies\n\t\t\t\ti = newDeps.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tkeypath = newDeps[ i ];\n\t\t\t\t\tif ( oldDeps.indexOf( keypath ) === -1 && ( !this.hardDeps || this.hardDeps.indexOf( keypath ) === -1 ) ) {\n\t\t\t\t\t\tdependenciesChanged = true;\n\t\t\t\t\t\tthis.viewmodel.register( keypath, this, 'computed' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( dependenciesChanged ) {\n\t\t\t\t\tthis.softDeps = newDeps.slice();\n\t\t\t\t}\n\t\t\t\treturn dependenciesChanged;\n\t\t\t}\n\t\t};\n\t\treturn Computation;\n\t}( log, isEqual );\n\n\t/* viewmodel/prototype/compute.js */\n\tvar viewmodel$compute = function( getComputationSignature, Computation ) {\n\n\t\treturn function Viewmodel$compute( key, signature ) {\n\t\t\tsignature = getComputationSignature( signature );\n\t\t\treturn this.computations[ key ] = new Computation( this.ractive, key, signature );\n\t\t};\n\t}( getComputationSignature, Computation );\n\n\t/* viewmodel/prototype/get/FAILED_LOOKUP.js */\n\tvar viewmodel$get_FAILED_LOOKUP = {\n\t\tFAILED_LOOKUP: true\n\t};\n\n\t/* viewmodel/prototype/get/UnresolvedImplicitDependency.js */\n\tvar viewmodel$get_UnresolvedImplicitDependency = function( removeFromArray, runloop ) {\n\n\t\tvar empty = {};\n\t\tvar UnresolvedImplicitDependency = function( viewmodel, keypath ) {\n\t\t\tthis.viewmodel = viewmodel;\n\t\t\tthis.root = viewmodel.ractive;\n\t\t\t// TODO eliminate this\n\t\t\tthis.ref = keypath;\n\t\t\tthis.parentFragment = empty;\n\t\t\tviewmodel.unresolvedImplicitDependencies[ keypath ] = true;\n\t\t\tviewmodel.unresolvedImplicitDependencies.push( this );\n\t\t\trunloop.addUnresolved( this );\n\t\t};\n\t\tUnresolvedImplicitDependency.prototype = {\n\t\t\tresolve: function() {\n\t\t\t\tthis.viewmodel.mark( this.ref );\n\t\t\t\tthis.viewmodel.unresolvedImplicitDependencies[ this.ref ] = false;\n\t\t\t\tremoveFromArray( this.viewmodel.unresolvedImplicitDependencies, this );\n\t\t\t},\n\t\t\tteardown: function() {\n\t\t\t\trunloop.removeUnresolved( this );\n\t\t\t}\n\t\t};\n\t\treturn UnresolvedImplicitDependency;\n\t}( removeFromArray, runloop );\n\n\t/* viewmodel/prototype/get.js */\n\tvar viewmodel$get = function( isNumeric, FAILED_LOOKUP, UnresolvedImplicitDependency ) {\n\n\t\tvar __export;\n\t\tvar empty = {};\n\t\t__export = function Viewmodel$get( keypath ) {\n\t\t\tvar options = arguments[ 1 ];\n\t\t\tif ( options === void 0 )\n\t\t\t\toptions = empty;\n\t\t\tvar ractive = this.ractive,\n\t\t\t\tcache = this.cache,\n\t\t\t\tvalue, computation, wrapped, captureGroup;\n\t\t\tif ( keypath[ 0 ] === '@' ) {\n\t\t\t\tvalue = keypath.slice( 1 );\n\t\t\t\treturn isNumeric( value ) ? +value : value;\n\t\t\t}\n\t\t\tif ( cache[ keypath ] === undefined ) {\n\t\t\t\t// Is this a computed property?\n\t\t\t\tif ( ( computation = this.computations[ keypath ] ) && !computation.bypass ) {\n\t\t\t\t\tvalue = computation.get();\n\t\t\t\t\tthis.adapt( keypath, value );\n\t\t\t\t} else if ( wrapped = this.wrapped[ keypath ] ) {\n\t\t\t\t\tvalue = wrapped.value;\n\t\t\t\t} else if ( !keypath ) {\n\t\t\t\t\tthis.adapt( '', ractive.data );\n\t\t\t\t\tvalue = ractive.data;\n\t\t\t\t} else {\n\t\t\t\t\tvalue = retrieve( this, keypath );\n\t\t\t\t}\n\t\t\t\tcache[ keypath ] = value;\n\t\t\t} else {\n\t\t\t\tvalue = cache[ keypath ];\n\t\t\t}\n\t\t\tif ( options.evaluateWrapped && ( wrapped = this.wrapped[ keypath ] ) ) {\n\t\t\t\tvalue = wrapped.get();\n\t\t\t}\n\t\t\t// capture the keypath, if we're inside a computation\n\t\t\tif ( options.capture && ( captureGroup = this.captureGroups[ this.captureGroups.length - 1 ] ) ) {\n\t\t\t\tif ( !~captureGroup.indexOf( keypath ) ) {\n\t\t\t\t\tcaptureGroup.push( keypath );\n\t\t\t\t\t// if we couldn't resolve the keypath, we need to make it as a failed\n\t\t\t\t\t// lookup, so that the computation updates correctly once we CAN\n\t\t\t\t\t// resolve the keypath\n\t\t\t\t\tif ( value === FAILED_LOOKUP && this.unresolvedImplicitDependencies[ keypath ] !== true ) {\n\t\t\t\t\t\tnew UnresolvedImplicitDependency( this, keypath );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn value === FAILED_LOOKUP ? void 0 : value;\n\t\t};\n\n\t\tfunction retrieve( viewmodel, keypath ) {\n\t\t\tvar keys, key, parentKeypath, parentValue, cacheMap, value, wrapped;\n\t\t\tkeys = keypath.split( '.' );\n\t\t\tkey = keys.pop();\n\t\t\tparentKeypath = keys.join( '.' );\n\t\t\tparentValue = viewmodel.get( parentKeypath );\n\t\t\tif ( wrapped = viewmodel.wrapped[ parentKeypath ] ) {\n\t\t\t\tparentValue = wrapped.get();\n\t\t\t}\n\t\t\tif ( parentValue === null || parentValue === undefined ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// update cache map\n\t\t\tif ( !( cacheMap = viewmodel.cacheMap[ parentKeypath ] ) ) {\n\t\t\t\tviewmodel.cacheMap[ parentKeypath ] = [ keypath ];\n\t\t\t} else {\n\t\t\t\tif ( cacheMap.indexOf( keypath ) === -1 ) {\n\t\t\t\t\tcacheMap.push( keypath );\n\t\t\t\t}\n\t\t\t}\n\t\t\t// If this property doesn't exist, we return a sentinel value\n\t\t\t// so that we know to query parent scope (if such there be)\n\t\t\tif ( typeof parentValue === 'object' && !( key in parentValue ) ) {\n\t\t\t\treturn viewmodel.cache[ keypath ] = FAILED_LOOKUP;\n\t\t\t}\n\t\t\tvalue = parentValue[ key ];\n\t\t\t// Do we have an adaptor for this value?\n\t\t\tviewmodel.adapt( keypath, value, false );\n\t\t\t// Update cache\n\t\t\tviewmodel.cache[ keypath ] = value;\n\t\t\treturn value;\n\t\t}\n\t\treturn __export;\n\t}( isNumeric, viewmodel$get_FAILED_LOOKUP, viewmodel$get_UnresolvedImplicitDependency );\n\n\t/* viewmodel/prototype/init.js */\n\tvar viewmodel$init = function() {\n\n\t\tvar __export;\n\t\t__export = function Viewmodel$init() {\n\t\t\tvar key, computation, computations = [];\n\t\t\tfor ( key in this.ractive.computed ) {\n\t\t\t\tcomputation = this.compute( key, this.ractive.computed[ key ] );\n\t\t\t\tcomputations.push( computation );\n\t\t\t}\n\t\t\tcomputations.forEach( init );\n\t\t};\n\n\t\tfunction init( computation ) {\n\t\t\tcomputation.init();\n\t\t}\n\t\treturn __export;\n\t}();\n\n\t/* viewmodel/prototype/mark.js */\n\tvar viewmodel$mark = function Viewmodel$mark( keypath, options ) {\n\t\tvar computation;\n\t\t// implicit changes (i.e. `foo.length` on `ractive.push('foo',42)`)\n\t\t// should not be picked up by pattern observers\n\t\tif ( options ) {\n\t\t\tif ( options.implicit ) {\n\t\t\t\tthis.implicitChanges[ keypath ] = true;\n\t\t\t}\n\t\t\tif ( options.noCascade ) {\n\t\t\t\tthis.noCascade[ keypath ] = true;\n\t\t\t}\n\t\t}\n\t\tif ( computation = this.computations[ keypath ] ) {\n\t\t\tcomputation.invalidate();\n\t\t}\n\t\tif ( this.changes.indexOf( keypath ) === -1 ) {\n\t\t\tthis.changes.push( keypath );\n\t\t}\n\t\tthis.clearCache( keypath );\n\t};\n\n\t/* viewmodel/prototype/merge/mapOldToNewIndex.js */\n\tvar viewmodel$merge_mapOldToNewIndex = function( oldArray, newArray ) {\n\t\tvar usedIndices, firstUnusedIndex, newIndices, changed;\n\t\tusedIndices = {};\n\t\tfirstUnusedIndex = 0;\n\t\tnewIndices = oldArray.map( function( item, i ) {\n\t\t\tvar index, start, len;\n\t\t\tstart = firstUnusedIndex;\n\t\t\tlen = newArray.length;\n\t\t\tdo {\n\t\t\t\tindex = newArray.indexOf( item, start );\n\t\t\t\tif ( index === -1 ) {\n\t\t\t\t\tchanged = true;\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\tstart = index + 1;\n\t\t\t} while ( usedIndices[ index ] && start < len );\n\t\t\t// keep track of the first unused index, so we don't search\n\t\t\t// the whole of newArray for each item in oldArray unnecessarily\n\t\t\tif ( index === firstUnusedIndex ) {\n\t\t\t\tfirstUnusedIndex += 1;\n\t\t\t}\n\t\t\tif ( index !== i ) {\n\t\t\t\tchanged = true;\n\t\t\t}\n\t\t\tusedIndices[ index ] = true;\n\t\t\treturn index;\n\t\t} );\n\t\treturn newIndices;\n\t};\n\n\t/* viewmodel/prototype/merge.js */\n\tvar viewmodel$merge = function( warn, mapOldToNewIndex ) {\n\n\t\tvar __export;\n\t\tvar comparators = {};\n\t\t__export = function Viewmodel$merge( keypath, currentArray, array, options ) {\n\t\t\tvar oldArray, newArray, comparator, newIndices;\n\t\t\tthis.mark( keypath );\n\t\t\tif ( options && options.compare ) {\n\t\t\t\tcomparator = getComparatorFunction( options.compare );\n\t\t\t\ttry {\n\t\t\t\t\toldArray = currentArray.map( comparator );\n\t\t\t\t\tnewArray = array.map( comparator );\n\t\t\t\t} catch ( err ) {\n\t\t\t\t\t// fallback to an identity check - worst case scenario we have\n\t\t\t\t\t// to do more DOM manipulation than we thought...\n\t\t\t\t\t// ...unless we're in debug mode of course\n\t\t\t\t\tif ( this.debug ) {\n\t\t\t\t\t\tthrow err;\n\t\t\t\t\t} else {\n\t\t\t\t\t\twarn( 'Merge operation: comparison failed. Falling back to identity checking' );\n\t\t\t\t\t}\n\t\t\t\t\toldArray = currentArray;\n\t\t\t\t\tnewArray = array;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toldArray = currentArray;\n\t\t\t\tnewArray = array;\n\t\t\t}\n\t\t\t// find new indices for members of oldArray\n\t\t\tnewIndices = mapOldToNewIndex( oldArray, newArray );\n\t\t\tthis.smartUpdate( keypath, array, newIndices, currentArray.length !== array.length );\n\t\t};\n\n\t\tfunction stringify( item ) {\n\t\t\treturn JSON.stringify( item );\n\t\t}\n\n\t\tfunction getComparatorFunction( comparator ) {\n\t\t\t// If `compare` is `true`, we use JSON.stringify to compare\n\t\t\t// objects that are the same shape, but non-identical - i.e.\n\t\t\t// { foo: 'bar' } !== { foo: 'bar' }\n\t\t\tif ( comparator === true ) {\n\t\t\t\treturn stringify;\n\t\t\t}\n\t\t\tif ( typeof comparator === 'string' ) {\n\t\t\t\tif ( !comparators[ comparator ] ) {\n\t\t\t\t\tcomparators[ comparator ] = function( item ) {\n\t\t\t\t\t\treturn item[ comparator ];\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn comparators[ comparator ];\n\t\t\t}\n\t\t\tif ( typeof comparator === 'function' ) {\n\t\t\t\treturn comparator;\n\t\t\t}\n\t\t\tthrow new Error( 'The `compare` option must be a function, or a string representing an identifying field (or `true` to use JSON.stringify)' );\n\t\t}\n\t\treturn __export;\n\t}( warn, viewmodel$merge_mapOldToNewIndex );\n\n\t/* viewmodel/prototype/register.js */\n\tvar viewmodel$register = function() {\n\n\t\tvar __export;\n\t\t__export = function Viewmodel$register( keypath, dependant ) {\n\t\t\tvar group = arguments[ 2 ];\n\t\t\tif ( group === void 0 )\n\t\t\t\tgroup = 'default';\n\t\t\tvar depsByKeypath, deps;\n\t\t\tif ( dependant.isStatic ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdepsByKeypath = this.deps[ group ] || ( this.deps[ group ] = {} );\n\t\t\tdeps = depsByKeypath[ keypath ] || ( depsByKeypath[ keypath ] = [] );\n\t\t\tdeps.push( dependant );\n\t\t\tif ( !keypath ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tupdateDependantsMap( this, keypath, group );\n\t\t};\n\n\t\tfunction updateDependantsMap( viewmodel, keypath, group ) {\n\t\t\tvar keys, parentKeypath, map, parent;\n\t\t\t// update dependants map\n\t\t\tkeys = keypath.split( '.' );\n\t\t\twhile ( keys.length ) {\n\t\t\t\tkeys.pop();\n\t\t\t\tparentKeypath = keys.join( '.' );\n\t\t\t\tmap = viewmodel.depsMap[ group ] || ( viewmodel.depsMap[ group ] = {} );\n\t\t\t\tparent = map[ parentKeypath ] || ( map[ parentKeypath ] = [] );\n\t\t\t\tif ( parent[ keypath ] === undefined ) {\n\t\t\t\t\tparent[ keypath ] = 0;\n\t\t\t\t\tparent.push( keypath );\n\t\t\t\t}\n\t\t\t\tparent[ keypath ] += 1;\n\t\t\t\tkeypath = parentKeypath;\n\t\t\t}\n\t\t}\n\t\treturn __export;\n\t}();\n\n\t/* viewmodel/prototype/release.js */\n\tvar viewmodel$release = function Viewmodel$release() {\n\t\treturn this.captureGroups.pop();\n\t};\n\n\t/* viewmodel/prototype/set.js */\n\tvar viewmodel$set = function( isEqual, createBranch ) {\n\n\t\tvar __export;\n\t\t__export = function Viewmodel$set( keypath, value, silent ) {\n\t\t\tvar computation, wrapper, dontTeardownWrapper;\n\t\t\tcomputation = this.computations[ keypath ];\n\t\t\tif ( computation ) {\n\t\t\t\tif ( computation.setting ) {\n\t\t\t\t\t// let the other computation set() handle things...\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tcomputation.set( value );\n\t\t\t\tvalue = computation.get();\n\t\t\t}\n\t\t\tif ( isEqual( this.cache[ keypath ], value ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\twrapper = this.wrapped[ keypath ];\n\t\t\t// If we have a wrapper with a `reset()` method, we try and use it. If the\n\t\t\t// `reset()` method returns false, the wrapper should be torn down, and\n\t\t\t// (most likely) a new one should be created later\n\t\t\tif ( wrapper && wrapper.reset ) {\n\t\t\t\tdontTeardownWrapper = wrapper.reset( value ) !== false;\n\t\t\t\tif ( dontTeardownWrapper ) {\n\t\t\t\t\tvalue = wrapper.get();\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( !computation && !dontTeardownWrapper ) {\n\t\t\t\tresolveSet( this, keypath, value );\n\t\t\t}\n\t\t\tif ( !silent ) {\n\t\t\t\tthis.mark( keypath );\n\t\t\t} else {\n\t\t\t\t// We're setting a parent of the original target keypath (i.e.\n\t\t\t\t// creating a fresh branch) - we need to clear the cache, but\n\t\t\t\t// not mark it as a change\n\t\t\t\tthis.clearCache( keypath );\n\t\t\t}\n\t\t};\n\n\t\tfunction resolveSet( viewmodel, keypath, value ) {\n\t\t\tvar keys, lastKey, parentKeypath, wrapper, parentValue, wrapperSet, valueSet;\n\t\t\twrapperSet = function() {\n\t\t\t\tif ( wrapper.set ) {\n\t\t\t\t\twrapper.set( lastKey, value );\n\t\t\t\t} else {\n\t\t\t\t\tparentValue = wrapper.get();\n\t\t\t\t\tvalueSet();\n\t\t\t\t}\n\t\t\t};\n\t\t\tvalueSet = function() {\n\t\t\t\tif ( !parentValue ) {\n\t\t\t\t\tparentValue = createBranch( lastKey );\n\t\t\t\t\tviewmodel.set( parentKeypath, parentValue, true );\n\t\t\t\t}\n\t\t\t\tparentValue[ lastKey ] = value;\n\t\t\t};\n\t\t\tkeys = keypath.split( '.' );\n\t\t\tlastKey = keys.pop();\n\t\t\tparentKeypath = keys.join( '.' );\n\t\t\twrapper = viewmodel.wrapped[ parentKeypath ];\n\t\t\tif ( wrapper ) {\n\t\t\t\twrapperSet();\n\t\t\t} else {\n\t\t\t\tparentValue = viewmodel.get( parentKeypath );\n\t\t\t\t// may have been wrapped via the above .get()\n\t\t\t\t// call on viewmodel if this is first access via .set()!\n\t\t\t\tif ( wrapper = viewmodel.wrapped[ parentKeypath ] ) {\n\t\t\t\t\twrapperSet();\n\t\t\t\t} else {\n\t\t\t\t\tvalueSet();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn __export;\n\t}( isEqual, createBranch );\n\n\t/* viewmodel/prototype/smartUpdate.js */\n\tvar viewmodel$smartUpdate = function() {\n\n\t\tvar __export;\n\t\tvar implicitOption = {\n\t\t\t\timplicit: true\n\t\t\t},\n\t\t\tnoCascadeOption = {\n\t\t\t\tnoCascade: true\n\t\t\t};\n\t\t__export = function Viewmodel$smartUpdate( keypath, array, newIndices ) {\n\t\t\tvar this$0 = this;\n\t\t\tvar dependants, oldLength;\n\t\t\toldLength = newIndices.length;\n\t\t\t// Indices that are being removed should be marked as dirty\n\t\t\tnewIndices.forEach( function( newIndex, oldIndex ) {\n\t\t\t\tif ( newIndex === -1 ) {\n\t\t\t\t\tthis$0.mark( keypath + '.' + oldIndex, noCascadeOption );\n\t\t\t\t}\n\t\t\t} );\n\t\t\t// Update the model\n\t\t\t// TODO allow existing array to be updated in place, rather than replaced?\n\t\t\tthis.set( keypath, array, true );\n\t\t\tif ( dependants = this.deps[ 'default' ][ keypath ] ) {\n\t\t\t\tdependants.filter( canShuffle ).forEach( function( d ) {\n\t\t\t\t\treturn d.shuffle( newIndices, array );\n\t\t\t\t} );\n\t\t\t}\n\t\t\tif ( oldLength !== array.length ) {\n\t\t\t\tthis.mark( keypath + '.length', implicitOption );\n\t\t\t\tfor ( var i = oldLength; i < array.length; i += 1 ) {\n\t\t\t\t\tthis.mark( keypath + '.' + i );\n\t\t\t\t}\n\t\t\t\t// don't allow removed indexes beyond end of new array to trigger recomputations\n\t\t\t\tfor ( var i$0 = array.length; i$0 < oldLength; i$0 += 1 ) {\n\t\t\t\t\tthis.mark( keypath + '.' + i$0, noCascadeOption );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tfunction canShuffle( dependant ) {\n\t\t\treturn typeof dependant.shuffle === 'function';\n\t\t}\n\t\treturn __export;\n\t}();\n\n\t/* viewmodel/prototype/teardown.js */\n\tvar viewmodel$teardown = function Viewmodel$teardown() {\n\t\tvar this$0 = this;\n\t\tvar unresolvedImplicitDependency;\n\t\t// Clear entire cache - this has the desired side-effect\n\t\t// of unwrapping adapted values (e.g. arrays)\n\t\tObject.keys( this.cache ).forEach( function( keypath ) {\n\t\t\treturn this$0.clearCache( keypath );\n\t\t} );\n\t\t// Teardown any failed lookups - we don't need them to resolve any more\n\t\twhile ( unresolvedImplicitDependency = this.unresolvedImplicitDependencies.pop() ) {\n\t\t\tunresolvedImplicitDependency.teardown();\n\t\t}\n\t};\n\n\t/* viewmodel/prototype/unregister.js */\n\tvar viewmodel$unregister = function() {\n\n\t\tvar __export;\n\t\t__export = function Viewmodel$unregister( keypath, dependant ) {\n\t\t\tvar group = arguments[ 2 ];\n\t\t\tif ( group === void 0 )\n\t\t\t\tgroup = 'default';\n\t\t\tvar deps, index;\n\t\t\tif ( dependant.isStatic ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdeps = this.deps[ group ][ keypath ];\n\t\t\tindex = deps.indexOf( dependant );\n\t\t\tif ( index === -1 ) {\n\t\t\t\tthrow new Error( 'Attempted to remove a dependant that was no longer registered! This should not happen. If you are seeing this bug in development please raise an issue at https://github.com/RactiveJS/Ractive/issues - thanks' );\n\t\t\t}\n\t\t\tdeps.splice( index, 1 );\n\t\t\tif ( !keypath ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tupdateDependantsMap( this, keypath, group );\n\t\t};\n\n\t\tfunction updateDependantsMap( viewmodel, keypath, group ) {\n\t\t\tvar keys, parentKeypath, map, parent;\n\t\t\t// update dependants map\n\t\t\tkeys = keypath.split( '.' );\n\t\t\twhile ( keys.length ) {\n\t\t\t\tkeys.pop();\n\t\t\t\tparentKeypath = keys.join( '.' );\n\t\t\t\tmap = viewmodel.depsMap[ group ];\n\t\t\t\tparent = map[ parentKeypath ];\n\t\t\t\tparent[ keypath ] -= 1;\n\t\t\t\tif ( !parent[ keypath ] ) {\n\t\t\t\t\t// remove from parent deps map\n\t\t\t\t\tparent.splice( parent.indexOf( keypath ), 1 );\n\t\t\t\t\tparent[ keypath ] = undefined;\n\t\t\t\t}\n\t\t\t\tkeypath = parentKeypath;\n\t\t\t}\n\t\t}\n\t\treturn __export;\n\t}();\n\n\t/* viewmodel/adaptConfig.js */\n\tvar adaptConfig = function() {\n\n\t\t// should this be combined with prototype/adapt.js?\n\t\tvar configure = {\n\t\t\tlookup: function( target, adaptors ) {\n\t\t\t\tvar i, adapt = target.adapt;\n\t\t\t\tif ( !adapt || !adapt.length ) {\n\t\t\t\t\treturn adapt;\n\t\t\t\t}\n\t\t\t\tif ( adaptors && Object.keys( adaptors ).length && ( i = adapt.length ) ) {\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tvar adaptor = adapt[ i ];\n\t\t\t\t\t\tif ( typeof adaptor === 'string' ) {\n\t\t\t\t\t\t\tadapt[ i ] = adaptors[ adaptor ] || adaptor;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn adapt;\n\t\t\t},\n\t\t\tcombine: function( parent, adapt ) {\n\t\t\t\t// normalize 'Foo' to [ 'Foo' ]\n\t\t\t\tparent = arrayIfString( parent );\n\t\t\t\tadapt = arrayIfString( adapt );\n\t\t\t\t// no parent? return adapt\n\t\t\t\tif ( !parent || !parent.length ) {\n\t\t\t\t\treturn adapt;\n\t\t\t\t}\n\t\t\t\t// no adapt? return 'copy' of parent\n\t\t\t\tif ( !adapt || !adapt.length ) {\n\t\t\t\t\treturn parent.slice();\n\t\t\t\t}\n\t\t\t\t// add parent adaptors to options\n\t\t\t\tparent.forEach( function( a ) {\n\t\t\t\t\t// don't put in duplicates\n\t\t\t\t\tif ( adapt.indexOf( a ) === -1 ) {\n\t\t\t\t\t\tadapt.push( a );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\treturn adapt;\n\t\t\t}\n\t\t};\n\n\t\tfunction arrayIfString( adapt ) {\n\t\t\tif ( typeof adapt === 'string' ) {\n\t\t\t\tadapt = [ adapt ];\n\t\t\t}\n\t\t\treturn adapt;\n\t\t}\n\t\treturn configure;\n\t}();\n\n\t/* viewmodel/Viewmodel.js */\n\tvar Viewmodel = function( create, adapt, applyChanges, capture, clearCache, compute, get, init, mark, merge, register, release, set, smartUpdate, teardown, unregister, adaptConfig ) {\n\n\t\tvar noMagic;\n\t\ttry {\n\t\t\tObject.defineProperty( {}, 'test', {\n\t\t\t\tvalue: 0\n\t\t\t} );\n\t\t} catch ( err ) {\n\t\t\tnoMagic = true;\n\t\t}\n\t\tvar Viewmodel = function( ractive ) {\n\t\t\tthis.ractive = ractive;\n\t\t\t// TODO eventually, we shouldn't need this reference\n\t\t\tViewmodel.extend( ractive.constructor, ractive );\n\t\t\tthis.cache = {};\n\t\t\t// we need to be able to use hasOwnProperty, so can't inherit from null\n\t\t\tthis.cacheMap = create( null );\n\t\t\tthis.deps = {\n\t\t\t\tcomputed: {},\n\t\t\t\t'default': {}\n\t\t\t};\n\t\t\tthis.depsMap = {\n\t\t\t\tcomputed: {},\n\t\t\t\t'default': {}\n\t\t\t};\n\t\t\tthis.patternObservers = [];\n\t\t\tthis.wrapped = create( null );\n\t\t\tthis.computations = create( null );\n\t\t\tthis.captureGroups = [];\n\t\t\tthis.unresolvedImplicitDependencies = [];\n\t\t\tthis.changes = [];\n\t\t\tthis.implicitChanges = {};\n\t\t\tthis.noCascade = {};\n\t\t};\n\t\tViewmodel.extend = function( Parent, instance ) {\n\t\t\tif ( instance.magic && noMagic ) {\n\t\t\t\tthrow new Error( 'Getters and setters (magic mode) are not supported in this browser' );\n\t\t\t}\n\t\t\tinstance.adapt = adaptConfig.combine( Parent.prototype.adapt, instance.adapt ) || [];\n\t\t\tinstance.adapt = adaptConfig.lookup( instance, instance.adaptors );\n\t\t};\n\t\tViewmodel.prototype = {\n\t\t\tadapt: adapt,\n\t\t\tapplyChanges: applyChanges,\n\t\t\tcapture: capture,\n\t\t\tclearCache: clearCache,\n\t\t\tcompute: compute,\n\t\t\tget: get,\n\t\t\tinit: init,\n\t\t\tmark: mark,\n\t\t\tmerge: merge,\n\t\t\tregister: register,\n\t\t\trelease: release,\n\t\t\tset: set,\n\t\t\tsmartUpdate: smartUpdate,\n\t\t\tteardown: teardown,\n\t\t\tunregister: unregister\n\t\t};\n\t\treturn Viewmodel;\n\t}( create, viewmodel$adapt, viewmodel$applyChanges, viewmodel$capture, viewmodel$clearCache, viewmodel$compute, viewmodel$get, viewmodel$init, viewmodel$mark, viewmodel$merge, viewmodel$register, viewmodel$release, viewmodel$set, viewmodel$smartUpdate, viewmodel$teardown, viewmodel$unregister, adaptConfig );\n\n\t/* Ractive/initialise.js */\n\tvar Ractive_initialise = function( config, create, Fragment, getElement, getNextNumber, Hook, HookQueue, Viewmodel ) {\n\n\t\tvar __export;\n\t\tvar constructHook = new Hook( 'construct' ),\n\t\t\tconfigHook = new Hook( 'config' ),\n\t\t\tinitHook = new HookQueue( 'init' );\n\t\t__export = function initialiseRactiveInstance( ractive ) {\n\t\t\tvar options = arguments[ 1 ];\n\t\t\tif ( options === void 0 )\n\t\t\t\toptions = {};\n\t\t\tvar el;\n\t\t\tinitialiseProperties( ractive, options );\n\t\t\t// make this option do what would be expected if someone\n\t\t\t// did include it on a new Ractive() or new Component() call.\n\t\t\t// Silly to do so (put a hook on the very options being used),\n\t\t\t// but handle it correctly, consistent with the intent.\n\t\t\tconstructHook.fire( config.getConstructTarget( ractive, options ), options );\n\t\t\t// init config from Parent and options\n\t\t\tconfig.init( ractive.constructor, ractive, options );\n\t\t\tconfigHook.fire( ractive );\n\t\t\t// Teardown any existing instances *before* trying to set up the new one -\n\t\t\t// avoids certain weird bugs\n\t\t\tif ( el = getElement( ractive.el ) ) {\n\t\t\t\tif ( !ractive.append ) {\n\t\t\t\t\tif ( el.__ractive_instances__ ) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tel.__ractive_instances__.splice( 0, el.__ractive_instances__.length ).forEach( function( r ) {\n\t\t\t\t\t\t\t\treturn r.teardown();\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t} catch ( err ) {}\n\t\t\t\t\t}\n\t\t\t\t\tel.innerHTML = '';\n\t\t\t\t}\n\t\t\t}\n\t\t\tinitHook.begin( ractive );\n\t\t\t// TEMPORARY. This is so we can implement Viewmodel gradually\n\t\t\tractive.viewmodel = new Viewmodel( ractive );\n\t\t\t// hacky circular problem until we get this sorted out\n\t\t\t// if viewmodel immediately processes computed properties,\n\t\t\t// they may call ractive.get, which calls ractive.viewmodel,\n\t\t\t// which hasn't been set till line above finishes.\n\t\t\tractive.viewmodel.init();\n\t\t\t// Render our *root fragment*\n\t\t\tif ( ractive.template ) {\n\t\t\t\tractive.fragment = new Fragment( {\n\t\t\t\t\ttemplate: ractive.template,\n\t\t\t\t\troot: ractive,\n\t\t\t\t\towner: ractive\n\t\t\t\t} );\n\t\t\t}\n\t\t\tinitHook.end( ractive );\n\t\t\t// render automatically ( if `el` is specified )\n\t\t\tif ( el ) {\n\t\t\t\tractive.render( el, ractive.append );\n\t\t\t}\n\t\t};\n\n\t\tfunction initialiseProperties( ractive, options ) {\n\t\t\t// Generate a unique identifier, for places where you'd use a weak map if it\n\t\t\t// existed\n\t\t\tractive._guid = getNextNumber();\n\t\t\t// events\n\t\t\tractive._subs = create( null );\n\t\t\t// storage for item configuration from instantiation to reset,\n\t\t\t// like dynamic functions or original values\n\t\t\tractive._config = {};\n\t\t\t// two-way bindings\n\t\t\tractive._twowayBindings = create( null );\n\t\t\t// animations (so we can stop any in progress at teardown)\n\t\t\tractive._animations = [];\n\t\t\t// nodes registry\n\t\t\tractive.nodes = {};\n\t\t\t// live queries\n\t\t\tractive._liveQueries = [];\n\t\t\tractive._liveComponentQueries = [];\n\t\t\t// If this is a component, store a reference to the parent\n\t\t\tif ( options._parent && options._component ) {\n\t\t\t\tractive._parent = options._parent;\n\t\t\t\tractive.component = options._component;\n\t\t\t\t// And store a reference to the instance on the component\n\t\t\t\toptions._component.instance = ractive;\n\t\t\t}\n\t\t}\n\t\treturn __export;\n\t}( config, create, Fragment, getElement, getNextNumber, Ractive$shared_hooks_Hook, Ractive$shared_hooks_HookQueue, Viewmodel );\n\n\t/* extend/unwrapExtended.js */\n\tvar unwrapExtended = function( wrap, config, circular ) {\n\n\t\tvar __export;\n\t\tvar Ractive;\n\t\tcircular.push( function() {\n\t\t\tRactive = circular.Ractive;\n\t\t} );\n\t\t__export = function unwrapExtended( Child ) {\n\t\t\tif ( !( Child.prototype instanceof Ractive ) ) {\n\t\t\t\treturn Child;\n\t\t\t}\n\t\t\tvar options = {};\n\t\t\twhile ( Child ) {\n\t\t\t\tconfig.registries.forEach( function( r ) {\n\t\t\t\t\taddRegistry( r.useDefaults ? Child.prototype : Child, options, r.name );\n\t\t\t\t} );\n\t\t\t\tObject.keys( Child.prototype ).forEach( function( key ) {\n\t\t\t\t\tif ( key === 'computed' ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar value = Child.prototype[ key ];\n\t\t\t\t\tif ( !( key in options ) ) {\n\t\t\t\t\t\toptions[ key ] = value._method ? value._method : value;\n\t\t\t\t\t} else if ( typeof options[ key ] === 'function' && typeof value === 'function' && options[ key ]._method ) {\n\t\t\t\t\t\tvar result, needsSuper = value._method;\n\t\t\t\t\t\tif ( needsSuper ) {\n\t\t\t\t\t\t\tvalue = value._method;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// rewrap bound directly to parent fn\n\t\t\t\t\t\tresult = wrap( options[ key ]._method, value );\n\t\t\t\t\t\tif ( needsSuper ) {\n\t\t\t\t\t\t\tresult._method = result;\n\t\t\t\t\t\t}\n\t\t\t\t\t\toptions[ key ] = result;\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\tif ( Child._parent !== Ractive ) {\n\t\t\t\t\tChild = Child._parent;\n\t\t\t\t} else {\n\t\t\t\t\tChild = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn options;\n\t\t};\n\n\t\tfunction addRegistry( target, options, name ) {\n\t\t\tvar registry, keys = Object.keys( target[ name ] );\n\t\t\tif ( !keys.length ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif ( !( registry = options[ name ] ) ) {\n\t\t\t\tregistry = options[ name ] = {};\n\t\t\t}\n\t\t\tkeys.filter( function( key ) {\n\t\t\t\treturn !( key in registry );\n\t\t\t} ).forEach( function( key ) {\n\t\t\t\treturn registry[ key ] = target[ name ][ key ];\n\t\t\t} );\n\t\t}\n\t\treturn __export;\n\t}( wrapMethod, config, circular );\n\n\t/* extend/_extend.js */\n\tvar Ractive_extend = function( create, defineProperties, getGuid, config, initialise, Viewmodel, unwrap ) {\n\n\t\treturn function extend() {\n\t\t\tvar options = arguments[ 0 ];\n\t\t\tif ( options === void 0 )\n\t\t\t\toptions = {};\n\t\t\tvar Parent = this,\n\t\t\t\tChild, proto, staticProperties;\n\t\t\t// if we're extending with another Ractive instance, inherit its\n\t\t\t// prototype methods and default options as well\n\t\t\toptions = unwrap( options );\n\t\t\t// create Child constructor\n\t\t\tChild = function( options ) {\n\t\t\t\tinitialise( this, options );\n\t\t\t};\n\t\t\tproto = create( Parent.prototype );\n\t\t\tproto.constructor = Child;\n\t\t\tstaticProperties = {\n\t\t\t\t// each component needs a guid, for managing CSS etc\n\t\t\t\t_guid: {\n\t\t\t\t\tvalue: getGuid()\n\t\t\t\t},\n\t\t\t\t// alias prototype as defaults\n\t\t\t\tdefaults: {\n\t\t\t\t\tvalue: proto\n\t\t\t\t},\n\t\t\t\t// extendable\n\t\t\t\textend: {\n\t\t\t\t\tvalue: extend,\n\t\t\t\t\twritable: true,\n\t\t\t\t\tconfigurable: true\n\t\t\t\t},\n\t\t\t\t// Parent - for IE8, can't use Object.getPrototypeOf\n\t\t\t\t_parent: {\n\t\t\t\t\tvalue: Parent\n\t\t\t\t}\n\t\t\t};\n\t\t\tdefineProperties( Child, staticProperties );\n\t\t\t// extend configuration\n\t\t\tconfig.extend( Parent, proto, options );\n\t\t\tViewmodel.extend( Parent, proto );\n\t\t\tChild.prototype = proto;\n\t\t\treturn Child;\n\t\t};\n\t}( create, defineProperties, getGuid, config, Ractive_initialise, Viewmodel, unwrapExtended );\n\n\t/* Ractive.js */\n\tvar Ractive = function( defaults, easing, interpolators, svg, magic, defineProperties, proto, Promise, extendObj, extend, parse, initialise, circular ) {\n\n\t\tvar Ractive, properties;\n\t\t// Main Ractive required object\n\t\tRactive = function( options ) {\n\t\t\tinitialise( this, options );\n\t\t};\n\t\t// Ractive properties\n\t\tproperties = {\n\t\t\t// static methods:\n\t\t\textend: {\n\t\t\t\tvalue: extend\n\t\t\t},\n\t\t\tparse: {\n\t\t\t\tvalue: parse\n\t\t\t},\n\t\t\t// Namespaced constructors\n\t\t\tPromise: {\n\t\t\t\tvalue: Promise\n\t\t\t},\n\t\t\t// support\n\t\t\tsvg: {\n\t\t\t\tvalue: svg\n\t\t\t},\n\t\t\tmagic: {\n\t\t\t\tvalue: magic\n\t\t\t},\n\t\t\t// version\n\t\t\tVERSION: {\n\t\t\t\tvalue: '0.6.1'\n\t\t\t},\n\t\t\t// Plugins\n\t\t\tadaptors: {\n\t\t\t\twritable: true,\n\t\t\t\tvalue: {}\n\t\t\t},\n\t\t\tcomponents: {\n\t\t\t\twritable: true,\n\t\t\t\tvalue: {}\n\t\t\t},\n\t\t\tdecorators: {\n\t\t\t\twritable: true,\n\t\t\t\tvalue: {}\n\t\t\t},\n\t\t\teasing: {\n\t\t\t\twritable: true,\n\t\t\t\tvalue: easing\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\twritable: true,\n\t\t\t\tvalue: {}\n\t\t\t},\n\t\t\tinterpolators: {\n\t\t\t\twritable: true,\n\t\t\t\tvalue: interpolators\n\t\t\t},\n\t\t\tpartials: {\n\t\t\t\twritable: true,\n\t\t\t\tvalue: {}\n\t\t\t},\n\t\t\ttransitions: {\n\t\t\t\twritable: true,\n\t\t\t\tvalue: {}\n\t\t\t}\n\t\t};\n\t\t// Ractive properties\n\t\tdefineProperties( Ractive, properties );\n\t\tRactive.prototype = extendObj( proto, defaults );\n\t\tRactive.prototype.constructor = Ractive;\n\t\t// alias prototype as defaults\n\t\tRactive.defaults = Ractive.prototype;\n\t\t// Certain modules have circular dependencies. If we were bundling a\n\t\t// module loader, e.g. almond.js, this wouldn't be a problem, but we're\n\t\t// not - we're using amdclean as part of the build process. Because of\n\t\t// this, we need to wait until all modules have loaded before those\n\t\t// circular dependencies can be required.\n\t\tcircular.Ractive = Ractive;\n\t\twhile ( circular.length ) {\n\t\t\tcircular.pop()();\n\t\t}\n\t\t// Ractive.js makes liberal use of things like Array.prototype.indexOf. In\n\t\t// older browsers, these are made available via a shim - here, we do a quick\n\t\t// pre-flight check to make sure that either a) we're not in a shit browser,\n\t\t// or b) we're using a Ractive-legacy.js build\n\t\tvar FUNCTION = 'function';\n\t\tif ( typeof Date.now !== FUNCTION || typeof String.prototype.trim !== FUNCTION || typeof Object.keys !== FUNCTION || typeof Array.prototype.indexOf !== FUNCTION || typeof Array.prototype.forEach !== FUNCTION || typeof Array.prototype.map !== FUNCTION || typeof Array.prototype.filter !== FUNCTION || typeof window !== 'undefined' && typeof window.addEventListener !== FUNCTION ) {\n\t\t\tthrow new Error( 'It looks like you\\'re attempting to use Ractive.js in an older browser. You\\'ll need to use one of the \\'legacy builds\\' in order to continue - see http://docs.ractivejs.org/latest/legacy-builds for more information.' );\n\t\t}\n\t\treturn Ractive;\n\t}( options, easing, interpolators, svg, magic, defineProperties, prototype, Promise, extend, Ractive_extend, parse, Ractive_initialise, circular );\n\n\n\t// export as Common JS module...\n\tif ( typeof module !== \"undefined\" && module.exports ) {\n\t\tmodule.exports = Ractive;\n\t}\n\n\t// ... or as AMD module\n\telse if ( typeof define === \"function\" && define.amd ) {\n\t\tdefine( function() {\n\t\t\treturn Ractive;\n\t\t} );\n\t}\n\n\t// ... or as browser global\n\tglobal.Ractive = Ractive;\n\n\tRactive.noConflict = function() {\n\t\tglobal.Ractive = noConflict;\n\t\treturn Ractive;\n\t};\n\n}( typeof window !== 'undefined' ? window : this ) );\n",";(function(root, factory) {\n\n  // Support AMD\n  if (typeof define === 'function' && define.amd) {\n    define([], factory);\n\n  // Support CommonJS\n  } else if (typeof exports === 'object') {\n    var randomColor = factory();\n    \n    // Support NodeJS & Component, which allow module.exports to be a function\n    if (typeof module === 'object' && module && module.exports) {\n      exports = module.exports = randomColor;\n    }\n    \n    // Support CommonJS 1.1.1 spec\n    exports.randomColor = randomColor;\n  \n  // Support vanilla script loading\n  } else {\n    root.randomColor = factory();\n  };\n\n}(this, function() {\n\n  // Shared color dictionary\n  var colorDictionary = {};\n\n  // Populate the color dictionary\n  loadColorBounds();\n\n  var randomColor = function(options) {\n    options = options || {};\n\n    var H,S,B;\n\n    // Check if we need to generate multiple colors\n    if (options.count) {\n\n      var totalColors = options.count,\n          colors = [];\n\n      options.count = false;\n\n      while (totalColors > colors.length) {\n        colors.push(randomColor(options));\n      }\n\n      return colors;\n    }\n\n    // First we pick a hue (H)\n    H = pickHue(options);\n\n    // Then use H to determine saturation (S)\n    S = pickSaturation(H, options);\n\n    // Then use S and H to determine brightness (B).\n    B = pickBrightness(H, S, options);\n\n    // Then we return the HSB color in the desired format\n    return setFormat([H,S,B], options);\n  };\n\n  function pickHue (options) {\n\n    var hueRange = getHueRange(options.hue),\n        hue = randomWithin(hueRange);\n\n    // Instead of storing red as two seperate ranges,\n    // we group them, using negative numbers\n    if (hue < 0) {hue = 360 + hue}\n\n    return hue;\n\n  }\n\n  function pickSaturation (hue, options) {\n\n    if (options.luminosity === 'random') {\n      return randomWithin([0,100]);\n    }\n\n    if (options.hue === 'monochrome') {\n      return 0;\n    }\n\n    var saturationRange = getSaturationRange(hue);\n\n    var sMin = saturationRange[0],\n        sMax = saturationRange[1];\n\n    switch (options.luminosity) {\n\n      case 'bright':\n        sMin = 55;\n        break;\n\n      case 'dark':\n        sMin = sMax - 10;\n        break;\n\n      case 'light':\n        sMax = 55;\n        break;\n   }\n\n    return randomWithin([sMin, sMax]);\n\n  }\n\n  function pickBrightness (H, S, options) {\n\n    var brightness,\n        bMin = getMinimumBrightness(H, S),\n        bMax = 100;\n\n    switch (options.luminosity) {\n\n      case 'dark':\n        bMax = bMin + 20;\n        break;\n\n      case 'light':\n        bMin = (bMax + bMin)/2;\n        break;\n\n      case 'random':\n        bMin = 0;\n        bMax = 100;\n        break;\n    }\n\n    return randomWithin([bMin, bMax]);\n\n  }\n\n  function setFormat (hsv, options) {\n\n    switch (options.format) {\n\n      case 'hsvArray':\n        return hsv;\n\n      case 'hsv':\n        return colorString('hsv', hsv);\n\n      case 'rgbArray':\n        return HSVtoRGB(hsv);\n\n      case 'rgb':\n        return colorString('rgb', HSVtoRGB(hsv));\n\n      default:\n        return HSVtoHex(hsv);\n    }\n\n  }\n\n  function getMinimumBrightness(H, S) {\n\n    var lowerBounds = getColorInfo(H).lowerBounds;\n\n    for (var i = 0; i < lowerBounds.length - 1; i++) {\n\n      var s1 = lowerBounds[i][0],\n          v1 = lowerBounds[i][1];\n\n      var s2 = lowerBounds[i+1][0],\n          v2 = lowerBounds[i+1][1];\n\n      if (S >= s1 && S <= s2) {\n\n         var m = (v2 - v1)/(s2 - s1),\n             b = v1 - m*s1;\n\n         return m*S + b;\n      }\n\n    }\n\n    return 0;\n  }\n\n  function getHueRange (colorInput) {\n\n    if (typeof parseInt(colorInput) === 'number') {\n\n      var number = parseInt(colorInput);\n\n      if (number < 360 && number > 0) {\n        return [number, number];\n      }\n\n    }\n\n    if (typeof colorInput === 'string') {\n\n      if (colorDictionary[colorInput]) {\n        var color = colorDictionary[colorInput];\n        if (color.hueRange) {return color.hueRange}\n      }\n    }\n\n    return [0,360];\n\n  }\n\n  function getSaturationRange (hue) {\n    return getColorInfo(hue).saturationRange;\n  }\n\n  function getColorInfo (hue) {\n\n    // Maps red colors to make picking hue easier\n    if (hue >= 334 && hue <= 360) {\n      hue-= 360;\n    }\n\n    for (var colorName in colorDictionary) {\n       var color = colorDictionary[colorName];\n       if (color.hueRange &&\n           hue >= color.hueRange[0] &&\n           hue <= color.hueRange[1]) {\n          return colorDictionary[colorName];\n       }\n    } return 'Color not found';\n  }\n\n  function randomWithin (range) {\n    return Math.floor(range[0] + Math.random()*(range[1] + 1 - range[0]));\n  }\n\n  function shiftHue (h, degrees) {\n    return (h + degrees)%360;\n  }\n\n  function HSVtoHex (hsv){\n\n    var rgb = HSVtoRGB(hsv);\n\n    function componentToHex(c) {\n        var hex = c.toString(16);\n        return hex.length == 1 ? \"0\" + hex : hex;\n    }\n\n    var hex = \"#\" + componentToHex(rgb[0]) + componentToHex(rgb[1]) + componentToHex(rgb[2]);\n\n    return hex;\n\n  }\n\n  function defineColor (name, hueRange, lowerBounds) {\n\n    var sMin = lowerBounds[0][0],\n        sMax = lowerBounds[lowerBounds.length - 1][0],\n\n        bMin = lowerBounds[lowerBounds.length - 1][1],\n        bMax = lowerBounds[0][1];\n\n    colorDictionary[name] = {\n      hueRange: hueRange,\n      lowerBounds: lowerBounds,\n      saturationRange: [sMin, sMax],\n      brightnessRange: [bMin, bMax]\n    };\n\n  }\n\n  function loadColorBounds () {\n\n    defineColor(\n      'monochrome',\n      null,\n      [[0,0],[100,0]]\n    );\n\n    defineColor(\n      'red',\n      [-26,18],\n      [[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]\n    );\n\n    defineColor(\n      'orange',\n      [19,46],\n      [[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]\n    );\n\n    defineColor(\n      'yellow',\n      [47,62],\n      [[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]\n    );\n\n    defineColor(\n      'green',\n      [63,158],\n      [[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]\n    );\n\n    defineColor(\n      'blue',\n      [159, 257],\n      [[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]\n    );\n\n    defineColor(\n      'purple',\n      [258, 282],\n      [[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]\n    );\n\n    defineColor(\n      'pink',\n      [283, 334],\n      [[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]]\n    );\n\n  }\n\n  function HSVtoRGB (hsv) {\n\n    // this doesn't work for the values of 0 and 360\n    // here's the hacky fix\n    var h = hsv[0];\n    if (h === 0) {h = 1}\n    if (h === 360) {h = 359}\n\n    // Rebase the h,s,v values\n    h = h/360;\n    var s = hsv[1]/100,\n        v = hsv[2]/100;\n\n    var h_i = Math.floor(h*6),\n      f = h * 6 - h_i,\n      p = v * (1 - s),\n      q = v * (1 - f*s),\n      t = v * (1 - (1 - f)*s),\n      r = 256,\n      g = 256,\n      b = 256;\n\n    switch(h_i) {\n      case 0: r = v, g = t, b = p;  break;\n      case 1: r = q, g = v, b = p;  break;\n      case 2: r = p, g = v, b = t;  break;\n      case 3: r = p, g = q, b = v;  break;\n      case 4: r = t, g = p, b = v;  break;\n      case 5: r = v, g = p, b = q;  break;\n    }\n    var result = [Math.floor(r*255), Math.floor(g*255), Math.floor(b*255)];\n    return result;\n  }\n\n  function colorString (prefix, values) {\n    return prefix + '(' + values.join(', ') + ')';\n  }\n\n  return randomColor;\n}));","/*!\n* screenfull\n* v1.2.0 - 2014-04-29\n* (c) Sindre Sorhus; MIT License\n*/\n(function () {\n\t'use strict';\n\n\tvar isCommonjs = typeof module !== 'undefined' && module.exports;\n\tvar keyboardAllowed = typeof Element !== 'undefined' && 'ALLOW_KEYBOARD_INPUT' in Element;\n\n\tvar fn = (function () {\n\t\tvar val;\n\t\tvar valLength;\n\n\t\tvar fnMap = [\n\t\t\t[\n\t\t\t\t'requestFullscreen',\n\t\t\t\t'exitFullscreen',\n\t\t\t\t'fullscreenElement',\n\t\t\t\t'fullscreenEnabled',\n\t\t\t\t'fullscreenchange',\n\t\t\t\t'fullscreenerror'\n\t\t\t],\n\t\t\t// new WebKit\n\t\t\t[\n\t\t\t\t'webkitRequestFullscreen',\n\t\t\t\t'webkitExitFullscreen',\n\t\t\t\t'webkitFullscreenElement',\n\t\t\t\t'webkitFullscreenEnabled',\n\t\t\t\t'webkitfullscreenchange',\n\t\t\t\t'webkitfullscreenerror'\n\n\t\t\t],\n\t\t\t// old WebKit (Safari 5.1)\n\t\t\t[\n\t\t\t\t'webkitRequestFullScreen',\n\t\t\t\t'webkitCancelFullScreen',\n\t\t\t\t'webkitCurrentFullScreenElement',\n\t\t\t\t'webkitCancelFullScreen',\n\t\t\t\t'webkitfullscreenchange',\n\t\t\t\t'webkitfullscreenerror'\n\n\t\t\t],\n\t\t\t[\n\t\t\t\t'mozRequestFullScreen',\n\t\t\t\t'mozCancelFullScreen',\n\t\t\t\t'mozFullScreenElement',\n\t\t\t\t'mozFullScreenEnabled',\n\t\t\t\t'mozfullscreenchange',\n\t\t\t\t'mozfullscreenerror'\n\t\t\t],\n\t\t\t[\n\t\t\t\t'msRequestFullscreen',\n\t\t\t\t'msExitFullscreen',\n\t\t\t\t'msFullscreenElement',\n\t\t\t\t'msFullscreenEnabled',\n\t\t\t\t'MSFullscreenChange',\n\t\t\t\t'MSFullscreenError'\n\t\t\t]\n\t\t];\n\n\t\tvar i = 0;\n\t\tvar l = fnMap.length;\n\t\tvar ret = {};\n\n\t\tfor (; i < l; i++) {\n\t\t\tval = fnMap[i];\n\t\t\tif (val && val[1] in document) {\n\t\t\t\tfor (i = 0, valLength = val.length; i < valLength; i++) {\n\t\t\t\t\tret[fnMap[0][i]] = val[i];\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t})();\n\n\tvar screenfull = {\n\t\trequest: function (elem) {\n\t\t\tvar request = fn.requestFullscreen;\n\n\t\t\telem = elem || document.documentElement;\n\n\t\t\t// Work around Safari 5.1 bug: reports support for\n\t\t\t// keyboard in fullscreen even though it doesn't.\n\t\t\t// Browser sniffing, since the alternative with\n\t\t\t// setTimeout is even worse.\n\t\t\tif (/5\\.1[\\.\\d]* Safari/.test(navigator.userAgent)) {\n\t\t\t\telem[request]();\n\t\t\t} else {\n\t\t\t\telem[request](keyboardAllowed && Element.ALLOW_KEYBOARD_INPUT);\n\t\t\t}\n\t\t},\n\t\texit: function () {\n\t\t\tdocument[fn.exitFullscreen]();\n\t\t},\n\t\ttoggle: function (elem) {\n\t\t\tif (this.isFullscreen) {\n\t\t\t\tthis.exit();\n\t\t\t} else {\n\t\t\t\tthis.request(elem);\n\t\t\t}\n\t\t},\n\t\tonchange: function () {},\n\t\tonerror: function () {},\n\t\traw: fn\n\t};\n\n\tif (!fn) {\n\t\tif (isCommonjs) {\n\t\t\tmodule.exports = false;\n\t\t} else {\n\t\t\twindow.screenfull = false;\n\t\t}\n\n\t\treturn;\n\t}\n\n\tObject.defineProperties(screenfull, {\n\t\tisFullscreen: {\n\t\t\tget: function () {\n\t\t\t\treturn !!document[fn.fullscreenElement];\n\t\t\t}\n\t\t},\n\t\telement: {\n\t\t\tenumerable: true,\n\t\t\tget: function () {\n\t\t\t\treturn document[fn.fullscreenElement];\n\t\t\t}\n\t\t},\n\t\tenabled: {\n\t\t\tenumerable: true,\n\t\t\tget: function () {\n\t\t\t\t// Coerce to boolean in case of old WebKit\n\t\t\t\treturn !!document[fn.fullscreenEnabled];\n\t\t\t}\n\t\t}\n\t});\n\n\tdocument.addEventListener(fn.fullscreenchange, function (e) {\n\t\tscreenfull.onchange.call(screenfull, e);\n\t});\n\n\tdocument.addEventListener(fn.fullscreenerror, function (e) {\n\t\tscreenfull.onerror.call(screenfull, e);\n\t});\n\n\tif (isCommonjs) {\n\t\tmodule.exports = screenfull;\n\t} else {\n\t\twindow.screenfull = screenfull;\n\t}\n})();\n","/*!\n * Sizzle CSS Selector Engine v2.1.1\n * http://sizzlejs.com/\n *\n * Copyright 2008, 2014 jQuery Foundation, Inc. and other contributors\n * Released under the MIT license\n * http://jquery.org/license\n *\n * Date: 2014-12-15\n */\n(function( window ) {\n\nvar i,\n\tsupport,\n\tExpr,\n\tgetText,\n\tisXML,\n\ttokenize,\n\tcompile,\n\tselect,\n\toutermostContext,\n\tsortInput,\n\thasDuplicate,\n\n\t// Local document vars\n\tsetDocument,\n\tdocument,\n\tdocElem,\n\tdocumentIsHTML,\n\trbuggyQSA,\n\trbuggyMatches,\n\tmatches,\n\tcontains,\n\n\t// Instance-specific data\n\texpando = \"sizzle\" + 1 * new Date(),\n\tpreferredDoc = window.document,\n\tdirruns = 0,\n\tdone = 0,\n\tclassCache = createCache(),\n\ttokenCache = createCache(),\n\tcompilerCache = createCache(),\n\tsortOrder = function( a, b ) {\n\t\tif ( a === b ) {\n\t\t\thasDuplicate = true;\n\t\t}\n\t\treturn 0;\n\t},\n\n\t// General-purpose constants\n\tMAX_NEGATIVE = 1 << 31,\n\n\t// Instance methods\n\thasOwn = ({}).hasOwnProperty,\n\tarr = [],\n\tpop = arr.pop,\n\tpush_native = arr.push,\n\tpush = arr.push,\n\tslice = arr.slice,\n\t// Use a stripped-down indexOf as it's faster than native\n\t// http://jsperf.com/thor-indexof-vs-for/5\n\tindexOf = function( list, elem ) {\n\t\tvar i = 0,\n\t\t\tlen = list.length;\n\t\tfor ( ; i < len; i++ ) {\n\t\t\tif ( list[i] === elem ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t},\n\n\tbooleans = \"checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped\",\n\n\t// Regular expressions\n\n\t// http://www.w3.org/TR/css3-selectors/#whitespace\n\twhitespace = \"[\\\\x20\\\\t\\\\r\\\\n\\\\f]\",\n\n\t// http://www.w3.org/TR/CSS21/syndata.html#value-def-identifier\n\tidentifier = \"(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+\",\n\n\t// Attribute selectors: http://www.w3.org/TR/selectors/#attribute-selectors\n\tattributes = \"\\\\[\" + whitespace + \"*(\" + identifier + \")(?:\" + whitespace +\n\t\t// Operator (capture 2)\n\t\t\"*([*^$|!~]?=)\" + whitespace +\n\t\t// \"Attribute values must be CSS identifiers [capture 5] or strings [capture 3 or capture 4]\"\n\t\t\"*(?:'((?:\\\\\\\\.|[^\\\\\\\\'])*)'|\\\"((?:\\\\\\\\.|[^\\\\\\\\\\\"])*)\\\"|(\" + identifier + \"))|)\" + whitespace +\n\t\t\"*\\\\]\",\n\n\tpseudos = \":(\" + identifier + \")(?:\\\\((\" +\n\t\t// To reduce the number of selectors needing tokenize in the preFilter, prefer arguments:\n\t\t// 1. quoted (capture 3; capture 4 or capture 5)\n\t\t\"('((?:\\\\\\\\.|[^\\\\\\\\'])*)'|\\\"((?:\\\\\\\\.|[^\\\\\\\\\\\"])*)\\\")|\" +\n\t\t// 2. simple (capture 6)\n\t\t\"((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|\" + attributes + \")*)|\" +\n\t\t// 3. anything else (capture 2)\n\t\t\".*\" +\n\t\t\")\\\\)|)\",\n\n\t// Leading and non-escaped trailing whitespace, capturing some non-whitespace characters preceding the latter\n\trwhitespace = new RegExp( whitespace + \"+\", \"g\" ),\n\trtrim = new RegExp( \"^\" + whitespace + \"+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)\" + whitespace + \"+$\", \"g\" ),\n\n\trcomma = new RegExp( \"^\" + whitespace + \"*,\" + whitespace + \"*\" ),\n\trcombinators = new RegExp( \"^\" + whitespace + \"*([>+~]|\" + whitespace + \")\" + whitespace + \"*\" ),\n\n\trattributeQuotes = new RegExp( \"=\" + whitespace + \"*([^\\\\]'\\\"]*?)\" + whitespace + \"*\\\\]\", \"g\" ),\n\n\trpseudo = new RegExp( pseudos ),\n\tridentifier = new RegExp( \"^\" + identifier + \"$\" ),\n\n\tmatchExpr = {\n\t\t\"ID\": new RegExp( \"^#(\" + identifier + \")\" ),\n\t\t\"CLASS\": new RegExp( \"^\\\\.(\" + identifier + \")\" ),\n\t\t\"TAG\": new RegExp( \"^(\" + identifier + \"|[*])\" ),\n\t\t\"ATTR\": new RegExp( \"^\" + attributes ),\n\t\t\"PSEUDO\": new RegExp( \"^\" + pseudos ),\n\t\t\"CHILD\": new RegExp( \"^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(\" + whitespace +\n\t\t\t\"*(even|odd|(([+-]|)(\\\\d*)n|)\" + whitespace + \"*(?:([+-]|)\" + whitespace +\n\t\t\t\"*(\\\\d+)|))\" + whitespace + \"*\\\\)|)\", \"i\" ),\n\t\t\"bool\": new RegExp( \"^(?:\" + booleans + \")$\", \"i\" ),\n\t\t// For use in libraries implementing .is()\n\t\t// We use this for POS matching in `select`\n\t\t\"needsContext\": new RegExp( \"^\" + whitespace + \"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(\" +\n\t\t\twhitespace + \"*((?:-\\\\d)?\\\\d*)\" + whitespace + \"*\\\\)|)(?=[^-]|$)\", \"i\" )\n\t},\n\n\trinputs = /^(?:input|select|textarea|button)$/i,\n\trheader = /^h\\d$/i,\n\n\trnative = /^[^{]+\\{\\s*\\[native \\w/,\n\n\t// Easily-parseable/retrievable ID or TAG or CLASS selectors\n\trquickExpr = /^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,\n\n\trsibling = /[+~]/,\n\trescape = /'|\\\\/g,\n\n\t// CSS escapes http://www.w3.org/TR/CSS21/syndata.html#escaped-characters\n\trunescape = new RegExp( \"\\\\\\\\([\\\\da-f]{1,6}\" + whitespace + \"?|(\" + whitespace + \")|.)\", \"ig\" ),\n\tfunescape = function( _, escaped, escapedWhitespace ) {\n\t\tvar high = \"0x\" + escaped - 0x10000;\n\t\t// NaN means non-codepoint\n\t\t// Support: Firefox<24\n\t\t// Workaround erroneous numeric interpretation of +\"0x\"\n\t\treturn high !== high || escapedWhitespace ?\n\t\t\tescaped :\n\t\t\thigh < 0 ?\n\t\t\t\t// BMP codepoint\n\t\t\t\tString.fromCharCode( high + 0x10000 ) :\n\t\t\t\t// Supplemental Plane codepoint (surrogate pair)\n\t\t\t\tString.fromCharCode( high >> 10 | 0xD800, high & 0x3FF | 0xDC00 );\n\t},\n\n\t// Used for iframes\n\t// See setDocument()\n\t// Removing the function wrapper causes a \"Permission Denied\"\n\t// error in IE\n\tunloadHandler = function() {\n\t\tsetDocument();\n\t};\n\n// Optimize for push.apply( _, NodeList )\ntry {\n\tpush.apply(\n\t\t(arr = slice.call( preferredDoc.childNodes )),\n\t\tpreferredDoc.childNodes\n\t);\n\t// Support: Android<4.0\n\t// Detect silently failing push.apply\n\tarr[ preferredDoc.childNodes.length ].nodeType;\n} catch ( e ) {\n\tpush = { apply: arr.length ?\n\n\t\t// Leverage slice if possible\n\t\tfunction( target, els ) {\n\t\t\tpush_native.apply( target, slice.call(els) );\n\t\t} :\n\n\t\t// Support: IE<9\n\t\t// Otherwise append directly\n\t\tfunction( target, els ) {\n\t\t\tvar j = target.length,\n\t\t\t\ti = 0;\n\t\t\t// Can't trust NodeList.length\n\t\t\twhile ( (target[j++] = els[i++]) ) {}\n\t\t\ttarget.length = j - 1;\n\t\t}\n\t};\n}\n\nfunction Sizzle( selector, context, results, seed ) {\n\tvar match, elem, m, nodeType,\n\t\t// QSA vars\n\t\ti, groups, old, nid, newContext, newSelector;\n\n\tif ( ( context ? context.ownerDocument || context : preferredDoc ) !== document ) {\n\t\tsetDocument( context );\n\t}\n\n\tcontext = context || document;\n\tresults = results || [];\n\n\tif ( !selector || typeof selector !== \"string\" ) {\n\t\treturn results;\n\t}\n\n\tif ( (nodeType = context.nodeType) !== 1 && nodeType !== 9 && nodeType !== 11 ) {\n\t\treturn [];\n\t}\n\n\tif ( documentIsHTML && !seed ) {\n\n\t\t// Try to shortcut find operations when possible (e.g., not under DocumentFragment)\n\t\tif ( nodeType !== 11 && (match = rquickExpr.exec( selector )) ) {\n\t\t\t// Speed-up: Sizzle(\"#ID\")\n\t\t\tif ( (m = match[1]) ) {\n\t\t\t\tif ( nodeType === 9 ) {\n\t\t\t\t\telem = context.getElementById( m );\n\t\t\t\t\t// Check parentNode to catch when Blackberry 4.6 returns\n\t\t\t\t\t// nodes that are no longer in the document (jQuery #6963)\n\t\t\t\t\tif ( elem && elem.parentNode ) {\n\t\t\t\t\t\t// Handle the case where IE, Opera, and Webkit return items\n\t\t\t\t\t\t// by name instead of ID\n\t\t\t\t\t\tif ( elem.id === m ) {\n\t\t\t\t\t\t\tresults.push( elem );\n\t\t\t\t\t\t\treturn results;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn results;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Context is not a document\n\t\t\t\t\tif ( context.ownerDocument && (elem = context.ownerDocument.getElementById( m )) &&\n\t\t\t\t\t\tcontains( context, elem ) && elem.id === m ) {\n\t\t\t\t\t\tresults.push( elem );\n\t\t\t\t\t\treturn results;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t// Speed-up: Sizzle(\"TAG\")\n\t\t\t} else if ( match[2] ) {\n\t\t\t\tpush.apply( results, context.getElementsByTagName( selector ) );\n\t\t\t\treturn results;\n\n\t\t\t// Speed-up: Sizzle(\".CLASS\")\n\t\t\t} else if ( (m = match[3]) && support.getElementsByClassName ) {\n\t\t\t\tpush.apply( results, context.getElementsByClassName( m ) );\n\t\t\t\treturn results;\n\t\t\t}\n\t\t}\n\n\t\t// QSA path\n\t\tif ( support.qsa && (!rbuggyQSA || !rbuggyQSA.test( selector )) ) {\n\t\t\tnid = old = expando;\n\t\t\tnewContext = context;\n\t\t\tnewSelector = nodeType !== 1 && selector;\n\n\t\t\t// qSA works strangely on Element-rooted queries\n\t\t\t// We can work around this by specifying an extra ID on the root\n\t\t\t// and working up from there (Thanks to Andrew Dupont for the technique)\n\t\t\t// IE 8 doesn't work on object elements\n\t\t\tif ( nodeType === 1 && context.nodeName.toLowerCase() !== \"object\" ) {\n\t\t\t\tgroups = tokenize( selector );\n\n\t\t\t\tif ( (old = context.getAttribute(\"id\")) ) {\n\t\t\t\t\tnid = old.replace( rescape, \"\\\\$&\" );\n\t\t\t\t} else {\n\t\t\t\t\tcontext.setAttribute( \"id\", nid );\n\t\t\t\t}\n\t\t\t\tnid = \"[id='\" + nid + \"'] \";\n\n\t\t\t\ti = groups.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tgroups[i] = nid + toSelector( groups[i] );\n\t\t\t\t}\n\t\t\t\tnewContext = rsibling.test( selector ) && testContext( context.parentNode ) || context;\n\t\t\t\tnewSelector = groups.join(\",\");\n\t\t\t}\n\n\t\t\tif ( newSelector ) {\n\t\t\t\ttry {\n\t\t\t\t\tpush.apply( results,\n\t\t\t\t\t\tnewContext.querySelectorAll( newSelector )\n\t\t\t\t\t);\n\t\t\t\t\treturn results;\n\t\t\t\t} catch(qsaError) {\n\t\t\t\t} finally {\n\t\t\t\t\tif ( !old ) {\n\t\t\t\t\t\tcontext.removeAttribute(\"id\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// All others\n\treturn select( selector.replace( rtrim, \"$1\" ), context, results, seed );\n}\n\n/**\n * Create key-value caches of limited size\n * @returns {Function(string, Object)} Returns the Object data after storing it on itself with\n *\tproperty name the (space-suffixed) string and (if the cache is larger than Expr.cacheLength)\n *\tdeleting the oldest entry\n */\nfunction createCache() {\n\tvar keys = [];\n\n\tfunction cache( key, value ) {\n\t\t// Use (key + \" \") to avoid collision with native prototype properties (see Issue #157)\n\t\tif ( keys.push( key + \" \" ) > Expr.cacheLength ) {\n\t\t\t// Only keep the most recent entries\n\t\t\tdelete cache[ keys.shift() ];\n\t\t}\n\t\treturn (cache[ key + \" \" ] = value);\n\t}\n\treturn cache;\n}\n\n/**\n * Mark a function for special use by Sizzle\n * @param {Function} fn The function to mark\n */\nfunction markFunction( fn ) {\n\tfn[ expando ] = true;\n\treturn fn;\n}\n\n/**\n * Support testing using an element\n * @param {Function} fn Passed the created div and expects a boolean result\n */\nfunction assert( fn ) {\n\tvar div = document.createElement(\"div\");\n\n\ttry {\n\t\treturn !!fn( div );\n\t} catch (e) {\n\t\treturn false;\n\t} finally {\n\t\t// Remove from its parent by default\n\t\tif ( div.parentNode ) {\n\t\t\tdiv.parentNode.removeChild( div );\n\t\t}\n\t\t// release memory in IE\n\t\tdiv = null;\n\t}\n}\n\n/**\n * Adds the same handler for all of the specified attrs\n * @param {String} attrs Pipe-separated list of attributes\n * @param {Function} handler The method that will be applied\n */\nfunction addHandle( attrs, handler ) {\n\tvar arr = attrs.split(\"|\"),\n\t\ti = attrs.length;\n\n\twhile ( i-- ) {\n\t\tExpr.attrHandle[ arr[i] ] = handler;\n\t}\n}\n\n/**\n * Checks document order of two siblings\n * @param {Element} a\n * @param {Element} b\n * @returns {Number} Returns less than 0 if a precedes b, greater than 0 if a follows b\n */\nfunction siblingCheck( a, b ) {\n\tvar cur = b && a,\n\t\tdiff = cur && a.nodeType === 1 && b.nodeType === 1 &&\n\t\t\t( ~b.sourceIndex || MAX_NEGATIVE ) -\n\t\t\t( ~a.sourceIndex || MAX_NEGATIVE );\n\n\t// Use IE sourceIndex if available on both nodes\n\tif ( diff ) {\n\t\treturn diff;\n\t}\n\n\t// Check if b follows a\n\tif ( cur ) {\n\t\twhile ( (cur = cur.nextSibling) ) {\n\t\t\tif ( cur === b ) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn a ? 1 : -1;\n}\n\n/**\n * Returns a function to use in pseudos for input types\n * @param {String} type\n */\nfunction createInputPseudo( type ) {\n\treturn function( elem ) {\n\t\tvar name = elem.nodeName.toLowerCase();\n\t\treturn name === \"input\" && elem.type === type;\n\t};\n}\n\n/**\n * Returns a function to use in pseudos for buttons\n * @param {String} type\n */\nfunction createButtonPseudo( type ) {\n\treturn function( elem ) {\n\t\tvar name = elem.nodeName.toLowerCase();\n\t\treturn (name === \"input\" || name === \"button\") && elem.type === type;\n\t};\n}\n\n/**\n * Returns a function to use in pseudos for positionals\n * @param {Function} fn\n */\nfunction createPositionalPseudo( fn ) {\n\treturn markFunction(function( argument ) {\n\t\targument = +argument;\n\t\treturn markFunction(function( seed, matches ) {\n\t\t\tvar j,\n\t\t\t\tmatchIndexes = fn( [], seed.length, argument ),\n\t\t\t\ti = matchIndexes.length;\n\n\t\t\t// Match elements found at the specified indexes\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( seed[ (j = matchIndexes[i]) ] ) {\n\t\t\t\t\tseed[j] = !(matches[j] = seed[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n}\n\n/**\n * Checks a node for validity as a Sizzle context\n * @param {Element|Object=} context\n * @returns {Element|Object|Boolean} The input node if acceptable, otherwise a falsy value\n */\nfunction testContext( context ) {\n\treturn context && typeof context.getElementsByTagName !== \"undefined\" && context;\n}\n\n// Expose support vars for convenience\nsupport = Sizzle.support = {};\n\n/**\n * Detects XML nodes\n * @param {Element|Object} elem An element or a document\n * @returns {Boolean} True iff elem is a non-HTML XML node\n */\nisXML = Sizzle.isXML = function( elem ) {\n\t// documentElement is verified for cases where it doesn't yet exist\n\t// (such as loading iframes in IE - #4833)\n\tvar documentElement = elem && (elem.ownerDocument || elem).documentElement;\n\treturn documentElement ? documentElement.nodeName !== \"HTML\" : false;\n};\n\n/**\n * Sets document-related variables once based on the current document\n * @param {Element|Object} [doc] An element or document object to use to set the document\n * @returns {Object} Returns the current document\n */\nsetDocument = Sizzle.setDocument = function( node ) {\n\tvar hasCompare, parent,\n\t\tdoc = node ? node.ownerDocument || node : preferredDoc;\n\n\t// If no document and documentElement is available, return\n\tif ( doc === document || doc.nodeType !== 9 || !doc.documentElement ) {\n\t\treturn document;\n\t}\n\n\t// Set our document\n\tdocument = doc;\n\tdocElem = doc.documentElement;\n\tparent = doc.defaultView;\n\n\t// Support: IE>8\n\t// If iframe document is assigned to \"document\" variable and if iframe has been reloaded,\n\t// IE will throw \"permission denied\" error when accessing \"document\" variable, see jQuery #13936\n\t// IE6-8 do not support the defaultView property so parent will be undefined\n\tif ( parent && parent !== parent.top ) {\n\t\t// IE11 does not have attachEvent, so all must suffer\n\t\tif ( parent.addEventListener ) {\n\t\t\tparent.addEventListener( \"unload\", unloadHandler, false );\n\t\t} else if ( parent.attachEvent ) {\n\t\t\tparent.attachEvent( \"onunload\", unloadHandler );\n\t\t}\n\t}\n\n\t/* Support tests\n\t---------------------------------------------------------------------- */\n\tdocumentIsHTML = !isXML( doc );\n\n\t/* Attributes\n\t---------------------------------------------------------------------- */\n\n\t// Support: IE<8\n\t// Verify that getAttribute really returns attributes and not properties\n\t// (excepting IE8 booleans)\n\tsupport.attributes = assert(function( div ) {\n\t\tdiv.className = \"i\";\n\t\treturn !div.getAttribute(\"className\");\n\t});\n\n\t/* getElement(s)By*\n\t---------------------------------------------------------------------- */\n\n\t// Check if getElementsByTagName(\"*\") returns only elements\n\tsupport.getElementsByTagName = assert(function( div ) {\n\t\tdiv.appendChild( doc.createComment(\"\") );\n\t\treturn !div.getElementsByTagName(\"*\").length;\n\t});\n\n\t// Support: IE<9\n\tsupport.getElementsByClassName = rnative.test( doc.getElementsByClassName );\n\n\t// Support: IE<10\n\t// Check if getElementById returns elements by name\n\t// The broken getElementById methods don't pick up programatically-set names,\n\t// so use a roundabout getElementsByName test\n\tsupport.getById = assert(function( div ) {\n\t\tdocElem.appendChild( div ).id = expando;\n\t\treturn !doc.getElementsByName || !doc.getElementsByName( expando ).length;\n\t});\n\n\t// ID find and filter\n\tif ( support.getById ) {\n\t\tExpr.find[\"ID\"] = function( id, context ) {\n\t\t\tif ( typeof context.getElementById !== \"undefined\" && documentIsHTML ) {\n\t\t\t\tvar m = context.getElementById( id );\n\t\t\t\t// Check parentNode to catch when Blackberry 4.6 returns\n\t\t\t\t// nodes that are no longer in the document #6963\n\t\t\t\treturn m && m.parentNode ? [ m ] : [];\n\t\t\t}\n\t\t};\n\t\tExpr.filter[\"ID\"] = function( id ) {\n\t\t\tvar attrId = id.replace( runescape, funescape );\n\t\t\treturn function( elem ) {\n\t\t\t\treturn elem.getAttribute(\"id\") === attrId;\n\t\t\t};\n\t\t};\n\t} else {\n\t\t// Support: IE6/7\n\t\t// getElementById is not reliable as a find shortcut\n\t\tdelete Expr.find[\"ID\"];\n\n\t\tExpr.filter[\"ID\"] =  function( id ) {\n\t\t\tvar attrId = id.replace( runescape, funescape );\n\t\t\treturn function( elem ) {\n\t\t\t\tvar node = typeof elem.getAttributeNode !== \"undefined\" && elem.getAttributeNode(\"id\");\n\t\t\t\treturn node && node.value === attrId;\n\t\t\t};\n\t\t};\n\t}\n\n\t// Tag\n\tExpr.find[\"TAG\"] = support.getElementsByTagName ?\n\t\tfunction( tag, context ) {\n\t\t\tif ( typeof context.getElementsByTagName !== \"undefined\" ) {\n\t\t\t\treturn context.getElementsByTagName( tag );\n\n\t\t\t// DocumentFragment nodes don't have gEBTN\n\t\t\t} else if ( support.qsa ) {\n\t\t\t\treturn context.querySelectorAll( tag );\n\t\t\t}\n\t\t} :\n\n\t\tfunction( tag, context ) {\n\t\t\tvar elem,\n\t\t\t\ttmp = [],\n\t\t\t\ti = 0,\n\t\t\t\t// By happy coincidence, a (broken) gEBTN appears on DocumentFragment nodes too\n\t\t\t\tresults = context.getElementsByTagName( tag );\n\n\t\t\t// Filter out possible comments\n\t\t\tif ( tag === \"*\" ) {\n\t\t\t\twhile ( (elem = results[i++]) ) {\n\t\t\t\t\tif ( elem.nodeType === 1 ) {\n\t\t\t\t\t\ttmp.push( elem );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn tmp;\n\t\t\t}\n\t\t\treturn results;\n\t\t};\n\n\t// Class\n\tExpr.find[\"CLASS\"] = support.getElementsByClassName && function( className, context ) {\n\t\tif ( documentIsHTML ) {\n\t\t\treturn context.getElementsByClassName( className );\n\t\t}\n\t};\n\n\t/* QSA/matchesSelector\n\t---------------------------------------------------------------------- */\n\n\t// QSA and matchesSelector support\n\n\t// matchesSelector(:active) reports false when true (IE9/Opera 11.5)\n\trbuggyMatches = [];\n\n\t// qSa(:focus) reports false when true (Chrome 21)\n\t// We allow this because of a bug in IE8/9 that throws an error\n\t// whenever `document.activeElement` is accessed on an iframe\n\t// So, we allow :focus to pass through QSA all the time to avoid the IE error\n\t// See http://bugs.jquery.com/ticket/13378\n\trbuggyQSA = [];\n\n\tif ( (support.qsa = rnative.test( doc.querySelectorAll )) ) {\n\t\t// Build QSA regex\n\t\t// Regex strategy adopted from Diego Perini\n\t\tassert(function( div ) {\n\t\t\t// Select is set to empty string on purpose\n\t\t\t// This is to test IE's treatment of not explicitly\n\t\t\t// setting a boolean content attribute,\n\t\t\t// since its presence should be enough\n\t\t\t// http://bugs.jquery.com/ticket/12359\n\t\t\tdocElem.appendChild( div ).innerHTML = \"<a id='\" + expando + \"'></a>\" +\n\t\t\t\t\"<select id='\" + expando + \"-\\f]' msallowcapture=''>\" +\n\t\t\t\t\"<option selected=''></option></select>\";\n\n\t\t\t// Support: IE8, Opera 11-12.16\n\t\t\t// Nothing should be selected when empty strings follow ^= or $= or *=\n\t\t\t// The test attribute must be unknown in Opera but \"safe\" for WinRT\n\t\t\t// http://msdn.microsoft.com/en-us/library/ie/hh465388.aspx#attribute_section\n\t\t\tif ( div.querySelectorAll(\"[msallowcapture^='']\").length ) {\n\t\t\t\trbuggyQSA.push( \"[*^$]=\" + whitespace + \"*(?:''|\\\"\\\")\" );\n\t\t\t}\n\n\t\t\t// Support: IE8\n\t\t\t// Boolean attributes and \"value\" are not treated correctly\n\t\t\tif ( !div.querySelectorAll(\"[selected]\").length ) {\n\t\t\t\trbuggyQSA.push( \"\\\\[\" + whitespace + \"*(?:value|\" + booleans + \")\" );\n\t\t\t}\n\n\t\t\t// Support: Chrome<29, Android<4.2+, Safari<7.0+, iOS<7.0+, PhantomJS<1.9.7+\n\t\t\tif ( !div.querySelectorAll( \"[id~=\" + expando + \"-]\" ).length ) {\n\t\t\t\trbuggyQSA.push(\"~=\");\n\t\t\t}\n\n\t\t\t// Webkit/Opera - :checked should return selected option elements\n\t\t\t// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked\n\t\t\t// IE8 throws error here and will not see later tests\n\t\t\tif ( !div.querySelectorAll(\":checked\").length ) {\n\t\t\t\trbuggyQSA.push(\":checked\");\n\t\t\t}\n\n\t\t\t// Support: Safari 8+, iOS 8+\n\t\t\t// https://bugs.webkit.org/show_bug.cgi?id=136851\n\t\t\t// In-page `selector#id sibing-combinator selector` fails\n\t\t\tif ( !div.querySelectorAll( \"a#\" + expando + \"+*\" ).length ) {\n\t\t\t\trbuggyQSA.push(\".#.+[+~]\");\n\t\t\t}\n\t\t});\n\n\t\tassert(function( div ) {\n\t\t\t// Support: Windows 8 Native Apps\n\t\t\t// The type and name attributes are restricted during .innerHTML assignment\n\t\t\tvar input = doc.createElement(\"input\");\n\t\t\tinput.setAttribute( \"type\", \"hidden\" );\n\t\t\tdiv.appendChild( input ).setAttribute( \"name\", \"D\" );\n\n\t\t\t// Support: IE8\n\t\t\t// Enforce case-sensitivity of name attribute\n\t\t\tif ( div.querySelectorAll(\"[name=d]\").length ) {\n\t\t\t\trbuggyQSA.push( \"name\" + whitespace + \"*[*^$|!~]?=\" );\n\t\t\t}\n\n\t\t\t// FF 3.5 - :enabled/:disabled and hidden elements (hidden elements are still enabled)\n\t\t\t// IE8 throws error here and will not see later tests\n\t\t\tif ( !div.querySelectorAll(\":enabled\").length ) {\n\t\t\t\trbuggyQSA.push( \":enabled\", \":disabled\" );\n\t\t\t}\n\n\t\t\t// Opera 10-11 does not throw on post-comma invalid pseudos\n\t\t\tdiv.querySelectorAll(\"*,:x\");\n\t\t\trbuggyQSA.push(\",.*:\");\n\t\t});\n\t}\n\n\tif ( (support.matchesSelector = rnative.test( (matches = docElem.matches ||\n\t\tdocElem.webkitMatchesSelector ||\n\t\tdocElem.mozMatchesSelector ||\n\t\tdocElem.oMatchesSelector ||\n\t\tdocElem.msMatchesSelector) )) ) {\n\n\t\tassert(function( div ) {\n\t\t\t// Check to see if it's possible to do matchesSelector\n\t\t\t// on a disconnected node (IE 9)\n\t\t\tsupport.disconnectedMatch = matches.call( div, \"div\" );\n\n\t\t\t// This should fail with an exception\n\t\t\t// Gecko does not error, returns false instead\n\t\t\tmatches.call( div, \"[s!='']:x\" );\n\t\t\trbuggyMatches.push( \"!=\", pseudos );\n\t\t});\n\t}\n\n\trbuggyQSA = rbuggyQSA.length && new RegExp( rbuggyQSA.join(\"|\") );\n\trbuggyMatches = rbuggyMatches.length && new RegExp( rbuggyMatches.join(\"|\") );\n\n\t/* Contains\n\t---------------------------------------------------------------------- */\n\thasCompare = rnative.test( docElem.compareDocumentPosition );\n\n\t// Element contains another\n\t// Purposefully does not implement inclusive descendent\n\t// As in, an element does not contain itself\n\tcontains = hasCompare || rnative.test( docElem.contains ) ?\n\t\tfunction( a, b ) {\n\t\t\tvar adown = a.nodeType === 9 ? a.documentElement : a,\n\t\t\t\tbup = b && b.parentNode;\n\t\t\treturn a === bup || !!( bup && bup.nodeType === 1 && (\n\t\t\t\tadown.contains ?\n\t\t\t\t\tadown.contains( bup ) :\n\t\t\t\t\ta.compareDocumentPosition && a.compareDocumentPosition( bup ) & 16\n\t\t\t));\n\t\t} :\n\t\tfunction( a, b ) {\n\t\t\tif ( b ) {\n\t\t\t\twhile ( (b = b.parentNode) ) {\n\t\t\t\t\tif ( b === a ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\n\t/* Sorting\n\t---------------------------------------------------------------------- */\n\n\t// Document order sorting\n\tsortOrder = hasCompare ?\n\tfunction( a, b ) {\n\n\t\t// Flag for duplicate removal\n\t\tif ( a === b ) {\n\t\t\thasDuplicate = true;\n\t\t\treturn 0;\n\t\t}\n\n\t\t// Sort on method existence if only one input has compareDocumentPosition\n\t\tvar compare = !a.compareDocumentPosition - !b.compareDocumentPosition;\n\t\tif ( compare ) {\n\t\t\treturn compare;\n\t\t}\n\n\t\t// Calculate position if both inputs belong to the same document\n\t\tcompare = ( a.ownerDocument || a ) === ( b.ownerDocument || b ) ?\n\t\t\ta.compareDocumentPosition( b ) :\n\n\t\t\t// Otherwise we know they are disconnected\n\t\t\t1;\n\n\t\t// Disconnected nodes\n\t\tif ( compare & 1 ||\n\t\t\t(!support.sortDetached && b.compareDocumentPosition( a ) === compare) ) {\n\n\t\t\t// Choose the first element that is related to our preferred document\n\t\t\tif ( a === doc || a.ownerDocument === preferredDoc && contains(preferredDoc, a) ) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif ( b === doc || b.ownerDocument === preferredDoc && contains(preferredDoc, b) ) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\t// Maintain original order\n\t\t\treturn sortInput ?\n\t\t\t\t( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :\n\t\t\t\t0;\n\t\t}\n\n\t\treturn compare & 4 ? -1 : 1;\n\t} :\n\tfunction( a, b ) {\n\t\t// Exit early if the nodes are identical\n\t\tif ( a === b ) {\n\t\t\thasDuplicate = true;\n\t\t\treturn 0;\n\t\t}\n\n\t\tvar cur,\n\t\t\ti = 0,\n\t\t\taup = a.parentNode,\n\t\t\tbup = b.parentNode,\n\t\t\tap = [ a ],\n\t\t\tbp = [ b ];\n\n\t\t// Parentless nodes are either documents or disconnected\n\t\tif ( !aup || !bup ) {\n\t\t\treturn a === doc ? -1 :\n\t\t\t\tb === doc ? 1 :\n\t\t\t\taup ? -1 :\n\t\t\t\tbup ? 1 :\n\t\t\t\tsortInput ?\n\t\t\t\t( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :\n\t\t\t\t0;\n\n\t\t// If the nodes are siblings, we can do a quick check\n\t\t} else if ( aup === bup ) {\n\t\t\treturn siblingCheck( a, b );\n\t\t}\n\n\t\t// Otherwise we need full lists of their ancestors for comparison\n\t\tcur = a;\n\t\twhile ( (cur = cur.parentNode) ) {\n\t\t\tap.unshift( cur );\n\t\t}\n\t\tcur = b;\n\t\twhile ( (cur = cur.parentNode) ) {\n\t\t\tbp.unshift( cur );\n\t\t}\n\n\t\t// Walk down the tree looking for a discrepancy\n\t\twhile ( ap[i] === bp[i] ) {\n\t\t\ti++;\n\t\t}\n\n\t\treturn i ?\n\t\t\t// Do a sibling check if the nodes have a common ancestor\n\t\t\tsiblingCheck( ap[i], bp[i] ) :\n\n\t\t\t// Otherwise nodes in our document sort first\n\t\t\tap[i] === preferredDoc ? -1 :\n\t\t\tbp[i] === preferredDoc ? 1 :\n\t\t\t0;\n\t};\n\n\treturn doc;\n};\n\nSizzle.matches = function( expr, elements ) {\n\treturn Sizzle( expr, null, null, elements );\n};\n\nSizzle.matchesSelector = function( elem, expr ) {\n\t// Set document vars if needed\n\tif ( ( elem.ownerDocument || elem ) !== document ) {\n\t\tsetDocument( elem );\n\t}\n\n\t// Make sure that attribute selectors are quoted\n\texpr = expr.replace( rattributeQuotes, \"='$1']\" );\n\n\tif ( support.matchesSelector && documentIsHTML &&\n\t\t( !rbuggyMatches || !rbuggyMatches.test( expr ) ) &&\n\t\t( !rbuggyQSA     || !rbuggyQSA.test( expr ) ) ) {\n\n\t\ttry {\n\t\t\tvar ret = matches.call( elem, expr );\n\n\t\t\t// IE 9's matchesSelector returns false on disconnected nodes\n\t\t\tif ( ret || support.disconnectedMatch ||\n\t\t\t\t\t// As well, disconnected nodes are said to be in a document\n\t\t\t\t\t// fragment in IE 9\n\t\t\t\t\telem.document && elem.document.nodeType !== 11 ) {\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t} catch (e) {}\n\t}\n\n\treturn Sizzle( expr, document, null, [ elem ] ).length > 0;\n};\n\nSizzle.contains = function( context, elem ) {\n\t// Set document vars if needed\n\tif ( ( context.ownerDocument || context ) !== document ) {\n\t\tsetDocument( context );\n\t}\n\treturn contains( context, elem );\n};\n\nSizzle.attr = function( elem, name ) {\n\t// Set document vars if needed\n\tif ( ( elem.ownerDocument || elem ) !== document ) {\n\t\tsetDocument( elem );\n\t}\n\n\tvar fn = Expr.attrHandle[ name.toLowerCase() ],\n\t\t// Don't get fooled by Object.prototype properties (jQuery #13807)\n\t\tval = fn && hasOwn.call( Expr.attrHandle, name.toLowerCase() ) ?\n\t\t\tfn( elem, name, !documentIsHTML ) :\n\t\t\tundefined;\n\n\treturn val !== undefined ?\n\t\tval :\n\t\tsupport.attributes || !documentIsHTML ?\n\t\t\telem.getAttribute( name ) :\n\t\t\t(val = elem.getAttributeNode(name)) && val.specified ?\n\t\t\t\tval.value :\n\t\t\t\tnull;\n};\n\nSizzle.error = function( msg ) {\n\tthrow new Error( \"Syntax error, unrecognized expression: \" + msg );\n};\n\n/**\n * Document sorting and removing duplicates\n * @param {ArrayLike} results\n */\nSizzle.uniqueSort = function( results ) {\n\tvar elem,\n\t\tduplicates = [],\n\t\tj = 0,\n\t\ti = 0;\n\n\t// Unless we *know* we can detect duplicates, assume their presence\n\thasDuplicate = !support.detectDuplicates;\n\tsortInput = !support.sortStable && results.slice( 0 );\n\tresults.sort( sortOrder );\n\n\tif ( hasDuplicate ) {\n\t\twhile ( (elem = results[i++]) ) {\n\t\t\tif ( elem === results[ i ] ) {\n\t\t\t\tj = duplicates.push( i );\n\t\t\t}\n\t\t}\n\t\twhile ( j-- ) {\n\t\t\tresults.splice( duplicates[ j ], 1 );\n\t\t}\n\t}\n\n\t// Clear input after sorting to release objects\n\t// See https://github.com/jquery/sizzle/pull/225\n\tsortInput = null;\n\n\treturn results;\n};\n\n/**\n * Utility function for retrieving the text value of an array of DOM nodes\n * @param {Array|Element} elem\n */\ngetText = Sizzle.getText = function( elem ) {\n\tvar node,\n\t\tret = \"\",\n\t\ti = 0,\n\t\tnodeType = elem.nodeType;\n\n\tif ( !nodeType ) {\n\t\t// If no nodeType, this is expected to be an array\n\t\twhile ( (node = elem[i++]) ) {\n\t\t\t// Do not traverse comment nodes\n\t\t\tret += getText( node );\n\t\t}\n\t} else if ( nodeType === 1 || nodeType === 9 || nodeType === 11 ) {\n\t\t// Use textContent for elements\n\t\t// innerText usage removed for consistency of new lines (jQuery #11153)\n\t\tif ( typeof elem.textContent === \"string\" ) {\n\t\t\treturn elem.textContent;\n\t\t} else {\n\t\t\t// Traverse its children\n\t\t\tfor ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {\n\t\t\t\tret += getText( elem );\n\t\t\t}\n\t\t}\n\t} else if ( nodeType === 3 || nodeType === 4 ) {\n\t\treturn elem.nodeValue;\n\t}\n\t// Do not include comment or processing instruction nodes\n\n\treturn ret;\n};\n\nExpr = Sizzle.selectors = {\n\n\t// Can be adjusted by the user\n\tcacheLength: 50,\n\n\tcreatePseudo: markFunction,\n\n\tmatch: matchExpr,\n\n\tattrHandle: {},\n\n\tfind: {},\n\n\trelative: {\n\t\t\">\": { dir: \"parentNode\", first: true },\n\t\t\" \": { dir: \"parentNode\" },\n\t\t\"+\": { dir: \"previousSibling\", first: true },\n\t\t\"~\": { dir: \"previousSibling\" }\n\t},\n\n\tpreFilter: {\n\t\t\"ATTR\": function( match ) {\n\t\t\tmatch[1] = match[1].replace( runescape, funescape );\n\n\t\t\t// Move the given value to match[3] whether quoted or unquoted\n\t\t\tmatch[3] = ( match[3] || match[4] || match[5] || \"\" ).replace( runescape, funescape );\n\n\t\t\tif ( match[2] === \"~=\" ) {\n\t\t\t\tmatch[3] = \" \" + match[3] + \" \";\n\t\t\t}\n\n\t\t\treturn match.slice( 0, 4 );\n\t\t},\n\n\t\t\"CHILD\": function( match ) {\n\t\t\t/* matches from matchExpr[\"CHILD\"]\n\t\t\t\t1 type (only|nth|...)\n\t\t\t\t2 what (child|of-type)\n\t\t\t\t3 argument (even|odd|\\d*|\\d*n([+-]\\d+)?|...)\n\t\t\t\t4 xn-component of xn+y argument ([+-]?\\d*n|)\n\t\t\t\t5 sign of xn-component\n\t\t\t\t6 x of xn-component\n\t\t\t\t7 sign of y-component\n\t\t\t\t8 y of y-component\n\t\t\t*/\n\t\t\tmatch[1] = match[1].toLowerCase();\n\n\t\t\tif ( match[1].slice( 0, 3 ) === \"nth\" ) {\n\t\t\t\t// nth-* requires argument\n\t\t\t\tif ( !match[3] ) {\n\t\t\t\t\tSizzle.error( match[0] );\n\t\t\t\t}\n\n\t\t\t\t// numeric x and y parameters for Expr.filter.CHILD\n\t\t\t\t// remember that false/true cast respectively to 0/1\n\t\t\t\tmatch[4] = +( match[4] ? match[5] + (match[6] || 1) : 2 * ( match[3] === \"even\" || match[3] === \"odd\" ) );\n\t\t\t\tmatch[5] = +( ( match[7] + match[8] ) || match[3] === \"odd\" );\n\n\t\t\t// other types prohibit arguments\n\t\t\t} else if ( match[3] ) {\n\t\t\t\tSizzle.error( match[0] );\n\t\t\t}\n\n\t\t\treturn match;\n\t\t},\n\n\t\t\"PSEUDO\": function( match ) {\n\t\t\tvar excess,\n\t\t\t\tunquoted = !match[6] && match[2];\n\n\t\t\tif ( matchExpr[\"CHILD\"].test( match[0] ) ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\t// Accept quoted arguments as-is\n\t\t\tif ( match[3] ) {\n\t\t\t\tmatch[2] = match[4] || match[5] || \"\";\n\n\t\t\t// Strip excess characters from unquoted arguments\n\t\t\t} else if ( unquoted && rpseudo.test( unquoted ) &&\n\t\t\t\t// Get excess from tokenize (recursively)\n\t\t\t\t(excess = tokenize( unquoted, true )) &&\n\t\t\t\t// advance to the next closing parenthesis\n\t\t\t\t(excess = unquoted.indexOf( \")\", unquoted.length - excess ) - unquoted.length) ) {\n\n\t\t\t\t// excess is a negative index\n\t\t\t\tmatch[0] = match[0].slice( 0, excess );\n\t\t\t\tmatch[2] = unquoted.slice( 0, excess );\n\t\t\t}\n\n\t\t\t// Return only captures needed by the pseudo filter method (type and argument)\n\t\t\treturn match.slice( 0, 3 );\n\t\t}\n\t},\n\n\tfilter: {\n\n\t\t\"TAG\": function( nodeNameSelector ) {\n\t\t\tvar nodeName = nodeNameSelector.replace( runescape, funescape ).toLowerCase();\n\t\t\treturn nodeNameSelector === \"*\" ?\n\t\t\t\tfunction() { return true; } :\n\t\t\t\tfunction( elem ) {\n\t\t\t\t\treturn elem.nodeName && elem.nodeName.toLowerCase() === nodeName;\n\t\t\t\t};\n\t\t},\n\n\t\t\"CLASS\": function( className ) {\n\t\t\tvar pattern = classCache[ className + \" \" ];\n\n\t\t\treturn pattern ||\n\t\t\t\t(pattern = new RegExp( \"(^|\" + whitespace + \")\" + className + \"(\" + whitespace + \"|$)\" )) &&\n\t\t\t\tclassCache( className, function( elem ) {\n\t\t\t\t\treturn pattern.test( typeof elem.className === \"string\" && elem.className || typeof elem.getAttribute !== \"undefined\" && elem.getAttribute(\"class\") || \"\" );\n\t\t\t\t});\n\t\t},\n\n\t\t\"ATTR\": function( name, operator, check ) {\n\t\t\treturn function( elem ) {\n\t\t\t\tvar result = Sizzle.attr( elem, name );\n\n\t\t\t\tif ( result == null ) {\n\t\t\t\t\treturn operator === \"!=\";\n\t\t\t\t}\n\t\t\t\tif ( !operator ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tresult += \"\";\n\n\t\t\t\treturn operator === \"=\" ? result === check :\n\t\t\t\t\toperator === \"!=\" ? result !== check :\n\t\t\t\t\toperator === \"^=\" ? check && result.indexOf( check ) === 0 :\n\t\t\t\t\toperator === \"*=\" ? check && result.indexOf( check ) > -1 :\n\t\t\t\t\toperator === \"$=\" ? check && result.slice( -check.length ) === check :\n\t\t\t\t\toperator === \"~=\" ? ( \" \" + result.replace( rwhitespace, \" \" ) + \" \" ).indexOf( check ) > -1 :\n\t\t\t\t\toperator === \"|=\" ? result === check || result.slice( 0, check.length + 1 ) === check + \"-\" :\n\t\t\t\t\tfalse;\n\t\t\t};\n\t\t},\n\n\t\t\"CHILD\": function( type, what, argument, first, last ) {\n\t\t\tvar simple = type.slice( 0, 3 ) !== \"nth\",\n\t\t\t\tforward = type.slice( -4 ) !== \"last\",\n\t\t\t\tofType = what === \"of-type\";\n\n\t\t\treturn first === 1 && last === 0 ?\n\n\t\t\t\t// Shortcut for :nth-*(n)\n\t\t\t\tfunction( elem ) {\n\t\t\t\t\treturn !!elem.parentNode;\n\t\t\t\t} :\n\n\t\t\t\tfunction( elem, context, xml ) {\n\t\t\t\t\tvar cache, outerCache, node, diff, nodeIndex, start,\n\t\t\t\t\t\tdir = simple !== forward ? \"nextSibling\" : \"previousSibling\",\n\t\t\t\t\t\tparent = elem.parentNode,\n\t\t\t\t\t\tname = ofType && elem.nodeName.toLowerCase(),\n\t\t\t\t\t\tuseCache = !xml && !ofType;\n\n\t\t\t\t\tif ( parent ) {\n\n\t\t\t\t\t\t// :(first|last|only)-(child|of-type)\n\t\t\t\t\t\tif ( simple ) {\n\t\t\t\t\t\t\twhile ( dir ) {\n\t\t\t\t\t\t\t\tnode = elem;\n\t\t\t\t\t\t\t\twhile ( (node = node[ dir ]) ) {\n\t\t\t\t\t\t\t\t\tif ( ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1 ) {\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// Reverse direction for :only-* (if we haven't yet done so)\n\t\t\t\t\t\t\t\tstart = dir = type === \"only\" && !start && \"nextSibling\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstart = [ forward ? parent.firstChild : parent.lastChild ];\n\n\t\t\t\t\t\t// non-xml :nth-child(...) stores cache data on `parent`\n\t\t\t\t\t\tif ( forward && useCache ) {\n\t\t\t\t\t\t\t// Seek `elem` from a previously-cached index\n\t\t\t\t\t\t\touterCache = parent[ expando ] || (parent[ expando ] = {});\n\t\t\t\t\t\t\tcache = outerCache[ type ] || [];\n\t\t\t\t\t\t\tnodeIndex = cache[0] === dirruns && cache[1];\n\t\t\t\t\t\t\tdiff = cache[0] === dirruns && cache[2];\n\t\t\t\t\t\t\tnode = nodeIndex && parent.childNodes[ nodeIndex ];\n\n\t\t\t\t\t\t\twhile ( (node = ++nodeIndex && node && node[ dir ] ||\n\n\t\t\t\t\t\t\t\t// Fallback to seeking `elem` from the start\n\t\t\t\t\t\t\t\t(diff = nodeIndex = 0) || start.pop()) ) {\n\n\t\t\t\t\t\t\t\t// When found, cache indexes on `parent` and break\n\t\t\t\t\t\t\t\tif ( node.nodeType === 1 && ++diff && node === elem ) {\n\t\t\t\t\t\t\t\t\touterCache[ type ] = [ dirruns, nodeIndex, diff ];\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Use previously-cached element index if available\n\t\t\t\t\t\t} else if ( useCache && (cache = (elem[ expando ] || (elem[ expando ] = {}))[ type ]) && cache[0] === dirruns ) {\n\t\t\t\t\t\t\tdiff = cache[1];\n\n\t\t\t\t\t\t// xml :nth-child(...) or :nth-last-child(...) or :nth(-last)?-of-type(...)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Use the same loop as above to seek `elem` from the start\n\t\t\t\t\t\t\twhile ( (node = ++nodeIndex && node && node[ dir ] ||\n\t\t\t\t\t\t\t\t(diff = nodeIndex = 0) || start.pop()) ) {\n\n\t\t\t\t\t\t\t\tif ( ( ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1 ) && ++diff ) {\n\t\t\t\t\t\t\t\t\t// Cache the index of each encountered element\n\t\t\t\t\t\t\t\t\tif ( useCache ) {\n\t\t\t\t\t\t\t\t\t\t(node[ expando ] || (node[ expando ] = {}))[ type ] = [ dirruns, diff ];\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif ( node === elem ) {\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Incorporate the offset, then check against cycle size\n\t\t\t\t\t\tdiff -= last;\n\t\t\t\t\t\treturn diff === first || ( diff % first === 0 && diff / first >= 0 );\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t},\n\n\t\t\"PSEUDO\": function( pseudo, argument ) {\n\t\t\t// pseudo-class names are case-insensitive\n\t\t\t// http://www.w3.org/TR/selectors/#pseudo-classes\n\t\t\t// Prioritize by case sensitivity in case custom pseudos are added with uppercase letters\n\t\t\t// Remember that setFilters inherits from pseudos\n\t\t\tvar args,\n\t\t\t\tfn = Expr.pseudos[ pseudo ] || Expr.setFilters[ pseudo.toLowerCase() ] ||\n\t\t\t\t\tSizzle.error( \"unsupported pseudo: \" + pseudo );\n\n\t\t\t// The user may use createPseudo to indicate that\n\t\t\t// arguments are needed to create the filter function\n\t\t\t// just as Sizzle does\n\t\t\tif ( fn[ expando ] ) {\n\t\t\t\treturn fn( argument );\n\t\t\t}\n\n\t\t\t// But maintain support for old signatures\n\t\t\tif ( fn.length > 1 ) {\n\t\t\t\targs = [ pseudo, pseudo, \"\", argument ];\n\t\t\t\treturn Expr.setFilters.hasOwnProperty( pseudo.toLowerCase() ) ?\n\t\t\t\t\tmarkFunction(function( seed, matches ) {\n\t\t\t\t\t\tvar idx,\n\t\t\t\t\t\t\tmatched = fn( seed, argument ),\n\t\t\t\t\t\t\ti = matched.length;\n\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\tidx = indexOf( seed, matched[i] );\n\t\t\t\t\t\t\tseed[ idx ] = !( matches[ idx ] = matched[i] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}) :\n\t\t\t\t\tfunction( elem ) {\n\t\t\t\t\t\treturn fn( elem, 0, args );\n\t\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn fn;\n\t\t}\n\t},\n\n\tpseudos: {\n\t\t// Potentially complex pseudos\n\t\t\"not\": markFunction(function( selector ) {\n\t\t\t// Trim the selector passed to compile\n\t\t\t// to avoid treating leading and trailing\n\t\t\t// spaces as combinators\n\t\t\tvar input = [],\n\t\t\t\tresults = [],\n\t\t\t\tmatcher = compile( selector.replace( rtrim, \"$1\" ) );\n\n\t\t\treturn matcher[ expando ] ?\n\t\t\t\tmarkFunction(function( seed, matches, context, xml ) {\n\t\t\t\t\tvar elem,\n\t\t\t\t\t\tunmatched = matcher( seed, null, xml, [] ),\n\t\t\t\t\t\ti = seed.length;\n\n\t\t\t\t\t// Match elements unmatched by `matcher`\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tif ( (elem = unmatched[i]) ) {\n\t\t\t\t\t\t\tseed[i] = !(matches[i] = elem);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}) :\n\t\t\t\tfunction( elem, context, xml ) {\n\t\t\t\t\tinput[0] = elem;\n\t\t\t\t\tmatcher( input, null, xml, results );\n\t\t\t\t\t// Don't keep the element (issue #299)\n\t\t\t\t\tinput[0] = null;\n\t\t\t\t\treturn !results.pop();\n\t\t\t\t};\n\t\t}),\n\n\t\t\"has\": markFunction(function( selector ) {\n\t\t\treturn function( elem ) {\n\t\t\t\treturn Sizzle( selector, elem ).length > 0;\n\t\t\t};\n\t\t}),\n\n\t\t\"contains\": markFunction(function( text ) {\n\t\t\ttext = text.replace( runescape, funescape );\n\t\t\treturn function( elem ) {\n\t\t\t\treturn ( elem.textContent || elem.innerText || getText( elem ) ).indexOf( text ) > -1;\n\t\t\t};\n\t\t}),\n\n\t\t// \"Whether an element is represented by a :lang() selector\n\t\t// is based solely on the element's language value\n\t\t// being equal to the identifier C,\n\t\t// or beginning with the identifier C immediately followed by \"-\".\n\t\t// The matching of C against the element's language value is performed case-insensitively.\n\t\t// The identifier C does not have to be a valid language name.\"\n\t\t// http://www.w3.org/TR/selectors/#lang-pseudo\n\t\t\"lang\": markFunction( function( lang ) {\n\t\t\t// lang value must be a valid identifier\n\t\t\tif ( !ridentifier.test(lang || \"\") ) {\n\t\t\t\tSizzle.error( \"unsupported lang: \" + lang );\n\t\t\t}\n\t\t\tlang = lang.replace( runescape, funescape ).toLowerCase();\n\t\t\treturn function( elem ) {\n\t\t\t\tvar elemLang;\n\t\t\t\tdo {\n\t\t\t\t\tif ( (elemLang = documentIsHTML ?\n\t\t\t\t\t\telem.lang :\n\t\t\t\t\t\telem.getAttribute(\"xml:lang\") || elem.getAttribute(\"lang\")) ) {\n\n\t\t\t\t\t\telemLang = elemLang.toLowerCase();\n\t\t\t\t\t\treturn elemLang === lang || elemLang.indexOf( lang + \"-\" ) === 0;\n\t\t\t\t\t}\n\t\t\t\t} while ( (elem = elem.parentNode) && elem.nodeType === 1 );\n\t\t\t\treturn false;\n\t\t\t};\n\t\t}),\n\n\t\t// Miscellaneous\n\t\t\"target\": function( elem ) {\n\t\t\tvar hash = window.location && window.location.hash;\n\t\t\treturn hash && hash.slice( 1 ) === elem.id;\n\t\t},\n\n\t\t\"root\": function( elem ) {\n\t\t\treturn elem === docElem;\n\t\t},\n\n\t\t\"focus\": function( elem ) {\n\t\t\treturn elem === document.activeElement && (!document.hasFocus || document.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);\n\t\t},\n\n\t\t// Boolean properties\n\t\t\"enabled\": function( elem ) {\n\t\t\treturn elem.disabled === false;\n\t\t},\n\n\t\t\"disabled\": function( elem ) {\n\t\t\treturn elem.disabled === true;\n\t\t},\n\n\t\t\"checked\": function( elem ) {\n\t\t\t// In CSS3, :checked should return both checked and selected elements\n\t\t\t// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked\n\t\t\tvar nodeName = elem.nodeName.toLowerCase();\n\t\t\treturn (nodeName === \"input\" && !!elem.checked) || (nodeName === \"option\" && !!elem.selected);\n\t\t},\n\n\t\t\"selected\": function( elem ) {\n\t\t\t// Accessing this property makes selected-by-default\n\t\t\t// options in Safari work properly\n\t\t\tif ( elem.parentNode ) {\n\t\t\t\telem.parentNode.selectedIndex;\n\t\t\t}\n\n\t\t\treturn elem.selected === true;\n\t\t},\n\n\t\t// Contents\n\t\t\"empty\": function( elem ) {\n\t\t\t// http://www.w3.org/TR/selectors/#empty-pseudo\n\t\t\t// :empty is negated by element (1) or content nodes (text: 3; cdata: 4; entity ref: 5),\n\t\t\t//   but not by others (comment: 8; processing instruction: 7; etc.)\n\t\t\t// nodeType < 6 works because attributes (2) do not appear as children\n\t\t\tfor ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {\n\t\t\t\tif ( elem.nodeType < 6 ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\n\t\t\"parent\": function( elem ) {\n\t\t\treturn !Expr.pseudos[\"empty\"]( elem );\n\t\t},\n\n\t\t// Element/input types\n\t\t\"header\": function( elem ) {\n\t\t\treturn rheader.test( elem.nodeName );\n\t\t},\n\n\t\t\"input\": function( elem ) {\n\t\t\treturn rinputs.test( elem.nodeName );\n\t\t},\n\n\t\t\"button\": function( elem ) {\n\t\t\tvar name = elem.nodeName.toLowerCase();\n\t\t\treturn name === \"input\" && elem.type === \"button\" || name === \"button\";\n\t\t},\n\n\t\t\"text\": function( elem ) {\n\t\t\tvar attr;\n\t\t\treturn elem.nodeName.toLowerCase() === \"input\" &&\n\t\t\t\telem.type === \"text\" &&\n\n\t\t\t\t// Support: IE<8\n\t\t\t\t// New HTML5 attribute values (e.g., \"search\") appear with elem.type === \"text\"\n\t\t\t\t( (attr = elem.getAttribute(\"type\")) == null || attr.toLowerCase() === \"text\" );\n\t\t},\n\n\t\t// Position-in-collection\n\t\t\"first\": createPositionalPseudo(function() {\n\t\t\treturn [ 0 ];\n\t\t}),\n\n\t\t\"last\": createPositionalPseudo(function( matchIndexes, length ) {\n\t\t\treturn [ length - 1 ];\n\t\t}),\n\n\t\t\"eq\": createPositionalPseudo(function( matchIndexes, length, argument ) {\n\t\t\treturn [ argument < 0 ? argument + length : argument ];\n\t\t}),\n\n\t\t\"even\": createPositionalPseudo(function( matchIndexes, length ) {\n\t\t\tvar i = 0;\n\t\t\tfor ( ; i < length; i += 2 ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t}),\n\n\t\t\"odd\": createPositionalPseudo(function( matchIndexes, length ) {\n\t\t\tvar i = 1;\n\t\t\tfor ( ; i < length; i += 2 ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t}),\n\n\t\t\"lt\": createPositionalPseudo(function( matchIndexes, length, argument ) {\n\t\t\tvar i = argument < 0 ? argument + length : argument;\n\t\t\tfor ( ; --i >= 0; ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t}),\n\n\t\t\"gt\": createPositionalPseudo(function( matchIndexes, length, argument ) {\n\t\t\tvar i = argument < 0 ? argument + length : argument;\n\t\t\tfor ( ; ++i < length; ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t})\n\t}\n};\n\nExpr.pseudos[\"nth\"] = Expr.pseudos[\"eq\"];\n\n// Add button/input type pseudos\nfor ( i in { radio: true, checkbox: true, file: true, password: true, image: true } ) {\n\tExpr.pseudos[ i ] = createInputPseudo( i );\n}\nfor ( i in { submit: true, reset: true } ) {\n\tExpr.pseudos[ i ] = createButtonPseudo( i );\n}\n\n// Easy API for creating new setFilters\nfunction setFilters() {}\nsetFilters.prototype = Expr.filters = Expr.pseudos;\nExpr.setFilters = new setFilters();\n\ntokenize = Sizzle.tokenize = function( selector, parseOnly ) {\n\tvar matched, match, tokens, type,\n\t\tsoFar, groups, preFilters,\n\t\tcached = tokenCache[ selector + \" \" ];\n\n\tif ( cached ) {\n\t\treturn parseOnly ? 0 : cached.slice( 0 );\n\t}\n\n\tsoFar = selector;\n\tgroups = [];\n\tpreFilters = Expr.preFilter;\n\n\twhile ( soFar ) {\n\n\t\t// Comma and first run\n\t\tif ( !matched || (match = rcomma.exec( soFar )) ) {\n\t\t\tif ( match ) {\n\t\t\t\t// Don't consume trailing commas as valid\n\t\t\t\tsoFar = soFar.slice( match[0].length ) || soFar;\n\t\t\t}\n\t\t\tgroups.push( (tokens = []) );\n\t\t}\n\n\t\tmatched = false;\n\n\t\t// Combinators\n\t\tif ( (match = rcombinators.exec( soFar )) ) {\n\t\t\tmatched = match.shift();\n\t\t\ttokens.push({\n\t\t\t\tvalue: matched,\n\t\t\t\t// Cast descendant combinators to space\n\t\t\t\ttype: match[0].replace( rtrim, \" \" )\n\t\t\t});\n\t\t\tsoFar = soFar.slice( matched.length );\n\t\t}\n\n\t\t// Filters\n\t\tfor ( type in Expr.filter ) {\n\t\t\tif ( (match = matchExpr[ type ].exec( soFar )) && (!preFilters[ type ] ||\n\t\t\t\t(match = preFilters[ type ]( match ))) ) {\n\t\t\t\tmatched = match.shift();\n\t\t\t\ttokens.push({\n\t\t\t\t\tvalue: matched,\n\t\t\t\t\ttype: type,\n\t\t\t\t\tmatches: match\n\t\t\t\t});\n\t\t\t\tsoFar = soFar.slice( matched.length );\n\t\t\t}\n\t\t}\n\n\t\tif ( !matched ) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t// Return the length of the invalid excess\n\t// if we're just parsing\n\t// Otherwise, throw an error or return tokens\n\treturn parseOnly ?\n\t\tsoFar.length :\n\t\tsoFar ?\n\t\t\tSizzle.error( selector ) :\n\t\t\t// Cache the tokens\n\t\t\ttokenCache( selector, groups ).slice( 0 );\n};\n\nfunction toSelector( tokens ) {\n\tvar i = 0,\n\t\tlen = tokens.length,\n\t\tselector = \"\";\n\tfor ( ; i < len; i++ ) {\n\t\tselector += tokens[i].value;\n\t}\n\treturn selector;\n}\n\nfunction addCombinator( matcher, combinator, base ) {\n\tvar dir = combinator.dir,\n\t\tcheckNonElements = base && dir === \"parentNode\",\n\t\tdoneName = done++;\n\n\treturn combinator.first ?\n\t\t// Check against closest ancestor/preceding element\n\t\tfunction( elem, context, xml ) {\n\t\t\twhile ( (elem = elem[ dir ]) ) {\n\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\n\t\t\t\t\treturn matcher( elem, context, xml );\n\t\t\t\t}\n\t\t\t}\n\t\t} :\n\n\t\t// Check against all ancestor/preceding elements\n\t\tfunction( elem, context, xml ) {\n\t\t\tvar oldCache, outerCache,\n\t\t\t\tnewCache = [ dirruns, doneName ];\n\n\t\t\t// We can't set arbitrary data on XML nodes, so they don't benefit from dir caching\n\t\t\tif ( xml ) {\n\t\t\t\twhile ( (elem = elem[ dir ]) ) {\n\t\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\n\t\t\t\t\t\tif ( matcher( elem, context, xml ) ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\twhile ( (elem = elem[ dir ]) ) {\n\t\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\n\t\t\t\t\t\touterCache = elem[ expando ] || (elem[ expando ] = {});\n\t\t\t\t\t\tif ( (oldCache = outerCache[ dir ]) &&\n\t\t\t\t\t\t\toldCache[ 0 ] === dirruns && oldCache[ 1 ] === doneName ) {\n\n\t\t\t\t\t\t\t// Assign to newCache so results back-propagate to previous elements\n\t\t\t\t\t\t\treturn (newCache[ 2 ] = oldCache[ 2 ]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Reuse newcache so results back-propagate to previous elements\n\t\t\t\t\t\t\touterCache[ dir ] = newCache;\n\n\t\t\t\t\t\t\t// A match means we're done; a fail means we have to keep checking\n\t\t\t\t\t\t\tif ( (newCache[ 2 ] = matcher( elem, context, xml )) ) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n}\n\nfunction elementMatcher( matchers ) {\n\treturn matchers.length > 1 ?\n\t\tfunction( elem, context, xml ) {\n\t\t\tvar i = matchers.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( !matchers[i]( elem, context, xml ) ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t} :\n\t\tmatchers[0];\n}\n\nfunction multipleContexts( selector, contexts, results ) {\n\tvar i = 0,\n\t\tlen = contexts.length;\n\tfor ( ; i < len; i++ ) {\n\t\tSizzle( selector, contexts[i], results );\n\t}\n\treturn results;\n}\n\nfunction condense( unmatched, map, filter, context, xml ) {\n\tvar elem,\n\t\tnewUnmatched = [],\n\t\ti = 0,\n\t\tlen = unmatched.length,\n\t\tmapped = map != null;\n\n\tfor ( ; i < len; i++ ) {\n\t\tif ( (elem = unmatched[i]) ) {\n\t\t\tif ( !filter || filter( elem, context, xml ) ) {\n\t\t\t\tnewUnmatched.push( elem );\n\t\t\t\tif ( mapped ) {\n\t\t\t\t\tmap.push( i );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn newUnmatched;\n}\n\nfunction setMatcher( preFilter, selector, matcher, postFilter, postFinder, postSelector ) {\n\tif ( postFilter && !postFilter[ expando ] ) {\n\t\tpostFilter = setMatcher( postFilter );\n\t}\n\tif ( postFinder && !postFinder[ expando ] ) {\n\t\tpostFinder = setMatcher( postFinder, postSelector );\n\t}\n\treturn markFunction(function( seed, results, context, xml ) {\n\t\tvar temp, i, elem,\n\t\t\tpreMap = [],\n\t\t\tpostMap = [],\n\t\t\tpreexisting = results.length,\n\n\t\t\t// Get initial elements from seed or context\n\t\t\telems = seed || multipleContexts( selector || \"*\", context.nodeType ? [ context ] : context, [] ),\n\n\t\t\t// Prefilter to get matcher input, preserving a map for seed-results synchronization\n\t\t\tmatcherIn = preFilter && ( seed || !selector ) ?\n\t\t\t\tcondense( elems, preMap, preFilter, context, xml ) :\n\t\t\t\telems,\n\n\t\t\tmatcherOut = matcher ?\n\t\t\t\t// If we have a postFinder, or filtered seed, or non-seed postFilter or preexisting results,\n\t\t\t\tpostFinder || ( seed ? preFilter : preexisting || postFilter ) ?\n\n\t\t\t\t\t// ...intermediate processing is necessary\n\t\t\t\t\t[] :\n\n\t\t\t\t\t// ...otherwise use results directly\n\t\t\t\t\tresults :\n\t\t\t\tmatcherIn;\n\n\t\t// Find primary matches\n\t\tif ( matcher ) {\n\t\t\tmatcher( matcherIn, matcherOut, context, xml );\n\t\t}\n\n\t\t// Apply postFilter\n\t\tif ( postFilter ) {\n\t\t\ttemp = condense( matcherOut, postMap );\n\t\t\tpostFilter( temp, [], context, xml );\n\n\t\t\t// Un-match failing elements by moving them back to matcherIn\n\t\t\ti = temp.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( (elem = temp[i]) ) {\n\t\t\t\t\tmatcherOut[ postMap[i] ] = !(matcherIn[ postMap[i] ] = elem);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( seed ) {\n\t\t\tif ( postFinder || preFilter ) {\n\t\t\t\tif ( postFinder ) {\n\t\t\t\t\t// Get the final matcherOut by condensing this intermediate into postFinder contexts\n\t\t\t\t\ttemp = [];\n\t\t\t\t\ti = matcherOut.length;\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tif ( (elem = matcherOut[i]) ) {\n\t\t\t\t\t\t\t// Restore matcherIn since elem is not yet a final match\n\t\t\t\t\t\t\ttemp.push( (matcherIn[i] = elem) );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tpostFinder( null, (matcherOut = []), temp, xml );\n\t\t\t\t}\n\n\t\t\t\t// Move matched elements from seed to results to keep them synchronized\n\t\t\t\ti = matcherOut.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tif ( (elem = matcherOut[i]) &&\n\t\t\t\t\t\t(temp = postFinder ? indexOf( seed, elem ) : preMap[i]) > -1 ) {\n\n\t\t\t\t\t\tseed[temp] = !(results[temp] = elem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t// Add elements to results, through postFinder if defined\n\t\t} else {\n\t\t\tmatcherOut = condense(\n\t\t\t\tmatcherOut === results ?\n\t\t\t\t\tmatcherOut.splice( preexisting, matcherOut.length ) :\n\t\t\t\t\tmatcherOut\n\t\t\t);\n\t\t\tif ( postFinder ) {\n\t\t\t\tpostFinder( null, results, matcherOut, xml );\n\t\t\t} else {\n\t\t\t\tpush.apply( results, matcherOut );\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction matcherFromTokens( tokens ) {\n\tvar checkContext, matcher, j,\n\t\tlen = tokens.length,\n\t\tleadingRelative = Expr.relative[ tokens[0].type ],\n\t\timplicitRelative = leadingRelative || Expr.relative[\" \"],\n\t\ti = leadingRelative ? 1 : 0,\n\n\t\t// The foundational matcher ensures that elements are reachable from top-level context(s)\n\t\tmatchContext = addCombinator( function( elem ) {\n\t\t\treturn elem === checkContext;\n\t\t}, implicitRelative, true ),\n\t\tmatchAnyContext = addCombinator( function( elem ) {\n\t\t\treturn indexOf( checkContext, elem ) > -1;\n\t\t}, implicitRelative, true ),\n\t\tmatchers = [ function( elem, context, xml ) {\n\t\t\tvar ret = ( !leadingRelative && ( xml || context !== outermostContext ) ) || (\n\t\t\t\t(checkContext = context).nodeType ?\n\t\t\t\t\tmatchContext( elem, context, xml ) :\n\t\t\t\t\tmatchAnyContext( elem, context, xml ) );\n\t\t\t// Avoid hanging onto element (issue #299)\n\t\t\tcheckContext = null;\n\t\t\treturn ret;\n\t\t} ];\n\n\tfor ( ; i < len; i++ ) {\n\t\tif ( (matcher = Expr.relative[ tokens[i].type ]) ) {\n\t\t\tmatchers = [ addCombinator(elementMatcher( matchers ), matcher) ];\n\t\t} else {\n\t\t\tmatcher = Expr.filter[ tokens[i].type ].apply( null, tokens[i].matches );\n\n\t\t\t// Return special upon seeing a positional matcher\n\t\t\tif ( matcher[ expando ] ) {\n\t\t\t\t// Find the next relative operator (if any) for proper handling\n\t\t\t\tj = ++i;\n\t\t\t\tfor ( ; j < len; j++ ) {\n\t\t\t\t\tif ( Expr.relative[ tokens[j].type ] ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn setMatcher(\n\t\t\t\t\ti > 1 && elementMatcher( matchers ),\n\t\t\t\t\ti > 1 && toSelector(\n\t\t\t\t\t\t// If the preceding token was a descendant combinator, insert an implicit any-element `*`\n\t\t\t\t\t\ttokens.slice( 0, i - 1 ).concat({ value: tokens[ i - 2 ].type === \" \" ? \"*\" : \"\" })\n\t\t\t\t\t).replace( rtrim, \"$1\" ),\n\t\t\t\t\tmatcher,\n\t\t\t\t\ti < j && matcherFromTokens( tokens.slice( i, j ) ),\n\t\t\t\t\tj < len && matcherFromTokens( (tokens = tokens.slice( j )) ),\n\t\t\t\t\tj < len && toSelector( tokens )\n\t\t\t\t);\n\t\t\t}\n\t\t\tmatchers.push( matcher );\n\t\t}\n\t}\n\n\treturn elementMatcher( matchers );\n}\n\nfunction matcherFromGroupMatchers( elementMatchers, setMatchers ) {\n\tvar bySet = setMatchers.length > 0,\n\t\tbyElement = elementMatchers.length > 0,\n\t\tsuperMatcher = function( seed, context, xml, results, outermost ) {\n\t\t\tvar elem, j, matcher,\n\t\t\t\tmatchedCount = 0,\n\t\t\t\ti = \"0\",\n\t\t\t\tunmatched = seed && [],\n\t\t\t\tsetMatched = [],\n\t\t\t\tcontextBackup = outermostContext,\n\t\t\t\t// We must always have either seed elements or outermost context\n\t\t\t\telems = seed || byElement && Expr.find[\"TAG\"]( \"*\", outermost ),\n\t\t\t\t// Use integer dirruns iff this is the outermost matcher\n\t\t\t\tdirrunsUnique = (dirruns += contextBackup == null ? 1 : Math.random() || 0.1),\n\t\t\t\tlen = elems.length;\n\n\t\t\tif ( outermost ) {\n\t\t\t\toutermostContext = context !== document && context;\n\t\t\t}\n\n\t\t\t// Add elements passing elementMatchers directly to results\n\t\t\t// Keep `i` a string if there are no elements so `matchedCount` will be \"00\" below\n\t\t\t// Support: IE<9, Safari\n\t\t\t// Tolerate NodeList properties (IE: \"length\"; Safari: <number>) matching elements by id\n\t\t\tfor ( ; i !== len && (elem = elems[i]) != null; i++ ) {\n\t\t\t\tif ( byElement && elem ) {\n\t\t\t\t\tj = 0;\n\t\t\t\t\twhile ( (matcher = elementMatchers[j++]) ) {\n\t\t\t\t\t\tif ( matcher( elem, context, xml ) ) {\n\t\t\t\t\t\t\tresults.push( elem );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif ( outermost ) {\n\t\t\t\t\t\tdirruns = dirrunsUnique;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Track unmatched elements for set filters\n\t\t\t\tif ( bySet ) {\n\t\t\t\t\t// They will have gone through all possible matchers\n\t\t\t\t\tif ( (elem = !matcher && elem) ) {\n\t\t\t\t\t\tmatchedCount--;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Lengthen the array for every element, matched or not\n\t\t\t\t\tif ( seed ) {\n\t\t\t\t\t\tunmatched.push( elem );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Apply set filters to unmatched elements\n\t\t\tmatchedCount += i;\n\t\t\tif ( bySet && i !== matchedCount ) {\n\t\t\t\tj = 0;\n\t\t\t\twhile ( (matcher = setMatchers[j++]) ) {\n\t\t\t\t\tmatcher( unmatched, setMatched, context, xml );\n\t\t\t\t}\n\n\t\t\t\tif ( seed ) {\n\t\t\t\t\t// Reintegrate element matches to eliminate the need for sorting\n\t\t\t\t\tif ( matchedCount > 0 ) {\n\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\tif ( !(unmatched[i] || setMatched[i]) ) {\n\t\t\t\t\t\t\t\tsetMatched[i] = pop.call( results );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Discard index placeholder values to get only actual matches\n\t\t\t\t\tsetMatched = condense( setMatched );\n\t\t\t\t}\n\n\t\t\t\t// Add matches to results\n\t\t\t\tpush.apply( results, setMatched );\n\n\t\t\t\t// Seedless set matches succeeding multiple successful matchers stipulate sorting\n\t\t\t\tif ( outermost && !seed && setMatched.length > 0 &&\n\t\t\t\t\t( matchedCount + setMatchers.length ) > 1 ) {\n\n\t\t\t\t\tSizzle.uniqueSort( results );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Override manipulation of globals by nested matchers\n\t\t\tif ( outermost ) {\n\t\t\t\tdirruns = dirrunsUnique;\n\t\t\t\toutermostContext = contextBackup;\n\t\t\t}\n\n\t\t\treturn unmatched;\n\t\t};\n\n\treturn bySet ?\n\t\tmarkFunction( superMatcher ) :\n\t\tsuperMatcher;\n}\n\ncompile = Sizzle.compile = function( selector, match /* Internal Use Only */ ) {\n\tvar i,\n\t\tsetMatchers = [],\n\t\telementMatchers = [],\n\t\tcached = compilerCache[ selector + \" \" ];\n\n\tif ( !cached ) {\n\t\t// Generate a function of recursive functions that can be used to check each element\n\t\tif ( !match ) {\n\t\t\tmatch = tokenize( selector );\n\t\t}\n\t\ti = match.length;\n\t\twhile ( i-- ) {\n\t\t\tcached = matcherFromTokens( match[i] );\n\t\t\tif ( cached[ expando ] ) {\n\t\t\t\tsetMatchers.push( cached );\n\t\t\t} else {\n\t\t\t\telementMatchers.push( cached );\n\t\t\t}\n\t\t}\n\n\t\t// Cache the compiled function\n\t\tcached = compilerCache( selector, matcherFromGroupMatchers( elementMatchers, setMatchers ) );\n\n\t\t// Save selector and tokenization\n\t\tcached.selector = selector;\n\t}\n\treturn cached;\n};\n\n/**\n * A low-level selection function that works with Sizzle's compiled\n *  selector functions\n * @param {String|Function} selector A selector or a pre-compiled\n *  selector function built with Sizzle.compile\n * @param {Element} context\n * @param {Array} [results]\n * @param {Array} [seed] A set of elements to match against\n */\nselect = Sizzle.select = function( selector, context, results, seed ) {\n\tvar i, tokens, token, type, find,\n\t\tcompiled = typeof selector === \"function\" && selector,\n\t\tmatch = !seed && tokenize( (selector = compiled.selector || selector) );\n\n\tresults = results || [];\n\n\t// Try to minimize operations if there is no seed and only one group\n\tif ( match.length === 1 ) {\n\n\t\t// Take a shortcut and set the context if the root selector is an ID\n\t\ttokens = match[0] = match[0].slice( 0 );\n\t\tif ( tokens.length > 2 && (token = tokens[0]).type === \"ID\" &&\n\t\t\t\tsupport.getById && context.nodeType === 9 && documentIsHTML &&\n\t\t\t\tExpr.relative[ tokens[1].type ] ) {\n\n\t\t\tcontext = ( Expr.find[\"ID\"]( token.matches[0].replace(runescape, funescape), context ) || [] )[0];\n\t\t\tif ( !context ) {\n\t\t\t\treturn results;\n\n\t\t\t// Precompiled matchers will still verify ancestry, so step up a level\n\t\t\t} else if ( compiled ) {\n\t\t\t\tcontext = context.parentNode;\n\t\t\t}\n\n\t\t\tselector = selector.slice( tokens.shift().value.length );\n\t\t}\n\n\t\t// Fetch a seed set for right-to-left matching\n\t\ti = matchExpr[\"needsContext\"].test( selector ) ? 0 : tokens.length;\n\t\twhile ( i-- ) {\n\t\t\ttoken = tokens[i];\n\n\t\t\t// Abort if we hit a combinator\n\t\t\tif ( Expr.relative[ (type = token.type) ] ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif ( (find = Expr.find[ type ]) ) {\n\t\t\t\t// Search, expanding context for leading sibling combinators\n\t\t\t\tif ( (seed = find(\n\t\t\t\t\ttoken.matches[0].replace( runescape, funescape ),\n\t\t\t\t\trsibling.test( tokens[0].type ) && testContext( context.parentNode ) || context\n\t\t\t\t)) ) {\n\n\t\t\t\t\t// If seed is empty or no tokens remain, we can return early\n\t\t\t\t\ttokens.splice( i, 1 );\n\t\t\t\t\tselector = seed.length && toSelector( tokens );\n\t\t\t\t\tif ( !selector ) {\n\t\t\t\t\t\tpush.apply( results, seed );\n\t\t\t\t\t\treturn results;\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Compile and execute a filtering function if one is not provided\n\t// Provide `match` to avoid retokenization if we modified the selector above\n\t( compiled || compile( selector, match ) )(\n\t\tseed,\n\t\tcontext,\n\t\t!documentIsHTML,\n\t\tresults,\n\t\trsibling.test( selector ) && testContext( context.parentNode ) || context\n\t);\n\treturn results;\n};\n\n// One-time assignments\n\n// Sort stability\nsupport.sortStable = expando.split(\"\").sort( sortOrder ).join(\"\") === expando;\n\n// Support: Chrome 14-35+\n// Always assume duplicates if they aren't passed to the comparison function\nsupport.detectDuplicates = !!hasDuplicate;\n\n// Initialize against the default document\nsetDocument();\n\n// Support: Webkit<537.32 - Safari 6.0.3/Chrome 25 (fixed in Chrome 27)\n// Detached nodes confoundingly follow *each other*\nsupport.sortDetached = assert(function( div1 ) {\n\t// Should return 1, but returns 4 (following)\n\treturn div1.compareDocumentPosition( document.createElement(\"div\") ) & 1;\n});\n\n// Support: IE<8\n// Prevent attribute/property \"interpolation\"\n// http://msdn.microsoft.com/en-us/library/ms536429%28VS.85%29.aspx\nif ( !assert(function( div ) {\n\tdiv.innerHTML = \"<a href='#'></a>\";\n\treturn div.firstChild.getAttribute(\"href\") === \"#\" ;\n}) ) {\n\taddHandle( \"type|href|height|width\", function( elem, name, isXML ) {\n\t\tif ( !isXML ) {\n\t\t\treturn elem.getAttribute( name, name.toLowerCase() === \"type\" ? 1 : 2 );\n\t\t}\n\t});\n}\n\n// Support: IE<9\n// Use defaultValue in place of getAttribute(\"value\")\nif ( !support.attributes || !assert(function( div ) {\n\tdiv.innerHTML = \"<input/>\";\n\tdiv.firstChild.setAttribute( \"value\", \"\" );\n\treturn div.firstChild.getAttribute( \"value\" ) === \"\";\n}) ) {\n\taddHandle( \"value\", function( elem, name, isXML ) {\n\t\tif ( !isXML && elem.nodeName.toLowerCase() === \"input\" ) {\n\t\t\treturn elem.defaultValue;\n\t\t}\n\t});\n}\n\n// Support: IE<9\n// Use getAttributeNode to fetch booleans when getAttribute lies\nif ( !assert(function( div ) {\n\treturn div.getAttribute(\"disabled\") == null;\n}) ) {\n\taddHandle( booleans, function( elem, name, isXML ) {\n\t\tvar val;\n\t\tif ( !isXML ) {\n\t\t\treturn elem[ name ] === true ? name.toLowerCase() :\n\t\t\t\t\t(val = elem.getAttributeNode( name )) && val.specified ?\n\t\t\t\t\tval.value :\n\t\t\t\tnull;\n\t\t}\n\t});\n}\n\n// EXPOSE\nif ( typeof define === \"function\" && define.amd ) {\n\tdefine(function() { return Sizzle; });\n// Sizzle requires that there be a global window in Common-JS like environments\n} else if ( typeof module !== \"undefined\" && module.exports ) {\n\tmodule.exports = Sizzle;\n} else {\n\twindow.Sizzle = Sizzle;\n}\n// EXPOSE\n\n})( window );\n","/**!\n * Sortable\n * @author\tRubaXa   <trash@rubaxa.org>\n * @license MIT\n */\n\n\n(function (factory) {\n\t\"use strict\";\n\n\tif (typeof define === \"function\" && define.amd) {\n\t\tdefine(factory);\n\t}\n\telse if (typeof module != \"undefined\" && typeof module.exports != \"undefined\") {\n\t\tmodule.exports = factory();\n\t}\n\telse if (typeof Package !== \"undefined\") {\n\t\tSortable = factory();  // export for Meteor.js\n\t}\n\telse {\n\t\t/* jshint sub:true */\n\t\twindow[\"Sortable\"] = factory();\n\t}\n})(function () {\n\t\"use strict\";\n\n\tvar dragEl,\n\t\tghostEl,\n\t\tcloneEl,\n\t\trootEl,\n\t\tscrollEl,\n\t\tnextEl,\n\n\t\tlastEl,\n\t\tlastCSS,\n\n\t\toldIndex,\n\t\tnewIndex,\n\n\t\tactiveGroup,\n\t\tautoScroll = {},\n\n\t\ttapEvt,\n\t\ttouchEvt,\n\n\t\texpando = 'Sortable' + (new Date).getTime(),\n\n\t\twin = window,\n\t\tdocument = win.document,\n\t\tparseInt = win.parseInt,\n\t\tsupportIEdnd = !!document.createElement('div').dragDrop,\n\n\t\t_silent = false,\n\n\t\t_dispatchEvent = function (rootEl, name, targetEl, fromEl, startIndex, newIndex) {\n\t\t\tvar evt = document.createEvent('Event');\n\n\t\t\tevt.initEvent(name, true, true);\n\n\t\t\tevt.item = targetEl || rootEl;\n\t\t\tevt.from = fromEl || rootEl;\n\t\t\tevt.clone = cloneEl;\n\n\t\t\tevt.oldIndex = startIndex;\n\t\t\tevt.newIndex = newIndex;\n\n\t\t\trootEl.dispatchEvent(evt);\n\t\t},\n\n\t\t_customEvents = 'onAdd onUpdate onRemove onStart onEnd onFilter onSort'.split(' '),\n\n\t\tnoop = function () {},\n\n\t\tabs = Math.abs,\n\t\tslice = [].slice,\n\n\t\ttouchDragOverListeners = []\n\t;\n\n\n\n\t/**\n\t * @class  Sortable\n\t * @param  {HTMLElement}  el\n\t * @param  {Object}       [options]\n\t */\n\tfunction Sortable(el, options) {\n\t\tthis.el = el; // root element\n\t\tthis.options = options = (options || {});\n\n\n\t\t// Default options\n\t\tvar defaults = {\n\t\t\tgroup: Math.random(),\n\t\t\tsort: true,\n\t\t\tdisabled: false,\n\t\t\tstore: null,\n\t\t\thandle: null,\n\t\t\tscroll: true,\n\t\t\tscrollSensitivity: 30,\n\t\t\tscrollSpeed: 10,\n\t\t\tdraggable: /[uo]l/i.test(el.nodeName) ? 'li' : '>*',\n\t\t\tghostClass: 'sortable-ghost',\n\t\t\tignore: 'a, img',\n\t\t\tfilter: null,\n\t\t\tanimation: 0,\n\t\t\tsetData: function (dataTransfer, dragEl) {\n\t\t\t\tdataTransfer.setData('Text', dragEl.textContent);\n\t\t\t},\n\t\t\tdropBubble: false,\n\t\t\tdragoverBubble: false\n\t\t};\n\n\n\t\t// Set default options\n\t\tfor (var name in defaults) {\n\t\t\t!(name in options) && (options[name] = defaults[name]);\n\t\t}\n\n\n\t\tvar group = options.group;\n\n\t\tif (!group || typeof group != 'object') {\n\t\t\tgroup = options.group = { name: group };\n\t\t}\n\n\n\t\t['pull', 'put'].forEach(function (key) {\n\t\t\tif (!(key in group)) {\n\t\t\t\tgroup[key] = true;\n\t\t\t}\n\t\t});\n\n\n\t\t// Define events\n\t\t_customEvents.forEach(function (name) {\n\t\t\toptions[name] = _bind(this, options[name] || noop);\n\t\t\t_on(el, name.substr(2).toLowerCase(), options[name]);\n\t\t}, this);\n\n\n\t\t// Export group name\n\t\tel[expando] = group.name + ' ' + (group.put.join ? group.put.join(' ') : '');\n\n\n\t\t// Bind all private methods\n\t\tfor (var fn in this) {\n\t\t\tif (fn.charAt(0) === '_') {\n\t\t\t\tthis[fn] = _bind(this, this[fn]);\n\t\t\t}\n\t\t}\n\n\n\t\t// Bind events\n\t\t_on(el, 'mousedown', this._onTapStart);\n\t\t_on(el, 'touchstart', this._onTapStart);\n\t\tsupportIEdnd && _on(el, 'selectstart', this._onTapStart);\n\n\t\t_on(el, 'dragover', this._onDragOver);\n\t\t_on(el, 'dragenter', this._onDragOver);\n\n\t\ttouchDragOverListeners.push(this._onDragOver);\n\n\t\t// Restore sorting\n\t\toptions.store && this.sort(options.store.get(this));\n\t}\n\n\n\tSortable.prototype = /** @lends Sortable.prototype */ {\n\t\tconstructor: Sortable,\n\n\n\t\t_dragStarted: function () {\n\t\t\t// Apply effect\n\t\t\t_toggleClass(dragEl, this.options.ghostClass, true);\n\n\t\t\tSortable.active = this;\n\n\t\t\t// Drag start event\n\t\t\t_dispatchEvent(rootEl, 'start', dragEl, rootEl, oldIndex);\n\t\t},\n\n\n\t\t_onTapStart: function (/**Event|TouchEvent*/evt) {\n\t\t\tvar type = evt.type,\n\t\t\t\ttouch = evt.touches && evt.touches[0],\n\t\t\t\ttarget = (touch || evt).target,\n\t\t\t\toriginalTarget = target,\n\t\t\t\toptions =  this.options,\n\t\t\t\tel = this.el,\n\t\t\t\tfilter = options.filter;\n\n\t\t\tif (type === 'mousedown' && evt.button !== 0 || options.disabled) {\n\t\t\t\treturn; // only left button or enabled\n\t\t\t}\n\n\t\t\tif (options.handle) {\n\t\t\t\ttarget = _closest(target, options.handle, el);\n\t\t\t}\n\n\t\t\ttarget = _closest(target, options.draggable, el);\n\n\t\t\t// get the index of the dragged element within its parent\n\t\t\toldIndex = _index(target);\n\n\t\t\t// Check filter\n\t\t\tif (typeof filter === 'function') {\n\t\t\t\tif (filter.call(this, evt, target, this)) {\n\t\t\t\t\t_dispatchEvent(originalTarget, 'filter', target, el, oldIndex);\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\treturn; // cancel dnd\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (filter) {\n\t\t\t\tfilter = filter.split(',').some(function (criteria) {\n\t\t\t\t\tcriteria = _closest(originalTarget, criteria.trim(), el);\n\n\t\t\t\t\tif (criteria) {\n\t\t\t\t\t\t_dispatchEvent(criteria, 'filter', target, el, oldIndex);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (filter) {\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\treturn; // cancel dnd\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Prepare `dragstart`\n\t\t\tif (target && !dragEl && (target.parentNode === el)) {\n\t\t\t\t// IE 9 Support\n\t\t\t\t(type === 'selectstart') && target.dragDrop();\n\n\t\t\t\ttapEvt = evt;\n\n\t\t\t\trootEl = this.el;\n\t\t\t\tdragEl = target;\n\t\t\t\tnextEl = dragEl.nextSibling;\n\t\t\t\tactiveGroup = this.options.group;\n\n\t\t\t\tdragEl.draggable = true;\n\n\t\t\t\t// Disable \"draggable\"\n\t\t\t\toptions.ignore.split(',').forEach(function (criteria) {\n\t\t\t\t\t_find(target, criteria.trim(), _disableDraggable);\n\t\t\t\t});\n\n\t\t\t\tif (touch) {\n\t\t\t\t\t// Touch device support\n\t\t\t\t\ttapEvt = {\n\t\t\t\t\t\ttarget: target,\n\t\t\t\t\t\tclientX: touch.clientX,\n\t\t\t\t\t\tclientY: touch.clientY\n\t\t\t\t\t};\n\n\t\t\t\t\tthis._onDragStart(tapEvt, true);\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t}\n\n\t\t\t\t_on(document, 'mouseup', this._onDrop);\n\t\t\t\t_on(document, 'touchend', this._onDrop);\n\t\t\t\t_on(document, 'touchcancel', this._onDrop);\n\n\t\t\t\t_on(dragEl, 'dragend', this);\n\t\t\t\t_on(rootEl, 'dragstart', this._onDragStart);\n\n\t\t\t\t_on(document, 'dragover', this);\n\n\n\t\t\t\ttry {\n\t\t\t\t\tif (document.selection) {\n\t\t\t\t\t\tdocument.selection.empty();\n\t\t\t\t\t} else {\n\t\t\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\t\t}\n\t\t\t\t} catch (err) {\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_emulateDragOver: function () {\n\t\t\tif (touchEvt) {\n\t\t\t\t_css(ghostEl, 'display', 'none');\n\n\t\t\t\tvar target = document.elementFromPoint(touchEvt.clientX, touchEvt.clientY),\n\t\t\t\t\tparent = target,\n\t\t\t\t\tgroupName = this.options.group.name,\n\t\t\t\t\ti = touchDragOverListeners.length;\n\n\t\t\t\tif (parent) {\n\t\t\t\t\tdo {\n\t\t\t\t\t\tif ((' ' + parent[expando] + ' ').indexOf(groupName) > -1) {\n\t\t\t\t\t\t\twhile (i--) {\n\t\t\t\t\t\t\t\ttouchDragOverListeners[i]({\n\t\t\t\t\t\t\t\t\tclientX: touchEvt.clientX,\n\t\t\t\t\t\t\t\t\tclientY: touchEvt.clientY,\n\t\t\t\t\t\t\t\t\ttarget: target,\n\t\t\t\t\t\t\t\t\trootEl: parent\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttarget = parent; // store last element\n\t\t\t\t\t}\n\t\t\t\t\t/* jshint boss:true */\n\t\t\t\t\twhile (parent = parent.parentNode);\n\t\t\t\t}\n\n\t\t\t\t_css(ghostEl, 'display', '');\n\t\t\t}\n\t\t},\n\n\n\t\t_onTouchMove: function (/**TouchEvent*/evt) {\n\t\t\tif (tapEvt) {\n\t\t\t\tvar touch = evt.touches[0],\n\t\t\t\t\tdx = touch.clientX - tapEvt.clientX,\n\t\t\t\t\tdy = touch.clientY - tapEvt.clientY,\n\t\t\t\t\ttranslate3d = 'translate3d(' + dx + 'px,' + dy + 'px,0)';\n\n\t\t\t\ttouchEvt = touch;\n\n\t\t\t\t_css(ghostEl, 'webkitTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'mozTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'msTransform', translate3d);\n\t\t\t\t_css(ghostEl, 'transform', translate3d);\n\n\t\t\t\tthis._onDrag(touch);\n\t\t\t\tevt.preventDefault();\n\t\t\t}\n\t\t},\n\n\n\t\t_onDragStart: function (/**Event*/evt, /**boolean*/isTouch) {\n\t\t\tvar dataTransfer = evt.dataTransfer,\n\t\t\t\toptions = this.options;\n\n\t\t\tthis._offUpEvents();\n\n\t\t\tif (activeGroup.pull == 'clone') {\n\t\t\t\tcloneEl = dragEl.cloneNode(true);\n\t\t\t\t_css(cloneEl, 'display', 'none');\n\t\t\t\trootEl.insertBefore(cloneEl, dragEl);\n\t\t\t}\n\n\t\t\tif (isTouch) {\n\t\t\t\tvar rect = dragEl.getBoundingClientRect(),\n\t\t\t\t\tcss = _css(dragEl),\n\t\t\t\t\tghostRect;\n\n\t\t\t\tghostEl = dragEl.cloneNode(true);\n\n\t\t\t\t_css(ghostEl, 'top', rect.top - parseInt(css.marginTop, 10));\n\t\t\t\t_css(ghostEl, 'left', rect.left - parseInt(css.marginLeft, 10));\n\t\t\t\t_css(ghostEl, 'width', rect.width);\n\t\t\t\t_css(ghostEl, 'height', rect.height);\n\t\t\t\t_css(ghostEl, 'opacity', '0.8');\n\t\t\t\t_css(ghostEl, 'position', 'fixed');\n\t\t\t\t_css(ghostEl, 'zIndex', '100000');\n\n\t\t\t\trootEl.appendChild(ghostEl);\n\n\t\t\t\t// Fixing dimensions.\n\t\t\t\tghostRect = ghostEl.getBoundingClientRect();\n\t\t\t\t_css(ghostEl, 'width', rect.width * 2 - ghostRect.width);\n\t\t\t\t_css(ghostEl, 'height', rect.height * 2 - ghostRect.height);\n\n\t\t\t\t// Bind touch events\n\t\t\t\t_on(document, 'touchmove', this._onTouchMove);\n\t\t\t\t_on(document, 'touchend', this._onDrop);\n\t\t\t\t_on(document, 'touchcancel', this._onDrop);\n\n\t\t\t\tthis._loopId = setInterval(this._emulateDragOver, 150);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (dataTransfer) {\n\t\t\t\t\tdataTransfer.effectAllowed = 'move';\n\t\t\t\t\toptions.setData && options.setData.call(this, dataTransfer, dragEl);\n\t\t\t\t}\n\n\t\t\t\t_on(document, 'drop', this);\n\t\t\t}\n\n\t\t\tscrollEl = options.scroll;\n\n\t\t\tif (scrollEl === true) {\n\t\t\t\tscrollEl = rootEl;\n\n\t\t\t\tdo {\n\t\t\t\t\tif ((scrollEl.offsetWidth < scrollEl.scrollWidth) ||\n\t\t\t\t\t\t(scrollEl.offsetHeight < scrollEl.scrollHeight)\n\t\t\t\t\t) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t/* jshint boss:true */\n\t\t\t\t} while (scrollEl = scrollEl.parentNode);\n\t\t\t}\n\n\t\t\tsetTimeout(this._dragStarted, 0);\n\t\t},\n\n\t\t_onDrag: _throttle(function (/**Event*/evt) {\n\t\t\t// Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=505521\n\t\t\tif (rootEl && this.options.scroll) {\n\t\t\t\tvar el,\n\t\t\t\t\trect,\n\t\t\t\t\toptions = this.options,\n\t\t\t\t\tsens = options.scrollSensitivity,\n\t\t\t\t\tspeed = options.scrollSpeed,\n\n\t\t\t\t\tx = evt.clientX,\n\t\t\t\t\ty = evt.clientY,\n\n\t\t\t\t\twinWidth = window.innerWidth,\n\t\t\t\t\twinHeight = window.innerHeight,\n\n\t\t\t\t\tvx = (winWidth - x <= sens) - (x <= sens),\n\t\t\t\t\tvy = (winHeight - y <= sens) - (y <= sens)\n\t\t\t\t;\n\n\t\t\t\tif (vx || vy) {\n\t\t\t\t\tel = win;\n\t\t\t\t}\n\t\t\t\telse if (scrollEl) {\n\t\t\t\t\tel = scrollEl;\n\t\t\t\t\trect = scrollEl.getBoundingClientRect();\n\t\t\t\t\tvx = (abs(rect.right - x) <= sens) - (abs(rect.left - x) <= sens);\n\t\t\t\t\tvy = (abs(rect.bottom - y) <= sens) - (abs(rect.top - y) <= sens);\n\t\t\t\t}\n\n\t\t\t\tif (autoScroll.vx !== vx || autoScroll.vy !== vy || autoScroll.el !== el) {\n\t\t\t\t\tautoScroll.el = el;\n\t\t\t\t\tautoScroll.vx = vx;\n\t\t\t\t\tautoScroll.vy = vy;\n\n\t\t\t\t\tclearInterval(autoScroll.pid);\n\n\t\t\t\t\tif (el) {\n\t\t\t\t\t\tautoScroll.pid = setInterval(function () {\n\t\t\t\t\t\t\tif (el === win) {\n\t\t\t\t\t\t\t\twin.scrollTo(win.scrollX + vx * speed, win.scrollY + vy * speed);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvy && (el.scrollTop += vy * speed);\n\t\t\t\t\t\t\t\tvx && (el.scrollLeft += vx * speed);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 24);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}, 30),\n\n\n\t\t_onDragOver: function (/**Event*/evt) {\n\t\t\tvar el = this.el,\n\t\t\t\ttarget,\n\t\t\t\tdragRect,\n\t\t\t\trevert,\n\t\t\t\toptions = this.options,\n\t\t\t\tgroup = options.group,\n\t\t\t\tgroupPut = group.put,\n\t\t\t\tisOwner = (activeGroup === group),\n\t\t\t\tcanSort = options.sort;\n\n\t\t\tif (evt.preventDefault !== void 0) {\n\t\t\t\tevt.preventDefault();\n\t\t\t\t!options.dragoverBubble && evt.stopPropagation();\n\t\t\t}\n\n\t\t\tif (!_silent && activeGroup &&\n\t\t\t\t(isOwner\n\t\t\t\t\t? canSort || (revert = !rootEl.contains(dragEl))\n\t\t\t\t\t: activeGroup.pull && groupPut && (\n\t\t\t\t\t\t(activeGroup.name === group.name) || // by Name\n\t\t\t\t\t\t(groupPut.indexOf && ~groupPut.indexOf(activeGroup.name)) // by Array\n\t\t\t\t\t)\n\t\t\t\t) &&\n\t\t\t\t(evt.rootEl === void 0 || evt.rootEl === this.el)\n\t\t\t) {\n\t\t\t\ttarget = _closest(evt.target, options.draggable, el);\n\t\t\t\tdragRect = dragEl.getBoundingClientRect();\n\n\n\t\t\t\tif (revert) {\n\t\t\t\t\t_cloneHide(true);\n\n\t\t\t\t\tif (cloneEl || nextEl) {\n\t\t\t\t\t\trootEl.insertBefore(dragEl, cloneEl || nextEl);\n\t\t\t\t\t}\n\t\t\t\t\telse if (!canSort) {\n\t\t\t\t\t\trootEl.appendChild(dragEl);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\n\t\t\t\tif ((el.children.length === 0) || (el.children[0] === ghostEl) ||\n\t\t\t\t\t(el === evt.target) && (target = _ghostInBottom(el, evt))\n\t\t\t\t) {\n\t\t\t\t\tif (target) {\n\t\t\t\t\t\tif (target.animated) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttargetRect = target.getBoundingClientRect();\n\t\t\t\t\t}\n\n\t\t\t\t\t_cloneHide(isOwner);\n\n\t\t\t\t\tel.appendChild(dragEl);\n\t\t\t\t\tthis._animate(dragRect, dragEl);\n\t\t\t\t\ttarget && this._animate(targetRect, target);\n\t\t\t\t}\n\t\t\t\telse if (target && !target.animated && target !== dragEl && (target.parentNode[expando] !== void 0)) {\n\t\t\t\t\tif (lastEl !== target) {\n\t\t\t\t\t\tlastEl = target;\n\t\t\t\t\t\tlastCSS = _css(target);\n\t\t\t\t\t}\n\n\n\t\t\t\t\tvar targetRect = target.getBoundingClientRect(),\n\t\t\t\t\t\twidth = targetRect.right - targetRect.left,\n\t\t\t\t\t\theight = targetRect.bottom - targetRect.top,\n\t\t\t\t\t\tfloating = /left|right|inline/.test(lastCSS.cssFloat + lastCSS.display),\n\t\t\t\t\t\tisWide = (target.offsetWidth > dragEl.offsetWidth),\n\t\t\t\t\t\tisLong = (target.offsetHeight > dragEl.offsetHeight),\n\t\t\t\t\t\thalfway = (floating ? (evt.clientX - targetRect.left) / width : (evt.clientY - targetRect.top) / height) > 0.5,\n\t\t\t\t\t\tnextSibling = target.nextElementSibling,\n\t\t\t\t\t\tafter\n\t\t\t\t\t;\n\n\t\t\t\t\t_silent = true;\n\t\t\t\t\tsetTimeout(_unsilent, 30);\n\n\t\t\t\t\t_cloneHide(isOwner);\n\n\t\t\t\t\tif (floating) {\n\t\t\t\t\t\tafter = (target.previousElementSibling === dragEl) && !isWide || halfway && isWide;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tafter = (nextSibling !== dragEl) && !isLong || halfway && isLong;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (after && !nextSibling) {\n\t\t\t\t\t\tel.appendChild(dragEl);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttarget.parentNode.insertBefore(dragEl, after ? nextSibling : target);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._animate(dragRect, dragEl);\n\t\t\t\t\tthis._animate(targetRect, target);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_animate: function (prevRect, target) {\n\t\t\tvar ms = this.options.animation;\n\n\t\t\tif (ms) {\n\t\t\t\tvar currentRect = target.getBoundingClientRect();\n\n\t\t\t\t_css(target, 'transition', 'none');\n\t\t\t\t_css(target, 'transform', 'translate3d('\n\t\t\t\t\t+ (prevRect.left - currentRect.left) + 'px,'\n\t\t\t\t\t+ (prevRect.top - currentRect.top) + 'px,0)'\n\t\t\t\t);\n\n\t\t\t\ttarget.offsetWidth; // repaint\n\n\t\t\t\t_css(target, 'transition', 'all ' + ms + 'ms');\n\t\t\t\t_css(target, 'transform', 'translate3d(0,0,0)');\n\n\t\t\t\tclearTimeout(target.animated);\n\t\t\t\ttarget.animated = setTimeout(function () {\n\t\t\t\t\t_css(target, 'transition', '');\n\t\t\t\t\ttarget.animated = false;\n\t\t\t\t}, ms);\n\t\t\t}\n\t\t},\n\n\t\t_offUpEvents: function () {\n\t\t\t_off(document, 'mouseup', this._onDrop);\n\t\t\t_off(document, 'touchmove', this._onTouchMove);\n\t\t\t_off(document, 'touchend', this._onDrop);\n\t\t\t_off(document, 'touchcancel', this._onDrop);\n\t\t},\n\n\t\t_onDrop: function (/**Event*/evt) {\n\t\t\tvar el = this.el,\n\t\t\t\toptions = this.options;\n\n\t\t\tclearInterval(this._loopId);\n\t\t\tclearInterval(autoScroll.pid);\n\n\t\t\t// Unbind events\n\t\t\t_off(document, 'drop', this);\n\t\t\t_off(document, 'dragover', this);\n\n\t\t\t_off(el, 'dragstart', this._onDragStart);\n\n\t\t\tthis._offUpEvents();\n\n\t\t\tif (evt) {\n\t\t\t\tevt.preventDefault();\n\t\t\t\t!options.dropBubble && evt.stopPropagation();\n\n\t\t\t\tghostEl && ghostEl.parentNode.removeChild(ghostEl);\n\n\t\t\t\tif (dragEl) {\n\t\t\t\t\t_off(dragEl, 'dragend', this);\n\n\t\t\t\t\t_disableDraggable(dragEl);\n\t\t\t\t\t_toggleClass(dragEl, this.options.ghostClass, false);\n\n\t\t\t\t\tif (rootEl !== dragEl.parentNode) {\n\t\t\t\t\t\tnewIndex = _index(dragEl);\n\n\t\t\t\t\t\t// drag from one list and drop into another\n\t\t\t\t\t\t_dispatchEvent(dragEl.parentNode, 'sort', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t_dispatchEvent(rootEl, 'sort', dragEl, rootEl, oldIndex, newIndex);\n\n\t\t\t\t\t\t// Add event\n\t\t\t\t\t\t_dispatchEvent(dragEl, 'add', dragEl, rootEl, oldIndex, newIndex);\n\n\t\t\t\t\t\t// Remove event\n\t\t\t\t\t\t_dispatchEvent(rootEl, 'remove', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Remove clone\n\t\t\t\t\t\tcloneEl && cloneEl.parentNode.removeChild(cloneEl);\n\n\t\t\t\t\t\tif (dragEl.nextSibling !== nextEl) {\n\t\t\t\t\t\t\t// Get the index of the dragged element within its parent\n\t\t\t\t\t\t\tnewIndex = _index(dragEl);\n\n\t\t\t\t\t\t\t// drag & drop within the same list\n\t\t\t\t\t\t\t_dispatchEvent(rootEl, 'update', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t\t_dispatchEvent(rootEl, 'sort', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Drag end event\n\t\t\t\t\tSortable.active && _dispatchEvent(rootEl, 'end', dragEl, rootEl, oldIndex, newIndex);\n\t\t\t\t}\n\n\t\t\t\t// Set NULL\n\t\t\t\trootEl =\n\t\t\t\tdragEl =\n\t\t\t\tghostEl =\n\t\t\t\tnextEl =\n\t\t\t\tcloneEl =\n\n\t\t\t\ttapEvt =\n\t\t\t\ttouchEvt =\n\n\t\t\t\tlastEl =\n\t\t\t\tlastCSS =\n\n\t\t\t\tactiveGroup =\n\t\t\t\tSortable.active = null;\n\n\t\t\t\t// Save sorting\n\t\t\t\tthis.save();\n\t\t\t}\n\t\t},\n\n\n\t\thandleEvent: function (/**Event*/evt) {\n\t\t\tvar type = evt.type;\n\n\t\t\tif (type === 'dragover') {\n\t\t\t\tthis._onDrag(evt);\n\t\t\t\t_globalDragOver(evt);\n\t\t\t}\n\t\t\telse if (type === 'drop' || type === 'dragend') {\n\t\t\t\tthis._onDrop(evt);\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Serializes the item into an array of string.\n\t\t * @returns {String[]}\n\t\t */\n\t\ttoArray: function () {\n\t\t\tvar order = [],\n\t\t\t\tel,\n\t\t\t\tchildren = this.el.children,\n\t\t\t\ti = 0,\n\t\t\t\tn = children.length;\n\n\t\t\tfor (; i < n; i++) {\n\t\t\t\tel = children[i];\n\t\t\t\tif (_closest(el, this.options.draggable, this.el)) {\n\t\t\t\t\torder.push(el.getAttribute('data-id') || _generateId(el));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn order;\n\t\t},\n\n\n\t\t/**\n\t\t * Sorts the elements according to the array.\n\t\t * @param  {String[]}  order  order of the items\n\t\t */\n\t\tsort: function (order) {\n\t\t\tvar items = {}, rootEl = this.el;\n\n\t\t\tthis.toArray().forEach(function (id, i) {\n\t\t\t\tvar el = rootEl.children[i];\n\n\t\t\t\tif (_closest(el, this.options.draggable, rootEl)) {\n\t\t\t\t\titems[id] = el;\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t\torder.forEach(function (id) {\n\t\t\t\tif (items[id]) {\n\t\t\t\t\trootEl.removeChild(items[id]);\n\t\t\t\t\trootEl.appendChild(items[id]);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\n\t\t/**\n\t\t * Save the current sorting\n\t\t */\n\t\tsave: function () {\n\t\t\tvar store = this.options.store;\n\t\t\tstore && store.set(this);\n\t\t},\n\n\n\t\t/**\n\t\t * For each element in the set, get the first element that matches the selector by testing the element itself and traversing up through its ancestors in the DOM tree.\n\t\t * @param   {HTMLElement}  el\n\t\t * @param   {String}       [selector]  default: `options.draggable`\n\t\t * @returns {HTMLElement|null}\n\t\t */\n\t\tclosest: function (el, selector) {\n\t\t\treturn _closest(el, selector || this.options.draggable, this.el);\n\t\t},\n\n\n\t\t/**\n\t\t * Set/get option\n\t\t * @param   {string} name\n\t\t * @param   {*}      [value]\n\t\t * @returns {*}\n\t\t */\n\t\toption: function (name, value) {\n\t\t\tvar options = this.options;\n\n\t\t\tif (value === void 0) {\n\t\t\t\treturn options[name];\n\t\t\t} else {\n\t\t\t\toptions[name] = value;\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Destroy\n\t\t */\n\t\tdestroy: function () {\n\t\t\tvar el = this.el, options = this.options;\n\n\t\t\t_customEvents.forEach(function (name) {\n\t\t\t\t_off(el, name.substr(2).toLowerCase(), options[name]);\n\t\t\t});\n\n\t\t\t_off(el, 'mousedown', this._onTapStart);\n\t\t\t_off(el, 'touchstart', this._onTapStart);\n\t\t\t_off(el, 'selectstart', this._onTapStart);\n\n\t\t\t_off(el, 'dragover', this._onDragOver);\n\t\t\t_off(el, 'dragenter', this._onDragOver);\n\n\t\t\t//remove draggable attributes\n\t\t\tArray.prototype.forEach.call(el.querySelectorAll('[draggable]'), function (el) {\n\t\t\t\tel.removeAttribute('draggable');\n\t\t\t});\n\n\t\t\ttouchDragOverListeners.splice(touchDragOverListeners.indexOf(this._onDragOver), 1);\n\n\t\t\tthis._onDrop();\n\n\t\t\tthis.el = null;\n\t\t}\n\t};\n\n\n\tfunction _cloneHide(state) {\n\t\tif (cloneEl && (cloneEl.state !== state)) {\n\t\t\t_css(cloneEl, 'display', state ? 'none' : '');\n\t\t\t!state && cloneEl.state && rootEl.insertBefore(cloneEl, dragEl);\n\t\t\tcloneEl.state = state;\n\t\t}\n\t}\n\n\n\tfunction _bind(ctx, fn) {\n\t\tvar args = slice.call(arguments, 2);\n\t\treturn\tfn.bind ? fn.bind.apply(fn, [ctx].concat(args)) : function () {\n\t\t\treturn fn.apply(ctx, args.concat(slice.call(arguments)));\n\t\t};\n\t}\n\n\n\tfunction _closest(/**HTMLElement*/el, /**String*/selector, /**HTMLElement*/ctx) {\n\t\tif (el) {\n\t\t\tctx = ctx || document;\n\t\t\tselector = selector.split('.');\n\n\t\t\tvar tag = selector.shift().toUpperCase(),\n\t\t\t\tre = new RegExp('\\\\s(' + selector.join('|') + ')\\\\s', 'g');\n\n\t\t\tdo {\n\t\t\t\tif (\n\t\t\t\t\t(tag === '>*' && el.parentNode === ctx) || (\n\t\t\t\t\t\t(tag === '' || el.nodeName.toUpperCase() == tag) &&\n\t\t\t\t\t\t(!selector.length || ((' ' + el.className + ' ').match(re) || []).length == selector.length)\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\treturn el;\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile (el !== ctx && (el = el.parentNode));\n\t\t}\n\n\t\treturn null;\n\t}\n\n\n\tfunction _globalDragOver(/**Event*/evt) {\n\t\tevt.dataTransfer.dropEffect = 'move';\n\t\tevt.preventDefault();\n\t}\n\n\n\tfunction _on(el, event, fn) {\n\t\tel.addEventListener(event, fn, false);\n\t}\n\n\n\tfunction _off(el, event, fn) {\n\t\tel.removeEventListener(event, fn, false);\n\t}\n\n\n\tfunction _toggleClass(el, name, state) {\n\t\tif (el) {\n\t\t\tif (el.classList) {\n\t\t\t\tel.classList[state ? 'add' : 'remove'](name);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar className = (' ' + el.className + ' ').replace(/\\s+/g, ' ').replace(' ' + name + ' ', '');\n\t\t\t\tel.className = className + (state ? ' ' + name : '');\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfunction _css(el, prop, val) {\n\t\tvar style = el && el.style;\n\n\t\tif (style) {\n\t\t\tif (val === void 0) {\n\t\t\t\tif (document.defaultView && document.defaultView.getComputedStyle) {\n\t\t\t\t\tval = document.defaultView.getComputedStyle(el, '');\n\t\t\t\t}\n\t\t\t\telse if (el.currentStyle) {\n\t\t\t\t\tval = el.currentStyle;\n\t\t\t\t}\n\n\t\t\t\treturn prop === void 0 ? val : val[prop];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!(prop in style)) {\n\t\t\t\t\tprop = '-webkit-' + prop;\n\t\t\t\t}\n\n\t\t\t\tstyle[prop] = val + (typeof val === 'string' ? '' : 'px');\n\t\t\t}\n\t\t}\n\t}\n\n\n\tfunction _find(ctx, tagName, iterator) {\n\t\tif (ctx) {\n\t\t\tvar list = ctx.getElementsByTagName(tagName), i = 0, n = list.length;\n\n\t\t\tif (iterator) {\n\t\t\t\tfor (; i < n; i++) {\n\t\t\t\t\titerator(list[i], i);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn list;\n\t\t}\n\n\t\treturn [];\n\t}\n\n\n\tfunction _disableDraggable(el) {\n\t\tel.draggable = false;\n\t}\n\n\n\tfunction _unsilent() {\n\t\t_silent = false;\n\t}\n\n\n\t/** @returns {HTMLElement|false} */\n\tfunction _ghostInBottom(el, evt) {\n\t\tvar lastEl = el.lastElementChild, rect = lastEl.getBoundingClientRect();\n\t\treturn (evt.clientY - (rect.top + rect.height) > 5) && lastEl; // min delta\n\t}\n\n\n\t/**\n\t * Generate id\n\t * @param   {HTMLElement} el\n\t * @returns {String}\n\t * @private\n\t */\n\tfunction _generateId(el) {\n\t\tvar str = el.tagName + el.className + el.src + el.href + el.textContent,\n\t\t\ti = str.length,\n\t\t\tsum = 0;\n\n\t\twhile (i--) {\n\t\t\tsum += str.charCodeAt(i);\n\t\t}\n\n\t\treturn sum.toString(36);\n\t}\n\n\t/**\n\t * Returns the index of an element within its parent\n\t * @param el\n\t * @returns {number}\n\t * @private\n\t */\n\tfunction _index(/**HTMLElement*/el) {\n\t\tvar index = 0;\n\t\twhile (el && (el = el.previousElementSibling) && (el.nodeName.toUpperCase() !== 'TEMPLATE')) {\n\t\t\tindex++;\n\t\t}\n\t\treturn index;\n\t}\n\n\tfunction _throttle(callback, ms) {\n\t\tvar args, _this;\n\n\t\treturn function () {\n\t\t\tif (args === void 0) {\n\t\t\t\targs = arguments;\n\t\t\t\t_this = this;\n\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tif (args.length === 1) {\n\t\t\t\t\t\tcallback.call(_this, args[0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcallback.apply(_this, args);\n\t\t\t\t\t}\n\n\t\t\t\t\targs = void 0;\n\t\t\t\t}, ms);\n\t\t\t}\n\t\t};\n\t}\n\n\n\t// Export utils\n\tSortable.utils = {\n\t\ton: _on,\n\t\toff: _off,\n\t\tcss: _css,\n\t\tfind: _find,\n\t\tbind: _bind,\n\t\tis: function (el, selector) {\n\t\t\treturn !!_closest(el, selector, el);\n\t\t},\n\t\tthrottle: _throttle,\n\t\tclosest: _closest,\n\t\ttoggleClass: _toggleClass,\n\t\tdispatchEvent: _dispatchEvent,\n\t\tindex: _index\n\t};\n\n\n\tSortable.version = '1.0.1';\n\n\n\t/**\n\t * Create sortable instance\n\t * @param {HTMLElement}  el\n\t * @param {Object}      [options]\n\t */\n\tSortable.create = function (el, options) {\n\t\treturn new Sortable(el, options);\n\t};\n\n\t// Export\n\treturn Sortable;\n});\n","var createElement = require(\"./vdom/create-element.js\")\n\nmodule.exports = createElement\n","var diff = require(\"./vtree/diff.js\")\n\nmodule.exports = diff\n","var h = require(\"./virtual-hyperscript/index.js\")\n\nmodule.exports = h\n","var topLevel = typeof global !== 'undefined' ? global :\n    typeof window !== 'undefined' ? window : {}\nvar minDoc = require('min-document');\n\nif (typeof document !== 'undefined') {\n    module.exports = document;\n} else {\n    var doccy = topLevel['__GLOBAL_DOCUMENT_CACHE@4'];\n\n    if (!doccy) {\n        doccy = topLevel['__GLOBAL_DOCUMENT_CACHE@4'] = minDoc;\n    }\n\n    module.exports = doccy;\n}\n","var patch = require(\"./vdom/patch.js\")\n\nmodule.exports = patch\n","var isObject = require(\"is-object\")\nvar isHook = require(\"../vnode/is-vhook.js\")\n\nmodule.exports = applyProperties\n\nfunction applyProperties(node, props, previous) {\n    for (var propName in props) {\n        var propValue = props[propName]\n\n        if (propValue === undefined) {\n            removeProperty(node, props, previous, propName);\n        } else if (isHook(propValue)) {\n            propValue.hook(node,\n                propName,\n                previous ? previous[propName] : undefined)\n        } else {\n            if (isObject(propValue)) {\n                patchObject(node, props, previous, propName, propValue);\n            } else if (propValue !== undefined) {\n                node[propName] = propValue\n            }\n        }\n    }\n}\n\nfunction removeProperty(node, props, previous, propName) {\n    if (previous) {\n        var previousValue = previous[propName]\n\n        if (!isHook(previousValue)) {\n            if (propName === \"attributes\") {\n                for (var attrName in previousValue) {\n                    node.removeAttribute(attrName)\n                }\n            } else if (propName === \"style\") {\n                for (var i in previousValue) {\n                    node.style[i] = \"\"\n                }\n            } else if (typeof previousValue === \"string\") {\n                node[propName] = \"\"\n            } else {\n                node[propName] = null\n            }\n        } else if (previousValue.unhook) {\n            previousValue.unhook(node, propName)\n        }\n    }\n}\n\nfunction patchObject(node, props, previous, propName, propValue) {\n    var previousValue = previous ? previous[propName] : undefined\n\n    // Set attributes\n    if (propName === \"attributes\") {\n        for (var attrName in propValue) {\n            var attrValue = propValue[attrName]\n\n            if (attrValue === undefined) {\n                node.removeAttribute(attrName)\n            } else {\n                node.setAttribute(attrName, attrValue)\n            }\n        }\n\n        return\n    }\n\n    if(previousValue && isObject(previousValue) &&\n        getPrototype(previousValue) !== getPrototype(propValue)) {\n        node[propName] = propValue\n        return\n    }\n\n    if (!isObject(node[propName])) {\n        node[propName] = {}\n    }\n\n    var replacer = propName === \"style\" ? \"\" : undefined\n\n    for (var k in propValue) {\n        var value = propValue[k]\n        node[propName][k] = (value === undefined) ? replacer : value\n    }\n}\n\nfunction getPrototype(value) {\n    if (Object.getPrototypeOf) {\n        return Object.getPrototypeOf(value)\n    } else if (value.__proto__) {\n        return value.__proto__\n    } else if (value.constructor) {\n        return value.constructor.prototype\n    }\n}\n","var document = require(\"global/document\")\n\nvar applyProperties = require(\"./apply-properties\")\n\nvar isVNode = require(\"../vnode/is-vnode.js\")\nvar isVText = require(\"../vnode/is-vtext.js\")\nvar isWidget = require(\"../vnode/is-widget.js\")\nvar handleThunk = require(\"../vnode/handle-thunk.js\")\n\nmodule.exports = createElement\n\nfunction createElement(vnode, opts) {\n    var doc = opts ? opts.document || document : document\n    var warn = opts ? opts.warn : null\n\n    vnode = handleThunk(vnode).a\n\n    if (isWidget(vnode)) {\n        return vnode.init()\n    } else if (isVText(vnode)) {\n        return doc.createTextNode(vnode.text)\n    } else if (!isVNode(vnode)) {\n        if (warn) {\n            warn(\"Item is not a valid virtual dom node\", vnode)\n        }\n        return null\n    }\n\n    var node = (vnode.namespace === null) ?\n        doc.createElement(vnode.tagName) :\n        doc.createElementNS(vnode.namespace, vnode.tagName)\n\n    var props = vnode.properties\n    applyProperties(node, props)\n\n    var children = vnode.children\n\n    for (var i = 0; i < children.length; i++) {\n        var childNode = createElement(children[i], opts)\n        if (childNode) {\n            node.appendChild(childNode)\n        }\n    }\n\n    return node\n}\n","// Maps a virtual DOM tree onto a real DOM tree in an efficient manner.\n// We don't want to read all of the DOM nodes in the tree so we use\n// the in-order tree indexing to eliminate recursion down certain branches.\n// We only recurse into a DOM node if we know that it contains a child of\n// interest.\n\nvar noChild = {}\n\nmodule.exports = domIndex\n\nfunction domIndex(rootNode, tree, indices, nodes) {\n    if (!indices || indices.length === 0) {\n        return {}\n    } else {\n        indices.sort(ascending)\n        return recurse(rootNode, tree, indices, nodes, 0)\n    }\n}\n\nfunction recurse(rootNode, tree, indices, nodes, rootIndex) {\n    nodes = nodes || {}\n\n\n    if (rootNode) {\n        if (indexInRange(indices, rootIndex, rootIndex)) {\n            nodes[rootIndex] = rootNode\n        }\n\n        var vChildren = tree.children\n\n        if (vChildren) {\n\n            var childNodes = rootNode.childNodes\n\n            for (var i = 0; i < tree.children.length; i++) {\n                rootIndex += 1\n\n                var vChild = vChildren[i] || noChild\n                var nextIndex = rootIndex + (vChild.count || 0)\n\n                // skip recursion down the tree if there are no nodes down here\n                if (indexInRange(indices, rootIndex, nextIndex)) {\n                    recurse(childNodes[i], vChild, indices, nodes, rootIndex)\n                }\n\n                rootIndex = nextIndex\n            }\n        }\n    }\n\n    return nodes\n}\n\n// Binary search for an index in the interval [left, right]\nfunction indexInRange(indices, left, right) {\n    if (indices.length === 0) {\n        return false\n    }\n\n    var minIndex = 0\n    var maxIndex = indices.length - 1\n    var currentIndex\n    var currentItem\n\n    while (minIndex <= maxIndex) {\n        currentIndex = ((maxIndex + minIndex) / 2) >> 0\n        currentItem = indices[currentIndex]\n\n        if (minIndex === maxIndex) {\n            return currentItem >= left && currentItem <= right\n        } else if (currentItem < left) {\n            minIndex = currentIndex + 1\n        } else  if (currentItem > right) {\n            maxIndex = currentIndex - 1\n        } else {\n            return true\n        }\n    }\n\n    return false;\n}\n\nfunction ascending(a, b) {\n    return a > b ? 1 : -1\n}\n","var applyProperties = require(\"./apply-properties\")\n\nvar isWidget = require(\"../vnode/is-widget.js\")\nvar VPatch = require(\"../vnode/vpatch.js\")\n\nvar render = require(\"./create-element\")\nvar updateWidget = require(\"./update-widget\")\n\nmodule.exports = applyPatch\n\nfunction applyPatch(vpatch, domNode, renderOptions) {\n    var type = vpatch.type\n    var vNode = vpatch.vNode\n    var patch = vpatch.patch\n\n    switch (type) {\n        case VPatch.REMOVE:\n            return removeNode(domNode, vNode)\n        case VPatch.INSERT:\n            return insertNode(domNode, patch, renderOptions)\n        case VPatch.VTEXT:\n            return stringPatch(domNode, vNode, patch, renderOptions)\n        case VPatch.WIDGET:\n            return widgetPatch(domNode, vNode, patch, renderOptions)\n        case VPatch.VNODE:\n            return vNodePatch(domNode, vNode, patch, renderOptions)\n        case VPatch.ORDER:\n            reorderChildren(domNode, patch)\n            return domNode\n        case VPatch.PROPS:\n            applyProperties(domNode, patch, vNode.properties)\n            return domNode\n        case VPatch.THUNK:\n            return replaceRoot(domNode,\n                renderOptions.patch(domNode, patch, renderOptions))\n        default:\n            return domNode\n    }\n}\n\nfunction removeNode(domNode, vNode) {\n    var parentNode = domNode.parentNode\n\n    if (parentNode) {\n        parentNode.removeChild(domNode)\n    }\n\n    destroyWidget(domNode, vNode);\n\n    return null\n}\n\nfunction insertNode(parentNode, vNode, renderOptions) {\n    var newNode = render(vNode, renderOptions)\n\n    if (parentNode) {\n        parentNode.appendChild(newNode)\n    }\n\n    return parentNode\n}\n\nfunction stringPatch(domNode, leftVNode, vText, renderOptions) {\n    var newNode\n\n    if (domNode.nodeType === 3) {\n        domNode.replaceData(0, domNode.length, vText.text)\n        newNode = domNode\n    } else {\n        var parentNode = domNode.parentNode\n        newNode = render(vText, renderOptions)\n\n        if (parentNode) {\n            parentNode.replaceChild(newNode, domNode)\n        }\n    }\n\n    return newNode\n}\n\nfunction widgetPatch(domNode, leftVNode, widget, renderOptions) {\n    var updating = updateWidget(leftVNode, widget)\n    var newNode\n\n    if (updating) {\n        newNode = widget.update(leftVNode, domNode) || domNode\n    } else {\n        newNode = render(widget, renderOptions)\n    }\n\n    var parentNode = domNode.parentNode\n\n    if (parentNode && newNode !== domNode) {\n        parentNode.replaceChild(newNode, domNode)\n    }\n\n    if (!updating) {\n        destroyWidget(domNode, leftVNode)\n    }\n\n    return newNode\n}\n\nfunction vNodePatch(domNode, leftVNode, vNode, renderOptions) {\n    var parentNode = domNode.parentNode\n    var newNode = render(vNode, renderOptions)\n\n    if (parentNode) {\n        parentNode.replaceChild(newNode, domNode)\n    }\n\n    return newNode\n}\n\nfunction destroyWidget(domNode, w) {\n    if (typeof w.destroy === \"function\" && isWidget(w)) {\n        w.destroy(domNode)\n    }\n}\n\nfunction reorderChildren(domNode, bIndex) {\n    var children = []\n    var childNodes = domNode.childNodes\n    var len = childNodes.length\n    var i\n    var reverseIndex = bIndex.reverse\n\n    for (i = 0; i < len; i++) {\n        children.push(domNode.childNodes[i])\n    }\n\n    var insertOffset = 0\n    var move\n    var node\n    var insertNode\n    for (i = 0; i < len; i++) {\n        move = bIndex[i]\n        if (move !== undefined && move !== i) {\n            // the element currently at this index will be moved later so increase the insert offset\n            if (reverseIndex[i] > i) {\n                insertOffset++\n            }\n\n            node = children[move]\n            insertNode = childNodes[i + insertOffset] || null\n            if (node !== insertNode) {\n                domNode.insertBefore(node, insertNode)\n            }\n\n            // the moved element came from the front of the array so reduce the insert offset\n            if (move < i) {\n                insertOffset--\n            }\n        }\n\n        // element at this index is scheduled to be removed so increase insert offset\n        if (i in bIndex.removes) {\n            insertOffset++\n        }\n    }\n}\n\nfunction replaceRoot(oldRoot, newRoot) {\n    if (oldRoot && newRoot && oldRoot !== newRoot && oldRoot.parentNode) {\n        console.log(oldRoot)\n        oldRoot.parentNode.replaceChild(newRoot, oldRoot)\n    }\n\n    return newRoot;\n}\n","var document = require(\"global/document\")\nvar isArray = require(\"x-is-array\")\n\nvar domIndex = require(\"./dom-index\")\nvar patchOp = require(\"./patch-op\")\nmodule.exports = patch\n\nfunction patch(rootNode, patches) {\n    return patchRecursive(rootNode, patches)\n}\n\nfunction patchRecursive(rootNode, patches, renderOptions) {\n    var indices = patchIndices(patches)\n\n    if (indices.length === 0) {\n        return rootNode\n    }\n\n    var index = domIndex(rootNode, patches.a, indices)\n    var ownerDocument = rootNode.ownerDocument\n\n    if (!renderOptions) {\n        renderOptions = { patch: patchRecursive }\n        if (ownerDocument !== document) {\n            renderOptions.document = ownerDocument\n        }\n    }\n\n    for (var i = 0; i < indices.length; i++) {\n        var nodeIndex = indices[i]\n        rootNode = applyPatch(rootNode,\n            index[nodeIndex],\n            patches[nodeIndex],\n            renderOptions)\n    }\n\n    return rootNode\n}\n\nfunction applyPatch(rootNode, domNode, patchList, renderOptions) {\n    if (!domNode) {\n        return rootNode\n    }\n\n    var newNode\n\n    if (isArray(patchList)) {\n        for (var i = 0; i < patchList.length; i++) {\n            newNode = patchOp(patchList[i], domNode, renderOptions)\n\n            if (domNode === rootNode) {\n                rootNode = newNode\n            }\n        }\n    } else {\n        newNode = patchOp(patchList, domNode, renderOptions)\n\n        if (domNode === rootNode) {\n            rootNode = newNode\n        }\n    }\n\n    return rootNode\n}\n\nfunction patchIndices(patches) {\n    var indices = []\n\n    for (var key in patches) {\n        if (key !== \"a\") {\n            indices.push(Number(key))\n        }\n    }\n\n    return indices\n}\n","var isWidget = require(\"../vnode/is-widget.js\")\n\nmodule.exports = updateWidget\n\nfunction updateWidget(a, b) {\n    if (isWidget(a) && isWidget(b)) {\n        if (\"name\" in a && \"name\" in b) {\n            return a.id === b.id\n        } else {\n            return a.init === b.init\n        }\n    }\n\n    return false\n}\n","var DataSet = require(\"data-set\")\n\nmodule.exports = DataSetHook;\n\nfunction DataSetHook(value) {\n    if (!(this instanceof DataSetHook)) {\n        return new DataSetHook(value);\n    }\n\n    this.value = value;\n}\n\nDataSetHook.prototype.hook = function (node, propertyName) {\n    var ds = DataSet(node)\n    var propName = propertyName.substr(5)\n\n    ds[propName] = this.value;\n};\n","var DataSet = require(\"data-set\")\n\nmodule.exports = DataSetHook;\n\nfunction DataSetHook(value) {\n    if (!(this instanceof DataSetHook)) {\n        return new DataSetHook(value);\n    }\n\n    this.value = value;\n}\n\nDataSetHook.prototype.hook = function (node, propertyName) {\n    var ds = DataSet(node)\n    var propName = propertyName.substr(3)\n\n    ds[propName] = this.value;\n};\n\nDataSetHook.prototype.unhook = function(node, propertyName) {\n    var ds = DataSet(node);\n    var propName = propertyName.substr(3);\n\n    ds[propName] = undefined;\n}\n","module.exports = SoftSetHook;\n\nfunction SoftSetHook(value) {\n    if (!(this instanceof SoftSetHook)) {\n        return new SoftSetHook(value);\n    }\n\n    this.value = value;\n}\n\nSoftSetHook.prototype.hook = function (node, propertyName) {\n    if (node[propertyName] !== this.value) {\n        node[propertyName] = this.value;\n    }\n};\n","var TypedError = require(\"error/typed\")\n\nvar VNode = require(\"../vnode/vnode.js\")\nvar VText = require(\"../vnode/vtext.js\")\nvar isVNode = require(\"../vnode/is-vnode\")\nvar isVText = require(\"../vnode/is-vtext\")\nvar isWidget = require(\"../vnode/is-widget\")\nvar isHook = require(\"../vnode/is-vhook\")\nvar isVThunk = require(\"../vnode/is-thunk\")\n\nvar parseTag = require(\"./parse-tag.js\")\nvar softSetHook = require(\"./hooks/soft-set-hook.js\")\nvar dataSetHook = require(\"./hooks/data-set-hook.js\")\nvar evHook = require(\"./hooks/ev-hook.js\")\n\nvar UnexpectedVirtualElement = TypedError({\n    type: \"virtual-hyperscript.unexpected.virtual-element\",\n    message: \"Unexpected virtual child passed to h().\\n\" +\n        \"Expected a VNode / Vthunk / VWidget / string but:\\n\" +\n        \"got a {foreignObjectStr}.\\n\" +\n        \"The parent vnode is {parentVnodeStr}.\\n\" +\n        \"Suggested fix: change your `h(..., [ ... ])` callsite.\",\n    foreignObjectStr: null,\n    parentVnodeStr: null,\n    foreignObject: null,\n    parentVnode: null\n})\n\nmodule.exports = h\n\nfunction h(tagName, properties, children) {\n    var childNodes = []\n    var tag, props, key, namespace\n\n    if (!children && isChildren(properties)) {\n        children = properties\n        props = {}\n    }\n\n    props = props || properties || {}\n    tag = parseTag(tagName, props)\n\n    // support keys\n    if (\"key\" in props) {\n        key = props.key\n        props.key = undefined\n    }\n\n    // support namespace\n    if (\"namespace\" in props) {\n        namespace = props.namespace\n        props.namespace = undefined\n    }\n\n    // fix cursor bug\n    if (tag === \"input\" &&\n        \"value\" in props &&\n        props.value !== undefined &&\n        !isHook(props.value)\n    ) {\n        props.value = softSetHook(props.value)\n    }\n\n    var keys = Object.keys(props)\n    var propName, value\n    for (var j = 0; j < keys.length; j++) {\n        propName = keys[j]\n        value = props[propName]\n        if (isHook(value)) {\n            continue\n        }\n\n        // add data-foo support\n        if (propName.substr(0, 5) === \"data-\") {\n            props[propName] = dataSetHook(value)\n        }\n\n        // add ev-foo support\n        if (propName.substr(0, 3) === \"ev-\") {\n            props[propName] = evHook(value)\n        }\n    }\n\n    if (children !== undefined && children !== null) {\n        addChild(children, childNodes, tag, props)\n    }\n\n\n    var node = new VNode(tag, props, childNodes, key, namespace)\n\n    return node\n}\n\nfunction addChild(c, childNodes, tag, props) {\n    if (typeof c === \"string\") {\n        childNodes.push(new VText(c))\n    } else if (isChild(c)) {\n        childNodes.push(c)\n    } else if (Array.isArray(c)) {\n        for (var i = 0; i < c.length; i++) {\n            addChild(c[i], childNodes, tag, props)\n        }\n    } else if (c === null || c === undefined) {\n        return\n    } else {\n        throw UnexpectedVirtualElement({\n            foreignObjectStr: JSON.stringify(c),\n            foreignObject: c,\n            parentVnodeStr: JSON.stringify({\n                tagName: tag,\n                properties: props\n            }),\n            parentVnode: {\n                tagName: tag,\n                properties: props\n            }\n        })\n    }\n}\n\nfunction isChild(x) {\n    return isVNode(x) || isVText(x) || isWidget(x) || isVThunk(x)\n}\n\nfunction isChildren(x) {\n    return typeof x === \"string\" || Array.isArray(x) || isChild(x)\n}\n","var classIdSplit = /([\\.#]?[a-zA-Z0-9_:-]+)/\nvar notClassId = /^\\.|#/\n\nmodule.exports = parseTag\n\nfunction parseTag(tag, props) {\n    if (!tag) {\n        return \"div\"\n    }\n\n    var noId = !(\"id\" in props)\n\n    var tagParts = tag.split(classIdSplit)\n    var tagName = null\n\n    if (notClassId.test(tagParts[1])) {\n        tagName = \"div\"\n    }\n\n    var classes, part, type, i\n    for (i = 0; i < tagParts.length; i++) {\n        part = tagParts[i]\n\n        if (!part) {\n            continue\n        }\n\n        type = part.charAt(0)\n\n        if (!tagName) {\n            tagName = part\n        } else if (type === \".\") {\n            classes = classes || []\n            classes.push(part.substring(1, part.length))\n        } else if (type === \"#\" && noId) {\n            props.id = part.substring(1, part.length)\n        }\n    }\n\n    if (classes) {\n        if (props.className) {\n            classes.push(props.className)\n        }\n\n        props.className = classes.join(\" \")\n    }\n\n    return tagName ? tagName.toLowerCase() : \"div\"\n}\n","var h = require(\"./index.js\")\n\nvar BLACKLISTED_KEYS = {\n    \"style\": true,\n    \"namespace\": true,\n    \"key\": true\n}\nvar SVG_NAMESPACE = \"http://www.w3.org/2000/svg\"\n\nmodule.exports = svg\n\nfunction svg(tagName, properties, children) {\n    if (!children && isChildren(properties)) {\n        children = properties\n        properties = {}\n    }\n\n    properties = properties || {}\n\n    // set namespace for svg\n    properties.namespace = SVG_NAMESPACE\n\n    var attributes = properties.attributes || (properties.attributes = {})\n\n    // for each key, if attribute & string, bool or number then\n    // convert it into a setAttribute hook\n    for (var key in properties) {\n        if (!properties.hasOwnProperty(key)) {\n            continue\n        }\n\n        if (BLACKLISTED_KEYS[key]) {\n            continue\n        }\n\n        var value = properties[key]\n        if (typeof value !== \"string\" &&\n            typeof value !== \"number\" &&\n            typeof value !== \"boolean\"\n        ) {\n            continue\n        }\n\n        attributes[key] = value\n    }\n\n    return h(tagName, properties, children)\n}\n\nfunction isChildren(x) {\n    return typeof x === \"string\" || Array.isArray(x)\n}\n","var isVNode = require(\"./is-vnode\")\nvar isVText = require(\"./is-vtext\")\nvar isWidget = require(\"./is-widget\")\nvar isThunk = require(\"./is-thunk\")\n\nmodule.exports = handleThunk\n\nfunction handleThunk(a, b) {\n    var renderedA = a\n    var renderedB = b\n\n    if (isThunk(b)) {\n        renderedB = renderThunk(b, a)\n    }\n\n    if (isThunk(a)) {\n        renderedA = renderThunk(a, null)\n    }\n\n    return {\n        a: renderedA,\n        b: renderedB\n    }\n}\n\nfunction renderThunk(thunk, previous) {\n    var renderedThunk = thunk.vnode\n\n    if (!renderedThunk) {\n        renderedThunk = thunk.vnode = thunk.render(previous)\n    }\n\n    if (!(isVNode(renderedThunk) ||\n            isVText(renderedThunk) ||\n            isWidget(renderedThunk))) {\n        throw new Error(\"thunk did not return a valid node\");\n    }\n\n    return renderedThunk\n}\n","module.exports = isThunk\r\n\r\nfunction isThunk(t) {\r\n    return t && t.type === \"Thunk\"\r\n}\r\n","module.exports = isHook\n\nfunction isHook(hook) {\n    return hook && typeof hook.hook === \"function\" &&\n        !hook.hasOwnProperty(\"hook\")\n}\n","var version = require(\"./version\")\n\nmodule.exports = isVirtualNode\n\nfunction isVirtualNode(x) {\n    return x && x.type === \"VirtualNode\" && x.version === version\n}\n","var version = require(\"./version\")\n\nmodule.exports = isVirtualText\n\nfunction isVirtualText(x) {\n    return x && x.type === \"VirtualText\" && x.version === version\n}\n","module.exports = isWidget\n\nfunction isWidget(w) {\n    return w && w.type === \"Widget\"\n}\n","module.exports = \"1\"\n","var version = require(\"./version\")\nvar isVNode = require(\"./is-vnode\")\nvar isWidget = require(\"./is-widget\")\nvar isThunk = require(\"./is-thunk\")\nvar isVHook = require(\"./is-vhook\")\n\nmodule.exports = VirtualNode\n\nvar noProperties = {}\nvar noChildren = []\n\nfunction VirtualNode(tagName, properties, children, key, namespace) {\n    this.tagName = tagName\n    this.properties = properties || noProperties\n    this.children = children || noChildren\n    this.key = key != null ? String(key) : undefined\n    this.namespace = (typeof namespace === \"string\") ? namespace : null\n\n    var count = (children && children.length) || 0\n    var descendants = 0\n    var hasWidgets = false\n    var hasThunks = false\n    var descendantHooks = false\n    var hooks\n\n    for (var propName in properties) {\n        if (properties.hasOwnProperty(propName)) {\n            var property = properties[propName]\n            if (isVHook(property) && property.unhook) {\n                if (!hooks) {\n                    hooks = {}\n                }\n\n                hooks[propName] = property\n            }\n        }\n    }\n\n    for (var i = 0; i < count; i++) {\n        var child = children[i]\n        if (isVNode(child)) {\n            descendants += child.count || 0\n\n            if (!hasWidgets && child.hasWidgets) {\n                hasWidgets = true\n            }\n\n            if (!hasThunks && child.hasThunks) {\n                hasThunks = true\n            }\n\n            if (!descendantHooks && (child.hooks || child.descendantHooks)) {\n                descendantHooks = true\n            }\n        } else if (!hasWidgets && isWidget(child)) {\n            if (typeof child.destroy === \"function\") {\n                hasWidgets = true\n            }\n        } else if (!hasThunks && isThunk(child)) {\n            hasThunks = true;\n        }\n    }\n\n    this.count = count + descendants\n    this.hasWidgets = hasWidgets\n    this.hasThunks = hasThunks\n    this.hooks = hooks\n    this.descendantHooks = descendantHooks\n}\n\nVirtualNode.prototype.version = version\nVirtualNode.prototype.type = \"VirtualNode\"\n","var version = require(\"./version\")\n\nVirtualPatch.NONE = 0\nVirtualPatch.VTEXT = 1\nVirtualPatch.VNODE = 2\nVirtualPatch.WIDGET = 3\nVirtualPatch.PROPS = 4\nVirtualPatch.ORDER = 5\nVirtualPatch.INSERT = 6\nVirtualPatch.REMOVE = 7\nVirtualPatch.THUNK = 8\n\nmodule.exports = VirtualPatch\n\nfunction VirtualPatch(type, vNode, patch) {\n    this.type = Number(type)\n    this.vNode = vNode\n    this.patch = patch\n}\n\nVirtualPatch.prototype.version = version\nVirtualPatch.prototype.type = \"VirtualPatch\"\n","var version = require(\"./version\")\n\nmodule.exports = VirtualText\n\nfunction VirtualText(text) {\n    this.text = String(text)\n}\n\nVirtualText.prototype.version = version\nVirtualText.prototype.type = \"VirtualText\"\n","var isArray = require(\"x-is-array\")\nvar isObject = require(\"is-object\")\n\nvar VPatch = require(\"../vnode/vpatch\")\nvar isVNode = require(\"../vnode/is-vnode\")\nvar isVText = require(\"../vnode/is-vtext\")\nvar isWidget = require(\"../vnode/is-widget\")\nvar isThunk = require(\"../vnode/is-thunk\")\nvar isHook = require(\"../vnode/is-vhook\")\nvar handleThunk = require(\"../vnode/handle-thunk\")\n\nmodule.exports = diff\n\nfunction diff(a, b) {\n    var patch = { a: a }\n    walk(a, b, patch, 0)\n    return patch\n}\n\nfunction walk(a, b, patch, index) {\n    if (a === b) {\n        return\n    }\n\n    var apply = patch[index]\n\n    if (isThunk(a) || isThunk(b)) {\n        thunks(a, b, patch, index)\n    } else if (b == null) {\n\n        // If a is a widget we will add a remove patch for it\n        // Otherwise any child widgets/hooks must be destroyed.\n        // This prevents adding two remove patches for a widget.\n        if (!isWidget(a)) {\n            clearState(a, patch, index)\n            apply = patch[index]\n        }\n\n        apply = appendPatch(apply, new VPatch(VPatch.REMOVE, a, b))\n    } else if (isVNode(b)) {\n        if (isVNode(a)) {\n            if (a.tagName === b.tagName &&\n                a.namespace === b.namespace &&\n                a.key === b.key) {\n                var propsPatch = diffProps(a.properties, b.properties)\n                if (propsPatch) {\n                    apply = appendPatch(apply,\n                        new VPatch(VPatch.PROPS, a, propsPatch))\n                }\n                apply = diffChildren(a, b, patch, apply, index)\n            } else {\n                clearState(a, patch, index)\n                apply = patch[index]\n                apply = appendPatch(apply, new VPatch(VPatch.VNODE, a, b))\n            }\n        } else {\n            clearState(a, patch, index)\n            apply = patch[index]\n            apply = appendPatch(apply, new VPatch(VPatch.VNODE, a, b))\n        }\n    } else if (isVText(b)) {\n        if (!isVText(a)) {\n            clearState(a, patch, index)\n            apply = patch[index]\n            apply = appendPatch(apply, new VPatch(VPatch.VTEXT, a, b))\n        } else if (a.text !== b.text) {\n            apply = appendPatch(apply, new VPatch(VPatch.VTEXT, a, b))\n        }\n    } else if (isWidget(b)) {\n        if (!isWidget(a)) {\n            clearState(a, patch, index)\n            apply = patch[index]\n        }\n\n        apply = appendPatch(apply, new VPatch(VPatch.WIDGET, a, b))\n    }\n\n    if (apply) {\n        patch[index] = apply\n    }\n}\n\nfunction diffProps(a, b) {\n    var diff\n\n    for (var aKey in a) {\n        if (!(aKey in b)) {\n            diff = diff || {}\n            diff[aKey] = undefined\n        }\n\n        var aValue = a[aKey]\n        var bValue = b[aKey]\n\n        if (aValue === bValue) {\n            continue\n        } else if (isObject(aValue) && isObject(bValue)) {\n            if (getPrototype(bValue) !== getPrototype(aValue)) {\n                diff = diff || {}\n                diff[aKey] = bValue\n            } else if (isHook(bValue)) {\n                 diff = diff || {}\n                 diff[aKey] = bValue\n            } else {\n                var objectDiff = diffProps(aValue, bValue)\n                if (objectDiff) {\n                    diff = diff || {}\n                    diff[aKey] = objectDiff\n                }\n            }\n        } else {\n            diff = diff || {}\n            diff[aKey] = bValue\n        }\n    }\n\n    for (var bKey in b) {\n        if (!(bKey in a)) {\n            diff = diff || {}\n            diff[bKey] = b[bKey]\n        }\n    }\n\n    return diff\n}\n\nfunction getPrototype(value) {\n    if (Object.getPrototypeOf) {\n        return Object.getPrototypeOf(value)\n    } else if (value.__proto__) {\n        return value.__proto__\n    } else if (value.constructor) {\n        return value.constructor.prototype\n    }\n}\n\nfunction diffChildren(a, b, patch, apply, index) {\n    var aChildren = a.children\n    var bChildren = reorder(aChildren, b.children)\n\n    var aLen = aChildren.length\n    var bLen = bChildren.length\n    var len = aLen > bLen ? aLen : bLen\n\n    for (var i = 0; i < len; i++) {\n        var leftNode = aChildren[i]\n        var rightNode = bChildren[i]\n        index += 1\n\n        if (!leftNode) {\n            if (rightNode) {\n                // Excess nodes in b need to be added\n                apply = appendPatch(apply,\n                    new VPatch(VPatch.INSERT, null, rightNode))\n            }\n        } else {\n            walk(leftNode, rightNode, patch, index)\n        }\n\n        if (isVNode(leftNode) && leftNode.count) {\n            index += leftNode.count\n        }\n    }\n\n    if (bChildren.moves) {\n        // Reorder nodes last\n        apply = appendPatch(apply, new VPatch(VPatch.ORDER, a, bChildren.moves))\n    }\n\n    return apply\n}\n\nfunction clearState(vNode, patch, index) {\n    // TODO: Make this a single walk, not two\n    unhook(vNode, patch, index)\n    destroyWidgets(vNode, patch, index)\n}\n\n// Patch records for all destroyed widgets must be added because we need\n// a DOM node reference for the destroy function\nfunction destroyWidgets(vNode, patch, index) {\n    if (isWidget(vNode)) {\n        if (typeof vNode.destroy === \"function\") {\n            patch[index] = appendPatch(\n                patch[index],\n                new VPatch(VPatch.REMOVE, vNode, null)\n            )\n        }\n    } else if (isVNode(vNode) && (vNode.hasWidgets || vNode.hasThunks)) {\n        var children = vNode.children\n        var len = children.length\n        for (var i = 0; i < len; i++) {\n            var child = children[i]\n            index += 1\n\n            destroyWidgets(child, patch, index)\n\n            if (isVNode(child) && child.count) {\n                index += child.count\n            }\n        }\n    } else if (isThunk(vNode)) {\n        thunks(vNode, null, patch, index)\n    }\n}\n\n// Create a sub-patch for thunks\nfunction thunks(a, b, patch, index) {\n    var nodes = handleThunk(a, b);\n    var thunkPatch = diff(nodes.a, nodes.b)\n    if (hasPatches(thunkPatch)) {\n        patch[index] = new VPatch(VPatch.THUNK, null, thunkPatch)\n    }\n}\n\nfunction hasPatches(patch) {\n    for (var index in patch) {\n        if (index !== \"a\") {\n            return true;\n        }\n    }\n\n    return false;\n}\n\n// Execute hooks when two nodes are identical\nfunction unhook(vNode, patch, index) {\n    if (isVNode(vNode)) {\n        if (vNode.hooks) {\n            patch[index] = appendPatch(\n                patch[index],\n                new VPatch(\n                    VPatch.PROPS,\n                    vNode,\n                    undefinedKeys(vNode.hooks)\n                )\n            )\n        }\n\n        if (vNode.descendantHooks || vNode.hasThunks) {\n            var children = vNode.children\n            var len = children.length\n            for (var i = 0; i < len; i++) {\n                var child = children[i]\n                index += 1\n\n                unhook(child, patch, index)\n\n                if (isVNode(child) && child.count) {\n                    index += child.count\n                }\n            }\n        }\n    } else if (isThunk(vNode)) {\n        thunks(vNode, null, patch, index)\n    }\n}\n\nfunction undefinedKeys(obj) {\n    var result = {}\n\n    for (var key in obj) {\n        result[key] = undefined\n    }\n\n    return result\n}\n\n// List diff, naive left to right reordering\nfunction reorder(aChildren, bChildren) {\n\n    var bKeys = keyIndex(bChildren)\n\n    if (!bKeys) {\n        return bChildren\n    }\n\n    var aKeys = keyIndex(aChildren)\n\n    if (!aKeys) {\n        return bChildren\n    }\n\n    var bMatch = {}, aMatch = {}\n\n    for (var aKey in bKeys) {\n        bMatch[bKeys[aKey]] = aKeys[aKey]\n    }\n\n    for (var bKey in aKeys) {\n        aMatch[aKeys[bKey]] = bKeys[bKey]\n    }\n\n    var aLen = aChildren.length\n    var bLen = bChildren.length\n    var len = aLen > bLen ? aLen : bLen\n    var shuffle = []\n    var freeIndex = 0\n    var i = 0\n    var moveIndex = 0\n    var moves = {}\n    var removes = moves.removes = {}\n    var reverse = moves.reverse = {}\n    var hasMoves = false\n\n    while (freeIndex < len) {\n        var move = aMatch[i]\n        if (move !== undefined) {\n            shuffle[i] = bChildren[move]\n            if (move !== moveIndex) {\n                moves[move] = moveIndex\n                reverse[moveIndex] = move\n                hasMoves = true\n            }\n            moveIndex++\n        } else if (i in aMatch) {\n            shuffle[i] = undefined\n            removes[i] = moveIndex++\n            hasMoves = true\n        } else {\n            while (bMatch[freeIndex] !== undefined) {\n                freeIndex++\n            }\n\n            if (freeIndex < len) {\n                var freeChild = bChildren[freeIndex]\n                if (freeChild) {\n                    shuffle[i] = freeChild\n                    if (freeIndex !== moveIndex) {\n                        hasMoves = true\n                        moves[freeIndex] = moveIndex\n                        reverse[moveIndex] = freeIndex\n                    }\n                    moveIndex++\n                }\n                freeIndex++\n            }\n        }\n        i++\n    }\n\n    if (hasMoves) {\n        shuffle.moves = moves\n    }\n\n    return shuffle\n}\n\nfunction keyIndex(children) {\n    var i, keys\n\n    for (i = 0; i < children.length; i++) {\n        var child = children[i]\n\n        if (child.key !== undefined) {\n            keys = keys || {}\n            keys[child.key] = i\n        }\n    }\n\n    return keys\n}\n\nfunction appendPatch(apply, patch) {\n    if (apply) {\n        if (isArray(apply)) {\n            apply.push(patch)\n        } else {\n            apply = [apply, patch]\n        }\n\n        return apply\n    } else {\n        return patch\n    }\n}\n","var hiddenStore = require('./hidden-store.js');\n\nmodule.exports = createStore;\n\nfunction createStore() {\n    var key = {};\n\n    return function (obj) {\n        if (typeof obj !== 'object' || obj === null) {\n            throw new Error('Weakmap-shim: Key must be object')\n        }\n\n        var store = obj.valueOf(key);\n        return store && store.identity === key ?\n            store : hiddenStore(obj, key);\n    };\n}\n","module.exports = hiddenStore;\n\nfunction hiddenStore(obj, key) {\n    var store = { identity: key };\n    var valueOf = obj.valueOf;\n\n    Object.defineProperty(obj, \"valueOf\", {\n        value: function (value) {\n            return value !== key ?\n                valueOf.apply(this, arguments) : store;\n        },\n        writable: true\n    });\n\n    return store;\n}\n","var nativeIsArray = Array.isArray\nvar toString = Object.prototype.toString\n\nmodule.exports = nativeIsArray || isArray\n\nfunction isArray(obj) {\n    return toString.call(obj) === \"[object Array]\"\n}\n","var intervals = require('./intervals.js'),\r\n\tnotes = require('./notes.js'),\r\n\tdiatonic = require('./diatonic.js'),\r\n\t_ = require('../node_modules/underscore');\r\n__indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\r\n\r\n_triads_cache = {};\r\n_sevenths_cache = {};\r\n\r\nchord_shorthand_meaning = {\r\n\t\t// Triads\r\n\t\t\"m\" : \" minor triad\",\r\n\t\t\"M\" : \" major triad\",\r\n\t\t\"\" : \" major triad\",\r\n\t\t\"dim\" : \" diminished triad\",\r\n\r\n\t\t// Augmented chords\r\n\t\t\"aug\" : \" augmented triad\",\r\n\t\t\"+\" : \" augmented triad\",\r\n\t\t\"7#5\" : \" augmented minor seventh\",\r\n\t\t\"M7+5\" : \" augmented minor seventh\",\r\n\t\t\"M7+\" : \" augmented major seventh\",\r\n\t\t\"m7+\" : \" augmented minor seventh\",\r\n\t\t\"7+\" : \" augmented major seventh\",\r\n\r\n\t\t// Suspended chords\r\n\t\t\"sus47\" :\" suspended seventh\",\r\n\t\t\"sus4\" :\" suspended fourth triad\",\r\n\t\t\"sus2\" :\" suspended second triad\",\r\n\t\t\"sus\" :\" suspended fourth triad\",\r\n\t\t\"11\" :\" eleventh\",\r\n\t\t\"sus4b9\" :\" suspended fourth ninth\",\r\n\t\t\"susb9\" :\" suspended fourth ninth\",\r\n\r\n\t\t// Sevenths\r\n\t\t\"m7\" :\" minor seventh\",\r\n\t\t\"M7\" :\" major seventh\",\r\n\t\t\"dom7\" :\" dominant seventh\",\r\n\t\t\"7\" :\" dominant seventh\",\r\n\t\t\"m7b5\" :\" half diminished seventh\",\r\n\t\t\"dim7\" :\" diminished seventh\",\r\n\t\t\"m/M7\" :\" minor/major seventh\",\r\n\t\t\"mM7\" :\" minor/major seventh\",\r\n\t\t\r\n\t\t// Sixths\r\n\t\t\"m6\" : \" minor sixth\",\r\n\t\t\"M6\" : \" major sixth\",\r\n\t\t\"6\" : \" major sixth\", \r\n\t\t\"6/7\" : \" dominant sixth\",\r\n\t\t\"67\": \" dominant sixth\",\r\n\t\t\"6/9\" :\" sixth ninth\",\r\n\t\t\"69\" : \" sixth ninth\",\r\n\r\n\t\t// Ninths\r\n\t\t\"9\" : \" dominant ninth\",\r\n\t\t\"7b9\" : \" dominant flat ninth\",\r\n\t\t\"7#9\" :\" dominant sharp ninth\",\r\n\t\t\"M9\" :\" major ninth\",\r\n\t\t\"m9\" :\" minor ninth\",\r\n\r\n\t\t// Elevenths\r\n\t\t\"7#11\" :\" lydian dominant seventh\",\r\n\t\t\"m11\" :\" minor eleventh\",\r\n\r\n\t\t// Thirteenths\r\n\t\t\"M13\" :\" major thirteenth\",\r\n\t\t\"m13\" :\" minor thirteenth\",\r\n\r\n\t\t\"13\" :\" dominant thirteenth\",\r\n\r\n\t\t// Altered Chords\r\n\t\t\"7b5\" :\" dominant flat five\",\r\n\t\t\r\n\t\t// Special\r\n\t\t\"hendrix\" :\" hendrix chord\",\r\n\t\t\"7b12\" :\" hendrix chord\",\r\n\t\t\"5\" :\" perfect fifth\"\r\n};\r\n\r\n/*===================================================================\r\n\t\t\t\t\t\t\tTriads\r\n===================================================================*/\r\n\r\n// diatonic\r\n\r\nfunction triad(note, key) {\r\n\treturn [note, intervals.third(note, key), intervals.fifth(note, key)]\r\n}\r\n\r\nfunction triads(key) {\r\n\tif(_triads_cache.hasOwnProperty(key)) {\r\n\t\treturn _triads_cache[key];\r\n\t}\r\n\tvar res = diatonic.get_notes(key).map(function (x) {\r\n\t\treturn triad(x, key);\r\n\t});\r\n\t_triads_cache[key] = res;\r\n\treturn res;\r\n}\r\n\r\n// absolute\r\n\r\nfunction major_triad(note) {\r\n\treturn [note, intervals.major_third(note), intervals.perfect_fifth(note)];\r\n}\r\n\r\nfunction minor_triad(note) {\r\n\treturn [note, intervals.minor_third(note), intervals.perfect_fifth(note)];\r\n}\r\n\r\nfunction diminished_triad(note) {\r\n\treturn [note, intervals.minor_third(note), intervals.minor_fifth(note)];\r\n}\r\n\r\nfunction augmented_triad(note) {\r\n\treturn [note, intervals.major_third(note), notes.augment(intervals.major_fifth(note))];\r\n}\r\n\r\n\r\n/*===================================================================\r\n\t\t\t\t\t\t\tSevenths\r\n===================================================================*/\r\n\r\n// diatonic\r\n\r\nfunction seventh(note, key) {\r\n\tvar arr = triad(note, key);\r\n\tarr.push(intervals.seventh(note, key));\r\n\treturn arr;\r\n}\r\n\r\n\r\nfunction sevenths(key) {\r\n\tif(_sevenths_cache.hasOwnProperty(key)) {\r\n\t\treturn _sevenths_cache[key];\r\n\t}\r\n\r\n\tres = diatonic.get_notes(key).map(function (x) {\r\n\t\treturn seventh(x, key);\r\n\t});\r\n\t_sevenths_cache[key] = res;\r\n\treturn res;\r\n}\r\n\r\n//absolute\r\n\r\nfunction major_seventh(note) {\r\n\tvar arr = major_triad(note);\r\n\tarr.push(intervals.major_seventh(note));\r\n\treturn arr;\r\n}\r\n\r\nfunction minor_seventh(note) {\r\n\tvar arr = minor_triad(note);\r\n\tarr.push(intervals.minor_seventh(note));\r\n\treturn arr;\r\n}\r\n\r\nfunction dominant_seventh(note) {\r\n\tvar arr = major_triad(note);\r\n\tarr.push(intervals.minor_seventh(note));\r\n\treturn arr;\r\n}\r\n\r\nfunction half_diminished_seventh(note) {\r\n\tvar arr = diminished_triad(note);\r\n\tarr.push(intervals.minor_seventh(note));\r\n\treturn  arr;\r\n}\r\n\r\nfunction minor_seventh_flat_five(note) {\r\n\treturn half_diminished_seventh(note);\r\n}\r\n\r\nfunction diminished_seventh(note) {\r\n\tvar arr = diminished_triad(note);\r\n\tarr.push(notes.diminish(intervals.minor_seventh(note)));\r\n\treturn arr;\r\n}\r\n\r\nfunction minor_major_seventh(note) {\r\n\tvar arr = minor_triad(note);\r\n\tarr.push(intervals.major_seventh(note));\r\n\treturn arr;\r\n}\r\n\r\n/*===================================================================\r\n\t\t\t\t\t\t\tSixths\r\n===================================================================*/\r\n\r\n// absolute\r\n\r\nfunction minor_sixth(note) {\r\n\tvar arr = minor_triad(note);\r\n\tarr.push(intervals.major_sixth(note));\r\n\treturn arr;\r\n}\r\n\r\nfunction major_sixth(note) {\r\n\tvar arr = major_triad(note);\r\n\tarr.push(intervals.major_sixth(note));\r\n\treturn arr;\r\n}\r\n\r\nfunction dominant_sixth(note) {\r\n\tvar arr = major_sixth(note);\r\n\tarr.push(intervals.minor_seventh(note));\r\n\treturn arr;\r\n}\r\n\r\nfunction sixth_ninth(note) {\r\n\tvar arr = major_sixth(note);\r\n\tarr.push(intervals.major_second(note));\r\n\treturn arr;\r\n}\r\n\r\n/*===================================================================\r\n\t\t\t\t\t\t\tNinths\r\n===================================================================*/\r\n\r\n// absolute\r\n\r\nfunction minor_ninth(note) {\r\n\tvar arr = minor_seventh(note);\r\n\tarr.push(intervals.major_second(note));\r\n\treturn arr;\r\n}\r\n\r\nfunction major_ninth(note) {\r\n\tvar arr = major_seventh(note);\r\n\tarr.push(intervals.major_second(note));\r\n\treturn arr;\r\n}\r\n\r\nfunction dominant_ninth(note) {\r\n\tvar arr = dominant_seventh(note);\r\n\tarr.push(intervals.major_second(note));\r\n\treturn arr;\r\n}\r\n\r\nfunction dominant_flat_ninth(note) {\r\n\tvar res = dominant_ninth(note);\r\n\tres[4] = intervals.minor_second(note);\r\n\treturn res;\r\n}\r\n\r\nfunction dominant_sharp_ninth(note) {\r\n\tvar res = dominant_ninth(note);\r\n\tres[4] = notes.augment(intervals.major_second(note));\r\n\treturn res;\r\n}\r\n\r\n/*===================================================================\r\n\t\t\t\t\t\t\tElevenths\r\n===================================================================*/\r\n\r\n// diatonic\r\n\r\n\r\n// absolute\r\n\r\n\r\nfunction eleventh(note) {\r\n\treturn [note, intervals.perfect_fifth(note), intervals.minor_seventh(note), intervals.perfect_fourth(note)];\r\n}\r\n\r\nfunction minor_eleventh(note) {\r\n\tvar arr = minor_seventh(note);\r\n\tarr.push(intervals.perfect_fourth(note));\r\n\treturn arr;\r\n}\r\n\r\n/*===================================================================\r\n\t\t\t\t\t\t\tThirteenths\r\n===================================================================*/\r\n\r\n// absolute\r\n\r\nfunction minor_thirteenth(note) {\r\n\tvar arr = minor_ninth(note);\r\n\tarr.push(intervals.major_sixth(note));\r\n\treturn arr;\r\n}\r\n\r\n\r\nfunction major_thirteenth(note) {\r\n\tvar arr = major_ninth(note);\r\n\tarr.push(intervals.major_sixth(note));\r\n\treturn arr;\r\n}\r\n\r\n\r\nfunction dominant_thirteenth(note) {\r\n\tvar arr = dominant_ninth(note);\r\n\tarr.push(intervals.major_sixth(note));\r\n\treturn arr;\r\n}\r\n\r\n/*===================================================================\r\n\t\t\t\t\t\t\tSuspended Chords\r\n===================================================================*/\r\n\r\n// absolute\r\n\r\nfunction suspended_triad(note) {\r\n\treturn suspended_fourth_triad(note)\r\n}\r\n\r\n\r\nfunction suspended_second_triad(note) {\r\n\treturn [note, intervals.major_second(note), intervals.perfect_fifth(note)];\r\n}\r\n\r\n\r\nfunction suspended_fourth_triad(note) {\r\n\treturn [note, intervals.perfect_fourth(note), intervals.perfect_fifth(note)]\r\n}\r\n\r\nfunction suspended_seventh(note) {\r\n\tvar arr = suspended_fourth_triad(note);\r\n\tarr.push(intervals.minor_seventh(note));\r\n\treturn arr;\r\n}\r\n\r\nfunction suspended_fourth_ninth(note) {\r\n\tvar arr = suspended_fourth_triad(note);\r\n\tarr.push(intervals.minor_second(note));\r\n\treturn arr;\r\n}\r\n\r\n/*===================================================================\r\n\t\t\t\t\t\t\tAugmented Chords\r\n===================================================================*/\r\n\r\nfunction augmented_major_seventh(note) {\r\n\tvar arr = augmented_triad(note);\r\n\tarr.push(intervals.major_seventh(note));\r\n\treturn arr;\r\n}\r\n\r\nfunction augmented_minor_seventh(note) {\r\n\tvar arr = augmented_triad(note);\r\n\tarr.push(intervals.minor_seventh(note));\r\n\treturn arr;\r\n}\r\n\r\n/*===================================================================\r\n\t\t\t\t\t\t\tVarious, Altered and Special chords\r\n===================================================================*/\r\n\r\nfunction dominant_flat_five(note) {\r\n\tvar res = dominant_seventh(note)\r\n\tres[2] = notes.diminish(res[2])\r\n\treturn res;\r\n}\r\n\r\nfunction lydian_dominant_seventh(note) {\r\n\tvar arr = dominant_seventh(note);\r\n\tarr.push(notes.augment(intervals.perfect_fourth(note)));\r\n\treturn arr;\r\n}\r\n\r\nfunction hendrix_chord(note) {\r\n\tvar arr = dominant_seventh(note);\r\n\tarr.push(intervals.minor_third(note));\r\n\treturn arr;\r\n}\r\n\r\n/*===================================================================\r\n\t\t\t\t\t\t\tChords by harmonic function\r\n===================================================================*/\r\n\r\nfunction tonic(key) {\r\n\treturn triads(key)[0];\r\n}\r\n\r\nfunction tonic7(key) {\r\n\treturn sevenths(key)[0];\r\n}\r\n\r\nfunction supertonic(key) {\r\n\treturn triads(key)[1];\r\n}\r\n\r\nfunction supertonic7(key) {\r\n\treturn sevenths(key)[1];\r\n}\r\n\r\nfunction mediant(key) {\r\n\treturn triads(key)[2];\r\n}\r\n\r\nfunction mediant7(key) {\r\n\treturn sevenths(key)[2];\r\n}\r\n\r\nfunction subdominant(key) {\r\n\treturn triads(key)[3];\r\n}\r\n\r\nfunction subdominant7(key) {\r\n\treturn sevenths(key)[3];\r\n}\r\n\r\nfunction dominant(key) {\r\n\treturn triads(key)[4];\r\n}\r\n\r\nfunction dominant7(key) {\r\n\treturn sevenths(key)[4];\r\n}\r\n\r\nfunction submediant(key) {\r\n\treturn triads(key)[5];\r\n}\r\n\r\nfunction submediant7(key) {\r\n\treturn sevenths(key)[5];\r\n}\r\n\r\nfunction subtonic(key) {\r\n\treturn triads(key)[6];\r\n}\r\n\r\nfunction subtonic7(key) {\r\n\treturn sevenths(key)[6];\r\n}\r\n\r\n/*===================================================================\r\n\t\t\t\t\t\t\tAliases\r\n===================================================================*/\r\n\r\nfunction I(key) {\r\n\treturn tonic(key);\r\n}\r\n\r\nfunction I7(key) {\r\n\treturn tonic7(key);\r\n}\r\n\r\nfunction ii(key) {\r\n\treturn supertonic(key);\r\n}\r\n\r\nfunction II(key) {\r\n\treturn supertonic(key);\r\n}\r\n\r\nfunction ii7(key) {\r\n\treturn supertonic7(key);\r\n}\r\n\r\nfunction II7(key) {\r\n\treturn supertonic7(key);\r\n}\r\n\r\nfunction iii(key) {\r\n\treturn mediant(key);\r\n}\r\n\r\nfunction III(key) {\r\n\treturn mediant(key);\r\n}\r\n\r\nfunction iii7(key) {\r\n\treturn mediant7(key);\r\n}\r\n\r\nfunction III7(key) {\r\n\treturn mediant7(key);\r\n}\r\n\r\nfunction IV(key) {\r\n\treturn subdominant(key);\r\n}\r\n\r\nfunction IV7(key) {\r\n\treturn subdominant7(key);\r\n}\r\n\r\nfunction V(key) {\r\n\treturn dominant(key);\r\n}\r\n\r\nfunction V7(key) {\r\n\treturn dominant7(key);\r\n}\r\n\r\nfunction vi(key) {\r\n\treturn submediant(key);\r\n}\r\n\r\nfunction VI(key) {\r\n\treturn submediant(key);\r\n}\r\n\r\nfunction vi7(key) {\r\n\treturn submediant7(key);\r\n}\r\n\r\nfunction VI7(key) {\r\n\treturn submediant7(key);\r\n}\r\n\r\nfunction vii(key) {\r\n\treturn subtonic(key);\r\n}\r\n\r\nfunction VII(key) {\r\n\treturn subtonic(key);\r\n}\r\n\r\nfunction vii7(key) {\r\n\treturn subtonic(key);\r\n}\r\n\r\nfunction VII7(key) {\r\n\treturn subtonic7(key);\r\n}\r\n\r\n/*===================================================================\r\n\t\t\t\t\t\t\tInversions\r\n===================================================================*/\r\n\r\nfunction invert(chord) {\r\n\tvar a = chord.slice(1, chord.length);\r\n\ta.push(chord[0]);\r\n\treturn a;\r\n}\r\n\r\nfunction first_inversion(chord) {\r\n\treturn invert(chord)\r\n}\r\n\r\nfunction second_inversion(chord) {\r\n\treturn invert(invert(chord))\r\n}\r\n\r\nfunction third_inversion(chord) {\r\n\treturn invert(invert(invert(chord)))\r\n}\r\n\r\n/*===================================================================\r\n\t\t\t\t\t\t\tOther\r\n===================================================================*/\r\n\r\nfunction from_shorthand(shorthand_string, slash) {\r\n\t//warning reduce?? \r\n\tif(typeof shorthand_string == 'array'){\r\n\t\tvar res = [];\r\n\t\tfor(var i = 0; i < shorthand_string.length; i++) {\r\n\t\t\tres.push(from_shorthand(shorthand_string[i]));\r\n\t\t};\r\n\t\treturn res;\r\n\t}\r\n\tif(__indexOf.call([\"NC\", \"N.C.\"], shorthand_string) >= 0) {\r\n\t\treturn [];\r\n\t}\r\n\r\n\t//Shrink shorthand_string to a format recognised by chord_shorthand\r\n\tshorthand_string = shorthand_string.replace('min', 'm');\r\n\tshorthand_string = shorthand_string.replace('mi', 'm');\r\n\tshorthand_string = shorthand_string.replace('-', 'm');\r\n\r\n\tshorthand_string = shorthand_string.replace('maj', 'M');\r\n\tshorthand_string = shorthand_string.replace('ma', 'M');\r\n\r\n\t//Get the note name\r\n\tif(!notes.is_valid_note(shorthand_string[0])) {\r\n\t\tthrow \"NoteFormatError: Unrecognised note '\" + shorthand_string[0] + \"' in chord '\" + shorthand_string + \"'\";\r\n\t}\r\n\r\n\tname = shorthand_string[0];\r\n\r\n\t//Look for accidentals\r\n\tfor (_i = 0, _len = shorthand_string.slice(1, shorthand_string.length).length; _i < _len; _i++) {\r\n\t\tn = shorthand_string.slice(1, shorthand_string.length)[_i];\r\n\t\tif (n === '#') {\r\n\t\t\tname += n;\r\n\t\t} else if (n === 'b') {\r\n\t\t\tname += n;\r\n\t\t} else {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\t//Look for slashes and polychords '|'\r\n\tslash_index = -1;\r\n\ts = 0;\r\n\trest_of_string = shorthand_string.slice(name.length, shorthand_string.length);\r\n\tfor (_i = 0, _len = rest_of_string.length; _i < _len; _i++) {\r\n\t\tn = rest_of_string[_i];\r\n\t\tif (n === '/') {\r\n\t\t\tslash_index = s;\r\n\t\t} else if (n === '|') {\r\n\t\t\t//Generate polychord\r\n\t\t\treturn from_shorthand(shorthand_string.slice(0, name.length + s), from_shorthand(shorthand_string.slice(name.length + s + 1, shorthand_string.length)));\r\n\t\t}\r\n\t\ts += 1;\r\n\t}\r\n\r\n\t//Generate slash chord\r\n\tif(slash_index != -1 && !(__indexOf.call([\"m/M7\", \"6/9\", \"6/7\"], rest_of_string) >= 0)) {\r\n\t\tres = shorthand_string.slice(0, name.length + slash_index);\r\n\t\treturn from_shorthand(shorthand_string.slice(0, name.length + slash_index), shorthand_string.slice(name.length + slash_index + 1, shorthand_string.length))\r\n\t}\r\n\r\n\tshorthand_start = name.length;\r\n\r\n\t//Return chord\r\n\tshort_chord = shorthand_string.slice(shorthand_start, shorthand_string.length);\r\n\tif(chord_shorthand.hasOwnProperty(short_chord)) {\r\n\t\tres = chord_shorthand[short_chord](name);\r\n\t\tif(slash != null) {\r\n\t\t\t//Add slashed chords\r\n\t\t\tif(typeof slash == 'string') {\r\n\t\t\t\tif(notes.is_valid_note(slash)) {\r\n\t\t\t\t\tres.unshift(slash);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow \"NoteFormatError: Unrecognised note '\" + slash + \"' in slash chord '\" + shorthand_string + \"'\";\r\n\t\t\t\t}\r\n\t\t\t//Add polychords\r\n\t\t\t} else if(typeof slash == 'object') {\r\n\t\t\t\tr = slash;\r\n\t\t\t\tfor (_i = 0, _len = res.length; _i < _len; _i++) {\r\n\t\t\t\t\tn = res[_i];\r\n\t\t\t\t\tif (n !== r[r.length-1]) {\r\n\t\t\t\t\t\tr.push(n);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn r;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res;\r\n\t} else {\r\n\t\tthrow \"FormatError: Unknown shorthand: \" + shorthand_string;\r\n\t}\r\n}\r\n\r\n/*===================================================================\r\n\t\t\t\t\t\t\tChord recognition\r\n===================================================================*/\r\n\r\nfunction determine(chord, shorthand, no_inversions, no_polychords) {\r\n\tif(shorthand == null) {\r\n\t\tshorthand = false;\r\n\t}\r\n\tif(no_inversions == null) {\r\n\t\tno_inversions = false;\r\n\t}\r\n\tif(no_polychords == null) {\r\n\t\tno_polychords = false;\r\n\t}\r\n\tif(chord == []) {\r\n\t\treturn [];\r\n\t} else if(chord.length == 1) {\r\n\t\treturn chord;\r\n\t} else if(chord.length == 2) {\r\n\t\treturn [intervals.determine(chord[0], chord[1])];\r\n\t} else if(chord.length == 3) {\r\n\t\treturn determine_triad(chord, shorthand, no_inversions, no_polychords);\r\n\t} else if(chord.length == 4) {\r\n\t\treturn determine_seventh(chord, shorthand, no_inversions, no_polychords);\r\n\t} else if(chord.length == 5) {\r\n\t\treturn determine_extended_chord5(chord, shorthand, no_inversions, no_polychords);\r\n\t} else if(chord.length == 6) {\r\n\t\treturn determine_extended_chord6(chord, shorthand, no_inversions, no_polychords);\r\n\t} else if(chord.length == 7) {\r\n\t\treturn determine_extended_chord7(chord, shorthand, no_inversions, no_polychords);\r\n\t} else {\r\n\t\treturn determine_polychords(chord, shorthand);\r\n\t}\r\n}\r\n\r\n\r\nfunction determine_triad(triad, shorthand, no_inversions, placeholder) {\r\n\tif(shorthand == null) {\r\n\t\tshorthand = false;\r\n\t}\r\n\tif(no_inversions == null) {\r\n\t\tno_inversions = false;\r\n\t}\r\n\tif(triad.length != 3) {\r\n\t\t//warning: raise exception: not a triad\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfunction inversion_exhauster(triad, shorthand, tries, resulta) {\r\n\t\t/*Recursive helper function that runs tries every inversion\r\n\t\tand saves the result.*/\r\n\t\tvar result = resulta;\r\n\t\tvar intval1 = intervals.determine(triad[0], triad[1], true);\r\n\t\tvar intval2 = intervals.determine(triad[0], triad[2], true);\r\n\r\n\t\tfunction add_result(short) {\r\n\t\t\tresult.push([short, tries, triad[0]]);\r\n\t\t}\r\n\r\n\t\tintval = intval1 + intval2;\r\n\t\tif(intval == \"25\") {\r\n\t\t\tadd_result(\"sus2\");\r\n\t\t} else if(intval == \"3b7\") {\r\n\t\t\tadd_result(\"dom7\"); // changed from just '7'\r\n\t\t} else if(intval == \"3b5\") { \r\n\t\t\tadd_result(\"7b5\"); // why not b5?\r\n\t\t} else if(intval == \"35\") {\r\n\t\t\tadd_result(\"M\");\r\n\t\t} else if(intval == \"3#5\") {\r\n\t\t\tadd_result(\"aug\");\r\n\t\t} else if(intval == \"36\") {\r\n\t\t\tadd_result(\"M6\");\r\n\t\t} else if(intval == \"37\") {\r\n\t\t\tadd_result(\"M7\");\r\n\t\t} else if(intval == \"b3b5\") {\r\n\t\t\tadd_result(\"dim\");\r\n\t\t} else if(intval == \"b35\") {\r\n\t\t\tadd_result(\"m\");\r\n\t\t} else if(intval == \"b36\") {\r\n\t\t\tadd_result(\"m6\");\r\n\t\t} else if(intval == \"b3b7\") {\r\n\t\t\tadd_result(\"m7\");\r\n\t\t} else if(intval == \"b37\") {\r\n\t\t\tadd_result(\"m/M7\");\r\n\t\t} else if(intval == \"45\") {\r\n\t\t\tadd_result(\"sus4\");\r\n\t\t} else if(intval == \"5b7\") {\r\n\t\t\tadd_result(\"m7\");\r\n\t\t} else if(intval == \"57\") {\r\n\t\t\tadd_result(\"M7\");\r\n\t\t}\r\n\r\n\t\tif(tries != 3 && !no_inversions) {\r\n\t\t\tvar arr = [triad[triad.length-1]];\r\n\t\t\tvar m = triad.slice(0, triad.length-1);\r\n\t\t\tfor (var i = 0; i < m.length; i++) {\r\n\t\t\t\tarr.push(m[i]);\r\n\t\t\t};\r\n\t\t\treturn inversion_exhauster(arr, shorthand, tries + 1, result);\r\n\t\t} else {\r\n\t\t\tres = [];\r\n\t\t\tfor (var i = 0; i < result.length; i++) {\r\n\t\t\t\tr = result[i];\r\n\t\t\t\tif(shorthand){\r\n\t\t\t\t\tres.push(r[2] + r[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tres.push(r[2] + chord_shorthand_meaning[r[0]] + int_desc(r[1]));\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\treturn res;\r\n\t\t}\r\n\t}\r\n\r\n\treturn inversion_exhauster(triad, shorthand, 1, []);\r\n}\r\n\r\nfunction determine_seventh(seventh, shorthand, no_inversion, no_polychords) {\r\n\tif(shorthand == null) {\r\n\t\tshorthand = false;\r\n\t}\r\n\tif(no_inversion == null) {\r\n\t\tno_inversion = false;\r\n\t}\r\n\tif(no_polychords == null) {\r\n\t\tno_polychords = false;\r\n\t}\r\n\tif(seventh.length != 4) {\r\n\t\t//warning raise exception: seventh chord is not a seventh chord\r\n\t\treturn false\r\n\t}\r\n\r\n\tfunction inversion_exhauster(seventh, shorthand, tries, resulta, polychordsa) {\r\n\t\t/*determine sevenths recursive functions*/\r\n\r\n\t\t// Check whether the first three notes of seventh \r\n\t\t// are part of some triad.\r\n\t\tvar result = resulta;\r\n\t\tvar polychords = polychordsa;\r\n\t\tvar triads = determine_triad(seventh.slice(0, 3), true, true);\r\n\r\n\t\t// Get the interval between the first and last note\r\n\t\tvar intval3 = intervals.determine(seventh[0], seventh[3]);\r\n\r\n\t\tfunction add_result(short, poly) {\r\n\t\t\t// helper function\r\n\t\t\tif(poly == null) {\r\n\t\t\t\tpoly = false;\r\n\t\t\t}\r\n\t\t\tresult.push([short, tries, seventh[0], poly]);\r\n\t\t}\r\n\r\n\t\t// Recognizing polychords\r\n\t\tif(tries == 1 && !no_polychords) {\r\n\t\t\tvar p = determine_polychords(seventh, shorthand);\r\n\t\t\tfor (var i = 0; i < p.length; i++) {\r\n\t\t\t\tpolychords.push(p[i]);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// Recognizing sevenths\r\n\t\tfor(var i = 0; i < triads.length; i++) {\r\n\t\t\tvar triad = triads[i];\r\n\t\t\t// Basic triads\r\n\t\t\ttriad = triad.slice(seventh[0].length, triad.length);\r\n\t\t\tif(triad == \"m\") {\r\n\t\t\t\tif(intval3 == \"minor seventh\") {\r\n\t\t\t\t\tadd_result(\"m7\");\r\n\t\t\t\t} else if(intval3 == \"major seventh\") {\r\n\t\t\t\t\tadd_result(\"m/M7\");\r\n\t\t\t\t} else if(intval3 == \"major sixth\") {\r\n\t\t\t\t\tadd_result(\"m6\");\r\n\t\t\t\t}\r\n\t\t\t} else if(triad == \"M\") {\r\n\t\t\t\tif(intval3 == \"major seventh\") {\r\n\t\t\t\t\tadd_result(\"M7\");\r\n\t\t\t\t} else if(intval3 == \"minor seventh\") {\r\n\t\t\t\t\tadd_result(\"7\");\r\n\t\t\t\t} else if(intval3 == \"major sixth\") {\r\n\t\t\t\t\tadd_result(\"M6\");\r\n\t\t\t\t}\r\n\t\t\t} else if(triad == \"dim\") {\r\n\t\t\t\tif(intval3 == \"minor seventh\") {\r\n\t\t\t\t\tadd_result(\"m7b5\");\r\n\t\t\t\t} else if(intval3 == \"diminished seventh\") {\r\n\t\t\t\t\tadd_result(\"dim7\");\r\n\t\t\t\t}\r\n\t\t\t} else if(triad == \"aug\") {\r\n\t\t\t\tif(intval3 == \"minor seventh\") {\r\n\t\t\t\t\tadd_result(\"m7+\");\r\n\t\t\t\t}\r\n\t\t\t\tif(intval3 == \"major seventh\") {\r\n\t\t\t\t\tadd_result(\"M7+\");\r\n\t\t\t\t}\r\n\t\t\t} else if(triad == \"sus4\") {\r\n\t\t\t\tif(intval3 == \"minor seventh\") {\r\n\t\t\t\t\tadd_result(\"sus47\");\r\n\t\t\t\t} else if(intval3 == \"minor second\") {\r\n\t\t\t\t\tadd_result(\"sus4b9\");\r\n\t\t\t\t}\r\n\t\t\t// Other\r\n\t\t\t} else if(triad == 'm7') {\r\n\t\t\t\tif(intval3 == 'perfect fourth') {\r\n\t\t\t\t\tadd_result(\"11\");\r\n\t\t\t\t}\r\n\t\t\t} else if(triad == '7b5') {\r\n\t\t\t\tif(intval3 == 'minor seventh') {\r\n\t\t\t\t\tadd_result(\"7b5\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Loop until we have exhausted all the inversions\r\n\t\tif(tries != 4 && !no_inversion) {\r\n\t\t\tvar arg1 = seventh.slice(0, seventh.length - 1);\r\n\t\t\targ1.unshift(seventh[seventh.length - 1]);\r\n\t\t\treturn inversion_exhauster(arg1, shorthand, tries + 1, result, polychords);\r\n\t\t} else {\r\n\t\t\t// Return results\r\n\t\t\tvar res = [];\r\n\t\t\t// Reset seventh\r\n\t\t\tvar arr = seventh.slice(0, 3);\r\n\t\t\tarr.unshift(seventh[3]);\r\n\t\t\tseventh = arr;\r\n\t\t\tfor(var i = 0; i < result.length; i++) {\r\n\t\t\t\tvar x = result[i];\r\n\t\t\t\tif(shorthand) {\r\n\t\t\t\t\tres.push(x[2] + x[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tres.push(x[2] + chord_shorthand_meaning[x[0]] + int_desc(x[1]));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor(var i = 0; i < polychords.length; i++) {\r\n\t\t\t\tres.push(polychords[i]);\r\n\t\t\t};\r\n\t\t\treturn res;\r\n\t\t}\r\n\t}\r\n\treturn inversion_exhauster(seventh, shorthand, 1, [], []);\r\n}\r\n\r\nfunction determine_extended_chord5(chord, shorthand, no_inversions, no_polychords) {\r\n\tif(shorthand == null) {\r\n\t\tshorthand = false;\r\n\t}\r\n\tif(no_inversions == null) {\r\n\t\tno_inversions = false;\r\n\t}\r\n\tif(no_polychords == null) {\r\n\t\tno_polychords = false;\r\n\t}\r\n\tif(chord.length != 5) {\r\n\t\t//warning raise exeption: not an extended chord\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfunction inversion_exhauster(chord, shorthand, tries, resulta, polychordsa) {\r\n\t\t/*Recursive helper function*/\r\n\t\tvar polychords = polychordsa;\r\n\t\tvar result = resulta;\r\n\r\n\t\tfunction add_result(short) {\r\n\t\t\tresult.push([short, tries, chord[0]]);\r\n\t\t}\r\n\r\n\t\tvar triads = determine_triad(chord.slice(0, 3), true, true);\r\n\t\tvar sevenths = determine_seventh(chord.slice(0, 4), true, true, true);\r\n\r\n\t\t// Determine polychords\r\n\t\tif(tries == 1 && !no_polychords){\r\n\t\t\tvar p = determine_polychords(chord, shorthand);\r\n\t\t\tfor (var i = 0; i < p.length; i++) {\r\n\t\t\t\tpolychords.push(p[i]);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// Determine 'normal' chords\r\n\t\tvar intval4 = intervals.determine(chord[0], chord[4]);\r\n\t\tfor(var i = 0; i < sevenths.length; i++) {\r\n\t\t\tvar seventh = sevenths[i];\r\n\t\t\tseventh = seventh.slice(chord[0].length, seventh.length)\r\n\t\t\tif(seventh == \"M7\") {\r\n\t\t\t\tif(intval4 == 'major second') {\r\n\t\t\t\t\tadd_result(\"M9\");\r\n\t\t\t\t}\r\n\t\t\t} else if(seventh == \"m7\") {\r\n\t\t\t\tif(intval4 == 'major second') {\r\n\t\t\t\t\tadd_result(\"m9\");\r\n\t\t\t\t} else if(intval4 == 'perfect fourth') {\r\n\t\t\t\t\tadd_result(\"m11\");\r\n\t\t\t\t}\r\n\t\t\t} else if(seventh == \"7\") {\r\n\t\t\t\tif(intval4 == 'major second') {\r\n\t\t\t\t\tadd_result(\"9\");\r\n\t\t\t\t} else if(intval4 == 'minor second') {\r\n\t\t\t\t\tadd_result(\"7b9\");\r\n\t\t\t\t} else if(intval4 == 'augmented second') {\r\n\t\t\t\t\tadd_result(\"7#9\");\r\n\t\t\t\t} else if(intval4 == 'minor third') {\r\n\t\t\t\t\tadd_result(\"7b12\");\r\n\t\t\t\t} else if(intval4 == 'augmented fourth') {\r\n\t\t\t\t\tadd_result(\"7#11\");\r\n\t\t\t\t} else if(intval4 == 'major sixth') {\r\n\t\t\t\t\tadd_result(\"13\");\r\n\t\t\t\t}\r\n\t\t\t} else if(seventh == \"M6\") {\r\n\t\t\t\tif(intval4 == \"major second\") {\r\n\t\t\t\t\tadd_result(\"6/9\");\r\n\t\t\t\t} else if(intval4 == \"minor seventh\") {\r\n\t\t\t\t\tadd_result(\"6/7\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (tries != 5 && !no_inversions) {\r\n\t\t\tvar arg1 = chord.slice(0, chord.length - 1);\r\n\t\t\targ1.unshift(chord[chord.length - 1]);\r\n\t\t\treturn inversion_exhauster(arg1, shorthand, tries + 1, result, polychords);\r\n\t\t} else {\r\n\t\t\tvar res = []\r\n\t\t\tfor(var i = 0; i < result.length; i++) {\r\n\t\t\t\tvar r = result[i];\r\n\t\t\t\tif(shorthand) {\r\n\t\t\t\t\tres.push(r[2] + r[0])\r\n\t\t\t\t} else {\r\n\t\t\t\t\tres.push(r[2] + chord_shorthand_meaning[r[0]] + int_desc(r[1]))\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor(var i = 0; i < polychords.length; i++) {\r\n\t\t\t\tres.push(polychords[i]);\r\n\t\t\t};\r\n\t\t\treturn res;\r\n\t\t}\r\n\t}\r\n\treturn inversion_exhauster(chord, shorthand, 1, [], [])\r\n}\r\n\r\nfunction determine_extended_chord6(chord, shorthand, no_inversions, no_polychords) {\r\n\tif(shorthand == null) {\r\n\t\tshorthand = false;\r\n\t}\r\n\tif(no_inversions == null) {\r\n\t\tno_inversions = false;\r\n\t}\r\n\tif(no_polychords == null) {\r\n\t\tno_polychords = false;\r\n\t}\r\n\r\n\tif(chord.length != 6) {\r\n\t\t//warning raise exeption: not an extended chord\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfunction inversion_exhauster(chord, shorthand, tries, resulta, polychordsa) {\r\n\t\t/*Recursive helper function*/\r\n\t\tvar polychords = polychordsa;\r\n\t\tvar result = resulta;\r\n\t\t// Determine polychords\r\n\t\tif(tries == 1 && !no_polychords) {\r\n\t\t\tvar p = determine_polychords(chord, shorthand);\r\n\t\t\tfor (var i = 0; i < p.length; i++) {\r\n\t\t\t\tpolychords.push(p[i]);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tfunction add_result(short) {\r\n\t\t\tresult.push([short, tries, chord[0]]);\r\n\t\t}\r\n\r\n\t\tvar ch = determine_extended_chord5(chord.slice(0, 5), true, true, true);\r\n\t\tvar intval5 = intervals.determine(chord[0], chord[5]);\r\n\r\n\t\tfor(var i = 0; i < ch.length; i++) {\r\n\t\t\tvar c = ch[i];\r\n\t\t\tc = c.slice(chord[0].length, c.length);\r\n\t\t\tif(c == '9') {\r\n\t\t\t\tif(intval5 == 'perfect fourth') {\r\n\t\t\t\t\tadd_result('11');\r\n\t\t\t\t} else if(intval5 == 'augmented fourth') {\r\n\t\t\t\t\tadd_result('7#11');\r\n\t\t\t\t} else if(intval5 == 'major sixth') {\r\n\t\t\t\t\tadd_result('13');\r\n\t\t\t\t}\r\n\t\t\t} else if(c == 'm9') {\r\n\t\t\t\tif(intval5 == 'perfect fourth') {\r\n\t\t\t\t\tadd_result('m11');\r\n\t\t\t\t} else if(intval5 == 'major sixth') {\r\n\t\t\t\t\tadd_result('m13');\r\n\t\t\t\t}\r\n\t\t\t} else if(c == 'M9') {\r\n\t\t\t\tif(intval5 == 'perfect fourth') {\r\n\t\t\t\t\tadd_result('M11');\r\n\t\t\t\t} else if(intval5 == 'major sixth') {\r\n\t\t\t\t\tadd_result('M13');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(tries != 6 && !no_inversions) {\r\n\t\t\tvar arg1 = chord.slice(0, chord.length - 1);\r\n\t\t\targ1.unshift(chord[chord.length - 1]);\r\n\t\t\treturn inversion_exhauster(arg1, shorthand, tries + 1, result, polychords)\r\n\t\t} else {\r\n\t\t\tvar res = []\r\n\t\t\tfor(var i = 0; i < result.length; i++) {\r\n\t\t\t\tvar r = result[i];\r\n\t\t\t\tif(shorthand) {\r\n\t\t\t\t\tres.push(r[2] + r[0])\r\n\t\t\t\t} else {\r\n\t\t\t\t\tres.push(r[2] + chord_shorthand_meaning[r[0]] + int_desc(r[1]))\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor(var i = 0; i < polychords.length; i++) {\r\n\t\t\t\tres.push(polychords[i]);\r\n\t\t\t};\r\n\t\t\treturn res;\r\n\t\t}\r\n\t}\r\n\treturn inversion_exhauster(chord, shorthand, 1, [], []);\r\n}\r\n\r\nfunction determine_extended_chord7(chord, shorthand, no_inversions, no_polychords) {\r\n\tif(shorthand == null) {\r\n\t\tshorthand = false;\r\n\t}\r\n\tif(no_inversions == null) {\r\n\t\tno_inversions = false;\r\n\t}\r\n\tif(no_polychords == null) {\r\n\t\tno_polychords = false;\r\n\t}\r\n\r\n\tif(chord.length != 7) {\r\n\t\t//warning raise exeption: not an extended chord\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfunction inversion_exhauster(chord, shorthand, tries, resulta, polychordsa) {\r\n\t\t/*Recursive helper function*/\r\n\t\tvar polychords = polychordsa;\r\n\t\tvar result = resulta;\r\n\t\t// Determine polychords\r\n\t\tif(tries == 1 && !no_polychords) {\r\n\t\t\tvar p = determine_polychords(chord, shorthand);\r\n\t\t\tfor (var i = 0; i < p.length; i++) {\r\n\t\t\t\tpolychords.push(p[i]);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tfunction add_result(short) {\r\n\t\t\tresult.push([short, tries, chord[0]]);\r\n\t\t}\r\n\r\n\t\tvar ch = determine_extended_chord6(chord.slice(0, 6), true, true, true);\r\n\t\tvar intval6 = intervals.determine(chord[0], chord[6]);\r\n\r\n\t\tfor(var i = 0; i < ch.length; i++) {\r\n\t\t\tvar c = ch[i]; \r\n\t\t\tc = c.slice(chord[0].length, c.length);\r\n\t\t\tif(c == '11') {\r\n\t\t\t\tif(intval6 == 'major sixth') {\r\n\t\t\t\t\tadd_result('13');\r\n\t\t\t\t}\r\n\t\t\t} else if(c == 'm11'){\r\n\t\t\t\tif(intval6 == 'major sixth') {\r\n\t\t\t\t\tadd_result('m13');\r\n\t\t\t\t}\r\n\t\t\t} else if(c == 'M11'){\r\n\t\t\t\tif(intval6 == 'major sixth') {\r\n\t\t\t\t\tadd_result('M13');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\t\t\r\n\t\tif(tries != 6) {\r\n\t\t\tvar arg1 = chord.slice(0, chord.length - 1);\r\n\t\t\targ1.unshift(chord[chord.length - 1]);\r\n\t\t\treturn inversion_exhauster(arg1, shorthand, tries + 1, result, polychords);\r\n\t\t} else {\r\n\t\t\tvar res = [];\r\n\t\t\tfor(var i = 0; i < result.length; i++) {\r\n\t\t\t\tvar r = result[i];\r\n\t\t\t\tif(shorthand) {\r\n\t\t\t\t\tres.push(r[2] + r[0]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tres.push(r[2] + chord_shorthand_meaning[r[0]] + int_desc(r[1]));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor(var i = 0; i < polychords.length; i++) {\r\n\t\t\t\tres.push(polychords[i]);\r\n\t\t\t};\r\n\t\t\treturn res;\r\n\t\t}\r\n\t}\r\n\treturn inversion_exhauster(chord, shorthand, 1, [], []);\r\n}\r\n\r\nfunction int_desc(tries) {\r\n\tif(tries == 1) {\r\n\t\treturn \"\";\r\n\t} else if(tries == 2) {\r\n\t\treturn \", first inversion\";\r\n\t} else if(tries == 3) {\r\n\t\treturn \", second inversion\";\r\n\t} else if(tries == 4) {\r\n\t\treturn \", third inversion\";\r\n\t}\r\n}\r\n\r\nfunction determine_polychords(chord, shorthand) {\r\n\tif(shorthand == null) {\r\n\t\tshorthand = false;\r\n\t}\r\n\tvar polychords = []\r\n\r\n\tvar function_list = [determine_triad, determine_seventh, determine_extended_chord5, determine_extended_chord6, determine_extended_chord7];\r\n\r\n\t// Range tracking. \r\n\tif(chord.length <= 3) {\r\n\t\treturn [];\r\n\t} else if(chord.length > 14) {\r\n\t\treturn [];\r\n\t} else if(chord.length - 3 <= 5) {\r\n\t\tfunction_nr = _.range(0, chord.length - 3);\r\n\t} else {\r\n\t\tfunction_nr = _.range(0, 5);\r\n\t}\r\n\r\n\tfor(var i = 0; i < function_nr.length; i++) {\r\n\t\tvar f = function_nr[i];\r\n\t\tfor (var k = 0; k < function_nr.length; k++) {\r\n\t\t\tvar f2 = function_nr[k]\r\n\t\t\tvar r1 = function_list[f](chord.slice(chord.length -(3 + f), chord.length), true, true, true);\r\n\t\t\tfor(var j = 0; j < r1.length; j++) {\r\n\t\t\t\tvar chord1 = r1[j];\r\n\t\t\t\tvar r2 = function_list[f2](chord.slice(0, f2+3), true, true, true);\r\n\t\t\t\tfor(var l = 0; l < r2.length; l++) {\r\n\t\t\t\t\tvar chord2 = r2[l];\r\n\t\t\t\t\tpolychords.push(chord1 + '|' + chord2);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif(shorthand) {\r\n\t\tfor(var i = 0; i < polychords.length; i++) {\r\n\t\t\tvar p = polychords[i];\r\n\t\t\tp = p + \" polychord\";\r\n\t\t};\r\n\t}\r\n\r\n\treturn polychords;\r\n}\r\n\r\nchord_shorthand = {\r\n\t\t// Triads\r\n\t\t\"m\" : minor_triad,\r\n\t\t\"M\" : major_triad, \r\n\t\t\"\" : major_triad,\r\n\t\t\"dim\" : diminished_triad,\r\n\r\n\t\t// Augmented chords\r\n\t\t\"aug\" : augmented_triad,\r\n\t\t\"+\" : augmented_triad,\r\n\t\t\"7#5\" : augmented_minor_seventh,\r\n\t\t\"M7+5\" : augmented_minor_seventh,\r\n\t\t\"M7+\" : augmented_major_seventh,\r\n\t\t\"m7+\" : augmented_minor_seventh,\r\n\t\t\"7+\" : augmented_major_seventh,\r\n\r\n\t\t// Suspended chords\r\n\t\t\"sus47\" : suspended_seventh,\r\n\t\t\"sus4\" : suspended_fourth_triad,\r\n\t\t\"sus2\" : suspended_second_triad,\r\n\t\t\"sus\" : suspended_triad,\r\n\t\t\"11\" : eleventh,\r\n\t\t\"sus4b9\" : suspended_fourth_ninth,\r\n\t\t\"susb9\" : suspended_fourth_ninth,\r\n\r\n\t\t// Sevenths\r\n\t\t\"m7\" : minor_seventh,\r\n\t\t\"M7\" : major_seventh,\r\n\t\t\"7\" : dominant_seventh,\r\n\t\t\"dom7\" : dominant_seventh,\r\n\t\t\"m7b5\" : minor_seventh_flat_five,\r\n\t\t\"dim7\" : diminished_seventh,\r\n\t\t\"m/M7\" : minor_major_seventh,\r\n\t\t\"mM7\" : minor_major_seventh,\r\n\t\t\r\n\t\t\r\n\t\t// Sixths\r\n\t\t\"m6\" : minor_sixth,\r\n\t\t\"M6\" : major_sixth,\r\n\t\t\"6\" : major_sixth, \r\n\t\t\"6/7\" : dominant_sixth,\r\n\t\t\"67\": dominant_sixth,\r\n\t\t\"6/9\" : sixth_ninth,\r\n\t\t\"69\" : sixth_ninth,\r\n\r\n\t\t// Ninths\r\n\t\t\"9\" : dominant_ninth,\r\n\t\t\"7b9\" : dominant_flat_ninth,\r\n\t\t\"7#9\" : dominant_sharp_ninth,\r\n\t\t\"M9\" : major_ninth,\r\n\t\t\"m9\" : minor_ninth,\r\n\r\n\t\t// Elevenths\r\n\t\t\"7#11\" : lydian_dominant_seventh,\r\n\t\t\"m11\" : minor_eleventh,\r\n\r\n\t\t// Thirteenths\r\n\t\t\"M13\" : major_thirteenth,\r\n\t\t\"m13\" : minor_thirteenth,\r\n\r\n\t\t\"13\" : dominant_thirteenth,\r\n\r\n\t\t// Altered Chords\r\n\t\t\"7b5\" : dominant_flat_five,\r\n\t\t\r\n\t\t// Special\r\n\t\t\"hendrix\" : hendrix_chord,\r\n\t\t\"7b12\" : hendrix_chord,\r\n\t\t\"5\" : function(x) {\r\n\t\t\treturn [x, intervals.perfect_fifth(x)];\r\n\t\t}\r\n}\r\n//export\r\nexports._triads_cache = _triads_cache;\r\nexports._sevenths_cache = _sevenths_cache;\r\nexports.chord_shorthand_meaning = chord_shorthand_meaning;\r\nexports.triad = triad;\r\nexports.triads = triads;\r\nexports.major_triad = major_triad;\r\nexports.minor_triad = minor_triad;\r\nexports.diminished_triad = diminished_triad;\r\nexports.augmented_triad = augmented_triad;\r\nexports.major_seventh = major_seventh;\r\nexports.minor_seventh = minor_seventh;\r\nexports.dominant_seventh = dominant_seventh;\r\nexports.half_diminished_seventh = half_diminished_seventh;\r\nexports.minor_seventh_flat_five = minor_seventh_flat_five;\r\nexports.diminished_seventh = diminished_seventh;\r\nexports.minor_major_seventh = minor_major_seventh;\r\nexports.minor_sixth = minor_sixth;\r\nexports.major_sixth = major_sixth;\r\nexports.dominant_sixth = dominant_sixth;\r\nexports.sixth_ninth = sixth_ninth;\r\nexports.minor_ninth = minor_ninth;\r\nexports.major_ninth = major_ninth;\r\nexports.dominant_ninth = dominant_ninth;\r\nexports.dominant_flat_ninth = dominant_flat_ninth\r\nexports.dominant_sharp_ninth = dominant_sharp_ninth;\r\nexports.eleventh = eleventh;\r\nexports.minor_eleventh = minor_eleventh;\r\nexports.minor_thirteenth = minor_thirteenth;\r\nexports.major_thirteenth = major_thirteenth;\r\nexports.dominant_thirteenth = dominant_thirteenth;\r\nexports.suspended_triad = suspended_triad;\r\nexports.suspended_second_triad = suspended_second_triad;\r\nexports.suspended_fourth_triad = suspended_fourth_triad;\r\nexports.suspended_seventh = suspended_seventh;\r\nexports.suspended_fourth_ninth = suspended_fourth_ninth;\r\nexports.augmented_major_seventh = augmented_major_seventh;\r\nexports.augmented_minor_seventh = augmented_minor_seventh;\r\nexports.dominant_flat_five = dominant_flat_five;\r\nexports.lydian_dominant_seventh = lydian_dominant_seventh;\r\nexports.hendrix_chord = hendrix_chord;\r\nexports.tonic = tonic;\r\nexports.tonic7 = tonic7;\r\nexports.supertonic = supertonic;\r\nexports.supertonic7 = supertonic7;\r\nexports.mediant = mediant;\r\nexports.mediant7 = mediant7;\r\nexports.subdominant = subdominant;\r\nexports.subdominant7 = subdominant7;\r\nexports.dominant = dominant;\r\nexports.dominant7 = dominant7;\r\nexports.submediant = submediant;\r\nexports.subdominant7 = subdominant7;\r\nexports.subtonic = subtonic;\r\nexports.subtonic7 = subtonic7;\r\nexports.I = I;\r\nexports.I7 = I7;\r\nexports.ii = ii;\r\nexports.II = II;\r\nexports.ii7 = ii7;\r\nexports.II7 = II7;\r\nexports.iii = iii;\r\nexports.III = III;\r\nexports.iii7 = iii7;\r\nexports.III7 = III7;\r\nexports.IV = IV;\r\nexports.IV7 = IV7;\r\nexports.V = V;\r\nexports.V7 = V7;\r\nexports.vi = vi;\r\nexports.VI = VI;\r\nexports.vi7 = vi7;\r\nexports.VI7 = VI7;\r\nexports.vii = vii;\r\nexports.VII = VII;\r\nexports.vii7 = vii7;\r\nexports.VII7 = VII7;\r\nexports.invert = invert;\r\nexports.first_inversion = first_inversion;\r\nexports.second_inversion = second_inversion;\r\nexports.third_inversion = third_inversion;\r\nexports.from_shorthand = from_shorthand;\r\nexports.chord_shorthand = chord_shorthand;\r\nexports.determine = determine;\r\nexports.determine_triad = determine_triad;\r\nexports.determine_seventh = determine_seventh;\r\nexports.determine_extended_chord5 = determine_extended_chord5;\r\nexports.determine_extended_chord6 = determine_extended_chord6;\r\nexports.determine_extended_chord7 = determine_extended_chord7;\r\nexports.determine_polychords = determine_polychords;","var notes = require('./notes.js'),\r\n\t_ = require('../node_modules/underscore');\r\n\r\nbasic_keys = [\"Gb\", \"Db\", \"Ab\", \"Eb\", \"Bb\", \"F\", \"C\", \"G\", \"D\", \"A\", \"E\", \"B\", \"F#\", \"C#\", \"G#\", \"D#\", \"A#\"];\r\n\r\n_key_cache = {};\r\n\r\nfunction get_notes(key) {\r\n\t//check cache\r\n\tvar key_dict;\r\n\tif(_key_cache.hasOwnProperty(key)) {\r\n\t\treturn _key_cache[key];\r\n\t} else if (!notes.is_valid_note(key)) {\r\n\t\tthrow \"NoteFormatError: Unrecognised format for key '\" + key + \"'\";\r\n\t}\r\n\r\n\tvar fifth_index = notes.fifths.indexOf(key[0]);\r\n\r\n\tvar result = [];\r\n\r\n\t// fifth_index = 0 is a special case. It's the key of F and needs \r\n\t// Bb instead of B included in the result.\r\n\tif(fifth_index != 0) {\r\n\t\tvar x, _i, _j, _len, _len1, _ref, _ref1;\r\n\t\tresult.push(notes.fifths[(fifth_index - 1) % 7] + key.slice(1, key.length));\r\n\t\t_ref = notes.fifths.slice(fifth_index, notes.fifths.length);\r\n\t\tfor (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n\t\t\tx = _ref[_i];\r\n\t\t\tresult.push(x + key.slice(1, key.length));\r\n\t\t}\r\n\t\t_ref1 = notes.fifths.slice(0, fifth_index - 1);\r\n\t\tfor (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {\r\n\t\t\tx = _ref1[_j];\r\n\t\t\tresult.push(x + key.slice(1, key.length) + \"#\");\r\n\t\t}\r\n\t} else {\r\n\t\tvar x, _i, _len, _ref;\r\n\t\t_ref = notes.fifths.slice(0, 6);\r\n\t\tfor (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n\t\t\tx = _ref[_i];\r\n\t\t\tresult.push(x + key.slice(1, key.length));\r\n\t\t}\r\n\t\tresult.push(\"Bb\" + key.slice(1, key.length))\r\n\t}\r\n\r\n\tresult.sort();\r\n\r\n\t// Remove redundant #'s and b's from the result\r\n\tresult = result.map(notes.remove_redundant_accidentals);\r\n\ttonic = result.indexOf(notes.remove_redundant_accidentals(key))\r\n\r\n\tvar el, pre_result, _i, _len;\r\n\tpre_result = result.slice(0, tonic);\r\n\tresult = result.slice(tonic, result.length);\r\n\tfor (_i = 0, _len = pre_result.length; _i < _len; _i++) {\r\n\t\tel = pre_result[_i];\r\n\t\tresult.push(el);\r\n\t}\r\n\r\n\t// Save result to cache\r\n\t_key_cache[key] = result;\r\n\treturn result;\r\n}\r\n\r\nfunction int_to_note(note_int, key) {\r\n\tif(!_.range(0,12).hasObject(note_int)) {\r\n\t\tthrow \"RangeError: Integer not in range 0-11.\";\r\n\t}\r\n\r\n\tvar intervals = [0, 2, 4, 5, 7, 9, 11];\r\n\r\n\tvar current = notes.note_to_int(key);\r\n\tvar known_intervals = intervals.map(function(x){\r\n\t\t(x + current) % 12;\r\n\t});\r\n\r\n\tknown_notes = get_notes(key)\r\n\tvar _ref, _ref1,\r\n\t__indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\r\n\r\n\tif(__indexOf.call(known_intervals, note_int) >= 0) {\r\n\t\treturn known_notes[known_intervals.index(note_int)];\r\n\t} else {\r\n\t\tif(_ref = note_int - 1, __indexOf.call(known_intervals, _ref) >= 0) {\r\n\t\t\treturn notes.remove_redundant_accidentals(known_notes[known_intervals.indexOf(note_int - 1)] + \"#\");\r\n\t\t} else if (_ref1 = note_int + 1, __indexOf.call(known_intervals, _ref1) >= 0) {\r\n\t\t\treturn notes.remove_redundant_accidentals(known_notes[known_intervals.indexOf(note_int + 1)] + \"b\");\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction interval(key, start_note, interval) {\r\n\tif(!notes.is_valid_note(start_note)) {\r\n\t\tthrow \"KeyError: The start note '\" + start_note + \"' is not a valid note\";\r\n\t}\r\n\r\n\tnotes_in_key = get_notes(key);\r\n\r\n\tvar index, n, _i, _len;\r\n\r\n\tfor (_i = 0, _len = notes_in_key.length; _i < _len; _i++) {\r\n\t\tn = notes_in_key[_i];\r\n\t\tif(n[0] === start_note[0]) {\r\n\t\t\tindex = notes_in_key.indexOf(n);\r\n\t\t}\r\n\t}\r\n\treturn notes_in_key[(index + interval) % 7];\r\n}\r\n\r\n//export\r\nexports.basic_keys = basic_keys;\r\nexports._key_cache = _key_cache;\r\nexports.get_notes = get_notes;\r\nexports.int_to_note = int_to_note;\r\nexports.interval = interval;","exports.diatonic = require('./diatonic.js');\r\nexports.notes = require('./notes.js');\r\nexports.intervals = require('./intervals.js');\r\nexports.chords = require('./chords.js');\r\nexports.scales = require('./scales.js');\r\nexports.meter = require('./meter.js');","var notes = require('./notes.js'),\r\n\tdiatonic = require('./diatonic.js');\r\n\t_ = require('../node_modules/underscore');\r\n\r\nfunction unison(note) {\r\n\treturn note\r\n}\r\n\r\n// Diatonic intervals.\r\n// Needs a note and a key.\r\n\r\nfunction second(note, key) {\r\n\treturn diatonic.interval(key, note, 1);\r\n}\r\n\r\nfunction third(note, key) {\r\n\treturn diatonic.interval(key, note, 2);\r\n}\r\n\r\nfunction fourth(note, key) {\r\n\treturn diatonic.interval(key, note, 3);\r\n}\r\n\r\nfunction fifth(note, key) {\r\n\treturn diatonic.interval(key, note, 4);\r\n}\r\n\r\nfunction sixth(note, key) {\r\n\treturn diatonic.interval(key, note, 5);\r\n}\r\n\r\nfunction seventh(note, key) {\r\n\treturn diatonic.interval(key, note, 6);\r\n}\r\n\r\n// Absolute intervals\r\n// Needs a note\r\n\r\nfunction minor_unison(note) {\r\n\treturn notes.diminish(note);\r\n}\r\n\r\nfunction major_unison(note) {\r\n\treturn note;\r\n}\r\n\r\nfunction augmented_unison(note) {\r\n\treturn notes.augment(note);\r\n}\r\n\r\nfunction minor_second(note) {\r\n\tsec = second(note[0], 'C');\r\n\treturn augment_or_diminish_until_the_interval_is_right(note, sec, 1);\r\n}\r\n\r\nfunction major_second(note) {\r\n\tsec = second(note[0], 'C');\r\n\treturn augment_or_diminish_until_the_interval_is_right(note, sec, 2);\r\n}\r\n\r\nfunction minor_third(note) {\r\n\ttrd = third(note[0], 'C');\r\n\treturn augment_or_diminish_until_the_interval_is_right(note, trd, 3);\r\n}\r\nfunction major_third(note) {\r\n\ttrd = third(note[0], 'C');\r\n\treturn augment_or_diminish_until_the_interval_is_right(note, trd, 4);\r\n}\r\nfunction minor_fourth(note) {\r\n\tfrt = fourth(note[0], 'C');\r\n\treturn augment_or_diminish_until_the_interval_is_right(note, frt, 4);\r\n}\r\n\r\nfunction major_fourth(note) {\r\n\tfrt = fourth(note[0], 'C');\r\n\treturn augment_or_diminish_until_the_interval_is_right(note, frt, 5);\r\n}\r\n\r\nfunction perfect_fourth(note) {\r\n\treturn major_fourth(note);\r\n}\r\n\r\nfunction minor_fifth(note) {\r\n\tfif = fifth(note[0], 'C');\r\n\treturn augment_or_diminish_until_the_interval_is_right(note, fif, 6);\r\n}\r\n\r\nfunction major_fifth(note) {\r\n\tfif = fifth(note[0], 'C');\r\n\treturn augment_or_diminish_until_the_interval_is_right(note, fif, 7);\r\n}\r\n\r\nfunction perfect_fifth(note) {\r\n\treturn major_fifth(note);\r\n}\r\n\r\nfunction minor_sixth(note) {\r\n\tsth = sixth(note[0], 'C');\r\n\treturn augment_or_diminish_until_the_interval_is_right(note, sth, 8);\r\n}\r\n\r\nfunction major_sixth(note) {\r\n\tsth = sixth(note[0], 'C');\r\n\treturn augment_or_diminish_until_the_interval_is_right(note, sth, 9);\r\n}\r\n\r\nfunction minor_seventh(note) {\r\n\tsth = seventh(note[0], 'C');\r\n\treturn augment_or_diminish_until_the_interval_is_right(note, sth, 10);\r\n}\r\n\r\nfunction major_seventh(note) {\r\n\tsth = seventh(note[0], 'C');\r\n\treturn augment_or_diminish_until_the_interval_is_right(note, sth, 11);\r\n}\r\n\r\nfunction get_interval(note, interval, key) {\r\n\t if (key == null) {\r\n\t\tkey = 'C';\r\n\t}\r\n\tintervals = [0, 2, 4, 5, 7, 9, 11].map(function(x) {\r\n\t\treturn (notes.note_to_int(key) + x) % 12;\r\n\t});\r\n\tkey_notes = diatonic.get_notes(key);\r\n\r\n\tvar result, x, _i, _len;\r\n\tfor (_i = 0, _len = key_notes.length; _i < _len; _i++) {\r\n\tx = key_notes[_i];\r\n\t\tif (x[0] === note[0]) {\r\n\t\t\tresult = (intervals[key_notes.indexOf(x)] + interval) % 12;\r\n\t\t}\r\n\t}\r\n\r\n\tvar __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\r\n\r\n\tif (__indexOf.call(intervals, result) >= 0) {\r\n\t\treturn key_notes[intervals.indexOf(result)] + note.slice(1, note.length);\r\n\t} else {\r\n\t\treturn notes.diminish(key_notes[intervals.indexOf((result + 1) % 12)] + note.slice(1, note.length));\r\n\t}\r\n}\r\n\r\nfunction measure(note1, note2) {\r\n\tres = notes.note_to_int(note2) - notes.note_to_int(note1);\r\n\tif(res < 0) {\r\n\t\treturn 12 - (res * (-1));\r\n\t} else {\r\n\t\treturn res;\r\n\t}\r\n}\r\n\r\nfunction augment_or_diminish_until_the_interval_is_right(note1, note2, interval) {\r\n\tvar cur, note2;\r\n\r\n\tcur = measure(note1, note2);\r\n\r\n\twhile(cur !== interval) {\r\n\t\tif (cur > interval) {\r\n\t\t\tnote2 = notes.diminish(note2);\r\n\t\t} else if (cur < interval) {\r\n\t\t\tnote2 = notes.augment(note2);\r\n\t\t}\r\n\t\tcur = measure(note1, note2);\r\n\t}\r\n\r\n\t// We are practically done right now, but we need to be able to create\r\n\t// the minor seventh of Cb and get Bbb instead of B######### as the result\r\n\tvar token, val, _i, _len, _ref;\r\n\r\n\tval = 0;\r\n\r\n\t_ref = note2.slice(1, note2.length);\r\n\tfor(_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n\t\ttoken = _ref[_i];\r\n\t\tif (token === '#') {\r\n\t\t\tval += 1;\r\n\t\t} else if (token === 'b') {\r\n\t\t\tval -= 1;\r\n\t\t}\r\n\t}\r\n\r\n\t// These are some checks to see if we have generated too much #'s\r\n\t// or too much b's. In these cases we need to convert #'s to b's\r\n\t// and vice versa. \r\n\t\r\n\tif (val > 6) {\r\n\t\tval = val % 12;\r\n\t\tval = -12 + val;\r\n\t} else if (val < -6) {\r\n\t\tval = val % -12;\r\n\t\tval = 12 + val;\r\n\t}\r\n\r\n\t// Rebuild the note\r\n\tresult = note2[0]\r\n\r\n\twhile (val > 0) {\r\n\t\tresult = notes.augment(result);\r\n\t\tval -= 1;\r\n\t}\r\n\r\n\twhile (val < 0) {\r\n\t\tresult = notes.diminish(result);\r\n\t\tval += 1;\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\nfunction invert(interval) {\r\n\tres = interval.reverse();\r\n\treturn res;\r\n}\r\n\r\nfunction determine(note1, note2, shorthand) {\r\n\tif (shorthand == null) {\r\n\t\tshorthand = false;\r\n\t}\r\n\t// Corner case for unisons ('A' and 'Ab', for instance)\r\n\tvar get_val, x, y;\r\n\tif (note1[0] === note2[0]) {\r\n\t\tget_val = function(note) {\r\n\t\t\t//Private function to count the value of accidentals\r\n\t\t\tvar r, x, _i, _len, _ref;\r\n\t\t\tr = 0;\r\n\t\t\t_ref = note.slice(1, note.length);\r\n\t\t\tfor (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n\t\t\t\tx = _ref[_i];\r\n\t\t\t\tif (x === 'b') {\r\n\t\t\t\t\tr -= 1;\r\n\t\t\t\t} else if (x === '#') {\r\n\t\t\t\t\tr += 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn r;\r\n\t\t};\r\n\t\tx = get_val(note1);\r\n\t\ty = get_val(note2);\r\n\t\tif (x === y) {\r\n\t\t\tif (!shorthand) {\r\n\t\t\t\treturn \"major unison\";\r\n\t\t\t}\r\n\t\t\treturn \"1\";\r\n\t\t} else if (x < y) {\r\n\t\t\tif (!shorthand) {\r\n\t\t\t\treturn \"augmented unison\";\r\n\t\t\t}\r\n\t\t\treturn \"#1\";\r\n\t\t} else if (x - y === 1) {\r\n\t\t\tif (!shorthand) {\r\n\t\t\t\treturn \"minor unison\";\r\n\t\t\t}\r\n\t\t\treturn \"b1\";\r\n\t\t} else {\r\n\t\t\tif (!shorthand) {\r\n\t\t\t\treturn \"diminished unison\";\r\n\t\t\t}\r\n\t\t\treturn \"bb1\";\r\n\t\t}\r\n\t}\r\n\r\n\t// Other intervals\r\n\tn1 = notes.fifths.indexOf(note1[0]);\r\n\tn2 = notes.fifths.indexOf(note2[0]);\r\n\r\n\tnumber_of_fifth_steps = n2 - n1;\r\n\r\n\tif(n2 < n1) {\r\n\t\tnumber_of_fifth_steps = notes.fifths.length - n1 + n2;\r\n\t}\r\n\t// [name, shorthand_name, half notes for major version of this interval]\r\n\tfifth_steps = [\r\n\t\t[\"unison\", \"1\", 0],\r\n\t\t[\"fifth\", \"5\", 7],\r\n\t\t[\"second\", \"2\", 2],\r\n\t\t[\"sixth\", \"6\", 9],\r\n\t\t[\"third\", \"3\", 4],\r\n\t\t[\"seventh\", \"7\", 11],\r\n\t\t[\"fourth\", \"4\", 5]\r\n\t];\r\n\r\n\t// Count half steps between note1 and note2\r\n\thalf_notes = measure(note1, note2);\r\n\t// Get the proper list from the number of fifth steps\r\n\tcurrent = fifth_steps[number_of_fifth_steps];\r\n\r\n\t// maj = number of major steps for this interval\r\n\tmaj = current[2];\r\n\r\n\t// if maj is equal to the half steps between note1 and note2\r\n\t// the interval is major or perfect\r\n\tif(maj == half_notes) {\r\n\t\t// Corner cases for perfect fifths and fourths\r\n\t\tif(current[0] == \"fifth\") {\r\n\t\t\tif(!shorthand) {\r\n\t\t\t\treturn \"perfect fifth\";\r\n\t\t\t}\r\n\t\t} else if(current[0] == \"fourth\") {\r\n\t\t\tif(!shorthand) {\r\n\t\t\t\treturn \"perfect fourth\";\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(!shorthand) {\r\n\t\t\treturn \"major \" + current[0];\r\n\t\t}\r\n\t\treturn current[1];\r\n\t} else if(maj + 1 <= half_notes) {\r\n\t // if maj + 1 is equal to half_notes, the interval is augmented.\r\n\t\tif(!shorthand) {\r\n\t\t\treturn \"augmented \" + current[0];\r\n\t\t}\r\n\t\treturn \"#\" * (half_notes - maj) + current[1];\r\n\r\n\t// etc.\r\n\t} else if(maj - 1 == half_notes) {\r\n\t\tif(!shorthand) {\r\n\t\t\treturn \"minor \" + current[0];\r\n\t\t}\r\n\t\treturn \"b\" + current[1];\r\n\r\n\t} else if(maj - 2 >= half_notes) {\r\n\t\tif(!shorthand) {\r\n\t\t\treturn \"diminished \" + current[0];\r\n\t\t}\r\n\t\treturn \"b\" * (maj - half_notes) + current[1];\r\n\t}\r\n}\r\n\r\nfunction from_shorthand(note, interval, up) {\r\n\tif (up == null) {\r\n\t\tup = true;\r\n\t}\r\n\r\n\t//warning should be a valid note.\r\n\tif(!notes.is_valid_note(note)) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// [shorthand, interval function up, interval function down]\r\n\tshorthand_lookup = [\r\n\t\t[\"1\", major_unison, major_unison],\r\n\t\t[\"2\", major_second, minor_seventh],\r\n\t\t[\"3\", major_third, minor_sixth],\r\n\t\t[\"4\", major_fourth, major_fifth],\r\n\t\t[\"5\", major_fifth, major_fourth],\r\n\t\t[\"6\", major_sixth, minor_third],\r\n\t\t[\"7\", major_seventh, minor_second]\r\n\t];\r\n\r\n\t// Looking up last character in interval in shorthand_lookup\r\n\t// and calling that function.\r\n\tval = false;\r\n\tvar shorthand, _i, _len;\r\n\tfor (_i = 0, _len = shorthand_lookup.length; _i < _len; _i++) {\r\n\t\tshorthand = shorthand_lookup[_i];\r\n\t\tif (shorthand[0] === interval[interval.length-1]) {\r\n\t\t\tif (up) {\r\n\t\t\t\tval = shorthand[1](note);\r\n\t\t\t} else {\r\n\t\t\t\tval = shorthand[2](note);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t// warning Last character in interval should be 1-7\r\n\tif(val == false) {\r\n\t\treturn false;\r\n\t}\r\n\t// Collect accidentals\r\n\tvar x, _i, _len;\r\n\r\n\tfor (_i = 0, _len = interval.length; _i < _len; _i++) {\r\n\t\tx = interval[_i];\r\n\t\tif (x === \"#\") {\r\n\t\t\tif (up) {\r\n\t\t\t\tval = notes.augment(val);\r\n\t\t\t} else {\r\n\t\t\t\tval = notes.diminish(val);\r\n\t\t\t}\r\n\t\t} else if (x === \"b\") {\r\n\t\t\tif (up) {\r\n\t\t\t\tval = notes.diminish(val);\r\n\t\t\t} else {\r\n\t\t\t\tval = notes.augment(val);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn val;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction is_consonant(note1, note2, include_fourths) {\r\n\tif (include_fourths == null) {\r\n\t\tinclude_fourths = true;\r\n\t}\r\n\treturn is_perfect_consonant(note1, note2, include_fourths) || is_imperfect_consonant(note1, note2);\r\n}\r\n\r\nfunction is_perfect_consonant(note1, note2, include_fourths) {\r\n\tif (include_fourths == null) {\r\n\t\tinclude_fourths = true;\r\n\t}\r\n\tdhalf = measure(note1, note2);\r\n\treturn (dhalf === 0 || dhalf === 7) || (include_fourths && dhalf === 5);\r\n}\r\nfunction is_imperfect_consonant(note1, note2) {\r\n\tvar _ref;\r\n\treturn (_ref = measure(note1, note2)) === 3 || _ref === 4 || _ref === 8 || _ref === 9;\r\n}\r\n\r\nfunction is_dissonant(note1, note2, include_fourths) {\r\n\tif(include_fourths == null) {\r\n\t\tinclude_fourths = false;\r\n\t}\r\n    return !(is_consonant(note1, note2, !include_fourths));\r\n}\r\n//export\r\nexports.unison = unison;\r\nexports.second = second;\r\nexports.third = third;\r\nexports.fourth = fourth;\r\nexports.fifth = fifth;\r\nexports.sixth = sixth;\r\nexports.seventh = seventh;\r\nexports.minor_unison = minor_unison;\r\nexports.major_unison = major_unison;\r\nexports.augmented_unison = augmented_unison;\r\nexports.minor_second = minor_second;\r\nexports.major_second = major_second;\r\nexports.minor_third = minor_third;\r\nexports.major_third = major_third;\r\nexports.minor_fourth = minor_fourth;\r\nexports.major_fourth = major_fourth;\r\nexports.perfect_fourth =perfect_fourth;\r\nexports.minor_fifth = minor_fifth;\r\nexports.major_fifth = major_fifth;\r\nexports.perfect_fifth =perfect_fifth;\r\nexports.minor_sixth = minor_sixth;\r\nexports.major_sixth = major_sixth;\r\nexports.minor_seventh = minor_seventh;\r\nexports.major_seventh = major_seventh;\r\nexports.get_interval = get_interval;\r\nexports.measure = measure;\r\nexports.augment_or_diminish_until_the_interval_is_right = augment_or_diminish_until_the_interval_is_right;\r\nexports.invert = invert;\r\nexports.determine = determine;\r\nexports.from_shorthand = from_shorthand;\r\nexports.is_consonant = is_consonant;\r\nexports.is_dissonant = is_dissonant;\r\nexports.is_perfect_consonant = is_perfect_consonant;\r\nexports.is_imperfect_consonant = is_imperfect_consonant;","common_time = (4, 4);\r\ncut_time = (2, 2);\r\n\r\nfunction valid_beat_duration(duration) {\r\n\tif(duration == 0) {\r\n\t\treturn false;\r\n\t} else if(duration == 1) {\r\n\t\treturn true;\r\n\t} else {\r\n\t\tr = duration;\r\n\t\twhile(r != 1) {\r\n\t\t\tif(r % 2 == 1) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tr /= 2;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nfunction is_valid(meter) {\r\n\treturn meter[0] > 0 && valid_beat_duration(meter[1]);\r\n}\r\n\r\nfunction is_compound(meter) {\r\n\treturn is_valid(meter) && meter[0] % 3 == 0;\r\n}\r\n\r\nfunction is_simple(meter) {\r\n\treturn is_valid(meter);\r\n}\r\n\r\nfunction is_asymmetrical(meter) {\r\n\treturn is_valid(meter) && meter[0] % 2 == 1;\r\n}\r\n//export\r\nexports.valid_beat_duration = valid_beat_duration;\r\nexports.is_valid = is_valid;\r\nexports.is_compound = is_compound;\r\nexports.is_asymmetrical = is_asymmetrical;\r\nexports.is_simple = is_simple;","var intervals = require('./intervals.js'),\r\n\t_ = require('../node_modules/underscore');\r\n\r\n_note_dict = {\r\n\t'C' : 0, \r\n\t'D' : 2,\r\n\t'E' : 4,\r\n\t'F' : 5, \r\n\t'G' : 7,\r\n\t'A' : 9,\r\n\t'B' : 11 \r\n};\r\n\r\nfifths = ['F', 'C', 'G', 'D', 'A', 'E', 'B'];\r\n\r\n//Find object in array function\r\nArray.prototype.hasObject = (\r\n\t!Array.indexOf ? function (o) {\r\n\t\tvar l = this.length + 1;\r\n\t\twhile (l -= 1){\r\n\t\t\tif (this[l - 1] === o) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t} : function (o) {\r\n\t\treturn (this.indexOf(o) !== -1);\r\n\t}\r\n);\r\n\r\nfunction int_to_note(note_int) {\r\n\tif(!_.range(0,12).hasObject(note_int)) {\r\n\t\tthrow \"RangeError: int out of bounds (0-11):\" + note_int;\r\n\t}\r\n\tn = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\r\n\treturn n[note_int];\r\n}\r\n\r\n\r\nfunction is_enharmonic(note1, note2) {\r\n\treturn note_to_int(note1) == note_to_int(note2);\r\n}\r\n\r\nfunction is_valid_note(note) {\r\n\tif(!_note_dict.hasOwnProperty(note[0])) {\r\n\t\treturn false;\r\n\t}\r\n\tvar post, _i, _len, _ref;\r\n\t_ref = note.slice(1, note.length);\r\n\tfor(_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n\t\tpost = _ref[_i];\r\n\t\tif (post !== 'b' && post !== '#') {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction note_to_int(note) {\r\n\tif(is_valid_note(note)) {\r\n\t\tval = _note_dict[note[0]];\r\n\t} else {\r\n\t\tthrow \"NoteFormatError: Unknown note format '\" + note + \"'\";\r\n\t}\r\n\t// Check for '#' and 'b' postfixes\r\n\tvar post, _i, _len, _ref;\r\n\t_ref = note.slice(1, note.length);\r\n\tfor(_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n\t\tpost = _ref[_i];\r\n\t\tif (post === 'b') {\r\n\t\t\tval -= 1;\r\n\t\t} else if (post === '#') {\r\n\t\t\tval += 1;\r\n\t\t}\r\n\t}\r\n\treturn val % 12;\r\n}\r\n\r\nfunction remove_redundant_accidentals(note) {\r\n\tvar result, token, val, _i, _len, _ref;\r\n\tval = 0;\r\n\t_ref = note.slice(1, note.length);\r\n\tfor (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n\t\ttoken = _ref[_i];\r\n\t\tif (token === 'b') {\r\n\t\t\tval -= 1;\r\n\t\t} else if (token === '#') {\r\n\t\t\tval += 1;\r\n\t\t}\r\n\t}\r\n\t\r\n\tresult = note[0];\r\n\twhile (val > 0) {\r\n\t\tresult = augment(result);\r\n\t\tval -= 1;\r\n\t}\r\n\r\n\twhile (val < 0) {\r\n\t\tresult = diminish(result);\r\n\t\tval += 1;\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\nfunction augment(note) {\r\n\tif(note[note.length-1] != 'b') {\r\n\t\treturn note + '#';\r\n\t} else {\r\n\t\treturn note.slice(0, note.length-1);\r\n\t}\r\n}\r\n\r\nfunction diminish(note) {\r\n\tif(note[note.length-1] != '#') {\r\n\t\treturn note + 'b';\r\n\t} else {\r\n\t\treturn note.slice(0, note.length-1);\r\n\t}\r\n}\r\n\r\nfunction to_major(note) {\r\n\treturn intervals.minor_third(note);\r\n}\r\n\r\nfunction to_minor(note) {\r\n\treturn intervals.major_sixth(note);\r\n}\r\n\r\n//export\r\nexports._note_dict = _note_dict;\r\nexports.fifths = fifths;\r\nexports.int_to_note = int_to_note;\r\nexports.is_enharmonic = is_enharmonic;\r\nexports.is_valid_note = is_valid_note;\r\nexports.note_to_int = note_to_int;\r\nexports.remove_redundant_accidentals = remove_redundant_accidentals;\r\nexports.augment = augment\r\nexports.diminish = diminish;\r\nexports.to_major = to_major;\r\nexports.to_minor = to_minor;","var intervals = require('./intervals.js'),\r\n\tnotes = require('./notes.js'),\r\n\tget_notes = require('./diatonic.js').get_notes,\r\n\t_ = require('../node_modules/underscore');\r\n\r\n// The diatonic scales and its modes\r\n\r\nfunction diatonic(note) {\r\n\treturn get_notes(note);\r\n}\r\n\r\nfunction ionian(note) {\r\n\treturn diatonic(note);\r\n}\r\n\r\nfunction dorian(note) {\r\n\tvar i = ionian(intervals.minor_seventh(note));\r\n\tvar arr = i.slice(1, i.length);\r\n\tarr.push(i[0]);\r\n\treturn arr;\r\n}\r\n\r\nfunction phrygian(note) {\r\n\tvar i = ionian(intervals.minor_sixth(note));\r\n\tvar arr = i.slice(2, i.length);\r\n\tfor (var k = 0; k < 2; k++) {\r\n\t\tarr.push(i[k]);\r\n\t};\r\n\treturn arr;\r\n}\r\n\r\nfunction lydian(note) {\r\n\tvar i = ionian(intervals.perfect_fifth(note))\r\n\tvar arr = i.slice(3, i.length);\r\n\tfor (var k = 0; k < 3; k++) {\r\n\t\tarr.push(i[k]);\r\n\t};\r\n\treturn arr;\r\n}\r\n\r\nfunction mixolydian(note) {\r\n\tvar i = ionian(intervals.perfect_fourth(note))\r\n\tvar arr = i.slice(4, i.length);\r\n\tfor (var k = 0; k < 4; k++) {\r\n\t\tarr.push(i[k]);\r\n\t};\r\n\treturn arr;\r\n}\r\n\r\nfunction aeolian(note) {\r\n\tvar i = ionian(intervals.minor_third(note))\r\n\tvar arr = i.slice(5, i.length);\r\n\tfor (var k = 0; k < 5; k++) {\r\n\t\tarr.push(i[k]);\r\n\t};\r\n\treturn arr;\r\n}\r\n\r\nfunction locrian(note) {\r\n\tvar i = ionian(intervals.minor_second(note))\r\n\tvar arr = i.slice(6, i.length);\r\n\tfor (var k = 0; k < 6; k++) {\r\n\t\tarr.push(i[k]);\r\n\t};\r\n\treturn arr;\r\n}\r\n\r\n// The minor modes\r\n\r\nfunction natural_minor(note) {\r\n\tvar i = get_notes(notes.to_major(note));\r\n\tvar arr = i.slice(5, i.length);\r\n\tfor (var k = 0; k < 5; k++) {\r\n\t\tarr.push(i[k]);\r\n\t};\r\n\treturn arr;\r\n}\r\n\r\nfunction harmonic_minor(note) {\r\n\tvar nat = natural_minor(note);\r\n\tnat[6] = notes.augment(nat[6]);\r\n\treturn nat;\r\n}\r\n\r\nfunction melodic_minor(note) {\r\n\tvar har = harmonic_minor(note);\r\n\thar[5] = notes.augment(har[5]);\r\n\treturn har;\r\n}\r\n\r\n// Other scales\r\n\r\nfunction chromatic(note) {\r\n\treturn _.range(0,12).map(function(x) {\r\n\t\treturn intervals.get_interval(note, x);\r\n\t});\r\n}\r\n\r\nfunction whole_note(note) {\r\n\tvar n = 0;\r\n\tvar last = note;\r\n\tvar res = [last];\r\n\twhile(n < 5) {\r\n\t\tne = intervals.major_second(last);\r\n\t\tlast = ne;\r\n\t\tres.push(ne);\r\n\t\tn += 1;\r\n\t}\r\n\treturn res\r\n}\r\n\r\nfunction diminished(note) {\r\n\tfunction whole_step_half_step(n) {\r\n\t\tvar res = [intervals.major_second(n), intervals.minor_third(n)];\r\n\t\treturn res;\r\n\t}\r\n\r\n\tvar res = [note];\r\n\tvar n = _.range(3);\r\n\tfor (var k = 0; k < n.length; k++) {\r\n\t\tvar arr = whole_step_half_step(note);\r\n\t\tfor (var i = 0; i < arr.length; i++) {\r\n\t\t\tres.push(arr[i]);\r\n\t\t};\r\n\t\tnote = res[res.length-1];\r\n\t};\r\n\r\n\tres.push(intervals.major_seventh(res[0]));\r\n\tres[res.length-2] = intervals.major_sixth(res[0]);\r\n\treturn res;\r\n}\r\n\r\nfunction determine(scale) {\r\n\tvar possible_result = [\r\n\t\t[\"ionian\",\r\n\t\t\t[\"major second\", \"major third\", \"perfect fourth\", \r\n\t\t\t\"perfect fifth\", \"major sixth\", \"major seventh\"]],\r\n\t\t[\"dorian\", \r\n\t\t\t[\"major second\", \"minor third\", \"perfect fourth\", \r\n\t\t\t\"perfect fifth\", \"major sixth\", \"minor seventh\"]],\r\n\t\t[\"phrygian\",\r\n\t\t\t[\"minor second\", \"minor third\", \"perfect fourth\",\r\n\t\t\t\"perfect fifth\", \"minor sixth\", \"minor seventh\"]],\r\n\t\t[\"lydian\",\r\n\t\t\t[\"major second\", \"major third\", \"major fourth\",\r\n\t\t\t\"perfect fifth\", \"major sixth\", \"major seventh\"]],\r\n\t\t[\"mixolydian\",\r\n\t\t\t[\"major second\", \"major third\", \"perfect fourth\",\r\n\t\t\t\"perfect fifth\", \"major sixth\", \"minor seventh\"]],\r\n\t\t[\"aeolian\",\r\n\t\t\t[\"major second\", \"minor third\", \"perfect fourth\",\r\n\t\t\t\"perfect fifth\", \"minor sixth\", \"minor seventh\"]],\r\n\t\t[\"locrian\",\r\n\t\t\t[\"minor second\", \"minor third\", \"perfect fourth\",\r\n\t\t\t\"minor fifth\", \"minor sixth\", \"minor seventh\"]],\r\n\t\t[\"natural minor\",\r\n\t\t\t[\"major second\", \"minor third\", \"perfect fourth\",\r\n\t\t\t\"perfect fifth\", \"minor sixth\", \"minor seventh\"]],\r\n\t\t[\"harmonic minor\",\r\n\t\t\t[\"major second\", \"minor third\", \"perfect fourth\",\r\n\t\t\t\"perfect fifth\", \"minor sixth\", \"major seventh\"]],\r\n\t\t[\"melodic minor\",\r\n\t\t\t[\"major second\", \"minor third\", \"perfect fourth\",\r\n\t\t\t\"perfect fifth\", \"major sixth\", \"major seventh\"]],\r\n\t];\r\n\r\n\tvar tonic = scale[0];\r\n\tvar n = 0;\r\n\r\n\t// -- Describing the algorithm:\r\n\t// Filter out all the wrong answers in possible_result\r\n\tvar arr = scale.slice(1, scale.length);\r\n\tfor (var i = 0; i < arr.length; i++) {\r\n\t\tvar note = arr[i];\r\n\t\t// 1. Determine the interval\r\n\t\tintval = intervals.determine(tonic, note);\r\n\t\ttemp = [];\r\n\t\t// 2. Go through possible_result and add it to temp if \r\n\t\t// it's a hit, do nothing otherwise\r\n\t\tfor (var k = 0; k < possible_result.length; k++) {\r\n\t\t\tvar x = possible_result[k];\r\n\t\t\tif(x[1][n] == intval) {\r\n\t\t\t\ttemp.push(x);\r\n\t\t\t}\r\n\t\t}\r\n\t\tn += 1;\r\n\r\n\t\t// 3. Set possible_result to temp\r\n\t\tpossible_result = temp;\r\n\t};\r\n\r\n\t// Get the results from possible_result and return\r\n\tvar res = [];\r\n\tfor (var i = 0; i < possible_result.length; i++) {\r\n\t\tvar x = possible_result[i];\r\n\t\tres.push(scale[0] + \" \" + x[0]);\r\n\t};\r\n\treturn res\r\n}\r\n//export\r\nexports.diatonic = diatonic;\r\nexports.ionian = ionian;\r\nexports.dorian = dorian\r\nexports.phrygian = phrygian;\r\nexports.lydian = lydian;\r\nexports.mixolydian = mixolydian;\r\nexports.aeolian = aeolian;\r\nexports.locrian = locrian;\r\nexports.natural_minor = natural_minor;\r\nexports.harmonic_minor = harmonic_minor;\r\nexports.melodic_minor = melodic_minor;\r\nexports.chromatic = chromatic;\r\nexports.whole_note = whole_note;\r\nexports.diminished = diminished;\r\nexports.determine = determine;","//     Underscore.js 1.5.2\n//     http://underscorejs.org\n//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n//     Underscore may be freely distributed under the MIT license.\n\n(function() {\n\n  // Baseline setup\n  // --------------\n\n  // Establish the root object, `window` in the browser, or `exports` on the server.\n  var root = this;\n\n  // Save the previous value of the `_` variable.\n  var previousUnderscore = root._;\n\n  // Establish the object that gets returned to break out of a loop iteration.\n  var breaker = {};\n\n  // Save bytes in the minified (but not gzipped) version:\n  var ArrayProto = Array.prototype, ObjProto = Object.prototype, FuncProto = Function.prototype;\n\n  // Create quick reference variables for speed access to core prototypes.\n  var\n    push             = ArrayProto.push,\n    slice            = ArrayProto.slice,\n    concat           = ArrayProto.concat,\n    toString         = ObjProto.toString,\n    hasOwnProperty   = ObjProto.hasOwnProperty;\n\n  // All **ECMAScript 5** native function implementations that we hope to use\n  // are declared here.\n  var\n    nativeForEach      = ArrayProto.forEach,\n    nativeMap          = ArrayProto.map,\n    nativeReduce       = ArrayProto.reduce,\n    nativeReduceRight  = ArrayProto.reduceRight,\n    nativeFilter       = ArrayProto.filter,\n    nativeEvery        = ArrayProto.every,\n    nativeSome         = ArrayProto.some,\n    nativeIndexOf      = ArrayProto.indexOf,\n    nativeLastIndexOf  = ArrayProto.lastIndexOf,\n    nativeIsArray      = Array.isArray,\n    nativeKeys         = Object.keys,\n    nativeBind         = FuncProto.bind;\n\n  // Create a safe reference to the Underscore object for use below.\n  var _ = function(obj) {\n    if (obj instanceof _) return obj;\n    if (!(this instanceof _)) return new _(obj);\n    this._wrapped = obj;\n  };\n\n  // Export the Underscore object for **Node.js**, with\n  // backwards-compatibility for the old `require()` API. If we're in\n  // the browser, add `_` as a global object via a string identifier,\n  // for Closure Compiler \"advanced\" mode.\n  if (typeof exports !== 'undefined') {\n    if (typeof module !== 'undefined' && module.exports) {\n      exports = module.exports = _;\n    }\n    exports._ = _;\n  } else {\n    root._ = _;\n  }\n\n  // Current version.\n  _.VERSION = '1.5.2';\n\n  // Collection Functions\n  // --------------------\n\n  // The cornerstone, an `each` implementation, aka `forEach`.\n  // Handles objects with the built-in `forEach`, arrays, and raw objects.\n  // Delegates to **ECMAScript 5**'s native `forEach` if available.\n  var each = _.each = _.forEach = function(obj, iterator, context) {\n    if (obj == null) return;\n    if (nativeForEach && obj.forEach === nativeForEach) {\n      obj.forEach(iterator, context);\n    } else if (obj.length === +obj.length) {\n      for (var i = 0, length = obj.length; i < length; i++) {\n        if (iterator.call(context, obj[i], i, obj) === breaker) return;\n      }\n    } else {\n      var keys = _.keys(obj);\n      for (var i = 0, length = keys.length; i < length; i++) {\n        if (iterator.call(context, obj[keys[i]], keys[i], obj) === breaker) return;\n      }\n    }\n  };\n\n  // Return the results of applying the iterator to each element.\n  // Delegates to **ECMAScript 5**'s native `map` if available.\n  _.map = _.collect = function(obj, iterator, context) {\n    var results = [];\n    if (obj == null) return results;\n    if (nativeMap && obj.map === nativeMap) return obj.map(iterator, context);\n    each(obj, function(value, index, list) {\n      results.push(iterator.call(context, value, index, list));\n    });\n    return results;\n  };\n\n  var reduceError = 'Reduce of empty array with no initial value';\n\n  // **Reduce** builds up a single result from a list of values, aka `inject`,\n  // or `foldl`. Delegates to **ECMAScript 5**'s native `reduce` if available.\n  _.reduce = _.foldl = _.inject = function(obj, iterator, memo, context) {\n    var initial = arguments.length > 2;\n    if (obj == null) obj = [];\n    if (nativeReduce && obj.reduce === nativeReduce) {\n      if (context) iterator = _.bind(iterator, context);\n      return initial ? obj.reduce(iterator, memo) : obj.reduce(iterator);\n    }\n    each(obj, function(value, index, list) {\n      if (!initial) {\n        memo = value;\n        initial = true;\n      } else {\n        memo = iterator.call(context, memo, value, index, list);\n      }\n    });\n    if (!initial) throw new TypeError(reduceError);\n    return memo;\n  };\n\n  // The right-associative version of reduce, also known as `foldr`.\n  // Delegates to **ECMAScript 5**'s native `reduceRight` if available.\n  _.reduceRight = _.foldr = function(obj, iterator, memo, context) {\n    var initial = arguments.length > 2;\n    if (obj == null) obj = [];\n    if (nativeReduceRight && obj.reduceRight === nativeReduceRight) {\n      if (context) iterator = _.bind(iterator, context);\n      return initial ? obj.reduceRight(iterator, memo) : obj.reduceRight(iterator);\n    }\n    var length = obj.length;\n    if (length !== +length) {\n      var keys = _.keys(obj);\n      length = keys.length;\n    }\n    each(obj, function(value, index, list) {\n      index = keys ? keys[--length] : --length;\n      if (!initial) {\n        memo = obj[index];\n        initial = true;\n      } else {\n        memo = iterator.call(context, memo, obj[index], index, list);\n      }\n    });\n    if (!initial) throw new TypeError(reduceError);\n    return memo;\n  };\n\n  // Return the first value which passes a truth test. Aliased as `detect`.\n  _.find = _.detect = function(obj, iterator, context) {\n    var result;\n    any(obj, function(value, index, list) {\n      if (iterator.call(context, value, index, list)) {\n        result = value;\n        return true;\n      }\n    });\n    return result;\n  };\n\n  // Return all the elements that pass a truth test.\n  // Delegates to **ECMAScript 5**'s native `filter` if available.\n  // Aliased as `select`.\n  _.filter = _.select = function(obj, iterator, context) {\n    var results = [];\n    if (obj == null) return results;\n    if (nativeFilter && obj.filter === nativeFilter) return obj.filter(iterator, context);\n    each(obj, function(value, index, list) {\n      if (iterator.call(context, value, index, list)) results.push(value);\n    });\n    return results;\n  };\n\n  // Return all the elements for which a truth test fails.\n  _.reject = function(obj, iterator, context) {\n    return _.filter(obj, function(value, index, list) {\n      return !iterator.call(context, value, index, list);\n    }, context);\n  };\n\n  // Determine whether all of the elements match a truth test.\n  // Delegates to **ECMAScript 5**'s native `every` if available.\n  // Aliased as `all`.\n  _.every = _.all = function(obj, iterator, context) {\n    iterator || (iterator = _.identity);\n    var result = true;\n    if (obj == null) return result;\n    if (nativeEvery && obj.every === nativeEvery) return obj.every(iterator, context);\n    each(obj, function(value, index, list) {\n      if (!(result = result && iterator.call(context, value, index, list))) return breaker;\n    });\n    return !!result;\n  };\n\n  // Determine if at least one element in the object matches a truth test.\n  // Delegates to **ECMAScript 5**'s native `some` if available.\n  // Aliased as `any`.\n  var any = _.some = _.any = function(obj, iterator, context) {\n    iterator || (iterator = _.identity);\n    var result = false;\n    if (obj == null) return result;\n    if (nativeSome && obj.some === nativeSome) return obj.some(iterator, context);\n    each(obj, function(value, index, list) {\n      if (result || (result = iterator.call(context, value, index, list))) return breaker;\n    });\n    return !!result;\n  };\n\n  // Determine if the array or object contains a given value (using `===`).\n  // Aliased as `include`.\n  _.contains = _.include = function(obj, target) {\n    if (obj == null) return false;\n    if (nativeIndexOf && obj.indexOf === nativeIndexOf) return obj.indexOf(target) != -1;\n    return any(obj, function(value) {\n      return value === target;\n    });\n  };\n\n  // Invoke a method (with arguments) on every item in a collection.\n  _.invoke = function(obj, method) {\n    var args = slice.call(arguments, 2);\n    var isFunc = _.isFunction(method);\n    return _.map(obj, function(value) {\n      return (isFunc ? method : value[method]).apply(value, args);\n    });\n  };\n\n  // Convenience version of a common use case of `map`: fetching a property.\n  _.pluck = function(obj, key) {\n    return _.map(obj, function(value){ return value[key]; });\n  };\n\n  // Convenience version of a common use case of `filter`: selecting only objects\n  // containing specific `key:value` pairs.\n  _.where = function(obj, attrs, first) {\n    if (_.isEmpty(attrs)) return first ? void 0 : [];\n    return _[first ? 'find' : 'filter'](obj, function(value) {\n      for (var key in attrs) {\n        if (attrs[key] !== value[key]) return false;\n      }\n      return true;\n    });\n  };\n\n  // Convenience version of a common use case of `find`: getting the first object\n  // containing specific `key:value` pairs.\n  _.findWhere = function(obj, attrs) {\n    return _.where(obj, attrs, true);\n  };\n\n  // Return the maximum element or (element-based computation).\n  // Can't optimize arrays of integers longer than 65,535 elements.\n  // See [WebKit Bug 80797](https://bugs.webkit.org/show_bug.cgi?id=80797)\n  _.max = function(obj, iterator, context) {\n    if (!iterator && _.isArray(obj) && obj[0] === +obj[0] && obj.length < 65535) {\n      return Math.max.apply(Math, obj);\n    }\n    if (!iterator && _.isEmpty(obj)) return -Infinity;\n    var result = {computed : -Infinity, value: -Infinity};\n    each(obj, function(value, index, list) {\n      var computed = iterator ? iterator.call(context, value, index, list) : value;\n      computed > result.computed && (result = {value : value, computed : computed});\n    });\n    return result.value;\n  };\n\n  // Return the minimum element (or element-based computation).\n  _.min = function(obj, iterator, context) {\n    if (!iterator && _.isArray(obj) && obj[0] === +obj[0] && obj.length < 65535) {\n      return Math.min.apply(Math, obj);\n    }\n    if (!iterator && _.isEmpty(obj)) return Infinity;\n    var result = {computed : Infinity, value: Infinity};\n    each(obj, function(value, index, list) {\n      var computed = iterator ? iterator.call(context, value, index, list) : value;\n      computed < result.computed && (result = {value : value, computed : computed});\n    });\n    return result.value;\n  };\n\n  // Shuffle an array, using the modern version of the \n  // [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/FisherYates_shuffle).\n  _.shuffle = function(obj) {\n    var rand;\n    var index = 0;\n    var shuffled = [];\n    each(obj, function(value) {\n      rand = _.random(index++);\n      shuffled[index - 1] = shuffled[rand];\n      shuffled[rand] = value;\n    });\n    return shuffled;\n  };\n\n  // Sample **n** random values from an array.\n  // If **n** is not specified, returns a single random element from the array.\n  // The internal `guard` argument allows it to work with `map`.\n  _.sample = function(obj, n, guard) {\n    if (arguments.length < 2 || guard) {\n      return obj[_.random(obj.length - 1)];\n    }\n    return _.shuffle(obj).slice(0, Math.max(0, n));\n  };\n\n  // An internal function to generate lookup iterators.\n  var lookupIterator = function(value) {\n    return _.isFunction(value) ? value : function(obj){ return obj[value]; };\n  };\n\n  // Sort the object's values by a criterion produced by an iterator.\n  _.sortBy = function(obj, value, context) {\n    var iterator = lookupIterator(value);\n    return _.pluck(_.map(obj, function(value, index, list) {\n      return {\n        value: value,\n        index: index,\n        criteria: iterator.call(context, value, index, list)\n      };\n    }).sort(function(left, right) {\n      var a = left.criteria;\n      var b = right.criteria;\n      if (a !== b) {\n        if (a > b || a === void 0) return 1;\n        if (a < b || b === void 0) return -1;\n      }\n      return left.index - right.index;\n    }), 'value');\n  };\n\n  // An internal function used for aggregate \"group by\" operations.\n  var group = function(behavior) {\n    return function(obj, value, context) {\n      var result = {};\n      var iterator = value == null ? _.identity : lookupIterator(value);\n      each(obj, function(value, index) {\n        var key = iterator.call(context, value, index, obj);\n        behavior(result, key, value);\n      });\n      return result;\n    };\n  };\n\n  // Groups the object's values by a criterion. Pass either a string attribute\n  // to group by, or a function that returns the criterion.\n  _.groupBy = group(function(result, key, value) {\n    (_.has(result, key) ? result[key] : (result[key] = [])).push(value);\n  });\n\n  // Indexes the object's values by a criterion, similar to `groupBy`, but for\n  // when you know that your index values will be unique.\n  _.indexBy = group(function(result, key, value) {\n    result[key] = value;\n  });\n\n  // Counts instances of an object that group by a certain criterion. Pass\n  // either a string attribute to count by, or a function that returns the\n  // criterion.\n  _.countBy = group(function(result, key) {\n    _.has(result, key) ? result[key]++ : result[key] = 1;\n  });\n\n  // Use a comparator function to figure out the smallest index at which\n  // an object should be inserted so as to maintain order. Uses binary search.\n  _.sortedIndex = function(array, obj, iterator, context) {\n    iterator = iterator == null ? _.identity : lookupIterator(iterator);\n    var value = iterator.call(context, obj);\n    var low = 0, high = array.length;\n    while (low < high) {\n      var mid = (low + high) >>> 1;\n      iterator.call(context, array[mid]) < value ? low = mid + 1 : high = mid;\n    }\n    return low;\n  };\n\n  // Safely create a real, live array from anything iterable.\n  _.toArray = function(obj) {\n    if (!obj) return [];\n    if (_.isArray(obj)) return slice.call(obj);\n    if (obj.length === +obj.length) return _.map(obj, _.identity);\n    return _.values(obj);\n  };\n\n  // Return the number of elements in an object.\n  _.size = function(obj) {\n    if (obj == null) return 0;\n    return (obj.length === +obj.length) ? obj.length : _.keys(obj).length;\n  };\n\n  // Array Functions\n  // ---------------\n\n  // Get the first element of an array. Passing **n** will return the first N\n  // values in the array. Aliased as `head` and `take`. The **guard** check\n  // allows it to work with `_.map`.\n  _.first = _.head = _.take = function(array, n, guard) {\n    if (array == null) return void 0;\n    return (n == null) || guard ? array[0] : slice.call(array, 0, n);\n  };\n\n  // Returns everything but the last entry of the array. Especially useful on\n  // the arguments object. Passing **n** will return all the values in\n  // the array, excluding the last N. The **guard** check allows it to work with\n  // `_.map`.\n  _.initial = function(array, n, guard) {\n    return slice.call(array, 0, array.length - ((n == null) || guard ? 1 : n));\n  };\n\n  // Get the last element of an array. Passing **n** will return the last N\n  // values in the array. The **guard** check allows it to work with `_.map`.\n  _.last = function(array, n, guard) {\n    if (array == null) return void 0;\n    if ((n == null) || guard) {\n      return array[array.length - 1];\n    } else {\n      return slice.call(array, Math.max(array.length - n, 0));\n    }\n  };\n\n  // Returns everything but the first entry of the array. Aliased as `tail` and `drop`.\n  // Especially useful on the arguments object. Passing an **n** will return\n  // the rest N values in the array. The **guard**\n  // check allows it to work with `_.map`.\n  _.rest = _.tail = _.drop = function(array, n, guard) {\n    return slice.call(array, (n == null) || guard ? 1 : n);\n  };\n\n  // Trim out all falsy values from an array.\n  _.compact = function(array) {\n    return _.filter(array, _.identity);\n  };\n\n  // Internal implementation of a recursive `flatten` function.\n  var flatten = function(input, shallow, output) {\n    if (shallow && _.every(input, _.isArray)) {\n      return concat.apply(output, input);\n    }\n    each(input, function(value) {\n      if (_.isArray(value) || _.isArguments(value)) {\n        shallow ? push.apply(output, value) : flatten(value, shallow, output);\n      } else {\n        output.push(value);\n      }\n    });\n    return output;\n  };\n\n  // Flatten out an array, either recursively (by default), or just one level.\n  _.flatten = function(array, shallow) {\n    return flatten(array, shallow, []);\n  };\n\n  // Return a version of the array that does not contain the specified value(s).\n  _.without = function(array) {\n    return _.difference(array, slice.call(arguments, 1));\n  };\n\n  // Produce a duplicate-free version of the array. If the array has already\n  // been sorted, you have the option of using a faster algorithm.\n  // Aliased as `unique`.\n  _.uniq = _.unique = function(array, isSorted, iterator, context) {\n    if (_.isFunction(isSorted)) {\n      context = iterator;\n      iterator = isSorted;\n      isSorted = false;\n    }\n    var initial = iterator ? _.map(array, iterator, context) : array;\n    var results = [];\n    var seen = [];\n    each(initial, function(value, index) {\n      if (isSorted ? (!index || seen[seen.length - 1] !== value) : !_.contains(seen, value)) {\n        seen.push(value);\n        results.push(array[index]);\n      }\n    });\n    return results;\n  };\n\n  // Produce an array that contains the union: each distinct element from all of\n  // the passed-in arrays.\n  _.union = function() {\n    return _.uniq(_.flatten(arguments, true));\n  };\n\n  // Produce an array that contains every item shared between all the\n  // passed-in arrays.\n  _.intersection = function(array) {\n    var rest = slice.call(arguments, 1);\n    return _.filter(_.uniq(array), function(item) {\n      return _.every(rest, function(other) {\n        return _.indexOf(other, item) >= 0;\n      });\n    });\n  };\n\n  // Take the difference between one array and a number of other arrays.\n  // Only the elements present in just the first array will remain.\n  _.difference = function(array) {\n    var rest = concat.apply(ArrayProto, slice.call(arguments, 1));\n    return _.filter(array, function(value){ return !_.contains(rest, value); });\n  };\n\n  // Zip together multiple lists into a single array -- elements that share\n  // an index go together.\n  _.zip = function() {\n    var length = _.max(_.pluck(arguments, \"length\").concat(0));\n    var results = new Array(length);\n    for (var i = 0; i < length; i++) {\n      results[i] = _.pluck(arguments, '' + i);\n    }\n    return results;\n  };\n\n  // Converts lists into objects. Pass either a single array of `[key, value]`\n  // pairs, or two parallel arrays of the same length -- one of keys, and one of\n  // the corresponding values.\n  _.object = function(list, values) {\n    if (list == null) return {};\n    var result = {};\n    for (var i = 0, length = list.length; i < length; i++) {\n      if (values) {\n        result[list[i]] = values[i];\n      } else {\n        result[list[i][0]] = list[i][1];\n      }\n    }\n    return result;\n  };\n\n  // If the browser doesn't supply us with indexOf (I'm looking at you, **MSIE**),\n  // we need this function. Return the position of the first occurrence of an\n  // item in an array, or -1 if the item is not included in the array.\n  // Delegates to **ECMAScript 5**'s native `indexOf` if available.\n  // If the array is large and already in sort order, pass `true`\n  // for **isSorted** to use binary search.\n  _.indexOf = function(array, item, isSorted) {\n    if (array == null) return -1;\n    var i = 0, length = array.length;\n    if (isSorted) {\n      if (typeof isSorted == 'number') {\n        i = (isSorted < 0 ? Math.max(0, length + isSorted) : isSorted);\n      } else {\n        i = _.sortedIndex(array, item);\n        return array[i] === item ? i : -1;\n      }\n    }\n    if (nativeIndexOf && array.indexOf === nativeIndexOf) return array.indexOf(item, isSorted);\n    for (; i < length; i++) if (array[i] === item) return i;\n    return -1;\n  };\n\n  // Delegates to **ECMAScript 5**'s native `lastIndexOf` if available.\n  _.lastIndexOf = function(array, item, from) {\n    if (array == null) return -1;\n    var hasIndex = from != null;\n    if (nativeLastIndexOf && array.lastIndexOf === nativeLastIndexOf) {\n      return hasIndex ? array.lastIndexOf(item, from) : array.lastIndexOf(item);\n    }\n    var i = (hasIndex ? from : array.length);\n    while (i--) if (array[i] === item) return i;\n    return -1;\n  };\n\n  // Generate an integer Array containing an arithmetic progression. A port of\n  // the native Python `range()` function. See\n  // [the Python documentation](http://docs.python.org/library/functions.html#range).\n  _.range = function(start, stop, step) {\n    if (arguments.length <= 1) {\n      stop = start || 0;\n      start = 0;\n    }\n    step = arguments[2] || 1;\n\n    var length = Math.max(Math.ceil((stop - start) / step), 0);\n    var idx = 0;\n    var range = new Array(length);\n\n    while(idx < length) {\n      range[idx++] = start;\n      start += step;\n    }\n\n    return range;\n  };\n\n  // Function (ahem) Functions\n  // ------------------\n\n  // Reusable constructor function for prototype setting.\n  var ctor = function(){};\n\n  // Create a function bound to a given object (assigning `this`, and arguments,\n  // optionally). Delegates to **ECMAScript 5**'s native `Function.bind` if\n  // available.\n  _.bind = function(func, context) {\n    var args, bound;\n    if (nativeBind && func.bind === nativeBind) return nativeBind.apply(func, slice.call(arguments, 1));\n    if (!_.isFunction(func)) throw new TypeError;\n    args = slice.call(arguments, 2);\n    return bound = function() {\n      if (!(this instanceof bound)) return func.apply(context, args.concat(slice.call(arguments)));\n      ctor.prototype = func.prototype;\n      var self = new ctor;\n      ctor.prototype = null;\n      var result = func.apply(self, args.concat(slice.call(arguments)));\n      if (Object(result) === result) return result;\n      return self;\n    };\n  };\n\n  // Partially apply a function by creating a version that has had some of its\n  // arguments pre-filled, without changing its dynamic `this` context.\n  _.partial = function(func) {\n    var args = slice.call(arguments, 1);\n    return function() {\n      return func.apply(this, args.concat(slice.call(arguments)));\n    };\n  };\n\n  // Bind all of an object's methods to that object. Useful for ensuring that\n  // all callbacks defined on an object belong to it.\n  _.bindAll = function(obj) {\n    var funcs = slice.call(arguments, 1);\n    if (funcs.length === 0) throw new Error(\"bindAll must be passed function names\");\n    each(funcs, function(f) { obj[f] = _.bind(obj[f], obj); });\n    return obj;\n  };\n\n  // Memoize an expensive function by storing its results.\n  _.memoize = function(func, hasher) {\n    var memo = {};\n    hasher || (hasher = _.identity);\n    return function() {\n      var key = hasher.apply(this, arguments);\n      return _.has(memo, key) ? memo[key] : (memo[key] = func.apply(this, arguments));\n    };\n  };\n\n  // Delays a function for the given number of milliseconds, and then calls\n  // it with the arguments supplied.\n  _.delay = function(func, wait) {\n    var args = slice.call(arguments, 2);\n    return setTimeout(function(){ return func.apply(null, args); }, wait);\n  };\n\n  // Defers a function, scheduling it to run after the current call stack has\n  // cleared.\n  _.defer = function(func) {\n    return _.delay.apply(_, [func, 1].concat(slice.call(arguments, 1)));\n  };\n\n  // Returns a function, that, when invoked, will only be triggered at most once\n  // during a given window of time. Normally, the throttled function will run\n  // as much as it can, without ever going more than once per `wait` duration;\n  // but if you'd like to disable the execution on the leading edge, pass\n  // `{leading: false}`. To disable execution on the trailing edge, ditto.\n  _.throttle = function(func, wait, options) {\n    var context, args, result;\n    var timeout = null;\n    var previous = 0;\n    options || (options = {});\n    var later = function() {\n      previous = options.leading === false ? 0 : new Date;\n      timeout = null;\n      result = func.apply(context, args);\n    };\n    return function() {\n      var now = new Date;\n      if (!previous && options.leading === false) previous = now;\n      var remaining = wait - (now - previous);\n      context = this;\n      args = arguments;\n      if (remaining <= 0) {\n        clearTimeout(timeout);\n        timeout = null;\n        previous = now;\n        result = func.apply(context, args);\n      } else if (!timeout && options.trailing !== false) {\n        timeout = setTimeout(later, remaining);\n      }\n      return result;\n    };\n  };\n\n  // Returns a function, that, as long as it continues to be invoked, will not\n  // be triggered. The function will be called after it stops being called for\n  // N milliseconds. If `immediate` is passed, trigger the function on the\n  // leading edge, instead of the trailing.\n  _.debounce = function(func, wait, immediate) {\n    var timeout, args, context, timestamp, result;\n    return function() {\n      context = this;\n      args = arguments;\n      timestamp = new Date();\n      var later = function() {\n        var last = (new Date()) - timestamp;\n        if (last < wait) {\n          timeout = setTimeout(later, wait - last);\n        } else {\n          timeout = null;\n          if (!immediate) result = func.apply(context, args);\n        }\n      };\n      var callNow = immediate && !timeout;\n      if (!timeout) {\n        timeout = setTimeout(later, wait);\n      }\n      if (callNow) result = func.apply(context, args);\n      return result;\n    };\n  };\n\n  // Returns a function that will be executed at most one time, no matter how\n  // often you call it. Useful for lazy initialization.\n  _.once = function(func) {\n    var ran = false, memo;\n    return function() {\n      if (ran) return memo;\n      ran = true;\n      memo = func.apply(this, arguments);\n      func = null;\n      return memo;\n    };\n  };\n\n  // Returns the first function passed as an argument to the second,\n  // allowing you to adjust arguments, run code before and after, and\n  // conditionally execute the original function.\n  _.wrap = function(func, wrapper) {\n    return function() {\n      var args = [func];\n      push.apply(args, arguments);\n      return wrapper.apply(this, args);\n    };\n  };\n\n  // Returns a function that is the composition of a list of functions, each\n  // consuming the return value of the function that follows.\n  _.compose = function() {\n    var funcs = arguments;\n    return function() {\n      var args = arguments;\n      for (var i = funcs.length - 1; i >= 0; i--) {\n        args = [funcs[i].apply(this, args)];\n      }\n      return args[0];\n    };\n  };\n\n  // Returns a function that will only be executed after being called N times.\n  _.after = function(times, func) {\n    return function() {\n      if (--times < 1) {\n        return func.apply(this, arguments);\n      }\n    };\n  };\n\n  // Object Functions\n  // ----------------\n\n  // Retrieve the names of an object's properties.\n  // Delegates to **ECMAScript 5**'s native `Object.keys`\n  _.keys = nativeKeys || function(obj) {\n    if (obj !== Object(obj)) throw new TypeError('Invalid object');\n    var keys = [];\n    for (var key in obj) if (_.has(obj, key)) keys.push(key);\n    return keys;\n  };\n\n  // Retrieve the values of an object's properties.\n  _.values = function(obj) {\n    var keys = _.keys(obj);\n    var length = keys.length;\n    var values = new Array(length);\n    for (var i = 0; i < length; i++) {\n      values[i] = obj[keys[i]];\n    }\n    return values;\n  };\n\n  // Convert an object into a list of `[key, value]` pairs.\n  _.pairs = function(obj) {\n    var keys = _.keys(obj);\n    var length = keys.length;\n    var pairs = new Array(length);\n    for (var i = 0; i < length; i++) {\n      pairs[i] = [keys[i], obj[keys[i]]];\n    }\n    return pairs;\n  };\n\n  // Invert the keys and values of an object. The values must be serializable.\n  _.invert = function(obj) {\n    var result = {};\n    var keys = _.keys(obj);\n    for (var i = 0, length = keys.length; i < length; i++) {\n      result[obj[keys[i]]] = keys[i];\n    }\n    return result;\n  };\n\n  // Return a sorted list of the function names available on the object.\n  // Aliased as `methods`\n  _.functions = _.methods = function(obj) {\n    var names = [];\n    for (var key in obj) {\n      if (_.isFunction(obj[key])) names.push(key);\n    }\n    return names.sort();\n  };\n\n  // Extend a given object with all the properties in passed-in object(s).\n  _.extend = function(obj) {\n    each(slice.call(arguments, 1), function(source) {\n      if (source) {\n        for (var prop in source) {\n          obj[prop] = source[prop];\n        }\n      }\n    });\n    return obj;\n  };\n\n  // Return a copy of the object only containing the whitelisted properties.\n  _.pick = function(obj) {\n    var copy = {};\n    var keys = concat.apply(ArrayProto, slice.call(arguments, 1));\n    each(keys, function(key) {\n      if (key in obj) copy[key] = obj[key];\n    });\n    return copy;\n  };\n\n   // Return a copy of the object without the blacklisted properties.\n  _.omit = function(obj) {\n    var copy = {};\n    var keys = concat.apply(ArrayProto, slice.call(arguments, 1));\n    for (var key in obj) {\n      if (!_.contains(keys, key)) copy[key] = obj[key];\n    }\n    return copy;\n  };\n\n  // Fill in a given object with default properties.\n  _.defaults = function(obj) {\n    each(slice.call(arguments, 1), function(source) {\n      if (source) {\n        for (var prop in source) {\n          if (obj[prop] === void 0) obj[prop] = source[prop];\n        }\n      }\n    });\n    return obj;\n  };\n\n  // Create a (shallow-cloned) duplicate of an object.\n  _.clone = function(obj) {\n    if (!_.isObject(obj)) return obj;\n    return _.isArray(obj) ? obj.slice() : _.extend({}, obj);\n  };\n\n  // Invokes interceptor with the obj, and then returns obj.\n  // The primary purpose of this method is to \"tap into\" a method chain, in\n  // order to perform operations on intermediate results within the chain.\n  _.tap = function(obj, interceptor) {\n    interceptor(obj);\n    return obj;\n  };\n\n  // Internal recursive comparison function for `isEqual`.\n  var eq = function(a, b, aStack, bStack) {\n    // Identical objects are equal. `0 === -0`, but they aren't identical.\n    // See the [Harmony `egal` proposal](http://wiki.ecmascript.org/doku.php?id=harmony:egal).\n    if (a === b) return a !== 0 || 1 / a == 1 / b;\n    // A strict comparison is necessary because `null == undefined`.\n    if (a == null || b == null) return a === b;\n    // Unwrap any wrapped objects.\n    if (a instanceof _) a = a._wrapped;\n    if (b instanceof _) b = b._wrapped;\n    // Compare `[[Class]]` names.\n    var className = toString.call(a);\n    if (className != toString.call(b)) return false;\n    switch (className) {\n      // Strings, numbers, dates, and booleans are compared by value.\n      case '[object String]':\n        // Primitives and their corresponding object wrappers are equivalent; thus, `\"5\"` is\n        // equivalent to `new String(\"5\")`.\n        return a == String(b);\n      case '[object Number]':\n        // `NaN`s are equivalent, but non-reflexive. An `egal` comparison is performed for\n        // other numeric values.\n        return a != +a ? b != +b : (a == 0 ? 1 / a == 1 / b : a == +b);\n      case '[object Date]':\n      case '[object Boolean]':\n        // Coerce dates and booleans to numeric primitive values. Dates are compared by their\n        // millisecond representations. Note that invalid dates with millisecond representations\n        // of `NaN` are not equivalent.\n        return +a == +b;\n      // RegExps are compared by their source patterns and flags.\n      case '[object RegExp]':\n        return a.source == b.source &&\n               a.global == b.global &&\n               a.multiline == b.multiline &&\n               a.ignoreCase == b.ignoreCase;\n    }\n    if (typeof a != 'object' || typeof b != 'object') return false;\n    // Assume equality for cyclic structures. The algorithm for detecting cyclic\n    // structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.\n    var length = aStack.length;\n    while (length--) {\n      // Linear search. Performance is inversely proportional to the number of\n      // unique nested structures.\n      if (aStack[length] == a) return bStack[length] == b;\n    }\n    // Objects with different constructors are not equivalent, but `Object`s\n    // from different frames are.\n    var aCtor = a.constructor, bCtor = b.constructor;\n    if (aCtor !== bCtor && !(_.isFunction(aCtor) && (aCtor instanceof aCtor) &&\n                             _.isFunction(bCtor) && (bCtor instanceof bCtor))) {\n      return false;\n    }\n    // Add the first object to the stack of traversed objects.\n    aStack.push(a);\n    bStack.push(b);\n    var size = 0, result = true;\n    // Recursively compare objects and arrays.\n    if (className == '[object Array]') {\n      // Compare array lengths to determine if a deep comparison is necessary.\n      size = a.length;\n      result = size == b.length;\n      if (result) {\n        // Deep compare the contents, ignoring non-numeric properties.\n        while (size--) {\n          if (!(result = eq(a[size], b[size], aStack, bStack))) break;\n        }\n      }\n    } else {\n      // Deep compare objects.\n      for (var key in a) {\n        if (_.has(a, key)) {\n          // Count the expected number of properties.\n          size++;\n          // Deep compare each member.\n          if (!(result = _.has(b, key) && eq(a[key], b[key], aStack, bStack))) break;\n        }\n      }\n      // Ensure that both objects contain the same number of properties.\n      if (result) {\n        for (key in b) {\n          if (_.has(b, key) && !(size--)) break;\n        }\n        result = !size;\n      }\n    }\n    // Remove the first object from the stack of traversed objects.\n    aStack.pop();\n    bStack.pop();\n    return result;\n  };\n\n  // Perform a deep comparison to check if two objects are equal.\n  _.isEqual = function(a, b) {\n    return eq(a, b, [], []);\n  };\n\n  // Is a given array, string, or object empty?\n  // An \"empty\" object has no enumerable own-properties.\n  _.isEmpty = function(obj) {\n    if (obj == null) return true;\n    if (_.isArray(obj) || _.isString(obj)) return obj.length === 0;\n    for (var key in obj) if (_.has(obj, key)) return false;\n    return true;\n  };\n\n  // Is a given value a DOM element?\n  _.isElement = function(obj) {\n    return !!(obj && obj.nodeType === 1);\n  };\n\n  // Is a given value an array?\n  // Delegates to ECMA5's native Array.isArray\n  _.isArray = nativeIsArray || function(obj) {\n    return toString.call(obj) == '[object Array]';\n  };\n\n  // Is a given variable an object?\n  _.isObject = function(obj) {\n    return obj === Object(obj);\n  };\n\n  // Add some isType methods: isArguments, isFunction, isString, isNumber, isDate, isRegExp.\n  each(['Arguments', 'Function', 'String', 'Number', 'Date', 'RegExp'], function(name) {\n    _['is' + name] = function(obj) {\n      return toString.call(obj) == '[object ' + name + ']';\n    };\n  });\n\n  // Define a fallback version of the method in browsers (ahem, IE), where\n  // there isn't any inspectable \"Arguments\" type.\n  if (!_.isArguments(arguments)) {\n    _.isArguments = function(obj) {\n      return !!(obj && _.has(obj, 'callee'));\n    };\n  }\n\n  // Optimize `isFunction` if appropriate.\n  if (typeof (/./) !== 'function') {\n    _.isFunction = function(obj) {\n      return typeof obj === 'function';\n    };\n  }\n\n  // Is a given object a finite number?\n  _.isFinite = function(obj) {\n    return isFinite(obj) && !isNaN(parseFloat(obj));\n  };\n\n  // Is the given value `NaN`? (NaN is the only number which does not equal itself).\n  _.isNaN = function(obj) {\n    return _.isNumber(obj) && obj != +obj;\n  };\n\n  // Is a given value a boolean?\n  _.isBoolean = function(obj) {\n    return obj === true || obj === false || toString.call(obj) == '[object Boolean]';\n  };\n\n  // Is a given value equal to null?\n  _.isNull = function(obj) {\n    return obj === null;\n  };\n\n  // Is a given variable undefined?\n  _.isUndefined = function(obj) {\n    return obj === void 0;\n  };\n\n  // Shortcut function for checking if an object has a given property directly\n  // on itself (in other words, not on a prototype).\n  _.has = function(obj, key) {\n    return hasOwnProperty.call(obj, key);\n  };\n\n  // Utility Functions\n  // -----------------\n\n  // Run Underscore.js in *noConflict* mode, returning the `_` variable to its\n  // previous owner. Returns a reference to the Underscore object.\n  _.noConflict = function() {\n    root._ = previousUnderscore;\n    return this;\n  };\n\n  // Keep the identity function around for default iterators.\n  _.identity = function(value) {\n    return value;\n  };\n\n  // Run a function **n** times.\n  _.times = function(n, iterator, context) {\n    var accum = Array(Math.max(0, n));\n    for (var i = 0; i < n; i++) accum[i] = iterator.call(context, i);\n    return accum;\n  };\n\n  // Return a random integer between min and max (inclusive).\n  _.random = function(min, max) {\n    if (max == null) {\n      max = min;\n      min = 0;\n    }\n    return min + Math.floor(Math.random() * (max - min + 1));\n  };\n\n  // List of HTML entities for escaping.\n  var entityMap = {\n    escape: {\n      '&': '&amp;',\n      '<': '&lt;',\n      '>': '&gt;',\n      '\"': '&quot;',\n      \"'\": '&#x27;'\n    }\n  };\n  entityMap.unescape = _.invert(entityMap.escape);\n\n  // Regexes containing the keys and values listed immediately above.\n  var entityRegexes = {\n    escape:   new RegExp('[' + _.keys(entityMap.escape).join('') + ']', 'g'),\n    unescape: new RegExp('(' + _.keys(entityMap.unescape).join('|') + ')', 'g')\n  };\n\n  // Functions for escaping and unescaping strings to/from HTML interpolation.\n  _.each(['escape', 'unescape'], function(method) {\n    _[method] = function(string) {\n      if (string == null) return '';\n      return ('' + string).replace(entityRegexes[method], function(match) {\n        return entityMap[method][match];\n      });\n    };\n  });\n\n  // If the value of the named `property` is a function then invoke it with the\n  // `object` as context; otherwise, return it.\n  _.result = function(object, property) {\n    if (object == null) return void 0;\n    var value = object[property];\n    return _.isFunction(value) ? value.call(object) : value;\n  };\n\n  // Add your own custom functions to the Underscore object.\n  _.mixin = function(obj) {\n    each(_.functions(obj), function(name) {\n      var func = _[name] = obj[name];\n      _.prototype[name] = function() {\n        var args = [this._wrapped];\n        push.apply(args, arguments);\n        return result.call(this, func.apply(_, args));\n      };\n    });\n  };\n\n  // Generate a unique integer id (unique within the entire client session).\n  // Useful for temporary DOM ids.\n  var idCounter = 0;\n  _.uniqueId = function(prefix) {\n    var id = ++idCounter + '';\n    return prefix ? prefix + id : id;\n  };\n\n  // By default, Underscore uses ERB-style template delimiters, change the\n  // following template settings to use alternative delimiters.\n  _.templateSettings = {\n    evaluate    : /<%([\\s\\S]+?)%>/g,\n    interpolate : /<%=([\\s\\S]+?)%>/g,\n    escape      : /<%-([\\s\\S]+?)%>/g\n  };\n\n  // When customizing `templateSettings`, if you don't want to define an\n  // interpolation, evaluation or escaping regex, we need one that is\n  // guaranteed not to match.\n  var noMatch = /(.)^/;\n\n  // Certain characters need to be escaped so that they can be put into a\n  // string literal.\n  var escapes = {\n    \"'\":      \"'\",\n    '\\\\':     '\\\\',\n    '\\r':     'r',\n    '\\n':     'n',\n    '\\t':     't',\n    '\\u2028': 'u2028',\n    '\\u2029': 'u2029'\n  };\n\n  var escaper = /\\\\|'|\\r|\\n|\\t|\\u2028|\\u2029/g;\n\n  // JavaScript micro-templating, similar to John Resig's implementation.\n  // Underscore templating handles arbitrary delimiters, preserves whitespace,\n  // and correctly escapes quotes within interpolated code.\n  _.template = function(text, data, settings) {\n    var render;\n    settings = _.defaults({}, settings, _.templateSettings);\n\n    // Combine delimiters into one regular expression via alternation.\n    var matcher = new RegExp([\n      (settings.escape || noMatch).source,\n      (settings.interpolate || noMatch).source,\n      (settings.evaluate || noMatch).source\n    ].join('|') + '|$', 'g');\n\n    // Compile the template source, escaping string literals appropriately.\n    var index = 0;\n    var source = \"__p+='\";\n    text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {\n      source += text.slice(index, offset)\n        .replace(escaper, function(match) { return '\\\\' + escapes[match]; });\n\n      if (escape) {\n        source += \"'+\\n((__t=(\" + escape + \"))==null?'':_.escape(__t))+\\n'\";\n      }\n      if (interpolate) {\n        source += \"'+\\n((__t=(\" + interpolate + \"))==null?'':__t)+\\n'\";\n      }\n      if (evaluate) {\n        source += \"';\\n\" + evaluate + \"\\n__p+='\";\n      }\n      index = offset + match.length;\n      return match;\n    });\n    source += \"';\\n\";\n\n    // If a variable is not specified, place data values in local scope.\n    if (!settings.variable) source = 'with(obj||{}){\\n' + source + '}\\n';\n\n    source = \"var __t,__p='',__j=Array.prototype.join,\" +\n      \"print=function(){__p+=__j.call(arguments,'');};\\n\" +\n      source + \"return __p;\\n\";\n\n    try {\n      render = new Function(settings.variable || 'obj', '_', source);\n    } catch (e) {\n      e.source = source;\n      throw e;\n    }\n\n    if (data) return render(data, _);\n    var template = function(data) {\n      return render.call(this, data, _);\n    };\n\n    // Provide the compiled function source as a convenience for precompilation.\n    template.source = 'function(' + (settings.variable || 'obj') + '){\\n' + source + '}';\n\n    return template;\n  };\n\n  // Add a \"chain\" function, which will delegate to the wrapper.\n  _.chain = function(obj) {\n    return _(obj).chain();\n  };\n\n  // OOP\n  // ---------------\n  // If Underscore is called as a function, it returns a wrapped object that\n  // can be used OO-style. This wrapper holds altered versions of all the\n  // underscore functions. Wrapped objects may be chained.\n\n  // Helper function to continue chaining intermediate results.\n  var result = function(obj) {\n    return this._chain ? _(obj).chain() : obj;\n  };\n\n  // Add all of the Underscore functions to the wrapper object.\n  _.mixin(_);\n\n  // Add all mutator Array functions to the wrapper.\n  each(['pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift'], function(name) {\n    var method = ArrayProto[name];\n    _.prototype[name] = function() {\n      var obj = this._wrapped;\n      method.apply(obj, arguments);\n      if ((name == 'shift' || name == 'splice') && obj.length === 0) delete obj[0];\n      return result.call(this, obj);\n    };\n  });\n\n  // Add all accessor Array functions to the wrapper.\n  each(['concat', 'join', 'slice'], function(name) {\n    var method = ArrayProto[name];\n    _.prototype[name] = function() {\n      return result.call(this, method.apply(this._wrapped, arguments));\n    };\n  });\n\n  _.extend(_.prototype, {\n\n    // Start chaining a wrapped Underscore object.\n    chain: function() {\n      this._chain = true;\n      return this;\n    },\n\n    // Extracts the result from a wrapped and chained object.\n    value: function() {\n      return this._wrapped;\n    }\n\n  });\n\n}).call(this);\n","/* FileSaver.js\n *  A saveAs() FileSaver implementation.\n *  2014-05-27\n *\n *  By Eli Grey, http://eligrey.com\n *  License: X11/MIT\n *    See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md\n */\n\n/*global self */\n/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */\n\n/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */\n\nvar saveAs = saveAs\n  // IE 10+ (native saveAs)\n  || (typeof navigator !== \"undefined\" &&\n      navigator.msSaveOrOpenBlob && navigator.msSaveOrOpenBlob.bind(navigator))\n  // Everyone else\n  || (function(view) {\n\t\"use strict\";\n\t// IE <10 is explicitly unsupported\n\tif (typeof navigator !== \"undefined\" &&\n\t    /MSIE [1-9]\\./.test(navigator.userAgent)) {\n\t\treturn;\n\t}\n\tvar\n\t\t  doc = view.document\n\t\t  // only get URL when necessary in case Blob.js hasn't overridden it yet\n\t\t, get_URL = function() {\n\t\t\treturn view.URL || view.webkitURL || view;\n\t\t}\n\t\t, save_link = doc.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\")\n\t\t, can_use_save_link = !view.externalHost && \"download\" in save_link\n\t\t, click = function(node) {\n\t\t\tvar event = doc.createEvent(\"MouseEvents\");\n\t\t\tevent.initMouseEvent(\n\t\t\t\t\"click\", true, false, view, 0, 0, 0, 0, 0\n\t\t\t\t, false, false, false, false, 0, null\n\t\t\t);\n\t\t\tnode.dispatchEvent(event);\n\t\t}\n\t\t, webkit_req_fs = view.webkitRequestFileSystem\n\t\t, req_fs = view.requestFileSystem || webkit_req_fs || view.mozRequestFileSystem\n\t\t, throw_outside = function(ex) {\n\t\t\t(view.setImmediate || view.setTimeout)(function() {\n\t\t\t\tthrow ex;\n\t\t\t}, 0);\n\t\t}\n\t\t, force_saveable_type = \"application/octet-stream\"\n\t\t, fs_min_size = 0\n\t\t, deletion_queue = []\n\t\t, process_deletion_queue = function() {\n\t\t\tvar i = deletion_queue.length;\n\t\t\twhile (i--) {\n\t\t\t\tvar file = deletion_queue[i];\n\t\t\t\tif (typeof file === \"string\") { // file is an object URL\n\t\t\t\t\tget_URL().revokeObjectURL(file);\n\t\t\t\t} else { // file is a File\n\t\t\t\t\tfile.remove();\n\t\t\t\t}\n\t\t\t}\n\t\t\tdeletion_queue.length = 0; // clear queue\n\t\t}\n\t\t, dispatch = function(filesaver, event_types, event) {\n\t\t\tevent_types = [].concat(event_types);\n\t\t\tvar i = event_types.length;\n\t\t\twhile (i--) {\n\t\t\t\tvar listener = filesaver[\"on\" + event_types[i]];\n\t\t\t\tif (typeof listener === \"function\") {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlistener.call(filesaver, event || filesaver);\n\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\tthrow_outside(ex);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t, FileSaver = function(blob, name) {\n\t\t\t// First try a.download, then web filesystem, then object URLs\n\t\t\tvar\n\t\t\t\t  filesaver = this\n\t\t\t\t, type = blob.type\n\t\t\t\t, blob_changed = false\n\t\t\t\t, object_url\n\t\t\t\t, target_view\n\t\t\t\t, get_object_url = function() {\n\t\t\t\t\tvar object_url = get_URL().createObjectURL(blob);\n\t\t\t\t\tdeletion_queue.push(object_url);\n\t\t\t\t\treturn object_url;\n\t\t\t\t}\n\t\t\t\t, dispatch_all = function() {\n\t\t\t\t\tdispatch(filesaver, \"writestart progress write writeend\".split(\" \"));\n\t\t\t\t}\n\t\t\t\t// on any filesys errors revert to saving with object URLs\n\t\t\t\t, fs_error = function() {\n\t\t\t\t\t// don't create more object URLs than needed\n\t\t\t\t\tif (blob_changed || !object_url) {\n\t\t\t\t\t\tobject_url = get_object_url(blob);\n\t\t\t\t\t}\n\t\t\t\t\tif (target_view) {\n\t\t\t\t\t\ttarget_view.location.href = object_url;\n\t\t\t\t\t} else {\n\t\t\t\t\t\twindow.open(object_url, \"_blank\");\n\t\t\t\t\t}\n\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t\tdispatch_all();\n\t\t\t\t}\n\t\t\t\t, abortable = function(func) {\n\t\t\t\t\treturn function() {\n\t\t\t\t\t\tif (filesaver.readyState !== filesaver.DONE) {\n\t\t\t\t\t\t\treturn func.apply(this, arguments);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t, create_if_not_found = {create: true, exclusive: false}\n\t\t\t\t, slice\n\t\t\t;\n\t\t\tfilesaver.readyState = filesaver.INIT;\n\t\t\tif (!name) {\n\t\t\t\tname = \"download\";\n\t\t\t}\n\t\t\tif (can_use_save_link) {\n\t\t\t\tobject_url = get_object_url(blob);\n\t\t\t\tsave_link.href = object_url;\n\t\t\t\tsave_link.download = name;\n\t\t\t\tclick(save_link);\n\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\tdispatch_all();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// Object and web filesystem URLs have a problem saving in Google Chrome when\n\t\t\t// viewed in a tab, so I force save with application/octet-stream\n\t\t\t// http://code.google.com/p/chromium/issues/detail?id=91158\n\t\t\tif (view.chrome && type && type !== force_saveable_type) {\n\t\t\t\tslice = blob.slice || blob.webkitSlice;\n\t\t\t\tblob = slice.call(blob, 0, blob.size, force_saveable_type);\n\t\t\t\tblob_changed = true;\n\t\t\t}\n\t\t\t// Since I can't be sure that the guessed media type will trigger a download\n\t\t\t// in WebKit, I append .download to the filename.\n\t\t\t// https://bugs.webkit.org/show_bug.cgi?id=65440\n\t\t\tif (webkit_req_fs && name !== \"download\") {\n\t\t\t\tname += \".download\";\n\t\t\t}\n\t\t\tif (type === force_saveable_type || webkit_req_fs) {\n\t\t\t\ttarget_view = view;\n\t\t\t}\n\t\t\tif (!req_fs) {\n\t\t\t\tfs_error();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfs_min_size += blob.size;\n\t\t\treq_fs(view.TEMPORARY, fs_min_size, abortable(function(fs) {\n\t\t\t\tfs.root.getDirectory(\"saved\", create_if_not_found, abortable(function(dir) {\n\t\t\t\t\tvar save = function() {\n\t\t\t\t\t\tdir.getFile(name, create_if_not_found, abortable(function(file) {\n\t\t\t\t\t\t\tfile.createWriter(abortable(function(writer) {\n\t\t\t\t\t\t\t\twriter.onwriteend = function(event) {\n\t\t\t\t\t\t\t\t\ttarget_view.location.href = file.toURL();\n\t\t\t\t\t\t\t\t\tdeletion_queue.push(file);\n\t\t\t\t\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t\t\t\t\t\tdispatch(filesaver, \"writeend\", event);\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\twriter.onerror = function() {\n\t\t\t\t\t\t\t\t\tvar error = writer.error;\n\t\t\t\t\t\t\t\t\tif (error.code !== error.ABORT_ERR) {\n\t\t\t\t\t\t\t\t\t\tfs_error();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\"writestart progress write abort\".split(\" \").forEach(function(event) {\n\t\t\t\t\t\t\t\t\twriter[\"on\" + event] = filesaver[\"on\" + event];\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\twriter.write(blob);\n\t\t\t\t\t\t\t\tfilesaver.abort = function() {\n\t\t\t\t\t\t\t\t\twriter.abort();\n\t\t\t\t\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tfilesaver.readyState = filesaver.WRITING;\n\t\t\t\t\t\t\t}), fs_error);\n\t\t\t\t\t\t}), fs_error);\n\t\t\t\t\t};\n\t\t\t\t\tdir.getFile(name, {create: false}, abortable(function(file) {\n\t\t\t\t\t\t// delete file if it already exists\n\t\t\t\t\t\tfile.remove();\n\t\t\t\t\t\tsave();\n\t\t\t\t\t}), abortable(function(ex) {\n\t\t\t\t\t\tif (ex.code === ex.NOT_FOUND_ERR) {\n\t\t\t\t\t\t\tsave();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfs_error();\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t}), fs_error);\n\t\t\t}), fs_error);\n\t\t}\n\t\t, FS_proto = FileSaver.prototype\n\t\t, saveAs = function(blob, name) {\n\t\t\treturn new FileSaver(blob, name);\n\t\t}\n\t;\n\tFS_proto.abort = function() {\n\t\tvar filesaver = this;\n\t\tfilesaver.readyState = filesaver.DONE;\n\t\tdispatch(filesaver, \"abort\");\n\t};\n\tFS_proto.readyState = FS_proto.INIT = 0;\n\tFS_proto.WRITING = 1;\n\tFS_proto.DONE = 2;\n\n\tFS_proto.error =\n\tFS_proto.onwritestart =\n\tFS_proto.onprogress =\n\tFS_proto.onwrite =\n\tFS_proto.onabort =\n\tFS_proto.onerror =\n\tFS_proto.onwriteend =\n\t\tnull;\n\n\tview.addEventListener(\"unload\", process_deletion_queue, false);\n\tsaveAs.unload = function() {\n\t\tprocess_deletion_queue();\n\t\tview.removeEventListener(\"unload\", process_deletion_queue, false);\n\t};\n\treturn saveAs;\n}(\n\t   typeof self !== \"undefined\" && self\n\t|| typeof window !== \"undefined\" && window\n\t|| this.content\n));\n// `self` is undefined in Firefox for Android content script context\n// while `this` is nsIContentFrameMessageManager\n// with an attribute `content` that corresponds to the window\n\nif (typeof module !== \"undefined\" && module !== null) {\n  module.exports = saveAs;\n} else if ((typeof define !== \"undefined\" && define !== null) && (define.amd != null)) {\n  define([], function() {\n    return saveAs;\n  });\n}\n"]}