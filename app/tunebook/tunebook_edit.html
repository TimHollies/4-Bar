<section class="page-view" id="view-tunebook"> 
    <div class="header row coloured" intro='fade'>
        <div class="central-menu">
            <div class="app-name">
                <img src="/images/logo.png" on-click="navigate_back" class="app-logo" height="32px">
            </div>
        </div>
        <div class="page-title">
            <h1>Create Tunebook</h1>
        </div>
        {{>userbox}}
    </div>
    <div class="row editor">
        <div class="column half flex-column card-list" intro='fade:{ delay: 100 }'>
            <div id="search-box">
                    <i class="fa fa-search"></i>
                    <input on-keyup="updated_search" type="text" placeholder="Type here to search for a tune.." value="{{search_filter}}" />                               
                </div>
                <div class="search-options-bar">

                    <div class="search-option">
                        <label>Key</label>
                        <div class="key-selector">
                            <div on-click="key-selector-value-clicked" class="key-selector-value {{#if showingKeySelectorPopup}}open{{/if}}">All <i class="fa fa-arrow-down"></i></div>
                            {{#if showingKeySelectorPopup}}
                            <div class="key-selector-popup" on-click="key-popup-clicked">
                                <div class="key-selector-popup-top">
                                    <div class="key-selector-popup-top-left">
                                        <table class="key-letter-selection-table">
                                            <tr>
                                                <td on-click="toggle-note" note="A" class="{{#if keynote['A']}}on{{/if}}">A</td>
                                                <td on-click="toggle-note" note="A#" class="{{#if keynote['A#']}}on{{/if}}">A#</td>
                                                <td on-click="toggle-note" note="B" class="{{#if keynote['B']}}on{{/if}}">B</td>
                                                <td on-click="toggle-note" note="C" class="{{#if keynote['C']}}on{{/if}}">C</td>
                                                <td on-click="toggle-note" note="C#" class="{{#if keynote['C#']}}on{{/if}}">C#</td>
                                                <td on-click="toggle-note" note="D" class="{{#if keynote['D']}}on{{/if}}">D</td>
                                            </tr>
                                            <tr>
                                                <td on-click="toggle-note" note="D#" class="{{#if keynote['D#']}}on{{/if}}" >D#</td>
                                                <td on-click="toggle-note" note="E" class="{{#if keynote['E']}}on{{/if}}" >E</td>
                                                <td on-click="toggle-note" note="F" class="{{#if keynote['F']}}on{{/if}}" >F</td>
                                                <td on-click="toggle-note" note="F#" class="{{#if keynote['F#']}}on{{/if}}" >F#</td>
                                                <td on-click="toggle-note" note="G" class="{{#if keynote['G']}}on{{/if}}" >G</td>
                                                <td on-click="toggle-note" note="G#" class="{{#if keynote['G#']}}on{{/if}}" >G#</td>
                                            </tr>
                                        </table>
                                        <div class="span-button-container"><span on-click="clear-all-keys">Clear All</span><span on-click="select-all-keys">Select All</span></div>
                                    </div>
                                    <div class="key-selector-popup-top-right">
                                        <p>Include equivilent keys</p>
                                        <input type="checkbox" value="Bike">
                                    </div>
                                </div>
                                <table class="key-mode-selection-table">
                                    <tr>
                                        <td on-click="toggle-mode" mode="Major" class="{{#if keymode['Major']}}on{{/if}}">Major</td>
                                        <td on-click="toggle-mode" mode="Dorian" class="{{#if keymode['Dorian']}}on{{/if}}">Dorian</td>
                                        <td on-click="toggle-mode" mode="Phrygian" class="{{#if keymode['Phrygian']}}on{{/if}}">Phrygian</td>
                                        <td on-click="toggle-mode" mode="Lydian" class="{{#if keymode['Lydian']}}on{{/if}}">Lydian</td>
                                    </tr>
                                    <tr>
                                        <td on-click="toggle-mode" mode="Mixolydian" class="{{#if keymode['Mixolydian']}}on{{/if}}">Mixolydian</td>
                                        <td on-click="toggle-mode" mode="Minor" class="{{#if keymode['Minor']}}on{{/if}}">Minor</td>
                                        <td on-click="toggle-mode" mode="Locrian" class="{{#if keymode['Locrian']}}on{{/if}}">Locrian</td>
                                    </tr>
                                </table>
                                <div class="span-button-container"><span on-click="clear-all-modes">Clear All</span><span on-click="select-all-modes">Select All</span></div>
                            </div>
                            {{/if}}

                        </div>                        
                    </div>

                    <div class="search-option">
                        <label>Rhythm</label>
                        <select>
                            <option>All</option>
                            {{#each rhythm}}
                                <option>{{.}}</option>
                            {{/each}}
                        </select>
                    </div>

                    <div class="search-option">
                        <label>Type</label>
                        <select>
                            <option>All</option>
                        </select>
                    </div>

                    <div class="search-option">
                        <label>Time Signature</label>
                        <select>
                            <option>All</option>
                        </select>
                    </div>
                        
                </div> 
            <div class="scrollable flex-column">
                <ul class="item-list tune-list" id="allTunes">
                {{#each publicTuneNames}}
                    <li class="drag tune-list-item thin-card" tuneId="{{_id}}" tuneData="{{JSON.stringify(.)}}">
                        <h3>{{settings.rhythm}} - {{settings.key.note}}{{settings.key.mode}} - {{name}}</h3>
                        <!--<div class="tune-information-card compact">
                             <div class="card clearfix">
                                <div class="card-left">
                                    <h3>{{name}}</h3>
                                    <h4>{{settings.type}} - {{settings.key}}</h4>
                                </div>
                                <div class="card-right">
                                    <p>Added by <strong>Tim Hollies</strong> on {{metadata.createdOn}}</p>     
                                </div>                   
                            </div>
                        </div>-->
                    </li>
                {{/each}}
                </ul>
            </div>
        </div>
        <div class="column half" intro='fade:{ delay: 200 }' id='tunebook-editor-pane'>
            <div class="tunebook-card-full card flex-column">
                <div class="tunebook-settings">
                    <input class="title-box" type="text" value="{{tunebookName}}" />
                </div>
                <div class="tunebook-tunes flex-column">                
                    <ul class="item-list tune-list" id="selectedTunes">
                    </ul>
                </div>
                <div class="tunebook-footer">
                    <div class="footer-stats">
                        <span>{{selectedTuneCount}} tune{{#if selectedTuneCount !== 1}}s{{/if}} added</span>
                    </div>
                    <div class="footer-buttons">
                        <button on-click="save-tunebook">Save</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>